diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/MessagesController.java b/TMessagesProj/src/main/java/org/telegram/messenger/MessagesController.java
index 7f23bb5ea..e61548c88 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/MessagesController.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/MessagesController.java
@@ -2332,7 +2332,7 @@ public void run(TLObject response, TLRPC.TL_error error) {
                     final String isAttachment = newMsgObj.messageOwner.media instanceof TLRPC.TL_messageMediaEmpty ? "false" : "true";
 
                     if(peer != null){
-                        new Handler().post(new Runnable() {
+                        Utilities.RunOnUIThread(new Runnable() {
                             @Override
                             public void run() {
                                 if(Utils.isAndroidVersionAtLeast(11)){
@@ -2340,9 +2340,9 @@ public void run() {
                                 }else{
                                     new NotificationSenderTask().execute(String.valueOf(peer.user_id), String.valueOf(peer.chat_id), senderName, isAttachment, newMsgObj.messageText.toString());
                                 }
-                                }
+                            }
                         });
-                        }
+                    }
 
                     if (response instanceof TLRPC.TL_messages_sentMessage) {
                         TLRPC.TL_messages_sentMessage res = (TLRPC.TL_messages_sentMessage) response;
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/NotificationSenderTask.java b/TMessagesProj/src/main/java/org/telegram/messenger/NotificationSenderTask.java
index d182b923a..5c8055dde 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/NotificationSenderTask.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/NotificationSenderTask.java
@@ -5,6 +5,8 @@
 
 import com.aniways.Utils;
 
+import org.telegram.ui.ApplicationLoader;
+
 import static org.telegram.messenger.TLRPC.TL_messages_sendMessage;
 
 /**
@@ -23,7 +25,7 @@ protected String doInBackground(String... params) {
             final String messageText = isAttachment ? params[4] + " received from " + senderName : senderName + " says " + params[4];
 
             if (user_id != 0) {
-                new Handler().post(new Runnable() {
+                Utilities.RunOnUIThread(new Runnable() {
                     @Override
                     public void run() {
                         if(Utils.isAndroidVersionAtLeast(11)){
