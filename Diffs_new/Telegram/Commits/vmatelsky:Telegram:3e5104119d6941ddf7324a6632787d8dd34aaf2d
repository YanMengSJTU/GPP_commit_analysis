diff --git a/TMessagesProj/src/main/java/org/telegram/techrunch/my_churches/MyChurchesActivity.java b/TMessagesProj/src/main/java/org/telegram/techrunch/my_churches/MyChurchesActivity.java
index 0d1190e2e..6c8571cce 100644
--- a/TMessagesProj/src/main/java/org/telegram/techrunch/my_churches/MyChurchesActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/techrunch/my_churches/MyChurchesActivity.java
@@ -1,57 +1,24 @@
 package org.telegram.techrunch.my_churches;
 
-import android.app.Activity;
-import android.app.AlertDialog;
 import android.content.Context;
-import android.content.DialogInterface;
 import android.content.Intent;
-import android.content.SharedPreferences;
-import android.net.Uri;
-import android.os.Build;
-import android.os.Bundle;
-import android.support.v7.widget.ViewUtils;
-import android.util.TypedValue;
 import android.view.Gravity;
 import android.view.MotionEvent;
 import android.view.View;
 import android.view.View.OnClickListener;
-import android.widget.AbsListView;
-import android.widget.AdapterView;
 import android.widget.Button;
 import android.widget.EditText;
 import android.widget.FrameLayout;
 import android.widget.LinearLayout;
-import android.widget.ListView;
-import android.widget.TextView;
 
-import org.telegram.messenger.AndroidUtilities;
-import org.telegram.messenger.ApplicationLoader;
-import org.telegram.messenger.ContactsController;
-import org.telegram.messenger.FileLog;
 import org.telegram.messenger.LocaleController;
-import org.telegram.messenger.MessagesController;
-import org.telegram.messenger.MessagesStorage;
-import org.telegram.messenger.SecretChatHelper;
-import org.telegram.messenger.UserConfig;
 import org.telegram.messenger.techranch.R;
 import org.telegram.techrunch.select_city.SelectCity;
-import org.telegram.tgnet.TLRPC;
-import org.telegram.tgnet.TLRPC.User;
 import org.telegram.ui.ActionBar.ActionBar;
 import org.telegram.ui.ActionBar.ActionBarMenu;
 import org.telegram.ui.ActionBar.ActionBarMenuItem;
 import org.telegram.ui.ActionBar.BaseFragment;
-import org.telegram.ui.Adapters.ContactsAdapter;
-import org.telegram.ui.Adapters.SearchAdapter;
-import org.telegram.ui.ChannelCreateActivity;
-import org.telegram.ui.ChannelIntroActivity;
-import org.telegram.ui.ChatActivity;
 import org.telegram.ui.Components.LayoutHelper;
-import org.telegram.ui.Components.LetterSectionsListView;
-import org.telegram.ui.GroupCreateActivity;
-import org.telegram.ui.GroupInviteActivity;
-
-import java.util.ArrayList;
 
 /**
  * Created by vlad on 5/24/16.
@@ -95,8 +62,6 @@ public void onTextChanged(EditText editText) {
         });
         item.getSearchField().setHint(LocaleController.getString("Search", R.string.Search));
 
-
-
         fragmentView = new FrameLayout(context);
 
         LinearLayout emptyTextLayout = new LinearLayout(context);
@@ -115,13 +80,12 @@ public boolean onTouch(View v, MotionEvent event) {
             }
         });
 
-
         Button submit = new Button(context);
         submit.setText("Выбрать город");
         submit.setOnClickListener(new OnClickListener() {
             @Override
             public void onClick(final View view) {
-                context.startActivity(new Intent(context, SelectCity.class));
+                presentFragment(new SelectCity(), false);
             }
         });
 
diff --git a/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CitiesAdapter.java b/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CitiesAdapter.java
index be83958fc..83898a7bd 100644
--- a/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CitiesAdapter.java
+++ b/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CitiesAdapter.java
@@ -1,12 +1,17 @@
 package org.telegram.techrunch.select_city;
 
 import android.content.Context;
-import android.support.v7.widget.RecyclerView;
-import android.view.LayoutInflater;
-import android.view.View;
+import android.view.Gravity;
 import android.view.ViewGroup;
+import android.widget.ImageView;
+import android.widget.LinearLayout;
+import android.widget.TextView;
 
+import org.telegram.messenger.AndroidUtilities;
+import org.telegram.messenger.LocaleController;
+import org.telegram.messenger.support.widget.RecyclerView;
 import org.telegram.messenger.techranch.R;
+import org.telegram.ui.Components.LayoutHelper;
 
 import java.util.List;
 
@@ -18,39 +23,53 @@
     private static final int HEADER = 0;
     private static final int ITEM = 1;
 
-    private final Context mContext;
-    private final List<String> mData;
-    private List<String> mFiltered;
-    private final OnCityClickedListener mListener;
+    protected final Context mContext;
+    protected final List<String> mData;
+    protected final OnCityClickedListener mListener;
 
     public CitiesAdapter(Context context, List<String> data, OnCityClickedListener listener) {
         mContext = context;
         mData = data;
-        mFiltered = mData;
         mListener = listener;
     }
 
     @Override
     public CityViewHolder onCreateViewHolder(final ViewGroup parent, final int viewType) {
-        int layoutId = viewType == HEADER ? R.layout.select_city_header : R.layout.select_city_item_layout;
+        if (viewType == HEADER) {
 
-        View itemView = LayoutInflater.
-                from(mContext).
-                inflate(layoutId, parent, false);
+            TextView header = new TextView(parent.getContext());
+            header.setText(LocaleController.getString("techranch_cities", R.string.techranch_cities));
+            header.setTextColor(parent.getResources().getColor(android.R.color.darker_gray));
+            header.setLayoutParams(new RecyclerView.LayoutParams(RecyclerView.LayoutParams.MATCH_PARENT, RecyclerView.LayoutParams.WRAP_CONTENT));
+            header.setPadding(AndroidUtilities.dp(10), AndroidUtilities.dp(5), 0, AndroidUtilities.dp(5));
 
-        return new CityViewHolder(itemView);
+            return new CityViewHolder(header, null, null);
+        } else {
+            LinearLayout cell = new LinearLayout(parent.getContext());
+
+            TextView cityField = new TextView(parent.getContext());
+            cell.addView(cityField, LayoutHelper.createLinear(LayoutHelper.MATCH_PARENT, LayoutHelper.WRAP_CONTENT, 1, 10, 0, 0, 0));
+
+            ImageView nearMeField = new ImageView(parent.getContext());
+            nearMeField.setImageResource(R.drawable.ic_near_me);
+
+            cell.addView(nearMeField, LayoutHelper.createLinear(LayoutHelper.WRAP_CONTENT, LayoutHelper.WRAP_CONTENT, 0, 0, 10, 0));
+
+            cell.setLayoutParams(new RecyclerView.LayoutParams(RecyclerView.LayoutParams.MATCH_PARENT, AndroidUtilities.dp(40)));
+            return new CityViewHolder(cell, cityField, nearMeField);
+        }
     }
 
     @Override
     public void onBindViewHolder(final CityViewHolder holder, final int position) {
         if (position > 0) {
-            holder.bind(mContext, mFiltered.get(position - 1), mListener);
+            holder.bind(mContext, mData.get(position - 1), mListener);
         }
     }
 
     @Override
     public int getItemCount() {
-        return mFiltered.size() + 1;
+        return mData.size() + 1;
     }
 
     @Override
diff --git a/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CitiesSearchAdapter.java b/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CitiesSearchAdapter.java
index 1e1d9b736..d2ef7d7fa 100644
--- a/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CitiesSearchAdapter.java
+++ b/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CitiesSearchAdapter.java
@@ -1,47 +1,25 @@
 package org.telegram.techrunch.select_city;
 
 import android.content.Context;
-import android.support.v7.widget.RecyclerView;
-import android.view.LayoutInflater;
-import android.view.View;
-import android.view.ViewGroup;
 import android.widget.Filter;
 import android.widget.Filterable;
 
-import org.telegram.messenger.techranch.R;
-
 import java.util.ArrayList;
 import java.util.List;
 
 /**
  * Created by vlad on 5/24/16.
  */
-public class CitiesSearchAdapter extends RecyclerView.Adapter<CityViewHolder> implements Filterable {
+public class CitiesSearchAdapter extends CitiesAdapter implements Filterable {
 
     private static final int HEADER = 0;
     private static final int ITEM = 1;
 
-    private final Context mContext;
-    private final List<String> mData;
     private List<String> mFiltered;
-    private final OnCityClickedListener mListener;
 
     public CitiesSearchAdapter(Context context, final List<String> data, OnCityClickedListener listener) {
-        mContext = context;
-        mData = data;
+        super(context, data, listener);
         mFiltered = mData;
-        mListener = listener;
-    }
-
-    @Override
-    public CityViewHolder onCreateViewHolder(final ViewGroup parent, final int viewType) {
-        int layoutId = viewType == HEADER ? R.layout.select_city_header : R.layout.select_city_item_layout;
-
-        View itemView = LayoutInflater.
-                from(mContext).
-                inflate(layoutId, parent, false);
-
-        return new CityViewHolder(itemView);
     }
 
     @Override
diff --git a/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CityViewHolder.java b/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CityViewHolder.java
index f6a873bf8..e1b837e6f 100644
--- a/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CityViewHolder.java
+++ b/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/CityViewHolder.java
@@ -1,11 +1,11 @@
 package org.telegram.techrunch.select_city;
 
 import android.content.Context;
-import android.support.v7.widget.RecyclerView.ViewHolder;
 import android.view.View;
 import android.view.View.OnClickListener;
 import android.widget.TextView;
 
+import org.telegram.messenger.support.widget.RecyclerView.ViewHolder;
 import org.telegram.messenger.techranch.R;
 import org.telegram.techrunch.TechranchConfig;
 
@@ -14,13 +14,13 @@
  */
 public class CityViewHolder extends ViewHolder {
 
-    TextView mCityField;
-    View mNearMeField;
+    private final TextView mCityField;
+    private final View mNearMeField;
 
-    public CityViewHolder(final View itemView) {
+    public CityViewHolder(final View itemView, final TextView cityField, final View nearMeField) {
         super(itemView);
-        mCityField = (TextView) itemView.findViewById(R.id.city_field);
-        mNearMeField = itemView.findViewById(R.id.ic_near_me);
+        mCityField = cityField;
+        mNearMeField = nearMeField;
     }
 
     public void bind(final Context context, final String city, final OnCityClickedListener listener) {
@@ -29,7 +29,12 @@ public void bind(final Context context, final String city, final OnCityClickedLi
         final TechranchConfig config = new TechranchConfig(context);
         String selectedCity = config.getSelectedCity();
         final boolean isSelected = city.equals(selectedCity);
-        itemView.setSelected(isSelected);
+
+        if (isSelected) {
+            mCityField.setTextColor(context.getResources().getColor(R.color.techranch_selected));
+        } else {
+            mCityField.setTextColor(context.getResources().getColor(R.color.techranch_unselected));
+        }
 
         boolean canDisplayNearMe = isSelected && config.isUseNearMeEnabled();
         int nearMeVisibility = canDisplayNearMe ? View.VISIBLE : View.INVISIBLE;
diff --git a/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/SelectCity.java b/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/SelectCity.java
index c701e8ac5..a606812c8 100644
--- a/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/SelectCity.java
+++ b/TMessagesProj/src/main/java/org/telegram/techrunch/select_city/SelectCity.java
@@ -1,32 +1,40 @@
 package org.telegram.techrunch.select_city;
 
-import android.os.Bundle;
-import android.support.v7.app.AppCompatActivity;
-import android.support.v7.widget.LinearLayoutManager;
-import android.support.v7.widget.RecyclerView;
+import android.content.Context;
+import android.graphics.Color;
+import android.os.Build;
 import android.view.View;
 import android.view.View.OnClickListener;
-import android.view.Window;
+import android.widget.Button;
 import android.widget.EditText;
 import android.widget.FrameLayout;
+import android.widget.LinearLayout;
+import android.widget.ListView;
 import android.widget.TextView;
 
+import org.telegram.messenger.AndroidUtilities;
 import org.telegram.messenger.LocaleController;
+import org.telegram.messenger.support.widget.LinearLayoutManager;
 import org.telegram.messenger.techranch.R;
 import org.telegram.techrunch.TechranchConfig;
 import org.telegram.ui.ActionBar.ActionBar;
 import org.telegram.ui.ActionBar.ActionBarMenu;
 import org.telegram.ui.ActionBar.ActionBarMenuItem;
+import org.telegram.ui.ActionBar.BaseFragment;
+import org.telegram.ui.Components.LayoutHelper;
+import org.telegram.ui.Components.RecyclerListView;
 
 import java.util.Arrays;
 import java.util.List;
 
-public class SelectCity extends AppCompatActivity implements OnCityClickedListener {
+public class SelectCity extends BaseFragment implements OnCityClickedListener {
+
+    private RecyclerListView listView;
+    private LinearLayoutManager layoutManager;
 
-    RecyclerView mCitiesList;
     TextView mSelectedCity;
 
-    View mClosestToMe;
+    Button mClosestToMe;
 
     TechranchConfig mConfig;
 
@@ -36,18 +44,8 @@
     private CitiesSearchAdapter mCitiesSearchAdapter;
 
     @Override
-    protected void onCreate(Bundle savedInstanceState) {
-        requestWindowFeature(Window.FEATURE_NO_TITLE);
-        getWindow().setBackgroundDrawableResource(R.drawable.transparent);
-
-        super.onCreate(savedInstanceState);
-        setContentView(R.layout.activity_choose_town);
-
-        FrameLayout toolbarPlace = (FrameLayout) findViewById(R.id.toolbar_place);
-        ActionBar actionBar = new ActionBar(this);
-        toolbarPlace.addView(actionBar);
-
-        actionBar.setTitle(getString(R.string.techrunch_select_city));
+    public View createView(final Context context) {
+        actionBar.setTitle(LocaleController.getString("techrunch_select_city", R.string.techrunch_select_city));
 
         ActionBarMenu menu = actionBar.createMenu();
 
@@ -56,7 +54,7 @@ protected void onCreate(Bundle savedInstanceState) {
             @Override
             public void onSearchExpand() {
                 mClosestToMe.setVisibility(View.GONE);
-                mCitiesList.setAdapter(mCitiesSearchAdapter);
+                listView.setAdapter(mCitiesSearchAdapter);
             }
 
             @Override
@@ -67,7 +65,7 @@ public boolean canCollapseSearch() {
             @Override
             public void onSearchCollapse() {
                 mClosestToMe.setVisibility(View.VISIBLE);
-                mCitiesList.setAdapter(mCitiesAdapter);
+                listView.setAdapter(mCitiesAdapter);
             }
 
             @Override
@@ -81,38 +79,60 @@ public void onTextChanged(EditText editText) {
             @Override
             public void onItemClick(int id) {
                 if (id == -1) {
-                    onBackPressed();
+                    finishFragment();
                 }
             }
         });
 
-        mCitiesList = (RecyclerView) findViewById(R.id.techrunch_cities_list);
-        mCitiesList.setHasFixedSize(true);
-        LinearLayoutManager llm = new LinearLayoutManager(this);
-        llm.setOrientation(LinearLayoutManager.VERTICAL);
-        mCitiesList.setLayoutManager(llm);
+        LinearLayout layout = new LinearLayout(context);
+        layout.setOrientation(LinearLayout.VERTICAL);
+        fragmentView = layout;
+
+        listView = new RecyclerListView(context);
+        listView.setVerticalScrollBarEnabled(true);
+        listView.setItemAnimator(null);
+        listView.setLayoutAnimation(null);
+        layoutManager = new LinearLayoutManager(context);
+        layoutManager.setOrientation(LinearLayoutManager.VERTICAL);
+        listView.setLayoutManager(layoutManager);
+        if (Build.VERSION.SDK_INT >= 11) {
+            listView.setVerticalScrollbarPosition(LocaleController.isRTL ? ListView.SCROLLBAR_POSITION_LEFT : ListView.SCROLLBAR_POSITION_RIGHT);
+        }
 
-        mSelectedCity = (TextView) findViewById(R.id.techrunch_your_city_name);
+        FrameLayout container = new FrameLayout(context);
+        container.addView(listView, LayoutHelper.createFrame(LayoutHelper.MATCH_PARENT, LayoutHelper.WRAP_CONTENT));
+        layout.addView(container, LayoutHelper.createFrame(LayoutHelper.MATCH_PARENT, LayoutHelper.WRAP_CONTENT));
 
-        mConfig = new TechranchConfig(this);
+        mSelectedCity = new TextView(context);
+
+        mConfig = new TechranchConfig(context);
         setCityFromConfig();
 
-        mCities = Arrays.asList(getResources().getStringArray(R.array.cities_list));
-        mCitiesAdapter = new CitiesAdapter(this, mCities, this);
-        mCitiesSearchAdapter = new CitiesSearchAdapter(this, mCities, this);
-        mCitiesList.setAdapter(mCitiesAdapter);
+        mCities = Arrays.asList(context.getResources().getStringArray(R.array.cities_list));
+        mCitiesAdapter = new CitiesAdapter(context, mCities, this);
+        mCitiesSearchAdapter = new CitiesSearchAdapter(context, mCities, this);
+        listView.setAdapter(mCitiesAdapter);
+
+        mClosestToMe = new Button(context);
+        mClosestToMe.setText(LocaleController.getString("techrunch_closest_to_me", R.string.techrunch_closest_to_me));
+        mClosestToMe.setBackgroundColor(context.getResources().getColor(R.color.techrunch_primary_color));
+        mClosestToMe.setTextColor(Color.WHITE);
 
-        mClosestToMe = findViewById(R.id.techrunch_closest_to_me);
         mClosestToMe.setOnClickListener(new OnClickListener() {
             @Override
             public void onClick(final View v) {
-                final TechranchConfig config = new TechranchConfig(SelectCity.this);
+                final TechranchConfig config = new TechranchConfig(context);
 
                 config.setUseNearMe(!config.isUseNearMeEnabled());
 
-                mCitiesAdapter.notifyDataSetChanged();
+                listView.getAdapter().notifyDataSetChanged();
             }
         });
+
+
+        layout.addView(mClosestToMe, LayoutHelper.createLinear(LayoutHelper.MATCH_PARENT, AndroidUtilities.dp(20)));
+
+        return fragmentView;
     }
 
     private void setCityFromConfig() {
@@ -123,6 +143,6 @@ private void setCityFromConfig() {
     public void onCitySelected(final String city) {
         mConfig.setSelectedCity(city);
         setCityFromConfig();
-        mCitiesList.getAdapter().notifyDataSetChanged();
+        listView.getAdapter().notifyDataSetChanged();
     }
 }
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/LoginActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/LoginActivity.java
index 4b3c4f50b..3ea2b444f 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/LoginActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/LoginActivity.java
@@ -448,7 +448,7 @@ private void needFinishActivity() {
 
         TechranchConfig config = new TechranchConfig(getParentActivity());
         if (!config.isCitySelected()) {
-            getParentActivity().startActivity(new Intent(getParentActivity(), SelectCity.class));
+            presentFragment(new SelectCity(), false);
         }
     }
 
diff --git a/TMessagesProj/src/main/res/color/techrunch_selected_city_color.xml b/TMessagesProj/src/main/res/color/techrunch_selected_city_color.xml
deleted file mode 100644
index 38f09d666..000000000
--- a/TMessagesProj/src/main/res/color/techrunch_selected_city_color.xml
+++ /dev/null
@@ -1,9 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<selector xmlns:android="http://schemas.android.com/apk/res/android">
-
-    <item android:state_selected="true"
-          android:color="#ffff4444" />
-
-    <item android:color="@android:color/black" />
-
-</selector>
\ No newline at end of file
diff --git a/TMessagesProj/src/main/res/layout/select_city_item_layout.xml b/TMessagesProj/src/main/res/layout/select_city_item_layout.xml
deleted file mode 100644
index 58feaaf4a..000000000
--- a/TMessagesProj/src/main/res/layout/select_city_item_layout.xml
+++ /dev/null
@@ -1,29 +0,0 @@
-<LinearLayout
-    xmlns:android="http://schemas.android.com/apk/res/android"
-    android:layout_width="match_parent"
-    android:layout_height="wrap_content"
-    android:orientation="horizontal"
-    android:minHeight="?attr/listPreferredItemHeightSmall"
-    android:paddingLeft="@dimen/techranch_listPreferredItemPadding"
-    android:paddingRight="@dimen/techranch_listPreferredItemPadding">
-
-    <TextView
-        android:id="@+id/city_field"
-        android:layout_width="0dp"
-        android:layout_height="wrap_content"
-        android:layout_weight="1"
-        android:layout_gravity="center_vertical"
-        android:text="test"
-        android:textAppearance="?attr/textAppearanceListItemSmall"
-        android:textColor="@color/techrunch_selected_city_color"/>
-
-    <ImageView
-        android:id="@+id/ic_near_me"
-        android:layout_width="wrap_content"
-        android:layout_height="wrap_content"
-        android:layout_gravity="center_vertical"
-        android:paddingRight="10dp"
-        android:src="@drawable/ic_near_me"/>
-
-</LinearLayout>
-
diff --git a/TMessagesProj/src/main/res/values-ru/strings.xml b/TMessagesProj/src/main/res/values-ru/strings.xml
index 73d22c922..9acac9701 100644
--- a/TMessagesProj/src/main/res/values-ru/strings.xml
+++ b/TMessagesProj/src/main/res/values-ru/strings.xml
@@ -1216,7 +1216,7 @@
   <string name="formatDateAtTime">%1$s в %2$s</string>
 
 
-  <string name="techrunch_select_city">Выберите город</string>
+  <string name="techrunch_select_city">Выбор города</string>
   <string name="techrunch_your_city">Ваш город</string>
   <string name="techrunch_no_city">---</string>
   <string name="techrunch_closest_to_me">Ближайшие ко мне</string>
diff --git a/TMessagesProj/src/main/res/values/colors.xml b/TMessagesProj/src/main/res/values/colors.xml
index 05a4be9b8..5c4eebe55 100755
--- a/TMessagesProj/src/main/res/values/colors.xml
+++ b/TMessagesProj/src/main/res/values/colors.xml
@@ -2,4 +2,10 @@
 <resources>
     <color name="divider">#dcdcdc</color>
     <color name="techrunch_primary_color">#ff527da3</color>
+
+
+    <color name="techranch_selected">#ffff4444</color>
+    <color name="techranch_unselected">#000000</color>
+
+
 </resources>
\ No newline at end of file
