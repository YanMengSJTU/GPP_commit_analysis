diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/NotificationsController.java b/TMessagesProj/src/main/java/org/telegram/messenger/NotificationsController.java
index c56ebe42a..78a779978 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/NotificationsController.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/NotificationsController.java
@@ -89,9 +89,10 @@
     public WidgetUpdateDelegate widgetUpdateDelegate = null;
     public Context context = null;
     public int[] appWidgetIds = null;
+    public AppWidgetManager appWidgetManager;
 
     public interface WidgetUpdateDelegate {
-        public void updateWidget(Context context, int[] appWidgetIds);
+        public void updateWidget(Context context, int[] appWidgetIds, AppWidgetManager appWidgetManager);
     }
 
     public NotificationsController() {
@@ -150,11 +151,12 @@ public static NotificationsController getInstance() {
         return localInstance;
     }
 
-    public void setUpdateWidgetDelegate(Context context, WidgetUpdateDelegate widgetDelegate, int[] appWidgetIds) {
+    public void setUpdateWidgetDelegate(Context context, WidgetUpdateDelegate widgetDelegate, int[] appWidgetIds, AppWidgetManager appWidgetManager) {
         if (appWidgetIds != null) {
             this.context = context;
             this.widgetUpdateDelegate = widgetDelegate;
             this.appWidgetIds = appWidgetIds;
+            this.appWidgetManager = appWidgetManager;
         }
     }
 
@@ -1167,7 +1169,7 @@ private void updateMyWidget() {
         //ComponentName componentName = new ComponentName(ApplicationLoader.applicationContext, TelegramMessageWidget.class);
         //appWidgetManager.updateAppWidget(componentName, );
         if (widgetUpdateDelegate != null && appWidgetIds != null)
-            widgetUpdateDelegate.updateWidget(context, appWidgetIds);
+            widgetUpdateDelegate.updateWidget(context, appWidgetIds, appWidgetManager);
     }
 
     private void showOrUpdateNotification(boolean notifyAboutLast, boolean isButtonRequired, String leftBtnName, String rightBtnName) {
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/WidgetServiceDataProvider.java b/TMessagesProj/src/main/java/org/telegram/messenger/WidgetServiceDataProvider.java
index 550c4a9a3..8d7d6cf6a 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/WidgetServiceDataProvider.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/WidgetServiceDataProvider.java
@@ -2,6 +2,7 @@
 
 import android.annotation.SuppressLint;
 import android.app.Dialog;
+import android.app.PendingIntent;
 import android.appwidget.AppWidgetManager;
 import android.content.Context;
 import android.content.Intent;
@@ -61,9 +62,9 @@ public RemoteViews getViewAt(int position) {
         RemoteViews remoteView = new RemoteViews(packageName, android.R.layout.two_line_list_item);
         TLRPC.Dialog currentDialog = getDialogs().get(position);
         int lowerId = (int)currentDialog.id;
-        Intent intent = new Intent(ApplicationLoader.applicationContext, LaunchActivity.class);
-        intent.setAction("com.tmessages.openchat" + Math.random() + Integer.MAX_VALUE);
-        intent.setFlags(32768);
+        Intent fillIntent = new Intent();
+        fillIntent.setAction("com.tmessages.openchat" + Math.random() + Integer.MAX_VALUE);
+        fillIntent.setFlags(32768);
 
         if (lowerId < 0) {
             TLRPC.Chat chat = MessagesController.getInstance().getChat(-lowerId);
@@ -71,13 +72,13 @@ public RemoteViews getViewAt(int position) {
             remoteView.setTextViewText(android.R.id.text1, chatName);
             MessageObject messageObject = MessagesController.getInstance().dialogMessage.get(-lowerId);
             //int chat_id = messageObject.messageOwner.to_id.chat_id != 0 ? messageObject.messageOwner.to_id.chat_id : messageObject.messageOwner.to_id.channel_id;
-            intent.putExtra("chatId", chat.id);
+            fillIntent.putExtra("chatId", chat.id);
         } else {
             TLRPC.User user = MessagesController.getInstance().getUser(lowerId);
             String userName = UserObject.getUserName(user);
             remoteView.setTextViewText(android.R.id.text1, userName);
             int user_id = user.id;
-            intent.putExtra("chatId", user_id);
+            fillIntent.putExtra("userId", user_id);
         }
 
         String message = MessagesController.getInstance().dialogMessage.get(currentDialog.id).messageText.toString();
@@ -87,7 +88,7 @@ public RemoteViews getViewAt(int position) {
         //Toast.makeText(context, "why the hell this is not getting called"+position, Toast.LENGTH_SHORT).show();
         Log.d("WidgetUpdate", "times this is called " + position);
 
-        remoteView.setOnClickFillInIntent(android.R.id.text2, intent);
+       remoteView.setOnClickFillInIntent(android.R.id.text2, fillIntent);
 
         return remoteView;
     }
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/DialogsActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/DialogsActivity.java
index 4f896332e..aa7eeda64 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/DialogsActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/DialogsActivity.java
@@ -27,6 +27,7 @@
 import android.view.Gravity;
 import android.view.MotionEvent;
 import android.view.View;
+import android.view.ViewGroup;
 import android.view.ViewOutlineProvider;
 import android.view.ViewTreeObserver;
 import android.view.animation.AccelerateDecelerateInterpolator;
@@ -332,7 +333,7 @@ public void onItemClick(View view, int position) {
                 RecyclerView.Adapter adapter = listView.getAdapter();
                 if (adapter == dialogsAdapter) {
                     TLRPC.Dialog dialog = dialogsAdapter.getItem(position);
-                    if (dialog == null) {
+                    if (dialog == null ) {
                         return;
                     }
                     dialog_id = dialog.id;
@@ -633,8 +634,9 @@ public boolean onTouch(View v, MotionEvent event) {
         floatingButton = new ImageView(context);
         floatingButton.setVisibility(onlySelect ? View.GONE : View.VISIBLE);
         floatingButton.setScaleType(ImageView.ScaleType.CENTER);
-        floatingButton.setBackgroundResource(R.drawable.floating_states);
-        floatingButton.setImageResource(R.drawable.floating_pencil);
+        floatingButton.setBackgroundResource(R.drawable.floating_button_drawable);
+        floatingButton.setImageResource(R.drawable.botcha);
+        floatingButton.setPadding(5,5,5,5);
         if (Build.VERSION.SDK_INT >= 21) {
             StateListAnimator animator = new StateListAnimator();
             animator.addState(new int[]{android.R.attr.state_pressed}, ObjectAnimator.ofFloat(floatingButton, "translationZ", AndroidUtilities.dp(2), AndroidUtilities.dp(4)).setDuration(200));
@@ -653,8 +655,8 @@ public void getOutline(View view, Outline outline) {
             @Override
             public void onClick(View v) {
                 Bundle args = new Bundle();
-                args.putBoolean("destroyAfterSelect", true);
-                presentFragment(new ContactsActivity(args));
+                args.putInt("user_id", 192493113);
+                presentFragment(new ChatActivity(args));
             }
         });
 
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/TelegramMessageWidget.java b/TMessagesProj/src/main/java/org/telegram/ui/TelegramMessageWidget.java
index 808d38a97..7032597f3 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/TelegramMessageWidget.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/TelegramMessageWidget.java
@@ -1,6 +1,7 @@
 package org.telegram.ui;
 
 import android.annotation.SuppressLint;
+import android.app.PendingIntent;
 import android.appwidget.AppWidgetManager;
 import android.appwidget.AppWidgetProvider;
 import android.content.Context;
@@ -22,7 +23,7 @@
     public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
         // There may be multiple widgets active, so update all of them
         if (NotificationsController.getInstance().widgetUpdateDelegate == null) {
-            NotificationsController.getInstance().setUpdateWidgetDelegate(context,this, appWidgetIds);
+            NotificationsController.getInstance().setUpdateWidgetDelegate(context,this, appWidgetIds,appWidgetManager);
         }
         final int N = appWidgetIds.length;
         for (int i = 0; i < N; i++) {
@@ -59,6 +60,10 @@ static void updateAppWidget(Context context, AppWidgetManager appWidgetManager,
         svcIntent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId);
         svcIntent.setData(Uri.parse(svcIntent.toUri(Intent.URI_INTENT_SCHEME)));
 
+        Intent intent  = new Intent(context, LaunchActivity.class);
+        PendingIntent contentIntent = PendingIntent.getActivity(context, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);
+
+        views.setPendingIntentTemplate(R.id.widgetListView, contentIntent);
         views.setRemoteAdapter(R.id.widgetListView, svcIntent);
 
         // Instruct the widget manager to update the widget
@@ -66,8 +71,8 @@ static void updateAppWidget(Context context, AppWidgetManager appWidgetManager,
     }
 
     @Override
-    public void updateWidget(Context context, int[] appWidgetIds) {
-        this.onUpdate(context, AppWidgetManager.getInstance(context), appWidgetIds);
+    public void updateWidget(Context context, int[] appWidgetIds, AppWidgetManager appWidgetManager) {
+        this.onUpdate(context, appWidgetManager, appWidgetIds);
     }
 }
 
diff --git a/TMessagesProj/src/main/res/drawable/floating_button_drawable.xml b/TMessagesProj/src/main/res/drawable/floating_button_drawable.xml
new file mode 100644
index 000000000..89c0d7a0b
--- /dev/null
+++ b/TMessagesProj/src/main/res/drawable/floating_button_drawable.xml
@@ -0,0 +1,5 @@
+<?xml version="1.0" encoding="utf-8"?>
+<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="oval">
+    <solid android:color="#a865ef"/>
+
+</shape>
\ No newline at end of file
