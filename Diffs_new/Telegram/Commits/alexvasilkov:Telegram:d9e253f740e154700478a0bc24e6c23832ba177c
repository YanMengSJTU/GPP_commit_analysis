diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/BringAppForegroundService.java b/TMessagesProj/src/main/java/org/telegram/messenger/BringAppForegroundService.java
index 18208dd3c..49f0745a0 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/BringAppForegroundService.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/BringAppForegroundService.java
@@ -15,6 +15,8 @@
 
 public class BringAppForegroundService extends IntentService {
 
+    public static final String ACTION_BRING_TO_FRONT = "org.telegram.messenger.ACTION_BRING_TO_FRONT";
+
     public BringAppForegroundService() {
         super("BringAppForegroundService");
     }
@@ -22,6 +24,7 @@ public BringAppForegroundService() {
     @Override
     protected void onHandleIntent(Intent intent) {
         Intent intent2 = new Intent(this, LaunchActivity.class);
+        intent2.setAction(ACTION_BRING_TO_FRONT);
         intent2.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
         startActivity(intent2);
     }
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/LaunchActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/LaunchActivity.java
index e36a7696d..53e68c45e 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/LaunchActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/LaunchActivity.java
@@ -42,6 +42,7 @@
 import android.widget.Toast;
 
 import org.telegram.messenger.AndroidUtilities;
+import org.telegram.messenger.BringAppForegroundService;
 import org.telegram.messenger.BuildVars;
 import org.telegram.messenger.ChatObject;
 import org.telegram.messenger.ContactsController;
@@ -846,7 +847,8 @@ private boolean handleIntent(Intent intent, boolean isNew, boolean restore, bool
             return true;
         }
         if (PhotoViewer.hasInstance() && PhotoViewer.getInstance().isVisible()) {
-            if (intent == null || !Intent.ACTION_MAIN.equals(intent.getAction())) {
+            final String action = intent == null ? null : intent.getAction();
+            if (!Intent.ACTION_MAIN.equals(action) && !BringAppForegroundService.ACTION_BRING_TO_FRONT.equals(action)) {
                 PhotoViewer.getInstance().closePhoto(false, true);
             }
         }
