diff --git a/TMessagesProj/src/main/java/org/telegram/android/MediaController.java b/TMessagesProj/src/main/java/org/telegram/android/MediaController.java
index da18be72e..8760b22bf 100644
--- a/TMessagesProj/src/main/java/org/telegram/android/MediaController.java
+++ b/TMessagesProj/src/main/java/org/telegram/android/MediaController.java
@@ -769,9 +769,7 @@ public boolean canSaveToGallery() {
     //TODO why it is static
     //TODO what is it guid. I need guid in postNotification. I should pass this parameter in args to say to which activiy I send the notification, because many activities could subscribe to the same notification, but not all of them must receive the response
     public static void loadGeoTaggedGalleryPhotos(final int guid, final boolean forceReSync) {
-        Activity activity = ApplicationLoader.parentActivity;
-        if (!Permissions.storagePermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {
-            activity.requestPermissions(Permissions.STORAGE_PERMISSION_GROUP, Permissions.STORAGE_REQUEST);
+        if(!Permissions.checkStoragePermission(ApplicationLoader.parentActivity)){
             return;
         }
         if (!forceReSync && (getInstance().rTree != null || getInstance().isRTreeloaded())) {
diff --git a/TMessagesProj/src/main/java/org/telegram/android/PostsController.java b/TMessagesProj/src/main/java/org/telegram/android/PostsController.java
index 295c050d4..f24049119 100644
--- a/TMessagesProj/src/main/java/org/telegram/android/PostsController.java
+++ b/TMessagesProj/src/main/java/org/telegram/android/PostsController.java
@@ -380,10 +380,7 @@ public void onFailure(Call<PostResponse> call, Throwable t) {
 //                java.net.SocketTimeoutException: failed to connect to /192.168.0.101 (port 8080) after 10000ms
                 removeCall(call);
                 loadingPosts = false; // TODO false or true ??? if continue then true otherwise false. False if finish. true if goes to VK
-                boolean withError = true; // failed to connect to /192.168.0.101 (port 8080) after 10000ms
-                if (t != null && !StringUtils.isEmpty(t.getMessage()) && t.getMessage().equalsIgnoreCase(Constants.CANCELLED_HTTP_EXCEPTION_MSG)) {
-                    withError = false; // because we cancelled it manually.
-                }
+                boolean withError = !isCallCanceled(t); // because we cancelled it manually.
                 NotificationCenter.getInstance().postNotificationName(NotificationCenter.postsRequestFinished, reload, withError);
 
 //                loadVKPhotos(postRequest, reload);
@@ -444,10 +441,7 @@ public void onFailure(Call<VKNewsFeedResponse> call, Throwable t) {
 //                call.request().url() GEt URL of request.
                 removeCall(call);
                 loadingPosts = false;
-                boolean withError = true;
-                if (t != null && !StringUtils.isEmpty(t.getMessage()) && t.getMessage().equalsIgnoreCase(Constants.CANCELLED_HTTP_EXCEPTION_MSG)) {
-                    withError = false;
-                }
+                boolean withError = !isCallCanceled(t); // because we cancelled it manually.
                 NotificationCenter.getInstance().postNotificationName(NotificationCenter.postsRequestFinished, reload, withError);
             }
         });
@@ -486,10 +480,7 @@ public void onResponse(Call<VKPhotoResponse> call, Response<VKPhotoResponse> res
             public void onFailure(Call<VKPhotoResponse> call, Throwable t) {
                 removeCall(call);
                 loadingPosts = false;
-                boolean withError = true;
-                if (t != null && !StringUtils.isEmpty(t.getMessage()) && t.getMessage().equalsIgnoreCase(Constants.CANCELLED_HTTP_EXCEPTION_MSG)) {
-                    withError = false;
-                }
+                boolean withError = !isCallCanceled(t); // because we cancelled it manually.
                 NotificationCenter.getInstance().postNotificationName(NotificationCenter.postsRequestFinished, reload, withError);
             }
         });
@@ -689,4 +680,8 @@ public Post createPost(String dir, String photo, double latitude, double longitu
 
 
     }
+
+    private boolean isCallCanceled(Throwable t) {
+        return t != null && !StringUtils.isEmpty(t.getMessage()) && t.getMessage().equalsIgnoreCase(Constants.CANCELED_HTTP_EXCEPTION_MSG);
+    }
 }
diff --git a/TMessagesProj/src/main/java/org/telegram/android/location/LocationManagerHelper.java b/TMessagesProj/src/main/java/org/telegram/android/location/LocationManagerHelper.java
index a4d25c2d8..f69a96cd0 100644
--- a/TMessagesProj/src/main/java/org/telegram/android/location/LocationManagerHelper.java
+++ b/TMessagesProj/src/main/java/org/telegram/android/location/LocationManagerHelper.java
@@ -127,10 +127,7 @@ public void stopLocationListener() {
     //TODO-aragats method to get location
     // TODO It does not work all time. It return only the last location, but not search current location ((( .
     public Location getLastLocation() {
-        Activity activity = ApplicationLoader.parentActivity;
-        //TODO check both permissions
-        if (!Permissions.locationPermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
-            activity.requestPermissions(Permissions.LOCATION_PERMISSION_GROUP, Permissions.LOCATION_REQUEST_CODE);
+        if(!Permissions.checkLocationPermission(ApplicationLoader.parentActivity)){
             return null;
         }
         LocationManager lm = (LocationManager) ApplicationLoader.applicationContext.getSystemService(Context.LOCATION_SERVICE);
@@ -154,9 +151,7 @@ public Location getLocation4TimeLine() {
     }
 
     public boolean isLocationServiceEnabled() {
-        Activity activity = ApplicationLoader.parentActivity;
-        if (!Permissions.locationPermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
-            activity.requestPermissions(Permissions.LOCATION_PERMISSION_GROUP, Permissions.LOCATION_REQUEST_CODE);
+        if(!Permissions.checkLocationPermission(ApplicationLoader.parentActivity)){
             return false;
         }
         LocationManager lm = (LocationManager) ApplicationLoader.applicationContext.getSystemService(Context.LOCATION_SERVICE);
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Adapters/PostsAdapter.java b/TMessagesProj/src/main/java/org/telegram/ui/Adapters/PostsAdapter.java
index 8f4c3148a..106edbb63 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Adapters/PostsAdapter.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Adapters/PostsAdapter.java
@@ -8,13 +8,10 @@
 
 package org.telegram.ui.Adapters;
 
-import android.Manifest;
 import android.app.Activity;
 import android.content.Context;
 import android.content.Intent;
-import android.content.pm.PackageManager;
 import android.net.Uri;
-import android.os.Build;
 import android.os.Bundle;
 import android.view.View;
 import android.view.ViewGroup;
@@ -22,19 +19,18 @@
 import org.telegram.android.AndroidUtilities;
 import org.telegram.android.PostsController;
 import org.telegram.android.support.widget.RecyclerView;
-
-import ru.aragats.wgo.dto.Post;
-
 import org.telegram.messenger.FileLog;
 import org.telegram.ui.Cells.EmptyCell;
-import org.telegram.ui.Cells.PostCell;
 import org.telegram.ui.Cells.LoadingCell;
+import org.telegram.ui.Cells.PostCell;
 import org.telegram.ui.LocationActivityAragats;
 import org.telegram.ui.PhotoViewer;
 import org.telegram.ui.PostsActivity;
 import org.telegram.utils.Permissions;
 import org.telegram.utils.StringUtils;
 
+import ru.aragats.wgo.dto.Post;
+
 // TODO-aragats
 public class PostsAdapter extends RecyclerView.Adapter {
 
@@ -134,13 +130,7 @@ public void didClickedImage(PostCell cell) {
 
                 @Override
                 public void didClickedVenue(PostCell cell) {
-                    if (postsActivity == null) {
-                        return;
-                    }
-                    Activity activity = postsActivity.getParentActivity();
-                    //TODO check both permissions
-                    if (!Permissions.locationPermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
-                        activity.requestPermissions(Permissions.LOCATION_PERMISSION_GROUP, Permissions.LOCATION_REQUEST_CODE);
+                    if (!Permissions.checkLocationPermission(postsActivity.getParentActivity())) {
                         return;
                     }
                     Post cellPost = cell.getPost();
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/PhotoViewer.java b/TMessagesProj/src/main/java/org/telegram/ui/PhotoViewer.java
index 0506782bb..2106a69cf 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/PhotoViewer.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/PhotoViewer.java
@@ -651,8 +651,7 @@ public void onItemClick(int id) {
                     }
                     closePhoto(true, false);
                 } else if (id == gallery_menu_save) {
-                    if (!Permissions.storagePermitted && parentActivity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && parentActivity.checkSelfPermission(Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {
-                        parentActivity.requestPermissions(Permissions.STORAGE_PERMISSION_GROUP, Permissions.STORAGE_REQUEST);
+                    if(!Permissions.checkStoragePermission(parentActivity)){
                         return;
                     }
                     Permissions.storagePermitted = true;
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/PostCreateActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/PostCreateActivity.java
index b51ca89cd..a31c2bf9c 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/PostCreateActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/PostCreateActivity.java
@@ -313,9 +313,7 @@ public void onItemClick(final int id) {
                     }
                     finishFragment();
                 } else if (id == done_button) {
-                    Activity activity = getParentActivity();
-                    if (!Permissions.storagePermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {
-                        activity.requestPermissions(Permissions.STORAGE_PERMISSION_GROUP, Permissions.STORAGE_REQUEST);
+                    if (!Permissions.checkStoragePermission(getParentActivity())) {
                         return;
                     }
                     Post post = buildPost();
@@ -1466,10 +1464,7 @@ public void removePost(Post post) {
 
 
     private void openLocationChooser() {
-        Activity activity = getParentActivity();
-        //TODO check both permissions
-        if (!Permissions.locationPermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
-            activity.requestPermissions(Permissions.LOCATION_PERMISSION_GROUP, Permissions.LOCATION_REQUEST_CODE);
+        if (!Permissions.checkLocationPermission(getParentActivity())) {
             return;
         }
         if (!isGoogleMapsInstalled()) {
@@ -1768,9 +1763,7 @@ public boolean didSelectVideo(String path) {
 
 
     private void openPhotoPicker() {
-        Activity activity = getParentActivity();
-        if (!Permissions.storagePermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {
-            activity.requestPermissions(Permissions.STORAGE_PERMISSION_GROUP, Permissions.STORAGE_REQUEST);
+        if (!Permissions.checkStoragePermission(getParentActivity())) {
             return;
         }
         Permissions.storagePermitted = true;
@@ -1815,9 +1808,7 @@ public boolean didSelectVideo(String path) {
     }
 
     private boolean attachPhotoHandle() {
-        Activity activity = getParentActivity();
-        if (!Permissions.cameraPermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED) {
-            activity.requestPermissions(Permissions.CAMERA_PERMISSION_GROUP, Permissions.CAMERA_REQUEST);
+        if (!Permissions.checkCameraPermission(getParentActivity())) {
             return false;
         }
         Permissions.cameraPermitted = true;
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/PostsActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/PostsActivity.java
index 0211bdc9e..e95db77e4 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/PostsActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/PostsActivity.java
@@ -613,7 +613,8 @@ public boolean onTouch(View v, MotionEvent event) {
 //            help = help.replace("\n", " ");
 //        }
 //        textView.setText(LocaleController.getString("NothingHappens", R.string.NothingHappens));
-        textViewForEmptyView.setText(LocaleController.getString("LoadDataFailed", R.string.LoadDataFailed));
+//        textViewForEmptyView.setText(LocaleController.getString("LoadDataFailed", R.string.LoadDataFailed));
+        textViewForEmptyView.setText("");
         textViewForEmptyView.setTextColor(0xff959595);
         textViewForEmptyView.setTextSize(TypedValue.COMPLEX_UNIT_DIP, 16);
         textViewForEmptyView.setGravity(Gravity.CENTER);
@@ -852,6 +853,8 @@ public void onClick(DialogInterface dialogInterface, int i) {
                 builder.setNegativeButton(LocaleController.getString("Cancel", R.string.Cancel), null);
                 showDialog(builder.create());
             }
+            notifyDateSetChanged();
+            updateViewLayers(false, id);
         } else if (id == NotificationCenter.postsRequestFinished) {
             boolean reloaded = false;
             boolean withError = false;
@@ -865,7 +868,7 @@ public void onClick(DialogInterface dialogInterface, int i) {
                 layoutManager.scrollToPosition(0);
             }
             notifyDateSetChanged();
-            updateViewLayers(withError);
+            updateViewLayers(withError, id);
             stopRefreshingProgressView();
             if (withError) {
                 Toast.makeText(getParentActivity(), "Load posts error", Toast.LENGTH_SHORT).show(); // TODO localize
@@ -1111,10 +1114,7 @@ private void stopRefreshingProgressView() {
 
     //http://stackoverflow.com/questions/5375654/how-to-implement-google-maps-search-by-address-in-android  search Google Maps
     private void openLocationChooser() {
-        Activity activity = getParentActivity();
-        //TODO check both permissions
-        if (!Permissions.locationPermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
-            activity.requestPermissions(Permissions.LOCATION_PERMISSION_GROUP, Permissions.LOCATION_REQUEST_CODE);
+        if (!Permissions.checkLocationPermission(getParentActivity())) {
             return;
         }
         if (!isGoogleMapsInstalled()) {
@@ -1134,7 +1134,7 @@ private void openLocationChooser() {
     }
 
 
-    private void updateViewLayers(boolean withError) {
+    private void updateViewLayers(boolean withError, int notificationId) {
         if (postListView != null) {
             try {
                 if (PostsController.getInstance().isLoadingPosts() && PostsController.getInstance().getPosts().isEmpty()) {
@@ -1151,15 +1151,23 @@ private void updateViewLayers(boolean withError) {
                         searchEmptyView.setVisibility(View.INVISIBLE);
                         postListView.setEmptyView(emptyView);
                     }
-                    if (PostsController.getInstance().getPosts().isEmpty()) {
-                        // if with or without errors.
-                        if (withError) {
-                            textViewForEmptyView.setText(LocaleController.getString("LoadDataFailed", R.string.LoadDataFailed));
+                    if (notificationId == NotificationCenter.undefinedLocation || notificationId == NotificationCenter.locationServiceDisabled) {
+                        if (Permissions.locationPermitted) {
+                            textViewForEmptyView.setText(LocaleController.getString("EnableGPS", R.string.EnableGPS));
                         } else {
-                            textViewForEmptyView.setText(LocaleController.getString("NoPosts", R.string.NoPosts));
-
+                            textViewForEmptyView.setText(LocaleController.getString("LocationAccess", R.string.LocationAccess));
                         }
+                    } else {
+                        if (PostsController.getInstance().getPosts().isEmpty()) {
+                            // if with or without errors.
+                            if (withError) {
+                                textViewForEmptyView.setText(LocaleController.getString("LoadDataFailed", R.string.LoadDataFailed));
+                            } else {
+                                textViewForEmptyView.setText(LocaleController.getString("NoPosts", R.string.NoPosts));
 
+                            }
+
+                        }
                     }
                 }
             } catch (Exception e) {
diff --git a/TMessagesProj/src/main/java/org/telegram/utils/Constants.java b/TMessagesProj/src/main/java/org/telegram/utils/Constants.java
index 32a2f0cf9..096aa527b 100644
--- a/TMessagesProj/src/main/java/org/telegram/utils/Constants.java
+++ b/TMessagesProj/src/main/java/org/telegram/utils/Constants.java
@@ -92,6 +92,6 @@
 
 
     // TODO cancelled or cancelled ??? Check it.
-    public static final String CANCELLED_HTTP_EXCEPTION_MSG = "Canceled";
+    public static final String CANCELED_HTTP_EXCEPTION_MSG = "Canceled";
     public static final String SOCKET_CLOSED_HTTP_EXCEPTION_MSG = "Socket closed";
 }
\ No newline at end of file
diff --git a/TMessagesProj/src/main/java/org/telegram/utils/Permissions.java b/TMessagesProj/src/main/java/org/telegram/utils/Permissions.java
index 56417b695..fe846b24a 100644
--- a/TMessagesProj/src/main/java/org/telegram/utils/Permissions.java
+++ b/TMessagesProj/src/main/java/org/telegram/utils/Permissions.java
@@ -1,6 +1,11 @@
 package org.telegram.utils;
 
 import android.Manifest;
+import android.app.Activity;
+import android.content.pm.PackageManager;
+import android.os.Build;
+
+import ru.aragats.aracle.ApplicationLoader;
 
 /**
  * Created by aragats on 05/06/16.
@@ -34,4 +39,35 @@
     public static final int STORAGE_REQUEST = 2;
     public static final int CAMERA_REQUEST = 3;
 
+
+    public static boolean checkStoragePermission(Activity activity) {
+        if (!Permissions.storagePermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {
+            activity.requestPermissions(Permissions.STORAGE_PERMISSION_GROUP, Permissions.STORAGE_REQUEST);
+            return false;
+        }
+        storagePermitted = true;
+        return true;
+    }
+
+
+    public static boolean checkLocationPermission(Activity activity) {
+        //TODO check both permissions
+        if (!Permissions.locationPermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
+            activity.requestPermissions(Permissions.LOCATION_PERMISSION_GROUP, Permissions.LOCATION_REQUEST_CODE);
+            return false;
+        }
+        locationPermitted = true;
+        return true;
+    }
+
+    public static boolean checkCameraPermission(Activity activity) {
+        if (!Permissions.cameraPermitted && activity != null && Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED) {
+            activity.requestPermissions(Permissions.CAMERA_PERMISSION_GROUP, Permissions.CAMERA_REQUEST);
+            return false;
+        }
+        cameraPermitted = true;
+        return true;
+    }
+
+
 }
diff --git a/TMessagesProj/src/main/res/values-de/strings.xml b/TMessagesProj/src/main/res/values-de/strings.xml
index 2ab791fc3..5c0b3b8db 100644
--- a/TMessagesProj/src/main/res/values-de/strings.xml
+++ b/TMessagesProj/src/main/res/values-de/strings.xml
@@ -172,9 +172,13 @@
     <string name="VKPhotos">VK Fotos (Beta)</string>
     <string name="Posts">Beiträge</string>
     <string name="MyPosts">Meine Fotos (Beta)</string>
-    <string name="NoPosts">Es gibt nicht die neuesten Beiträge in Ihrer Nähe.</string>
+    <!--TODO check gramma-->
+    <string name="NoPosts">Es gibt keine neuesten Beiträge in Ihrer Nähe.</string>
     <string name="NothingHappens">Nichts ist hier los.</string>
+    <!--TODO check gramma-->
     <string name="EnableGPS">Bitte aktivieren Sie GPS auf Ihrem Handy.</string>
+    <!--TODO check gramma-->
+    <string name="LocationAccess">Aracle braucht auf den Standort ihres Geräts zuzugreifen.</string>
     <string name="Synchronize">Synchronisieren</string>
     <string name="TryAgain">Versuch es noch einmal</string>
     <string name="LoadDataFailed">Daten können nicht geladen. Bitte überprüfen Sie Ihre Netzwerkverbindung.</string>
diff --git a/TMessagesProj/src/main/res/values/strings.xml b/TMessagesProj/src/main/res/values/strings.xml
index 020b9042a..c446ea653 100644
--- a/TMessagesProj/src/main/res/values/strings.xml
+++ b/TMessagesProj/src/main/res/values/strings.xml
@@ -1,7 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 
 
-
 <resources>
     <string name="AppName">Aracle</string>
     <string name="AppFullName">What\'s going on around you?</string>
@@ -176,6 +175,7 @@
     <string name="NoPosts">There are not recent posts around you.</string>
     <string name="NothingHappens">Nothing is going on here.</string>
     <string name="EnableGPS">Please enable GPS on your phone.</string>
+    <string name="LocationAccess">Aracle needs to access the location of your device.</string>
     <string name="Synchronize">Synchronize</string>
     <string name="TryAgain">Try again</string>
     <string name="LoadDataFailed">Cannot load data. Please check your network connection.</string>
