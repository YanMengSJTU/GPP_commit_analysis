diff --git a/TMessagesProj/build.gradle b/TMessagesProj/build.gradle
index 0c0dd28fc..be9ecbc91 100644
--- a/TMessagesProj/build.gradle
+++ b/TMessagesProj/build.gradle
@@ -269,7 +269,7 @@ android {
         }
     }
 
-    defaultConfig.versionCode = 1648
+    defaultConfig.versionCode = 1650
 
     applicationVariants.all { variant ->
         variant.outputs.all { output ->
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/BuildVars.java b/TMessagesProj/src/main/java/org/telegram/messenger/BuildVars.java
index 0e343fbfe..ef861dd3a 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/BuildVars.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/BuildVars.java
@@ -18,14 +18,14 @@
     public static boolean LOGS_ENABLED = false;
     public static boolean USE_CLOUD_STRINGS = true;
     public static boolean CHECK_UPDATES = false;
-    public static int BUILD_VERSION = 1517;
-    public static String BUILD_VERSION_STRING = "5.4.0";
+    public static int BUILD_VERSION = 1648;
+    public static String BUILD_VERSION_STRING = "5.9.0";
     public static int APP_ID = 66408;
     public static String APP_HASH = "2db8d372e3978a884a38ee57d04d4ee1"; //obtain your own APP_HASH at https://core.telegram.org/api/obtaining_api_id
     public static String HOCKEY_APP_HASH = "e683f2bc25474272a9d987ffc3c73763";
     public static String HOCKEY_APP_HASH_DEBUG = "e683f2bc25474272a9d987ffc3c73763";
-    public static String PLAYSTORE_APP_URL = "";
     public static String SMS_HASH = ""; //https://developers.google.com/identity/sms-retriever/overview
+    public static String PLAYSTORE_APP_URL = "";
 
     static {
         if (ApplicationLoader.applicationContext != null) {
@@ -33,4 +33,4 @@
             LOGS_ENABLED = sharedPreferences.getBoolean("logsEnabled", DEBUG_VERSION);
         }
     }
-}
+}
\ No newline at end of file
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java b/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java
index c1f7e2a23..929251524 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java
@@ -1725,11 +1725,7 @@ public void setAllowStickersAndGifs(boolean value, boolean value2) {
             allowStickers = false;
         }
 
-        if (!GlobalSecuritySettings.isLockDisableGifs()) {
-            allowGifs = value2;
-        } else {
-            allowGifs = false;
-        }
+        allowGifs = value2;
         //CloudVeil end
 
         setEmojiButtonImage(false, !isPaused);
@@ -3282,9 +3278,6 @@ private void createEmojiView() {
         if (emojiView != null) {
             return;
         }
-        //CloudVeil start
-        emojiView = new EmojiView(allowStickers && !GlobalSecuritySettings.isLockDisableStickers(), allowGifs && !GlobalSecuritySettings.isLockDisableGifs(), parentActivity, true, info);
-        //CloudVeil end
 
         emojiView = new EmojiView(allowStickers, allowGifs, parentActivity, true, info);
         emojiView.setVisibility(GONE);
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Components/EmojiView.java b/TMessagesProj/src/main/java/org/telegram/ui/Components/EmojiView.java
index 081d0c7cd..c2298ea95 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Components/EmojiView.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Components/EmojiView.java
@@ -57,6 +57,7 @@
 import android.widget.PopupWindow;
 import android.widget.TextView;
 
+import org.cloudveil.messenger.GlobalSecuritySettings;
 import org.telegram.messenger.AndroidUtilities;
 import org.telegram.messenger.ChatObject;
 import org.telegram.messenger.MediaDataController;
@@ -4188,6 +4189,11 @@ public boolean isEnabled(RecyclerView.ViewHolder holder) {
 
         @Override
         public int getItemCount() {
+            //CloudVeil start
+            if(GlobalSecuritySettings.isLockDisableGifs()) {
+                return 0;
+            }
+            //CloudVeil end
             return recentGifs.size() + 1;
         }
 
@@ -4198,6 +4204,11 @@ public long getItemId(int i) {
 
         @Override
         public int getItemViewType(int position) {
+            //CloudVeil start
+            if(GlobalSecuritySettings.isLockDisableGifs()) {
+                return 0;
+            }
+            //CloudVeil end
             if (position == 0) {
                 return 1;
             }
@@ -4346,6 +4357,11 @@ public void onBindViewHolder(RecyclerView.ViewHolder holder, int position) {
         }
 
         public void search(String text) {
+            //CloudVeil start
+            if(GlobalSecuritySettings.isLockDisableGifs()) {
+                return;
+            }
+            //CloudVel end
             if (reqId != 0) {
                 ConnectionsManager.getInstance(currentAccount).cancelRequest(reqId, true);
                 reqId = 0;
@@ -4373,6 +4389,11 @@ public void run() {
         }
 
         private void searchBotUser() {
+            //CloudVeil start
+            if(GlobalSecuritySettings.isLockDisableGifs()) {
+                return;
+            }
+            //CloudVel end
             if (searchingUser) {
                 return;
             }
@@ -4395,6 +4416,11 @@ private void searchBotUser() {
         }
 
         private void search(final String query, final String offset, boolean searchUser) {
+            //CloudVeil start
+            if(GlobalSecuritySettings.isLockDisableGifs()) {
+                return;
+            }
+            //CloudVel end
             if (reqId != 0) {
                 ConnectionsManager.getInstance(currentAccount).cancelRequest(reqId, true);
                 reqId = 0;
