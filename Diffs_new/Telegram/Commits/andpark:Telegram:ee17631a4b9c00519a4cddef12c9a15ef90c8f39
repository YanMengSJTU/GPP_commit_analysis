diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatActionCell.java b/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatActionCell.java
index 4e11bf7e2..cf2e999a0 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatActionCell.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatActionCell.java
@@ -21,6 +21,8 @@
 import android.view.MotionEvent;
 import android.view.SoundEffectConstants;
 
+import com.teamjihu.ThemeManager;
+
 import org.telegram.android.AndroidUtilities;
 import org.telegram.android.ImageReceiver;
 import org.telegram.android.MessageObject;
@@ -61,8 +63,11 @@
 
     private ChatActionCellDelegate delegate;
 
+    private ThemeManager themeManager;
+
     public ChatActionCell(Context context) {
         super(context);
+        themeManager = new ThemeManager(context);
         if (backgroundBlack == null) {
             backgroundBlack = getResources().getDrawable(R.drawable.system_black);
             backgroundBlue = getResources().getDrawable(R.drawable.system_blue);
@@ -98,17 +103,26 @@ public void setMessageObject(MessageObject messageObject) {
                 }
             }
             if (currentMessageObject.messageOwner.action instanceof TLRPC.TL_messageActionUserUpdatedPhoto) {
-                imageReceiver.setImage(currentMessageObject.messageOwner.action.newUserPhoto.photo_small, "50_50", getResources().getDrawable(AndroidUtilities.getUserAvatarForId(id)), false);
+                //imageReceiver.setImage(currentMessageObject.messageOwner.action.newUserPhoto.photo_small, "50_50", getResources().getDrawable(AndroidUtilities.getUserAvatarForId(id)), false);
+                String placeHolderId = AndroidUtilities.getUserAvatarForId(id);
+                Drawable d = themeManager.getDrawable(placeHolderId, false);
+                imageReceiver.setImage(currentMessageObject.messageOwner.action.newUserPhoto.photo_small, "50_50", d, false);
             } else {
                 PhotoObject photo = PhotoObject.getClosestImageWithSize(currentMessageObject.photoThumbs, AndroidUtilities.dp(64));
                 if (photo != null) {
                     if (photo.image != null) {
                         imageReceiver.setImageBitmap(photo.image);
                     } else {
-                        imageReceiver.setImage(photo.photoOwner.location, "50_50", getResources().getDrawable(AndroidUtilities.getGroupAvatarForId(id)), false);
+                        //imageReceiver.setImage(photo.photoOwner.location, "50_50", getResources().getDrawable(AndroidUtilities.getGroupAvatarForId(id)), false);
+                        String placeHolderId = AndroidUtilities.getGroupAvatarForId(id);
+                        Drawable d = themeManager.getDrawable(placeHolderId, false);
+                        imageReceiver.setImage(photo.photoOwner.location, "50_50", d, false);
                     }
                 } else {
-                    imageReceiver.setImageBitmap(getResources().getDrawable(AndroidUtilities.getGroupAvatarForId(id)));
+                    //imageReceiver.setImageBitmap(getResources().getDrawable(AndroidUtilities.getGroupAvatarForId(id)));
+                    String placeHolderId = AndroidUtilities.getGroupAvatarForId(id);
+                    Drawable d = themeManager.getDrawable(placeHolderId, false);
+                    imageReceiver.setImageBitmap(d);
                 }
             }
             imageReceiver.setVisible(!PhotoViewer.getInstance().isShowingImage(currentMessageObject), false);
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatContactCell.java b/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatContactCell.java
index c72971a21..ee7f92972 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatContactCell.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatContactCell.java
@@ -9,6 +9,7 @@
 package org.telegram.ui.Cells;
 
 import android.content.Context;
+import android.content.res.Resources;
 import android.graphics.Canvas;
 import android.graphics.drawable.Drawable;
 import android.text.Layout;
@@ -18,6 +19,8 @@
 import android.view.MotionEvent;
 import android.view.SoundEffectConstants;
 
+import com.teamjihu.ThemeManager;
+
 import org.telegram.PhoneFormat.PhoneFormat;
 import org.telegram.android.AndroidUtilities;
 import org.telegram.android.ContactsController;
@@ -56,8 +59,11 @@
 
     private ChatContactCellDelegate contactDelegate = null;
 
+    private ThemeManager themeManager;
+
     public ChatContactCell(Context context) {
         super(context);
+        themeManager = new ThemeManager(context);
         if (namePaint == null) {
             namePaint = new TextPaint(TextPaint.ANTI_ALIAS_FLAG);
             namePaint.setTextSize(AndroidUtilities.dp(15));
@@ -184,9 +190,17 @@ public void setMessageObject(MessageObject messageObject) {
                 if (contactUser.photo != null) {
                     currentPhoto = contactUser.photo.photo_small;
                 }
-                avatarImage.setImage(currentPhoto, "50_50", getResources().getDrawable(AndroidUtilities.getUserAvatarForId(uid)), false);
+                //avatarImage.setImage(currentPhoto, "50_50", getResources().getDrawable(AndroidUtilities.getUserAvatarForId(uid)), false);
+                String placeHolderId = AndroidUtilities.getUserAvatarForId(uid);
+
+                Drawable d = themeManager.getDrawable(placeHolderId, false);
+                avatarImage.setImage(currentPhoto, "50_50", d, false);
             } else {
-                avatarImage.setImage(null, "50_50", getResources().getDrawable(AndroidUtilities.getUserAvatarForId(uid)), false);
+                //avatarImage.setImage(null, "50_50", getResources().getDrawable(AndroidUtilities.getUserAvatarForId(uid)), false);
+                String placeHolderId = AndroidUtilities.getUserAvatarForId(uid);
+
+                Drawable d = themeManager.getDrawable(placeHolderId, false);
+                avatarImage.setImage(null, "50_50", d, false);
             }
 
             String currentNameString = ContactsController.formatName(messageObject.messageOwner.media.first_name, messageObject.messageOwner.media.last_name);
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java
index c5889ca08..ba792c3d8 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java
@@ -1059,6 +1059,10 @@ public void onClick(DialogInterface dialogInterface, int i) {
         return fragmentView;
     }
 
+    public void didSelectPhotos(ArrayList<String> photos) {
+        SendMessagesHelper.prepareSendingPhotos(photos, null, dialog_id);
+    }
+
     private boolean sendSecretMessageRead(MessageObject messageObject) {
         if (messageObject == null || messageObject.isOut() || !messageObject.isSecretMedia() || messageObject.messageOwner.destroyTime != 0 || messageObject.messageOwner.ttl <= 0) {
             return false;
