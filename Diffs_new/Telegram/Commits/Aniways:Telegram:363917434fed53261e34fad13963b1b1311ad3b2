diff --git a/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java
index 2348aed19..5f4852c75 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java
@@ -25,6 +25,7 @@
 import android.os.Bundle;
 import android.provider.MediaStore;
 import android.support.v7.widget.LinearLayoutManager;
+import android.text.Editable;
 import android.text.Html;
 import android.text.TextUtils;
 import android.util.SparseArray;
@@ -45,6 +46,7 @@
 import android.widget.TextView;
 import android.widget.Toast;
 
+import com.aniways.Aniways;
 import com.aniways.anigram.messenger.R;
 
 import org.telegram.android.AndroidUtilities;
@@ -2871,11 +2873,11 @@ public void onPause() {
         paused = true;
         NotificationsController.getInstance().setOpennedDialogId(0);
 
-        String text = chatActivityEnterView.getFieldText();
+        Editable text = chatActivityEnterView.getFieldEditableText();
         if (text != null) {
             SharedPreferences preferences = ApplicationLoader.applicationContext.getSharedPreferences("mainconfig", Activity.MODE_PRIVATE);
             SharedPreferences.Editor editor = preferences.edit();
-            editor.putString("dialog_" + dialog_id, text);
+            editor.putString("dialog_" + dialog_id, Aniways.serializeMessage(text));
             editor.commit();
         }
 
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java b/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java
index d37162d57..57f9b54e8 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java
@@ -839,6 +839,13 @@ public String getFieldText() {
         return null;
     }
 
+    public Editable getFieldEditableText() {
+        if (messsageEditText != null && messsageEditText.length() > 0) {
+            return messsageEditText.getText();
+        }
+        return null;
+    }
+
     public boolean isEmojiPopupShowing() {
         return emojiPopup != null && emojiPopup.isShowing();
     }
