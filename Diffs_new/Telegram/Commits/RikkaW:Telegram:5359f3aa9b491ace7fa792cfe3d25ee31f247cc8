diff --git a/TMessagesProj/build.gradle b/TMessagesProj/build.gradle
index cdc6fdf51..5d2745913 100644
--- a/TMessagesProj/build.gradle
+++ b/TMessagesProj/build.gradle
@@ -81,7 +81,7 @@ android {
         }
     }
 
-    defaultConfig.versionCode = 851 + 11
+    defaultConfig.versionCode = 851 + 12
 
     sourceSets.debug {
         manifest.srcFile 'config/debug/AndroidManifest.xml'
@@ -121,7 +121,7 @@ android {
     defaultConfig {
         minSdkVersion 21
         targetSdkVersion 25
-        versionName "3.13.1.11"
+        versionName "3.13.1.12"
 
         /*externalNativeBuild {
             ndkBuild {
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/ActionBar.java b/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/ActionBar.java
index 956efd4f8..5549b3a25 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/ActionBar.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/ActionBar.java
@@ -15,6 +15,7 @@
 import android.content.res.Configuration;
 import android.graphics.drawable.Drawable;
 import android.os.Build;
+import android.support.v4.content.ContextCompat;
 import android.view.Gravity;
 import android.view.MotionEvent;
 import android.view.View;
@@ -23,6 +24,7 @@
 
 import org.telegram.messenger.AndroidUtilities;
 import org.telegram.messenger.AnimatorListenerAdapterProxy;
+import org.telegram.messenger.R;
 import org.telegram.ui.Components.LayoutHelper;
 
 import java.util.ArrayList;
@@ -206,7 +208,7 @@ public ActionBarMenu createActionMode() {
             return actionMode;
         }
         actionMode = new ActionBarMenu(getContext(), this);
-        actionMode.setBackgroundColor(0xffffffff);
+        actionMode.setBackgroundColor(ContextCompat.getColor(getContext(), R.color.background));
         addView(actionMode, indexOfChild(backButtonImageView));
         actionMode.setPadding(0, occupyStatusBar ? AndroidUtilities.statusBarHeight : 0, 0, 0);
         FrameLayout.LayoutParams layoutParams = (FrameLayout.LayoutParams)actionMode.getLayoutParams();
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/ActionBarMenu.java b/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/ActionBarMenu.java
index 0ca40d4e1..06d9e803a 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/ActionBarMenu.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/ActionBarMenu.java
@@ -9,12 +9,15 @@
 package org.telegram.ui.ActionBar;
 
 import android.content.Context;
+import android.content.res.ColorStateList;
 import android.graphics.drawable.Drawable;
+import android.support.v4.content.ContextCompat;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.widget.LinearLayout;
 
 import org.telegram.messenger.AndroidUtilities;
+import org.telegram.messenger.R;
 import org.telegram.ui.Components.LayoutHelper;
 
 public class ActionBarMenu extends LinearLayout {
@@ -72,6 +75,7 @@ public ActionBarMenuItem addItem(int id, int icon, int backgroundColor, Drawable
             menuItem.iconView.setImageDrawable(drawable);
         } else {
             menuItem.iconView.setImageResource(icon);
+            menuItem.iconView.setImageTintList(ColorStateList.valueOf(ContextCompat.getColor(getContext(), R.color.secondary_text)));
         }
         addView(menuItem);
         LinearLayout.LayoutParams layoutParams = (LinearLayout.LayoutParams) menuItem.getLayoutParams();
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/BackDrawable.java b/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/BackDrawable.java
index 4c0ac82b1..d15e2f6ad 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/BackDrawable.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/BackDrawable.java
@@ -80,7 +80,7 @@ public void draw(Canvas canvas) {
             invalidateSelf();
         }
 
-        int rD = (int) ((117 - 255) * currentRotation);
+        int rD = (int) (((Theme.ACTION_BAR_ACTION_MODE_TEXT_COLOR & 0xff) - 255) * currentRotation);
         int c = Color.rgb(255 + rD, 255 + rD, 255 + rD);
         paint.setColor(c);
 
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/Theme.java b/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/Theme.java
index 3b128aafc..b77d8ad5c 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/Theme.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/ActionBar/Theme.java
@@ -46,7 +46,7 @@
     public static int ACTION_BAR_PROFILE_COLOR = 0xff598fba;
     public static final int ACTION_BAR_PROFILE_SUBTITLE_COLOR = 0xffd7eafa;
     public static final int ACTION_BAR_MAIN_AVATAR_COLOR = 0xff5085b1;
-    public static final int ACTION_BAR_ACTION_MODE_TEXT_COLOR = 0xff737373;
+    public static int ACTION_BAR_ACTION_MODE_TEXT_COLOR = 0xff737373;
     public static final int ACTION_BAR_SELECTOR_COLOR = 0xff406d94;
 
     public static final int INPUT_FIELD_SELECTOR_COLOR = 0xffd6d6d6;
@@ -67,9 +67,10 @@
     public static int ATTACH_SHEET_TEXT_COLOR = 0xff757575;
 
     public static final int DIALOGS_MESSAGE_TEXT_COLOR = 0xff8f8f8f;
-    public static final int DIALOGS_NAME_TEXT_COLOR = 0xff4d83b3;
-    public static final int DIALOGS_ATTACH_TEXT_COLOR = 0xff4d83b3;
-    public static final int DIALOGS_PRINTING_TEXT_COLOR = 0xff4d83b3;
+    public static int DIALOGS_MESSAGE_ENCRYPTED_TEXT_COLOR = 0xff00a60e;
+    public static int DIALOGS_NAME_TEXT_COLOR = 0xff4d83b3;
+    public static int DIALOGS_ATTACH_TEXT_COLOR = 0xff4d83b3;
+    public static int DIALOGS_PRINTING_TEXT_COLOR = 0xff4d83b3;
     public static final int DIALOGS_DRAFT_TEXT_COLOR = 0xffdd4b39;
 
     public static final int CHAT_UNREAD_TEXT_COLOR = 0xff5695cc;
@@ -423,6 +424,11 @@ private static void resetColor(Context context) {
         EmojiView.BACKGROUND_COLOR = ContextCompat.getColor(context, R.color.sticker_select_background);
         EmojiView.INDICATOR_COLOR = ContextCompat.getColor(context, R.color.sticker_indicator_background);
 
+        DIALOGS_NAME_TEXT_COLOR = DIALOGS_ATTACH_TEXT_COLOR = DIALOGS_PRINTING_TEXT_COLOR = ContextCompat.getColor(context, R.color.dialog_name);
+        DIALOGS_MESSAGE_ENCRYPTED_TEXT_COLOR = ContextCompat.getColor(context, R.color.dialog_title_encrypted);
+
+        ACTION_BAR_ACTION_MODE_TEXT_COLOR = ContextCompat.getColor(context, R.color.action_bar_action_mode);
+
         INAPP_PLAYER_PERFORMER_TEXT_COLOR = ContextCompat.getColor(context, R.color.in_app_player_title);
         INAPP_PLAYER_TITLE_TEXT_COLOR = ContextCompat.getColor(context, R.color.in_app_player_title);
         INAPP_PLAYER_BACKGROUND_COLOR = background;
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Cells/DialogCell.java b/TMessagesProj/src/main/java/org/telegram/ui/Cells/DialogCell.java
index 3072672ba..01ac3b6af 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Cells/DialogCell.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Cells/DialogCell.java
@@ -143,7 +143,6 @@ public DialogCell(Context context) {
             namePaint.setTypeface(AndroidUtilities.getTypeface("fonts/rmedium.ttf"));
 
             nameEncryptedPaint = new TextPaint(TextPaint.ANTI_ALIAS_FLAG);
-            nameEncryptedPaint.setColor(0xff00a60e);
             nameEncryptedPaint.setTypeface(AndroidUtilities.getTypeface("fonts/rmedium.ttf"));
 
             messagePaint = new TextPaint(TextPaint.ANTI_ALIAS_FLAG);
@@ -154,7 +153,6 @@ public DialogCell(Context context) {
             backPaint.setColor(0x0f000000);
 
             messagePrintingPaint = new TextPaint(TextPaint.ANTI_ALIAS_FLAG);
-            messagePrintingPaint.setColor(Theme.DIALOGS_PRINTING_TEXT_COLOR);
 
             timePaint = new TextPaint(TextPaint.ANTI_ALIAS_FLAG);
             timePaint.setColor(0xff999999);
@@ -202,11 +200,14 @@ public static void resetPaintColor(Context context) {
         messagePaint.linkColor = ContextCompat.getColor(context, R.color.secondary_text)/*Theme.DIALOGS_MESSAGE_TEXT_COLOR*/;
         linePaint.setColor(ContextCompat.getColor(context, R.color.chat_list_divider));
         countPaint.setColor(ContextCompat.getColor(context, R.color.dialog_count_color));
-
-        DrawableCompat.setTint(groupDrawable, ContextCompat.getColor(context, R.color.primary_text));
-        DrawableCompat.setTint(broadcastDrawable, ContextCompat.getColor(context, R.color.primary_text));
-        DrawableCompat.setTint(botDrawable, ContextCompat.getColor(context, R.color.primary_text));
-        DrawableCompat.setTint(muteDrawable, ContextCompat.getColor(context, R.color.disabled_text));
+        nameEncryptedPaint.setColor(Theme.DIALOGS_MESSAGE_ENCRYPTED_TEXT_COLOR);
+        messagePrintingPaint.setColor(Theme.DIALOGS_PRINTING_TEXT_COLOR);
+
+        groupDrawable.setTint(ContextCompat.getColor(context, R.color.primary_text));
+        broadcastDrawable.setTint(ContextCompat.getColor(context, R.color.primary_text));
+        botDrawable.setTint(ContextCompat.getColor(context, R.color.primary_text));
+        muteDrawable.setTint(ContextCompat.getColor(context, R.color.disabled_text));
+        lockDrawable.setTint(Theme.DIALOGS_MESSAGE_ENCRYPTED_TEXT_COLOR);
     }
 
     public void setDialog(TLRPC.TL_dialog dialog, int i, int type) {
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Cells/HeaderCell.java b/TMessagesProj/src/main/java/org/telegram/ui/Cells/HeaderCell.java
index 5aefeaa79..87f90b20f 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Cells/HeaderCell.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Cells/HeaderCell.java
@@ -33,7 +33,7 @@ public HeaderCell(Context context) {
         textView = new TextView(getContext());
         textView.setTextSize(TypedValue.COMPLEX_UNIT_DIP, 15);
         textView.setTypeface(AndroidUtilities.getTypeface("fonts/rmedium.ttf"));
-        textView.setTextColor(0xff3e90cf);
+        textView.setTextColor(ContextCompat.getColor(context, R.color.colorAccent));
         textView.setGravity((LocaleController.isRTL ? Gravity.RIGHT : Gravity.LEFT) | Gravity.CENTER_VERTICAL);
         addView(textView, LayoutHelper.createFrame(LayoutHelper.MATCH_PARENT, LayoutHelper.MATCH_PARENT, (LocaleController.isRTL ? Gravity.RIGHT : Gravity.LEFT) | Gravity.TOP, 17, 15, 17, 0));
     }
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Cells/TextSettingsCell.java b/TMessagesProj/src/main/java/org/telegram/ui/Cells/TextSettingsCell.java
index 3402392b0..8afcd0383 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Cells/TextSettingsCell.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Cells/TextSettingsCell.java
@@ -57,7 +57,7 @@ public TextSettingsCell(Context context) {
         addView(textView, LayoutHelper.createFrame(LayoutHelper.MATCH_PARENT, LayoutHelper.MATCH_PARENT, (LocaleController.isRTL ? Gravity.RIGHT : Gravity.LEFT) | Gravity.TOP, 17, 0, 17, 0));
 
         valueTextView = new TextView(context);
-        valueTextView.setTextColor(0xff2f8cc9);
+        valueTextView.setTextColor(ContextCompat.getColor(context, R.color.colorAccent));
         valueTextView.setTextSize(TypedValue.COMPLEX_UNIT_DIP, 16);
         valueTextView.setLines(1);
         valueTextView.setMaxLines(1);
diff --git a/TMessagesProj/src/main/res/drawable/edit_text_background.xml b/TMessagesProj/src/main/res/drawable/edit_text_background.xml
new file mode 100644
index 000000000..21e385149
--- /dev/null
+++ b/TMessagesProj/src/main/res/drawable/edit_text_background.xml
@@ -0,0 +1,16 @@
+<?xml version="1.0" encoding="utf-8"?>
+<selector
+    xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false">
+        <nine-patch android:src="@drawable/search_dark"
+                    android:tint="?android:attr/colorControlNormal" />
+    </item>
+    <item android:state_pressed="false" android:state_focused="false">
+        <nine-patch android:src="@drawable/search_dark"
+                    android:tint="?android:attr/colorControlNormal" />
+    </item>
+    <item>
+        <nine-patch android:src="@drawable/search_dark_activated"
+                    android:tint="?android:attr/colorControlActivated" />
+    </item>
+</selector>
\ No newline at end of file
diff --git a/TMessagesProj/src/main/res/values-night-v21/styles.xml b/TMessagesProj/src/main/res/values-night-v21/styles.xml
index 9ff80e672..1036ea85b 100644
--- a/TMessagesProj/src/main/res/values-night-v21/styles.xml
+++ b/TMessagesProj/src/main/res/values-night-v21/styles.xml
@@ -7,7 +7,7 @@
     <!--EDIT TEXT-->
 
     <style name="Theme.TMessages.EditText" parent="android:Widget.Material.EditText">
-        <item name="android:background">@drawable/edit_text</item>
+        <item name="android:background">@drawable/edit_text_background</item>
     </style>
 
     <style name="Theme.TMessages.Dialog.Alert.Chat" parent="@style/Theme.TMessages.Dialog.Alert">
diff --git a/TMessagesProj/src/main/res/values-night/colors.xml b/TMessagesProj/src/main/res/values-night/colors.xml
index b4adb8c6e..2d7496c62 100644
--- a/TMessagesProj/src/main/res/values-night/colors.xml
+++ b/TMessagesProj/src/main/res/values-night/colors.xml
@@ -2,7 +2,7 @@
 <resources>
     <color name="colorPrimary">#1f3145</color>
     <color name="colorPrimaryDark">#1c2c3e</color>
-    <color name="colorAccent">#233f5f</color>
+    <color name="colorAccent">@color/material_blue_A100</color>
 
     <color name="fab">#a4000000</color>
 
@@ -47,7 +47,7 @@
 
     <color name="in_app_player_title">#b1c6d6</color>
 
-    <color name="msg_link_text">#3a96db</color>
+    <color name="msg_link_text">#79abd1</color>
 
     <color name="drawer_text">@color/primary_text</color>
 
@@ -55,6 +55,11 @@
     <color name="bot_keyboard_background_pressed">#616467</color>
     <color name="bot_keyboard_text">#c4e0ec</color>
 
+    <color name="action_bar_action_mode">#ffbdbdbd</color>
+
+    <color name="dialog_name">#9ac0ff</color>
+    <color name="dialog_title_encrypted">@color/material_green_A100</color>
+
     <color name="avatar_profile_back_red">#8f2e24</color>
     <color name="avatar_profile_back_origin">#a55927</color>
     <color name="avatar_profile_back_purple">#473070</color>
diff --git a/TMessagesProj/src/main/res/values-v21/styles.xml b/TMessagesProj/src/main/res/values-v21/styles.xml
index 815b812b0..535aa3eb0 100644
--- a/TMessagesProj/src/main/res/values-v21/styles.xml
+++ b/TMessagesProj/src/main/res/values-v21/styles.xml
@@ -31,6 +31,7 @@
         <item name="android:windowContentOverlay">@null</item>
         <item name="android:colorPrimaryDark">@color/colorPrimaryDark</item>
         <item name="android:colorPrimary">@color/colorPrimary</item>
+        <item name="android:colorAccent">@color/colorAccent</item>
     </style>
 
     <style name="Theme.TMessages" parent="@style/Theme.DayNight">
@@ -45,11 +46,12 @@
         <item name="android:listChoiceBackgroundIndicator">@drawable/list_selector</item>
         <item name="android:editTextStyle">@style/Theme.TMessages.EditText</item>
         <item name="android:actionBarItemBackground">@drawable/bar_selector_style</item>
-        <item name="android:colorPrimaryDark">#33000000</item>
+        <item name="android:statusBarColor">#33000000</item>
         <item name="android:colorPrimary">@color/colorPrimary</item>
+        <item name="android:colorPrimaryDark">@color/colorPrimaryDark</item>
+        <item name="android:colorAccent">@color/colorAccent</item>
         <item name="android:dialogTheme">@style/Theme.TMessages.Dialog</item>
         <item name="android:alertDialogTheme">@style/Theme.TMessages.Dialog.Alert</item>
-        <item name="android:colorControlActivated">#4991cc</item>
     </style>
 
     <style name="Theme.TMessages.PopupNotification" parent="Theme.TMessages">
@@ -120,8 +122,7 @@
     <!--EDIT TEXT-->
 
     <style name="Theme.TMessages.EditText" parent="android:Widget.Material.Light.EditText">
-        <!--<item name="android:background">@drawable/edit_text</item>
-        <item name="android:textColor">#000000</item>-->
+        <item name="android:background">@drawable/edit_text_background</item>
     </style>
 
     <!--ALERT DIALOG-->
diff --git a/TMessagesProj/src/main/res/values/colors.xml b/TMessagesProj/src/main/res/values/colors.xml
index 34e0f45bd..a12269d6e 100755
--- a/TMessagesProj/src/main/res/values/colors.xml
+++ b/TMessagesProj/src/main/res/values/colors.xml
@@ -66,6 +66,11 @@
     <color name="bot_keyboard_background_pressed">#CCD1D4</color>
     <color name="bot_keyboard_text">#36474f</color>
 
+    <color name="action_bar_action_mode">#ff737373</color>
+
+    <color name="dialog_name">#ff4d83b3</color>
+    <color name="dialog_title_encrypted">#ff00a60e</color>
+
     <!--<color name="avatar_red"></color>
     <color name="avatar_profile_red"></color>-->
     <color name="avatar_profile_back_red">#ffca6056</color>
