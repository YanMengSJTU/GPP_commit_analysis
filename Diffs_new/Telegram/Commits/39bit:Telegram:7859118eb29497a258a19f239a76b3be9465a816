diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/Emoji.java b/TMessagesProj/src/main/java/org/telegram/messenger/Emoji.java
index 888563acb..1a1b3b967 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/Emoji.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/Emoji.java
@@ -27,6 +27,7 @@
 import android.text.TextPaint;
 import android.text.style.DynamicDrawableSpan;
 import android.text.style.ImageSpan;
+import android.util.TypedValue;
 import android.view.View;
 import android.view.ViewGroup;
 import android.widget.TextView;
@@ -254,11 +255,21 @@ public Rect getDrawRect() {
 
         @Override
         public void draw(Canvas canvas) {
-            /*if (MessagesController.getInstance().useSystemEmoji) {
-                //textPaint.setTextSize(getBounds().width());
-                canvas.drawText(EmojiData.data[info.page][info.emojiIndex], getBounds().left, getBounds().bottom, textPaint);
-                return;
-            }*/
+            if (MessagesController.getInstance().useSystemEmoji) {
+                String emoji = EmojiData.data[info.page][info.emojiIndex];
+                if (EmojiData.emojiToFE0FMap.containsKey(emoji.charAt(0))) {
+                    emoji = emoji.substring(0, 1) + "\uFE0F" + emoji.substring(1);
+                }
+                Rect emojiRect = new Rect();
+                textPaint.setTextSize(getBounds().width() * 10.0f);
+                textPaint.setTextSize(getBounds().width() * 7.0f * Math.min(1.0f, getBounds().width() / textPaint.measureText(emoji)));
+                textPaint.getTextBounds(emoji, 0, emoji.length(), emojiRect);
+                if (emojiRect.height() <= getBounds().height()) {
+                    textPaint.setTextAlign(Paint.Align.CENTER);
+                    canvas.drawText(emoji.length() < 2 ? emoji + "\uFE0F" : emoji, getBounds().left + getBounds().width() / 2.0f, getBounds().bottom - getBounds().height() / 5.0f, textPaint);
+                    return;
+                }
+            }
             if (emojiBmp[info.page][info.page2] == null) {
                 if (loadingEmoji[info.page][info.page2]) {
                     return;
@@ -331,7 +342,7 @@ public static CharSequence replaceEmoji(CharSequence cs, Paint.FontMetricsInt fo
     }
 
     public static CharSequence replaceEmoji(CharSequence cs, Paint.FontMetricsInt fontMetrics, int size, boolean createNew, int[] emojiOnly) {
-        if (MessagesController.getInstance().useSystemEmoji || cs == null || cs.length() == 0) {
+        if (cs == null || cs.length() == 0) {
             return cs;
         }
         //String str = "\"\uD83D\uDC68\uD83C\uDFFB\u200D\uD83C\uDFA4\""
@@ -343,6 +354,9 @@ public static CharSequence replaceEmoji(CharSequence cs, Paint.FontMetricsInt fo
         } else {
             s = Spannable.Factory.getInstance().newSpannable(cs.toString());
         }
+        if (MessagesController.getInstance().useSystemEmoji) {
+            return s;
+        }
         long buf = 0;
         int emojiCount = 0;
         char c;
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/SettingsActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/SettingsActivity.java
index e0c8a9574..8da1be0c0 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/SettingsActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/SettingsActivity.java
@@ -262,7 +262,7 @@ public void run() {
             directShareRow = rowCount++;
         }
         stickersRow = rowCount++;
-        //emojiRow = rowCount++;
+        emojiRow = rowCount++;
         textSizeRow = rowCount++;
         raiseToSpeakRow = rowCount++;
         sendByEnterRow = rowCount++;
@@ -578,12 +578,12 @@ public void onClick(DialogInterface dialog, int which) {
                     builder.setApplyBottomPadding(false);
                     LinearLayout linearLayout = new LinearLayout(getParentActivity());
                     linearLayout.setOrientation(LinearLayout.VERTICAL);
-                    for (int a = 0; a < (Build.VERSION.SDK_INT >= 19 ? 2 : 1); a++) {
+                    for (int a = 1; a < (Build.VERSION.SDK_INT >= 19 ? 2 : 1); a++) {
                         String name = null;
-                        if (a == 0) {
+                        /*if (a == 0) {
                             maskValues[a] = MessagesController.getInstance().allowBigEmoji;
                             name = LocaleController.getString("EmojiBigSize", R.string.EmojiBigSize);
-                        } else if (a == 1) {
+                        } else */ if (a == 1) {
                             maskValues[a] = MessagesController.getInstance().useSystemEmoji;
                             name = LocaleController.getString("EmojiUseDefault", R.string.EmojiUseDefault);
                         }
@@ -618,7 +618,7 @@ public void onClick(View v) {
                                 FileLog.e(e);
                             }
                             SharedPreferences.Editor editor = ApplicationLoader.applicationContext.getSharedPreferences("mainconfig", Activity.MODE_PRIVATE).edit();
-                            editor.putBoolean("allowBigEmoji", MessagesController.getInstance().allowBigEmoji = maskValues[0]);
+                            //editor.putBoolean("allowBigEmoji", MessagesController.getInstance().allowBigEmoji = maskValues[0]);
                             editor.putBoolean("useSystemEmoji", MessagesController.getInstance().useSystemEmoji = maskValues[1]);
                             editor.commit();
                             if (listAdapter != null) {
