diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Adapters/DialogsSearchAdapter.java b/TMessagesProj/src/main/java/org/telegram/ui/Adapters/DialogsSearchAdapter.java
index 3546ae83a..069e3730b 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Adapters/DialogsSearchAdapter.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Adapters/DialogsSearchAdapter.java
@@ -163,7 +163,9 @@ public DialogsSearchAdapter(Context context, int messagesSearch, int type) {
             public void onDataSetChanged() {
                 searchWas = true;
                 if (!searchAdapterHelper.isSearchInProgress() && delegate != null) {
-                    delegate.searchStateChanged(false);
+                    if (getItemCount() > 0 || reqId == 0) {
+                        delegate.searchStateChanged(false);
+                    }
                 }
                 notifyDataSetChanged();
             }
@@ -282,7 +284,9 @@ private void searchMessagesInternal(final String query) {
                 }
             }
             if (delegate != null) {
-                delegate.searchStateChanged(false);
+                if (!searchAdapterHelper.isSearchInProgress() || getItemCount() > 0) {
+                    delegate.searchStateChanged(false);
+                }
             }
             reqId = 0;
         }), ConnectionsManager.RequestFlagFailOnServerErrors);
@@ -805,7 +809,7 @@ private void updateSearchResults(final ArrayList<TLObject> result, final ArrayLi
             searchAdapterHelper.mergeResults(searchResult);
             notifyDataSetChanged();
             if (delegate != null) {
-                if (getItemCount() == 0 && (searchRunnable2 != null || searchAdapterHelper.isSearchInProgress())) {
+                if (searchRunnable2 != null || searchAdapterHelper.isSearchInProgress()) {
                     delegate.searchStateChanged(true);
                 } else {
                     delegate.searchStateChanged(false);
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Adapters/SearchAdapterHelper.java b/TMessagesProj/src/main/java/org/telegram/ui/Adapters/SearchAdapterHelper.java
index 8888de19c..8fb21149d 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Adapters/SearchAdapterHelper.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Adapters/SearchAdapterHelper.java
@@ -140,6 +140,7 @@ public void queryServerSearch(final String query, final boolean allowUsername, f
                             if (localSearchResults != null) {
                                 mergeResults(localSearchResults);
                             }
+                            channelReqId = 0;
                             delegate.onDataSetChanged();
                         }
                     }
@@ -242,6 +243,7 @@ public void queryServerSearch(final String query, final boolean allowUsername, f
                                 mergeResults(localSearchResults);
                             }
                             mergeExcludeResults();
+                            reqId = 0;
                             delegate.onDataSetChanged();
                         }
                     }
