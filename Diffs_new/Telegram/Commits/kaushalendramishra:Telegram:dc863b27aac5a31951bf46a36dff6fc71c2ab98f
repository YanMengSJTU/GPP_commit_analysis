diff --git a/TMessagesProj/jni/utils.c b/TMessagesProj/jni/utils.c
index 1321a8213..96e38d559 100644
--- a/TMessagesProj/jni/utils.c
+++ b/TMessagesProj/jni/utils.c
@@ -1,14 +1,15 @@
 #include "utils.h"
+#define BUFSIZE 255
 
 void throwException(JNIEnv *env, char *format, ...) {
     jclass exClass = (*env)->FindClass(env, "java/lang/UnsupportedOperationException");
     if (!exClass) {
         return;
 	}
-    char dest[256];
+    char dest[BUFSIZE+1] ={0};
     va_list argptr;
     va_start(argptr, format);
-    vsprintf(dest, format, argptr);
+    vsnprintf(dest, BUFSIZE, format, argptr);
     va_end(argptr);
     (*env)->ThrowNew(env, exClass, dest);
 }
