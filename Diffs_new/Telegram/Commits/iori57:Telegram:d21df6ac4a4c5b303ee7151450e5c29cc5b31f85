diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/SendMessagesHelper.java b/TMessagesProj/src/main/java/org/telegram/messenger/SendMessagesHelper.java
index 8f9e5bb6e..9552e12de 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/SendMessagesHelper.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/SendMessagesHelper.java
@@ -2063,7 +2063,7 @@ private static boolean prepareSendingDocumentInternal(String path, String origin
         if (idx != -1) {
             ext = path.substring(idx + 1);
         }
-        if (ext.toLowerCase().equals("mp3") || ext.toLowerCase().equals("m4a")) {
+        if (ext.toLowerCase().equals("mp3") || ext.toLowerCase().equals("m4a") || ext.toLowerCase().equals("wav") || ext.toLowerCase().equals("aac")) {
             AudioInfo audioInfo = AudioInfo.getAudioInfo(f);
             if (audioInfo != null && audioInfo.getDuration() != 0) {
                 if (isEncrypted) {
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/audioinfo/AudioInfo.java b/TMessagesProj/src/main/java/org/telegram/messenger/audioinfo/AudioInfo.java
index dd1181cac..026620b57 100755
--- a/TMessagesProj/src/main/java/org/telegram/messenger/audioinfo/AudioInfo.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/audioinfo/AudioInfo.java
@@ -145,7 +145,7 @@ public static AudioInfo getAudioInfo(File file) {
             if (header[4] == 'f' && header[5] == 't' && header[6] == 'y' && header[7] == 'p') {
                 return new M4AInfo(input);
             } else {
-                return new MP3Info(input, file.length());
+                return new MP3Info(input, file);
             }
         } catch (Exception e) {
             return null;
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/audioinfo/mp3/MP3Info.java b/TMessagesProj/src/main/java/org/telegram/messenger/audioinfo/mp3/MP3Info.java
index 32e6c663a..61da9f79d 100755
--- a/TMessagesProj/src/main/java/org/telegram/messenger/audioinfo/mp3/MP3Info.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/audioinfo/mp3/MP3Info.java
@@ -15,9 +15,14 @@
  */
 package org.telegram.messenger.audioinfo.mp3;
 
+import android.media.MediaPlayer;
+import android.net.Uri;
+
+import org.telegram.messenger.ApplicationLoader;
 import org.telegram.messenger.audioinfo.AudioInfo;
 
 import java.io.EOFException;
+import java.io.File;
 import java.io.IOException;
 import java.io.InputStream;
 import java.util.logging.Level;
@@ -30,11 +35,12 @@
 		boolean stopRead(MP3Input data) throws IOException;
 	}
 
-	public MP3Info(InputStream input, long fileLength) throws IOException, ID3v2Exception, MP3Exception {
-		this(input, fileLength, Level.FINEST);
+	public MP3Info(InputStream input, File file) throws IOException, ID3v2Exception, MP3Exception {
+		this(input, file, Level.FINEST);
 	}
 
-	public MP3Info(InputStream input, final long fileLength, Level debugLevel) throws IOException, ID3v2Exception, MP3Exception {
+	public MP3Info(InputStream input, File file, Level debugLevel) throws IOException, ID3v2Exception, MP3Exception {
+		final long fileLength = file.length();
 		brand = "MP3";
 		version = "0";
 		MP3Input data = new MP3Input(input);
@@ -72,7 +78,17 @@ public boolean stopRead(MP3Input data) throws IOException {
 				});
 			} catch (MP3Exception e) {
 				if (LOGGER.isLoggable(debugLevel)) {
-					LOGGER.log(debugLevel, "Could not determine MP3 duration", e);
+					LOGGER.log(debugLevel, "Could not determine MP3 duration by reading file structure", e);
+				}
+
+				// Try to determine duration using Media Player
+				try {
+					MediaPlayer mp = MediaPlayer.create(ApplicationLoader.applicationContext, Uri.fromFile(file));
+					duration = mp.getDuration();
+				} catch (Exception exception) {
+					if (LOGGER.isLoggable(debugLevel)) {
+						LOGGER.log(debugLevel, "Could not determine MP3 duration", exception);
+					}
 				}
 			}
 		}
