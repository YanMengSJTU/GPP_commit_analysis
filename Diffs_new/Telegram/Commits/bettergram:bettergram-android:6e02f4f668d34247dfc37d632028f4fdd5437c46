diff --git a/TMessagesProj/config/debug/AndroidManifest.xml b/TMessagesProj/config/debug/AndroidManifest.xml
index 6b455b198..8a75ab2df 100644
--- a/TMessagesProj/config/debug/AndroidManifest.xml
+++ b/TMessagesProj/config/debug/AndroidManifest.xml
@@ -29,7 +29,7 @@
         android:supportsRtl="false"
         tools:replace="android:supportsRtl">
 
-        <meta-data android:name="com.google.android.maps.v2.API_KEY" android:value="@string/google_maps_key" />
+        <meta-data android:name="com.google.android.geo.API_KEY" android:value="@string/google_maps_key" />
 
         <service
             android:name="io.bettergram.telegram.messenger.GcmPushListenerService">
diff --git a/TMessagesProj/config/debug/AndroidManifest_SDK23.xml b/TMessagesProj/config/debug/AndroidManifest_SDK23.xml
index c6bb1ae9a..fe3d3b2fa 100644
--- a/TMessagesProj/config/debug/AndroidManifest_SDK23.xml
+++ b/TMessagesProj/config/debug/AndroidManifest_SDK23.xml
@@ -33,7 +33,7 @@
         android:supportsRtl="false"
         tools:replace="android:supportsRtl">
 
-        <meta-data android:name="com.google.android.maps.v2.API_KEY" android:value="@string/google_maps_key" />
+        <meta-data android:name="com.google.android.geo.API_KEY" android:value="@string/google_maps_key" />
 
         <service
             android:name="io.bettergram.telegram.messenger.GcmPushListenerService">
diff --git a/TMessagesProj/config/release/AndroidManifest.xml b/TMessagesProj/config/release/AndroidManifest.xml
index b9adee8a8..51ff219da 100644
--- a/TMessagesProj/config/release/AndroidManifest.xml
+++ b/TMessagesProj/config/release/AndroidManifest.xml
@@ -29,7 +29,7 @@
         android:supportsRtl="false"
         tools:replace="android:supportsRtl">
 
-        <meta-data android:name="com.google.android.maps.v2.API_KEY" android:value="@string/google_maps_key" />
+        <meta-data android:name="com.google.android.geo.API_KEY" android:value="@string/google_maps_key" />
 
         <service
             android:name="io.bettergram.telegram.messenger.GcmPushListenerService">
diff --git a/TMessagesProj/config/release/AndroidManifest_SDK23.xml b/TMessagesProj/config/release/AndroidManifest_SDK23.xml
index 33409d02c..e5d9cd31a 100644
--- a/TMessagesProj/config/release/AndroidManifest_SDK23.xml
+++ b/TMessagesProj/config/release/AndroidManifest_SDK23.xml
@@ -33,7 +33,7 @@
         android:supportsRtl="false"
         tools:replace="android:supportsRtl">
 
-        <meta-data android:name="com.google.android.maps.v2.API_KEY" android:value="@string/google_maps_key" />
+        <meta-data android:name="com.google.android.geo.API_KEY" android:value="@string/google_maps_key" />
 
         <service
             android:name="io.bettergram.telegram.messenger.GcmPushListenerService">
diff --git a/TMessagesProj/src/debug/res/values/google_maps_api.xml b/TMessagesProj/src/debug/res/values/google_maps_api.xml
index 9633ae5da..a36ef9d20 100644
--- a/TMessagesProj/src/debug/res/values/google_maps_api.xml
+++ b/TMessagesProj/src/debug/res/values/google_maps_api.xml
@@ -1,5 +1,5 @@
 <resources>
     <string name="google_maps_key" templateMergeStrategy="preserve" translatable="false">
-        AIzaSyAB8Fm6boQqEA3nwSrD-oP6rnEBYJ6bIng
+        AIzaSyCMDlqt1hAAxkPaobNQFwI4mn1WHf-Q3EQ
     </string>
 </resources>
diff --git a/TMessagesProj/src/main/java/io/bettergram/telegram/messenger/AndroidUtilities.java b/TMessagesProj/src/main/java/io/bettergram/telegram/messenger/AndroidUtilities.java
index 2d19fe3f2..72018ea85 100644
--- a/TMessagesProj/src/main/java/io/bettergram/telegram/messenger/AndroidUtilities.java
+++ b/TMessagesProj/src/main/java/io/bettergram/telegram/messenger/AndroidUtilities.java
@@ -1052,6 +1052,9 @@ public static String formapMapUrl(int account, double lat, double lon, int width
             }
         } else {
             String k = MessagesController.getInstance(account).mapKey;
+            if (k == null) {
+                k = getGoogleMapApiKey();
+            }
             if (!TextUtils.isEmpty(k)) {
                 if (marker) {
                     return String.format(Locale.US, "https://maps.googleapis.com/maps/api/staticmap?center=%.6f,%.6f&zoom=%d&size=%dx%d&maptype=roadmap&scale=%d&markers=color:red%%7Csize:mid%%7C%.6f,%.6f&sensor=false&key=%s", lat, lon, zoom, width, height, scale, lat, lon, k);
@@ -1068,6 +1071,10 @@ public static String formapMapUrl(int account, double lat, double lon, int width
         }
     }
 
+    public static String getGoogleMapApiKey() {
+        return LocaleController.getString("google_maps_key", R.string.google_maps_key);
+    }
+
     public static float getPixelsInCM(float cm, boolean isX) {
         return (cm / 2.54f) * (isX ? displayMetrics.xdpi : displayMetrics.ydpi);
     }
diff --git a/TMessagesProj/src/main/java/io/bettergram/telegram/messenger/MessagesController.java b/TMessagesProj/src/main/java/io/bettergram/telegram/messenger/MessagesController.java
index af9034ef7..d542a791b 100644
--- a/TMessagesProj/src/main/java/io/bettergram/telegram/messenger/MessagesController.java
+++ b/TMessagesProj/src/main/java/io/bettergram/telegram/messenger/MessagesController.java
@@ -493,6 +493,9 @@ public void updateConfig(final TLRPC.TL_config config) {
                         if (typeAndKey.length > 1) {
                             mapKey = typeAndKey[1];
                         }
+                        if ("google".equals(typeAndKey[0]) && mapKey == null) {
+                            mapKey = AndroidUtilities.getGoogleMapApiKey();
+                        }
                     }
                 }
             }
diff --git a/TMessagesProj/src/main/java/io/bettergram/telegram/ui/LocationActivity.java b/TMessagesProj/src/main/java/io/bettergram/telegram/ui/LocationActivity.java
index 06203b986..f9b148ed6 100644
--- a/TMessagesProj/src/main/java/io/bettergram/telegram/ui/LocationActivity.java
+++ b/TMessagesProj/src/main/java/io/bettergram/telegram/ui/LocationActivity.java
@@ -50,9 +50,7 @@
 import com.google.android.gms.maps.CameraUpdateFactory;
 import com.google.android.gms.maps.GoogleMap;
 import com.google.android.gms.maps.MapView;
-
 import com.google.android.gms.maps.MapsInitializer;
-import com.google.android.gms.maps.OnMapReadyCallback;
 import com.google.android.gms.maps.model.BitmapDescriptorFactory;
 import com.google.android.gms.maps.model.CircleOptions;
 import com.google.android.gms.maps.model.LatLng;
@@ -60,14 +58,23 @@
 import com.google.android.gms.maps.model.Marker;
 import com.google.android.gms.maps.model.MarkerOptions;
 
+import java.io.File;
+import java.util.ArrayList;
+import java.util.List;
+import java.util.Locale;
+
+import io.bettergram.messenger.R;
 import io.bettergram.telegram.messenger.AndroidUtilities;
+import io.bettergram.telegram.messenger.ApplicationLoader;
 import io.bettergram.telegram.messenger.ChatObject;
 import io.bettergram.telegram.messenger.FileLoader;
-import io.bettergram.telegram.messenger.LocationController;
-import io.bettergram.telegram.messenger.MessagesStorage;
-import io.bettergram.telegram.messenger.ApplicationLoader;
 import io.bettergram.telegram.messenger.FileLog;
 import io.bettergram.telegram.messenger.LocaleController;
+import io.bettergram.telegram.messenger.LocationController;
+import io.bettergram.telegram.messenger.MessageObject;
+import io.bettergram.telegram.messenger.MessagesController;
+import io.bettergram.telegram.messenger.MessagesStorage;
+import io.bettergram.telegram.messenger.NotificationCenter;
 import io.bettergram.telegram.messenger.UserConfig;
 import io.bettergram.telegram.messenger.support.widget.LinearLayoutManager;
 import io.bettergram.telegram.messenger.support.widget.RecyclerView;
@@ -75,14 +82,11 @@
 import io.bettergram.telegram.tgnet.RequestDelegate;
 import io.bettergram.telegram.tgnet.TLObject;
 import io.bettergram.telegram.tgnet.TLRPC;
-import io.bettergram.telegram.messenger.MessageObject;
-import io.bettergram.telegram.messenger.MessagesController;
-import io.bettergram.telegram.messenger.NotificationCenter;
-import io.bettergram.messenger.R;
 import io.bettergram.telegram.ui.ActionBar.ActionBar;
 import io.bettergram.telegram.ui.ActionBar.ActionBarMenu;
 import io.bettergram.telegram.ui.ActionBar.ActionBarMenuItem;
 import io.bettergram.telegram.ui.ActionBar.AlertDialog;
+import io.bettergram.telegram.ui.ActionBar.BaseFragment;
 import io.bettergram.telegram.ui.ActionBar.Theme;
 import io.bettergram.telegram.ui.ActionBar.ThemeDescription;
 import io.bettergram.telegram.ui.Adapters.BaseLocationAdapter;
@@ -95,17 +99,13 @@
 import io.bettergram.telegram.ui.Cells.SendLocationCell;
 import io.bettergram.telegram.ui.Components.AlertsCreator;
 import io.bettergram.telegram.ui.Components.AvatarDrawable;
-import io.bettergram.telegram.ui.ActionBar.BaseFragment;
 import io.bettergram.telegram.ui.Components.CombinedDrawable;
 import io.bettergram.telegram.ui.Components.EmptyTextProgressView;
 import io.bettergram.telegram.ui.Components.LayoutHelper;
 import io.bettergram.telegram.ui.Components.MapPlaceholderDrawable;
 import io.bettergram.telegram.ui.Components.RecyclerListView;
 
-import java.io.File;
-import java.util.ArrayList;
-import java.util.List;
-import java.util.Locale;
+import static io.bettergram.telegram.messenger.AndroidUtilities.runOnUIThread;
 
 public class LocationActivity extends BaseFragment implements NotificationCenter.NotificationCenterDelegate {
 
@@ -535,40 +535,33 @@ public boolean onInterceptTouchEvent(MotionEvent ev) {
             }
         };
         final MapView map = mapView;
-        new Thread(new Runnable() {
-            @Override
-            public void run() {
-                try {
-                    map.onCreate(null);
-                } catch (Exception e) {
-                    //this will cause exception, but will preload google maps?
-                }
-                AndroidUtilities.runOnUIThread(new Runnable() {
-                    @Override
-                    public void run() {
-                        if (mapView != null && getParentActivity() != null) {
-                            try {
-                                map.onCreate(null);
-                                MapsInitializer.initialize(ApplicationLoader.applicationContext);
-                                mapView.getMapAsync(new OnMapReadyCallback() {
-                                    @Override
-                                    public void onMapReady(GoogleMap map) {
-                                        googleMap = map;
-                                        googleMap.setPadding(AndroidUtilities.dp(70), 0, AndroidUtilities.dp(70), AndroidUtilities.dp(10));
-                                        onMapInit();
-                                    }
-                                });
-                                mapsInitialized = true;
-                                if (onResumeCalled) {
-                                    mapView.onResume();
-                                }
-                            } catch (Exception e) {
-                                FileLog.e(e);
-                            }
+        new Thread(() -> {
+            try {
+                runOnUIThread(() -> map.onCreate(null));
+            } catch (Exception e) {
+                e.printStackTrace();
+                //this will cause exception, but will preload google maps?
+            }
+            runOnUIThread(() -> {
+                if (mapView != null && getParentActivity() != null) {
+                    try {
+                        map.onCreate(null);
+                        MapsInitializer.initialize(ApplicationLoader.applicationContext);
+                        mapView.getMapAsync(map1 -> {
+                            googleMap = map1;
+                            googleMap.setPadding(AndroidUtilities.dp(70), 0, AndroidUtilities.dp(70), AndroidUtilities.dp(10));
+                            onMapInit();
+                        });
+                        mapsInitialized = true;
+                        if (onResumeCalled) {
+                            mapView.onResume();
                         }
+                    } catch (Exception e) {
+                        e.printStackTrace();
+                        FileLog.e(e);
                     }
-                });
-            }
+                }
+            });
         }).start();
 
         View shadow = new View(context);
