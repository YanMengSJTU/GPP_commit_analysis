diff --git a/TMessagesProj/build.gradle b/TMessagesProj/build.gradle
index bd3d3a7f4..9a5f0e8ac 100644
--- a/TMessagesProj/build.gradle
+++ b/TMessagesProj/build.gradle
@@ -6,18 +6,39 @@ repositories {
 
 dependencies {
     compile 'com.android.support:support-v4:23.2.1'
+    compile 'com.android.support:support-v4:23.0.1'
     compile "com.google.android.gms:play-services-gcm:8.4.0"
     compile "com.google.android.gms:play-services-maps:8.4.0"
     compile 'net.hockeyapp.android:HockeySDK:3.6.+'
     compile 'com.googlecode.mp4parser:isoparser:1.0.+'
+    testCompile 'org.mockito:mockito-core:1.9.5'
+    testCompile ('junit:junit:4.12'){
+        exclude module: 'support-annotations'
+    }
+    androidTestCompile ('com.android.support.test:runner:0.4.1'){
+        exclude module: 'support-annotations'
+    }
+    androidTestCompile ('com.android.support.test:rules:0.4.1'){
+        exclude module: 'support-annotations'
+    }
+    // Optional -- Hamcrest library
+    androidTestCompile ('org.hamcrest:hamcrest-library:1.3'){
+        exclude module: 'support-annotations'
+    }
+    // Optional -- UI testing with Espresso
+    androidTestCompile ('com.android.support.test.espresso:espresso-core:2.2.1'){
+        exclude module: 'support-annotations'
+    }
+    // Optional -- UI testing with UI Automator
 }
 
 android {
+    testBuildType "debug"
+
     compileSdkVersion 23
     buildToolsVersion '23.0.2'
 
     useLibrary 'org.apache.http.legacy'
-    defaultConfig.applicationId = "org.telegram.messenger"
 
     compileOptions {
         sourceCompatibility JavaVersion.VERSION_1_7
@@ -42,6 +63,7 @@ android {
 
     buildTypes {
         debug {
+
             debuggable true
             jniDebuggable true
             signingConfig signingConfigs.debug
@@ -63,7 +85,7 @@ android {
         }
     }
 
-    defaultConfig.versionCode = 767
+
 
     sourceSets.main {
         jniLibs.srcDir 'libs'
@@ -82,6 +104,8 @@ android {
         manifest.srcFile 'config/foss/AndroidManifest.xml'
     }
 
+
+
     productFlavors {
         x86 {
             ndk {
@@ -106,14 +130,17 @@ android {
         }
     }
 
-    applicationVariants.all { variant ->
-        def abiVersion = variant.productFlavors.get(0).versionCode
-        variant.mergedFlavor.versionCode = defaultConfig.versionCode * 10 + abiVersion;
-    }
-
     defaultConfig {
+        applicationId = "org.telegram.messenger"
+        versionCode = 767
         minSdkVersion 9
         targetSdkVersion 23
         versionName "3.7.0"
+        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
+    }
+
+    applicationVariants.all { variant ->
+        def abiVersion = variant.productFlavors.get(0).versionCode
+        variant.mergedFlavor.versionCode = defaultConfig.versionCode * 10 + abiVersion;
     }
 }
