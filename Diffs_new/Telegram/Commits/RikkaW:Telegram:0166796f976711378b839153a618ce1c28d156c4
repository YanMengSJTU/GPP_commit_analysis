diff --git a/TMessagesProj/build.gradle b/TMessagesProj/build.gradle
index 1031c63c6..9bfcb92ce 100644
--- a/TMessagesProj/build.gradle
+++ b/TMessagesProj/build.gradle
@@ -9,9 +9,9 @@ configurations {
 }
 
 dependencies {
-    compile 'com.google.android.gms:play-services-gcm:9.6.1'
-    compile 'com.google.android.gms:play-services-maps:9.6.1'
-    compile 'com.google.android.gms:play-services-vision:9.6.1'
+    compile 'com.google.android.gms:play-services-gcm:9.8.00'
+    compile 'com.google.android.gms:play-services-maps:9.8.00'
+    compile 'com.google.android.gms:play-services-vision:9.8.00'
     compile 'com.android.support:support-core-ui:25.0.0'
     compile 'com.android.support:support-compat:25.0.0'
     compile 'com.android.support:support-core-utils:25.0.0'
@@ -81,7 +81,7 @@ android {
         }
     }
 
-    defaultConfig.versionCode = 851 + 7
+    defaultConfig.versionCode = 851 + 8
 
     sourceSets.debug {
         manifest.srcFile 'config/debug/AndroidManifest.xml'
@@ -121,7 +121,7 @@ android {
     defaultConfig {
         minSdkVersion 21
         targetSdkVersion 25
-        versionName "3.13.1.7"
+        versionName "3.13.1.8"
 
         /*externalNativeBuild {
             ndkBuild {
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Components/EmojiView.java b/TMessagesProj/src/main/java/org/telegram/ui/Components/EmojiView.java
index 76eb2e2bf..51a1a41cb 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Components/EmojiView.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Components/EmojiView.java
@@ -22,10 +22,9 @@
 import android.graphics.RectF;
 import android.graphics.drawable.Drawable;
 import android.os.Build;
-import android.support.v4.content.ContextCompat;
 import android.support.v4.view.PagerAdapter;
 import android.support.v4.view.ViewPager;
-import android.util.Log;
+import android.text.TextPaint;
 import android.util.TypedValue;
 import android.view.Gravity;
 import android.view.HapticFeedbackConstants;
@@ -119,7 +118,9 @@ private static String addColorToCode(String code, String color) {
         return code;
     }
 
-    private class ImageViewEmoji extends ForegroundTextView {
+    private static TextPaint emojiPaint;
+
+    private class ImageViewEmoji extends ImageView {
 
         private boolean touched;
         private float lastX;
@@ -127,6 +128,10 @@ private static String addColorToCode(String code, String color) {
         private float touchedX;
         private float touchedY;
 
+        private int mTextSize;
+
+        private String mText;
+
         public ImageViewEmoji(Context context) {
             super(context);
             setOnClickListener(new OnClickListener() {
@@ -189,9 +194,14 @@ public boolean onLongClick(View view) {
                 }
             });
             setBackgroundResource(R.drawable.list_selector);
-            setGravity(Gravity.CENTER);
-            setTypeface(AndroidUtilities.getTypeface("fonts/NotoColorEmoji.ttf"));
-            setTextColor(Color.BLACK);
+            setScaleType(ScaleType.CENTER);
+
+            if (emojiPaint == null) {
+                emojiPaint = new TextPaint();
+                emojiPaint.setTypeface(AndroidUtilities.getTypeface("fonts/NotoColorEmoji.ttf"));
+                emojiPaint.setColor(Color.BLACK);
+            }
+
         }
 
         private void sendEmoji(String override) {
@@ -236,8 +246,27 @@ private void sendEmoji(String override) {
         @Override
         public void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
             setMeasuredDimension(View.MeasureSpec.getSize(widthMeasureSpec), View.MeasureSpec.getSize(widthMeasureSpec));
-            if (getPaint().getTextSize() != 0.6f * getMeasuredWidth()) {
-                getPaint().setTextSize(0.6f * getMeasuredWidth());
+            if (mTextSize == 0) {
+                mTextSize = (int) (0.6f * getMeasuredWidth());
+                emojiPaint.setTextSize(mTextSize);
+            }
+        }
+
+        private android.graphics.Rect r = new android.graphics.Rect();
+
+        @Override
+        protected void onDraw(Canvas canvas) {
+            super.onDraw(canvas);
+
+            if (mText != null) {
+                canvas.getClipBounds(r);
+                int height = r.height();
+                int width = r.width();
+                emojiPaint.setTextAlign(Paint.Align.LEFT);
+                emojiPaint.getTextBounds(mText, 0, mText.length(), r);
+                float x = width / 2f - r.width() / 2f - r.left;
+                float y = height / 2f + r.height() / 2f - r.bottom;
+                canvas.drawText(mText, x, y, emojiPaint);
             }
         }
 
@@ -276,10 +305,10 @@ public boolean onTouchEvent(MotionEvent event) {
                             }
                             if (MessagesController.getInstance().useGoogleEmoji) {
                                 setText(code);
-                                setForeground(null);
+                                setImageDrawable(null);
                             } else {
                                 setText(null);
-                                setForeground(Emoji.getEmojiBigDrawable(code));
+                                setImageDrawable(Emoji.getEmojiBigDrawable(code));
                             }
                             sendEmoji(null);
                             saveEmojiColors();
@@ -319,6 +348,14 @@ public boolean onTouchEvent(MotionEvent event) {
             lastY = event.getY();
             return super.onTouchEvent(event);
         }
+
+        public void setText(String text) {
+            mText = text;
+        }
+
+        public String getText() {
+            return mText;
+        }
     }
 
     private class EmojiPopupWindow extends PopupWindow {
@@ -2102,10 +2139,10 @@ public View getView(int position, View view, ViewGroup paramViewGroup) {
             }
             if (MessagesController.getInstance().useGoogleEmoji) {
                 imageView.setText(code);
-                imageView.setForeground(null);
+                imageView.setImageDrawable(null);
             } else {
                 imageView.setText(null);
-                imageView.setForeground(Emoji.getEmojiBigDrawable(code));
+                imageView.setImageDrawable(Emoji.getEmojiBigDrawable(code));
             }
 
             imageView.setTag(code);
diff --git a/TMessagesProj/src/main/res/values-ar/strings.xml b/TMessagesProj/src/main/res/values-ar/strings.xml
index aabb52056..2d7837109 100644
--- a/TMessagesProj/src/main/res/values-ar/strings.xml
+++ b/TMessagesProj/src/main/res/values-ar/strings.xml
@@ -1301,13 +1301,13 @@
     <string name="UseGoogleEmojiInfo">Use Noto Color Emoji instead of iOS emoji</string>
     <string name="NightMode">Night Mode</string>
     <string name="NightModeStatus">Status</string>
-    <string name="NightModeEnable">Enable</string>
-    <string name="NightModeDisable">Disable</string>
+    <string name="NightModeEnable">Enabled</string>
+    <string name="NightModeDisable">Disabled</string>
     <string name="NightModeAuto">Auto</string>
     <string name="NightModeFollowSystem">Follow System</string>
-    <string name="NightModeAutoSwitch">Auto switch time</string>
-    <string name="NightModeStartTime">Start time</string>
-    <string name="NightModeEndTime">End time</string>
-    <string name="NightModeAutoSwitchInfo">This setting only take effect when you select auto.</string>
-    <string name="NightModeInfo">Follow System may need you to force stop and restart app to take effect.</string>
+    <string name="NightModeAutoSwitch">Night time</string>
+    <string name="NightModeStartTime">From</string>
+    <string name="NightModeAutoSwitchInfo">The above section will only take effect if \'Auto\' is selected.</string>
+    <string name="NightModeEndTime">To</string>
+    <string name="NightModeInfo">Restart of the app may be required for \'Follow System\' to come into effect</string>
 </resources>
diff --git a/TMessagesProj/src/main/res/values-de/strings.xml b/TMessagesProj/src/main/res/values-de/strings.xml
index 3d4837f03..16d30fd62 100644
--- a/TMessagesProj/src/main/res/values-de/strings.xml
+++ b/TMessagesProj/src/main/res/values-de/strings.xml
@@ -1301,13 +1301,13 @@
     <string name="UseGoogleEmojiInfo">Use Noto Color Emoji instead of iOS emoji</string>
     <string name="NightMode">Night Mode</string>
     <string name="NightModeStatus">Status</string>
-    <string name="NightModeEnable">Enable</string>
-    <string name="NightModeDisable">Disable</string>
+    <string name="NightModeEnable">Enabled</string>
+    <string name="NightModeDisable">Disabled</string>
     <string name="NightModeAuto">Auto</string>
     <string name="NightModeFollowSystem">Follow System</string>
-    <string name="NightModeAutoSwitch">Auto switch time</string>
-    <string name="NightModeStartTime">Start time</string>
-    <string name="NightModeEndTime">End time</string>
-    <string name="NightModeAutoSwitchInfo">This setting only take effect when you select auto.</string>
-    <string name="NightModeInfo">Follow System may need you to force stop and restart app to take effect.</string>
+    <string name="NightModeAutoSwitch">Night time</string>
+    <string name="NightModeStartTime">From</string>
+    <string name="NightModeAutoSwitchInfo">The above section will only take effect if \'Auto\' is selected.</string>
+    <string name="NightModeEndTime">To</string>
+    <string name="NightModeInfo">Restart of the app may be required for \'Follow System\' to come into effect</string>
 </resources>
diff --git a/TMessagesProj/src/main/res/values-es/strings.xml b/TMessagesProj/src/main/res/values-es/strings.xml
index 600ea72c2..aeb822d9d 100644
--- a/TMessagesProj/src/main/res/values-es/strings.xml
+++ b/TMessagesProj/src/main/res/values-es/strings.xml
@@ -1296,17 +1296,18 @@
     <string name="formatterDay12H">h:mm a</string>
     <string name="formatDateAtTime">%1$s a las %2$s</string>
 
+    <!--Rikkagram-->
     <string name="UseGoogleEmoji">Google emoji</string>
     <string name="UseGoogleEmojiInfo">Use Noto Color Emoji instead of iOS emoji</string>
     <string name="NightMode">Night Mode</string>
     <string name="NightModeStatus">Status</string>
-    <string name="NightModeEnable">Enable</string>
-    <string name="NightModeDisable">Disable</string>
+    <string name="NightModeEnable">Enabled</string>
+    <string name="NightModeDisable">Disabled</string>
     <string name="NightModeAuto">Auto</string>
     <string name="NightModeFollowSystem">Follow System</string>
-    <string name="NightModeAutoSwitch">Auto switch time</string>
-    <string name="NightModeStartTime">Start time</string>
-    <string name="NightModeEndTime">End time</string>
-    <string name="NightModeAutoSwitchInfo">This setting only take effect when you select auto.</string>
-    <string name="NightModeInfo">Follow System may need you to force stop and restart app to take effect.</string>
+    <string name="NightModeAutoSwitch">Night time</string>
+    <string name="NightModeStartTime">From</string>
+    <string name="NightModeAutoSwitchInfo">The above section will only take effect if \'Auto\' is selected.</string>
+    <string name="NightModeEndTime">To</string>
+    <string name="NightModeInfo">Restart of the app may be required for \'Follow System\' to come into effect</string>
 </resources>
diff --git a/TMessagesProj/src/main/res/values-it/strings.xml b/TMessagesProj/src/main/res/values-it/strings.xml
index 501c8a61d..6b09c288b 100644
--- a/TMessagesProj/src/main/res/values-it/strings.xml
+++ b/TMessagesProj/src/main/res/values-it/strings.xml
@@ -1296,17 +1296,18 @@
     <string name="formatterDay12H">h:mm a</string>
     <string name="formatDateAtTime">%1$s alle %2$s</string>
 
+    <!--Rikkagram-->
     <string name="UseGoogleEmoji">Google emoji</string>
     <string name="UseGoogleEmojiInfo">Use Noto Color Emoji instead of iOS emoji</string>
     <string name="NightMode">Night Mode</string>
     <string name="NightModeStatus">Status</string>
-    <string name="NightModeEnable">Enable</string>
-    <string name="NightModeDisable">Disable</string>
+    <string name="NightModeEnable">Enabled</string>
+    <string name="NightModeDisable">Disabled</string>
     <string name="NightModeAuto">Auto</string>
     <string name="NightModeFollowSystem">Follow System</string>
-    <string name="NightModeAutoSwitch">Auto switch time</string>
-    <string name="NightModeStartTime">Start time</string>
-    <string name="NightModeEndTime">End time</string>
-    <string name="NightModeAutoSwitchInfo">This setting only take effect when you select auto.</string>
-    <string name="NightModeInfo">Follow System may need you to force stop and restart app to take effect.</string>
+    <string name="NightModeAutoSwitch">Night time</string>
+    <string name="NightModeStartTime">From</string>
+    <string name="NightModeAutoSwitchInfo">The above section will only take effect if \'Auto\' is selected.</string>
+    <string name="NightModeEndTime">To</string>
+    <string name="NightModeInfo">Restart of the app may be required for \'Follow System\' to come into effect</string>
 </resources>
diff --git a/TMessagesProj/src/main/res/values-ko/strings.xml b/TMessagesProj/src/main/res/values-ko/strings.xml
index 1e0309cdd..0fad9df6c 100644
--- a/TMessagesProj/src/main/res/values-ko/strings.xml
+++ b/TMessagesProj/src/main/res/values-ko/strings.xml
@@ -1301,13 +1301,13 @@
     <string name="UseGoogleEmojiInfo">Use Noto Color Emoji instead of iOS emoji</string>
     <string name="NightMode">Night Mode</string>
     <string name="NightModeStatus">Status</string>
-    <string name="NightModeEnable">Enable</string>
-    <string name="NightModeDisable">Disable</string>
+    <string name="NightModeEnable">Enabled</string>
+    <string name="NightModeDisable">Disabled</string>
     <string name="NightModeAuto">Auto</string>
     <string name="NightModeFollowSystem">Follow System</string>
-    <string name="NightModeAutoSwitch">Auto switch time</string>
-    <string name="NightModeStartTime">Start time</string>
-    <string name="NightModeEndTime">End time</string>
-    <string name="NightModeAutoSwitchInfo">This setting only take effect when you select auto.</string>
-    <string name="NightModeInfo">Follow System may need you to force stop and restart app to take effect.</string>
+    <string name="NightModeAutoSwitch">Night time</string>
+    <string name="NightModeStartTime">From</string>
+    <string name="NightModeAutoSwitchInfo">The above section will only take effect if \'Auto\' is selected.</string>
+    <string name="NightModeEndTime">To</string>
+    <string name="NightModeInfo">Restart of the app may be required for \'Follow System\' to come into effect</string>
 </resources>
diff --git a/TMessagesProj/src/main/res/values-nl/strings.xml b/TMessagesProj/src/main/res/values-nl/strings.xml
index 405b5ede8..2c6b6c4ab 100644
--- a/TMessagesProj/src/main/res/values-nl/strings.xml
+++ b/TMessagesProj/src/main/res/values-nl/strings.xml
@@ -1301,13 +1301,13 @@
     <string name="UseGoogleEmojiInfo">Use Noto Color Emoji instead of iOS emoji</string>
     <string name="NightMode">Night Mode</string>
     <string name="NightModeStatus">Status</string>
-    <string name="NightModeEnable">Enable</string>
-    <string name="NightModeDisable">Disable</string>
+    <string name="NightModeEnable">Enabled</string>
+    <string name="NightModeDisable">Disabled</string>
     <string name="NightModeAuto">Auto</string>
     <string name="NightModeFollowSystem">Follow System</string>
-    <string name="NightModeAutoSwitch">Auto switch time</string>
-    <string name="NightModeStartTime">Start time</string>
-    <string name="NightModeEndTime">End time</string>
-    <string name="NightModeAutoSwitchInfo">This setting only take effect when you select auto.</string>
-    <string name="NightModeInfo">Follow System may need you to force stop and restart app to take effect.</string>
+    <string name="NightModeAutoSwitch">Night time</string>
+    <string name="NightModeStartTime">From</string>
+    <string name="NightModeAutoSwitchInfo">The above section will only take effect if \'Auto\' is selected.</string>
+    <string name="NightModeEndTime">To</string>
+    <string name="NightModeInfo">Restart of the app may be required for \'Follow System\' to come into effect</string>
 </resources>
diff --git a/TMessagesProj/src/main/res/values-pt-rBR/strings.xml b/TMessagesProj/src/main/res/values-pt-rBR/strings.xml
index ff10bdbdf..154814aea 100644
--- a/TMessagesProj/src/main/res/values-pt-rBR/strings.xml
+++ b/TMessagesProj/src/main/res/values-pt-rBR/strings.xml
@@ -1301,13 +1301,13 @@
     <string name="UseGoogleEmojiInfo">Use Noto Color Emoji instead of iOS emoji</string>
     <string name="NightMode">Night Mode</string>
     <string name="NightModeStatus">Status</string>
-    <string name="NightModeEnable">Enable</string>
-    <string name="NightModeDisable">Disable</string>
+    <string name="NightModeEnable">Enabled</string>
+    <string name="NightModeDisable">Disabled</string>
     <string name="NightModeAuto">Auto</string>
     <string name="NightModeFollowSystem">Follow System</string>
-    <string name="NightModeAutoSwitch">Auto switch time</string>
-    <string name="NightModeStartTime">Start time</string>
-    <string name="NightModeEndTime">End time</string>
-    <string name="NightModeAutoSwitchInfo">This setting only take effect when you select auto.</string>
-    <string name="NightModeInfo">Follow System may need you to force stop and restart app to take effect.</string>
+    <string name="NightModeAutoSwitch">Night time</string>
+    <string name="NightModeStartTime">From</string>
+    <string name="NightModeAutoSwitchInfo">The above section will only take effect if \'Auto\' is selected.</string>
+    <string name="NightModeEndTime">To</string>
+    <string name="NightModeInfo">Restart of the app may be required for \'Follow System\' to come into effect</string>
 </resources>
diff --git a/TMessagesProj/src/main/res/values-pt-rPT/strings.xml b/TMessagesProj/src/main/res/values-pt-rPT/strings.xml
index d8ed29da7..b0bb6fc5f 100644
--- a/TMessagesProj/src/main/res/values-pt-rPT/strings.xml
+++ b/TMessagesProj/src/main/res/values-pt-rPT/strings.xml
@@ -1301,13 +1301,13 @@
     <string name="UseGoogleEmojiInfo">Use Noto Color Emoji instead of iOS emoji</string>
     <string name="NightMode">Night Mode</string>
     <string name="NightModeStatus">Status</string>
-    <string name="NightModeEnable">Enable</string>
-    <string name="NightModeDisable">Disable</string>
+    <string name="NightModeEnable">Enabled</string>
+    <string name="NightModeDisable">Disabled</string>
     <string name="NightModeAuto">Auto</string>
     <string name="NightModeFollowSystem">Follow System</string>
-    <string name="NightModeAutoSwitch">Auto switch time</string>
-    <string name="NightModeStartTime">Start time</string>
-    <string name="NightModeEndTime">End time</string>
-    <string name="NightModeAutoSwitchInfo">This setting only take effect when you select auto.</string>
-    <string name="NightModeInfo">Follow System may need you to force stop and restart app to take effect.</string>
+    <string name="NightModeAutoSwitch">Night time</string>
+    <string name="NightModeStartTime">From</string>
+    <string name="NightModeAutoSwitchInfo">The above section will only take effect if \'Auto\' is selected.</string>
+    <string name="NightModeEndTime">To</string>
+    <string name="NightModeInfo">Restart of the app may be required for \'Follow System\' to come into effect</string>
 </resources>
diff --git a/TMessagesProj/src/main/res/values/strings.xml b/TMessagesProj/src/main/res/values/strings.xml
index 11aaf4f0b..f9210c9a8 100644
--- a/TMessagesProj/src/main/res/values/strings.xml
+++ b/TMessagesProj/src/main/res/values/strings.xml
@@ -1309,7 +1309,7 @@
     <string name="NightModeFollowSystem">Follow System</string>
     <string name="NightModeAutoSwitch">Night time</string>
     <string name="NightModeStartTime">From</string>
-    <string name="NightModeAutoSwitchInfo">The above section will only take effect if 'Auto' is selected.</string>
+    <string name="NightModeAutoSwitchInfo">The above section will only take effect if \'Auto\' is selected.</string>
     <string name="NightModeEndTime">To</string>
-    <string name="NightModeInfo">Restart of the app may be required for 'Follow System' to come into effect</string>
+    <string name="NightModeInfo">Restart of the app may be required for \'Follow System\' to come into effect</string>
 </resources>
