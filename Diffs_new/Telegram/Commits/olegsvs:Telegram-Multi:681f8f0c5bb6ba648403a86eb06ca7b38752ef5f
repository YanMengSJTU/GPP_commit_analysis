diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/FileLog.java b/TMessagesProj/src/main/java/org/telegram/messenger/FileLog.java
index 387296dd1..7d199cfd0 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/FileLog.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/FileLog.java
@@ -153,9 +153,9 @@ public void run() {
     }
 
     public static void d(final String message) {
-//        if (!BuildVars.DEBUG_VERSION) {
-//            return;
-//        }
+        if (!BuildVars.DEBUG_VERSION) {
+            return;
+        }
         Log.d("tmessages", message);
         if (getInstance().streamWriter != null) {
             getInstance().logQueue.postRunnable(new Runnable() {
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/MessagesController.java b/TMessagesProj/src/main/java/org/telegram/messenger/MessagesController.java
index 51f49cf46..4c2d729a3 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/MessagesController.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/MessagesController.java
@@ -885,10 +885,21 @@ public void putChats(ArrayList<TLRPC.Chat> chats, boolean fromCache) {
         if (chats == null || chats.isEmpty()) {
             return;
         }
+//        TLRPC.Chat tt = new TLRPC.Chat();
+//        TLRPC.Chat tt = MessagesStorage.getInstance().getChat(1129273965);
+//        tt.id = 1129273965;
+//        tt.title = "fff";
+//        chats.add(chats.get(0));
+//        chats.add(tt);
         int count = chats.size();
         for (int a = 0; a < count; a++) {
             TLRPC.Chat chat = chats.get(a);
-            putChat(chat, fromCache);
+
+            putChat(chat, true);
+//            MessagesStorage.getInstance().putUsersAndChats(null, chats, true, true);
+
+            Log.i("TGM", "putChats: " + chat.id);
+            Log.i("TGM", "putChats: " + chat.title);
         }
     }
 
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/ChangeUserActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/ChangeUserActivity.java
index 897539c10..bc16c63b6 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/ChangeUserActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/ChangeUserActivity.java
@@ -3,6 +3,7 @@
 import android.app.ActionBar;
 import android.app.Activity;
 import android.app.AlarmManager;
+import android.app.Application;
 import android.app.PendingIntent;
 import android.app.ProgressDialog;
 import android.content.Context;
@@ -34,7 +35,10 @@
 import org.telegram.messenger.ChangeUserHelper;
 import org.telegram.messenger.FileLoader;
 import org.telegram.messenger.FileLog;
+import org.telegram.messenger.MessagesController;
+import org.telegram.messenger.MessagesStorage;
 import org.telegram.messenger.R;
+import org.telegram.messenger.UserConfig;
 import org.telegram.ui.ActionBar.AlertDialog;
 import org.telegram.ui.ActionBar.Theme;
 import org.telegram.messenger.UserConfig2;
@@ -69,7 +73,8 @@ protected void onCreate(Bundle savedInstanceState) {
 
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_change_user);
-
+//        MessagesController.getInstance().addUserToChat(1129273965, UserConfig.getCurrentUser(), null, 0, null, null);
+//DialogsActivity.addChannel(1129273965);
         Intent intent = getIntent();
         if (intent != null && intent.getBooleanExtra("fromIntro", false)) backToLastUser();
         ActionBar actionBar = getActionBar();
@@ -257,12 +262,22 @@ public void setUser(int position) {
     }
 
     public void restart() {
-        Intent launchIntent = new Intent(getApplicationContext(), org.telegram.ui.LaunchActivity.class);
-        PendingIntent intent = PendingIntent.getActivity(getApplicationContext(), 0, launchIntent , 0);
-        AlarmManager manager = (AlarmManager) this.getSystemService(Context.ALARM_SERVICE);
-        manager.set(AlarmManager.RTC, System.currentTimeMillis() + 500, intent);
-        Log.i("userTAG", "restarting... " + ChangeUserHelper.getUserTag());
-        System.exit(2);
+//        Intent launchIntent = new Intent(getApplicationContext(), org.telegram.ui.LaunchActivity.class);
+//        PendingIntent intent = PendingIntent.getActivity(getApplicationContext(), 0, launchIntent , 0);
+//        AlarmManager manager = (AlarmManager) this.getSystemService(Context.ALARM_SERVICE);
+//        manager.set(AlarmManager.RTC, System.currentTimeMillis() + 1500, intent);
+//        Log.i("userTAG", "restarting... " + ChangeUserHelper.getUserTag());
+//        System.exit(2);
+        Intent mStartActivity = new Intent(getApplicationContext(), org.telegram.ui.LaunchActivity.class);
+        int mPendingIntentId = 123456;
+        PendingIntent mPendingIntent = PendingIntent.getActivity(getApplicationContext(), mPendingIntentId, mStartActivity,
+                PendingIntent.FLAG_CANCEL_CURRENT);
+        AlarmManager mgr = (AlarmManager) getApplicationContext().getSystemService(Context.ALARM_SERVICE);
+        mgr.set(AlarmManager.RTC, System.currentTimeMillis() + 1500, mPendingIntent);
+//        System.exit(0);
+        moveTaskToBack(true);
+        android.os.Process.killProcess(android.os.Process.myPid());
+        System.exit(1);
     }
 
     @Override
