diff --git a/DaoCore/build.gradle b/DaoCore/build.gradle
index d8bca22f..e70e49bb 100644
--- a/DaoCore/build.gradle
+++ b/DaoCore/build.gradle
@@ -25,9 +25,9 @@ configurations {
 
 dependencies {
     //sqlcipher dependencies
-    provided 'commons-codec:commons-codec:1.5'
-    provided group: 'com.google.guava', name: 'guava', version: '12.0'
-    provided files('libs/sqlcipher.jar')
+    compileOnly 'commons-codec:commons-codec:1.5'
+    compileOnly group: 'com.google.guava', name: 'guava', version: '12.0'
+    compileOnly files('libs/sqlcipher.jar')
 
     // Other dependencies
     compileOnly 'com.google.android:android:4.1.1.4'
diff --git a/DaoCore/src/main/java/de/greenrobot/dao/AbstractDao.java b/DaoCore/src/main/java/de/greenrobot/dao/AbstractDao.java
index e08741ac..f8127a87 100644
--- a/DaoCore/src/main/java/de/greenrobot/dao/AbstractDao.java
+++ b/DaoCore/src/main/java/de/greenrobot/dao/AbstractDao.java
@@ -16,17 +16,19 @@
 
 package de.greenrobot.dao;
 
+import android.database.CrossProcessCursor;
+
 import net.sqlcipher.Cursor;
 import net.sqlcipher.CursorWindow;
 import net.sqlcipher.DatabaseUtils;
 import net.sqlcipher.database.SQLiteDatabase;
 import net.sqlcipher.database.SQLiteStatement;
 
-import android.database.CrossProcessCursor;
 import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.Collection;
 import java.util.List;
+
 import de.greenrobot.dao.identityscope.IdentityScope;
 import de.greenrobot.dao.identityscope.IdentityScopeLong;
 import de.greenrobot.dao.internal.DaoConfig;
@@ -378,7 +380,7 @@ protected void updateKeyAfterInsertAndAttach(T entity, long rowId, boolean lock)
         CursorWindow window = null;
         boolean useFastCursor = false;
         if (cursor instanceof CrossProcessCursor) {
-            window = ((CrossProcessCursor) cursor).getWindow();
+            window = (CursorWindow) ((CrossProcessCursor) cursor).getWindow();
             if (window != null) { // E.g. Robolectric has no Window at this point
                 if (window.getNumRows() == count) {
                     cursor = new FastCursor(window);
@@ -439,7 +441,7 @@ private CursorWindow moveToNextUnlocked(Cursor cursor) {
         identityScope.unlock();
         try {
             if (cursor.moveToNext()) {
-                return ((CrossProcessCursor) cursor).getWindow();
+                return (CursorWindow) ((CrossProcessCursor) cursor).getWindow();
             } else {
                 return null;
             }
diff --git a/DaoCore/src/main/java/de/greenrobot/dao/internal/FastCursor.java b/DaoCore/src/main/java/de/greenrobot/dao/internal/FastCursor.java
index d43e97f6..a72e0a20 100644
--- a/DaoCore/src/main/java/de/greenrobot/dao/internal/FastCursor.java
+++ b/DaoCore/src/main/java/de/greenrobot/dao/internal/FastCursor.java
@@ -18,12 +18,13 @@
 import android.content.ContentResolver;
 import android.database.CharArrayBuffer;
 import android.database.ContentObserver;
-import android.database.Cursor;
-import android.database.CursorWindow;
 import android.database.DataSetObserver;
 import android.net.Uri;
 import android.os.Bundle;
 
+import net.sqlcipher.Cursor;
+import net.sqlcipher.CursorWindow;
+
 /** Internal class used by greenDAO. */
 final public class FastCursor implements Cursor {
 
diff --git a/DaoTest/build.gradle b/DaoTest/build.gradle
index aeefcbff..dafab9cf 100644
--- a/DaoTest/build.gradle
+++ b/DaoTest/build.gradle
@@ -19,14 +19,10 @@ android {
 
 dependencies {
     //sqlcipher dependencies
-//    androidTestCompile 'commons-codec:commons-codec:1.5'
-//    androidTestCompile group: 'com.google.guava', name: 'guava', version: '12.0'
-//    androidTestCompile files('libs/sqlcipher.jar')
-//
-//    androidTestCompile project(':DaoCore')
-//    androidTestCompile project(':PerformanceTests:Common')
-//
-//    testCompile project(':DaoCore')
+    compile 'commons-codec:commons-codec:1.5'
+    compile group: 'com.google.guava', name: 'guava', version: '12.0'
+    compile files('libs/sqlcipher.jar')
+
     compile project(':DaoTestBase')
     testCompile 'org.robolectric:robolectric:3.0'
 }
diff --git a/DaoTest/src/main/assets/icudt46l.zip b/DaoTest/src/main/assets/icudt46l.zip
new file mode 100644
index 00000000..91dc7f71
Binary files /dev/null and b/DaoTest/src/main/assets/icudt46l.zip differ
diff --git a/DaoTestBase/build.gradle b/DaoTestBase/build.gradle
index 162abe30..379615a6 100644
--- a/DaoTestBase/build.gradle
+++ b/DaoTestBase/build.gradle
@@ -4,6 +4,10 @@ sourceCompatibility = 1.7
 targetCompatibility = 1.7
 
 dependencies {
+    compileOnly 'commons-codec:commons-codec:1.5'
+    compileOnly group: 'com.google.guava', name: 'guava', version: '12.0'
+    compileOnly files('libs/sqlcipher.jar')
+
     compile project(':DaoCore')
     compileOnly 'com.google.android:android:4.1.1.4'
 }
diff --git a/DaoTestBase/libs/sqlcipher.jar b/DaoTestBase/libs/sqlcipher.jar
new file mode 100644
index 00000000..e3a94a49
Binary files /dev/null and b/DaoTestBase/libs/sqlcipher.jar differ
diff --git a/DaoTestBase/src/main/assets/icudt46l.zip b/DaoTestBase/src/main/assets/icudt46l.zip
new file mode 100644
index 00000000..91dc7f71
Binary files /dev/null and b/DaoTestBase/src/main/assets/icudt46l.zip differ
diff --git a/DaoTestBase/src/main/jniLibs/armeabi-v7a/libdatabase_sqlcipher.so b/DaoTestBase/src/main/jniLibs/armeabi-v7a/libdatabase_sqlcipher.so
new file mode 100755
index 00000000..023de886
Binary files /dev/null and b/DaoTestBase/src/main/jniLibs/armeabi-v7a/libdatabase_sqlcipher.so differ
diff --git a/DaoTestBase/src/main/jniLibs/armeabi-v7a/libsqlcipher_android.so b/DaoTestBase/src/main/jniLibs/armeabi-v7a/libsqlcipher_android.so
new file mode 100755
index 00000000..1b69f022
Binary files /dev/null and b/DaoTestBase/src/main/jniLibs/armeabi-v7a/libsqlcipher_android.so differ
diff --git a/DaoTestBase/src/main/jniLibs/armeabi-v7a/libstlport_shared.so b/DaoTestBase/src/main/jniLibs/armeabi-v7a/libstlport_shared.so
new file mode 100755
index 00000000..0ec49f44
Binary files /dev/null and b/DaoTestBase/src/main/jniLibs/armeabi-v7a/libstlport_shared.so differ
diff --git a/DaoTestBase/src/main/jniLibs/armeabi/libdatabase_sqlcipher.so b/DaoTestBase/src/main/jniLibs/armeabi/libdatabase_sqlcipher.so
new file mode 100755
index 00000000..6a40cc21
Binary files /dev/null and b/DaoTestBase/src/main/jniLibs/armeabi/libdatabase_sqlcipher.so differ
diff --git a/DaoTestBase/src/main/jniLibs/armeabi/libsqlcipher_android.so b/DaoTestBase/src/main/jniLibs/armeabi/libsqlcipher_android.so
new file mode 100755
index 00000000..d3d7a4dd
Binary files /dev/null and b/DaoTestBase/src/main/jniLibs/armeabi/libsqlcipher_android.so differ
diff --git a/DaoTestBase/src/main/jniLibs/armeabi/libstlport_shared.so b/DaoTestBase/src/main/jniLibs/armeabi/libstlport_shared.so
new file mode 100755
index 00000000..050818bb
Binary files /dev/null and b/DaoTestBase/src/main/jniLibs/armeabi/libstlport_shared.so differ
diff --git a/DaoTestBase/src/main/jniLibs/x86/libdatabase_sqlcipher.so b/DaoTestBase/src/main/jniLibs/x86/libdatabase_sqlcipher.so
new file mode 100755
index 00000000..5725c9d5
Binary files /dev/null and b/DaoTestBase/src/main/jniLibs/x86/libdatabase_sqlcipher.so differ
diff --git a/DaoTestBase/src/main/jniLibs/x86/libsqlcipher_android.so b/DaoTestBase/src/main/jniLibs/x86/libsqlcipher_android.so
new file mode 100755
index 00000000..72798ed6
Binary files /dev/null and b/DaoTestBase/src/main/jniLibs/x86/libsqlcipher_android.so differ
diff --git a/DaoTestBase/src/main/jniLibs/x86/libstlport_shared.so b/DaoTestBase/src/main/jniLibs/x86/libstlport_shared.so
new file mode 100755
index 00000000..a5e8b357
Binary files /dev/null and b/DaoTestBase/src/main/jniLibs/x86/libstlport_shared.so differ
