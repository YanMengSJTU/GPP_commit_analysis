diff --git a/DaoCore/build.gradle b/DaoCore/build.gradle
index 88832b25..ac7b1e86 100644
--- a/DaoCore/build.gradle
+++ b/DaoCore/build.gradle
@@ -7,11 +7,24 @@ version = '1.3.7-java'
 sourceCompatibility = 1.6
 
 def isSnapshot = version.endsWith('-SNAPSHOT')
-def sonatypeRepositoryUrl
+def preferedRepo
+def preferedRepoId
+def parsedProjectXml = (new XmlParser()).parse("$System.env.HOME" + "/.m2/settings.xml")
+def username
+def password
+
+def passwordSnapshots = parsedProjectXml.servers.server[1].password.text()
 if(isSnapshot) {
-	sonatypeRepositoryUrl = "https://oss.sonatype.org/content/repositories/snapshots/"
+  preferedRepo = "http://archiva.cliff.cloudburrito.com:8080/archiva/repository/snapshots/"
+  preferedRepoId = "cloud.archiva.internal"
+  username = parsedProjectXml.servers.server[0].username.text()
+  password = parsedProjectXml.servers.server[0].password.text()
+
 } else {
-	sonatypeRepositoryUrl = "https://oss.sonatype.org/service/local/staging/deploy/maven2/"
+  preferedRepo = "http://archiva.cliff.cloudburrito.com:8080/archiva/repository/internal/"
+  preferedRepoId = "cloud.archiva.snapshots"
+  username = parsedProjectXml.servers.server[1].username.text()
+  password = parsedProjectXml.servers.server[1].password.text()
 }
 
 repositories {
@@ -19,6 +32,7 @@ repositories {
 }
 
 
+
 // provided is not supported in Gradle 1.4, see http://issues.gradle.org/browse/GRADLE-784
 // Like this, it won't appear at all in the POM
 configurations {
@@ -79,21 +93,12 @@ signing {
 uploadArchives {
     repositories {
         mavenDeployer {
-            if(project.hasProperty('preferedRepo') && project.hasProperty('preferedUsername') 
-                && project.hasProperty('preferedPassword')) {
-                configuration = configurations.deployerJars
-                repository(url: preferedRepo) {
-                    authentication(userName: preferedUsername, password: preferedPassword)
-                }
-            } else if(project.hasProperty('sonatypeUsername') && project.hasProperty('sonatypePassword')) {
-                beforeDeployment { MavenDeployment deployment -> signing.signPom(deployment) }
-                repository(url: sonatypeRepositoryUrl) {
-                    authentication(userName: sonatypeUsername, password: sonatypePassword)
-                }
-            } else {
-                println "Settings sonatypeUsername/sonatypePassword missing/incomplete for ${project.name}"
+            repository(url: preferedRepo, id: preferedRepoId) {
+              authentication(userName: username, password: password)
             }
-
+            pom.groupId = 'de.greenrobot'
+            pom.artifactId = 'greendao'
+            pom.version = '1.3.7-java'
             pom.project {
                name 'greenDAO'
                packaging 'jar'
diff --git a/DaoGenerator/build.gradle b/DaoGenerator/build.gradle
index 874f89ce..80b7342a 100644
--- a/DaoGenerator/build.gradle
+++ b/DaoGenerator/build.gradle
@@ -7,11 +7,24 @@ version = '1.3.1-SNAPSHOT'
 sourceCompatibility = 1.6
 
 def isSnapshot = version.endsWith('-SNAPSHOT')
-def sonatypeRepositoryUrl
+def preferedRepo
+def preferedRepoId
+def parsedProjectXml = (new XmlParser()).parse("$System.env.HOME" + "/.m2/settings.xml")
+def username
+def password
+
+def passwordSnapshots = parsedProjectXml.servers.server[1].password.text()
 if(isSnapshot) {
-    sonatypeRepositoryUrl = "https://oss.sonatype.org/content/repositories/snapshots/"
+  preferedRepo = "http://archiva.cliff.cloudburrito.com:8080/archiva/repository/snapshots/"
+  preferedRepoId = "cloud.archiva.internal"
+  username = parsedProjectXml.servers.server[0].username.text()
+  password = parsedProjectXml.servers.server[0].password.text()
+
 } else {
-    sonatypeRepositoryUrl = "https://oss.sonatype.org/service/local/staging/deploy/maven2/"
+  preferedRepo = "http://archiva.cliff.cloudburrito.com:8080/archiva/repository/internal/"
+  preferedRepoId = "cloud.archiva.snapshots"
+  username = parsedProjectXml.servers.server[1].username.text()
+  password = parsedProjectXml.servers.server[1].password.text()
 }
 
 repositories {
@@ -92,19 +105,8 @@ signing {
 uploadArchives {
     repositories {
         mavenDeployer {
-            if(project.hasProperty('preferedRepo') && project.hasProperty('preferedUsername') 
-                && project.hasProperty('preferedPassword')) {
-                configuration = configurations.deployerJars
-                repository(url: preferedRepo) {
-                    authentication(userName: preferedUsername, password: preferedPassword)
-                }
-            } else if(project.hasProperty('sonatypeUsername') && project.hasProperty('sonatypePassword')) {
-                beforeDeployment { MavenDeployment deployment -> signing.signPom(deployment) }
-                repository(url: sonatypeRepositoryUrl) {
-                    authentication(userName: sonatypeUsername, password: sonatypePassword)
-                }
-            } else {
-                println "Settings sonatypeUsername/sonatypePassword missing/incomplete for ${project.name}"
+            repository(url: preferedRepo, id: preferedRepoId) {
+              authentication(userName: username, password: password)
             }
 
             pom.project {
