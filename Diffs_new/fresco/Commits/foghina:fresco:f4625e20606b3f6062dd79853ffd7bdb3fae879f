diff --git a/animated-drawable/build.gradle b/animated-drawable/build.gradle
index 89f7ca32e..f543c5243 100644
--- a/animated-drawable/build.gradle
+++ b/animated-drawable/build.gradle
@@ -16,29 +16,29 @@ android {
 }
 
 dependencies {
-    provided "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
-    provided "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
-    provided "javax.annotation:javax.annotation-api:${ANNOTATION_API_VERSION}"
-
-    testCompile "junit:junit:${JUNIT_VERSION}"
-    testCompile "org.easytesting:fest-assert-core:${FEST_ASSERT_CORE_VERSION}"
-    testCompile "org.mockito:mockito-core:${MOCKITO_CORE_VERSION}"
-    testCompile("org.powermock:powermock-api-mockito:${POWERMOCK_VERSION}") {
+    compileOnly "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
+    compileOnly "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    compileOnly "javax.annotation:javax.annotation-api:${ANNOTATION_API_VERSION}"
+
+    testImplementation "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    testImplementation "junit:junit:${JUNIT_VERSION}"
+    testImplementation "org.easytesting:fest-assert-core:${FEST_ASSERT_CORE_VERSION}"
+    testImplementation "org.mockito:mockito-core:${MOCKITO_CORE_VERSION}"
+    testImplementation("org.powermock:powermock-api-mockito:${POWERMOCK_VERSION}") {
         exclude group: 'org.mockito', module: 'mockito-all'
     }
-    testCompile "org.powermock:powermock-module-junit4:${POWERMOCK_VERSION}"
-    testCompile "org.powermock:powermock-module-junit4-rule:${POWERMOCK_VERSION}"
-    testCompile "org.powermock:powermock-classloading-xstream:${POWERMOCK_VERSION}"
-    testCompile("org.robolectric:robolectric:${ROBOLECTRIC_VERSION}") {
+    testImplementation "org.powermock:powermock-module-junit4:${POWERMOCK_VERSION}"
+    testImplementation "org.powermock:powermock-module-junit4-rule:${POWERMOCK_VERSION}"
+    testImplementation "org.powermock:powermock-classloading-xstream:${POWERMOCK_VERSION}"
+    testImplementation("org.robolectric:robolectric:${ROBOLECTRIC_VERSION}") {
         exclude group: 'commons-logging', module: 'commons-logging'
         exclude group: 'org.apache.httpcomponents', module: 'httpclient'
     }
-    testCompile project(':imagepipeline-test')
+    testImplementation project(':imagepipeline-test')
     
-    compile project(':imagepipeline-base')
-    compile project(':imagepipeline')
-    compile project(':drawee')
-    compile project(':fbcore')
+    implementation project(':imagepipeline')
+    implementation project(':drawee')
+    implementation project(':fbcore')
 }
 
 apply from: rootProject.file('release.gradle')
diff --git a/build.gradle b/build.gradle
index 2578ea84f..444ad225d 100644
--- a/build.gradle
+++ b/build.gradle
@@ -5,6 +5,7 @@ import org.apache.tools.ant.taskdefs.condition.Os
 
 buildscript {
     repositories {
+        google()
         jcenter()
     }
     dependencies {
@@ -24,18 +25,17 @@ plugins {
 project.ext {
     buildToolsVersion = "${BUILD_TOOLS_VERSION}"
     compileSdkVersion = COMPILE_SDK_VERSION.toInteger()
-    minSdkVersion = MIN_SDK_VERSION;
-    targetSdkVersion = TARGET_SDK_VERSION;
-    preDexLibs = !project.hasProperty('disablePreDex');
+    minSdkVersion = MIN_SDK_VERSION
+    samplesMinSdkVersion = SAMPLES_MIN_SDK_VERSION
+    targetSdkVersion = TARGET_SDK_VERSION
+    preDexLibs = !project.hasProperty('disablePreDex')
 }
 
 subprojects {
 
     repositories {
+        google()
         jcenter()
-        maven {
-            url "https://maven.google.com"
-        }
     }
 
     task allclean {
@@ -225,6 +225,3 @@ subprojects {
             "libwebp-${LIBWEBP_VERSION}" // Final destination dir
     )
 }
-
-repositories {
-}
diff --git a/circle.yml b/circle.yml
index 7840c5d2a..8a5367795 100644
--- a/circle.yml
+++ b/circle.yml
@@ -9,7 +9,7 @@ dependencies:
   pre:
     # if necessary SDK / build tools / support library folders do not exist, update the circle ci instance accordingly
     - if [ ! -d "/usr/local/android-sdk-linux/platforms/android-26" ]; then echo y | android update sdk --no-ui --all --filter "android-26"; fi
-    - if [ ! -d "/usr/local/android-sdk-linux/build-tools/26.0.0" ]; then echo y | android update sdk --no-ui --all --filter "build-tools-26.0.0"; fi
+    - if [ ! -d "/usr/local/android-sdk-linux/build-tools/26.0.0" ]; then echo y | android update sdk --no-ui --all --filter "build-tools-27.0.2"; fi
     - if [ ! -d "/usr/local/android_sdk/extras/android/m2repository/com/android/support/support-core-utils/25.1.0" ]; then echo y | android update sdk --no-ui --all --filter "extra-android-m2repository"; fi
     # setup NDK r15b
     - if [ ! -d "/home/ubuntu/android-ndk-r15b" ]; then wget https://dl.google.com/android/repository/android-ndk-r15b-linux-x86_64.zip; unzip android-ndk-r15b-linux-x86_64.zip -d "/home/ubuntu"; fi
diff --git a/drawee-backends/drawee-pipeline/build.gradle b/drawee-backends/drawee-pipeline/build.gradle
index 5c520a2a0..b1fabcbc4 100644
--- a/drawee-backends/drawee-pipeline/build.gradle
+++ b/drawee-backends/drawee-pipeline/build.gradle
@@ -4,11 +4,11 @@ project.group = GROUP
 version = VERSION_NAME
 
 dependencies {
-    provided "com.android.support:support-core-utils:${SUPPORT_LIB_VERSION}"
-    provided "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
-    compile project(':drawee')
-    compile project(':fbcore')
-    compile project(':imagepipeline')
+    compileOnly "com.android.support:support-core-utils:${SUPPORT_LIB_VERSION}"
+    compileOnly "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    api project(':fbcore')
+    api project(':drawee')
+    api project(':imagepipeline')
 }
 apply from: rootProject.file('release.gradle')
 
diff --git a/drawee/build.gradle b/drawee/build.gradle
index 0ff8f3c75..cf8663b60 100644
--- a/drawee/build.gradle
+++ b/drawee/build.gradle
@@ -5,16 +5,17 @@ project.group = GROUP
 version = VERSION_NAME
 
 dependencies {
-    provided "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
-    provided "com.facebook.infer.annotation:infer-annotation:${INFER_ANNOTATION_VERSION}"
-    provided "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
-    provided "javax.annotation:javax.annotation-api:${ANNOTATION_API_VERSION}"
+    compileOnly "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
+    compileOnly "com.facebook.infer.annotation:infer-annotation:${INFER_ANNOTATION_VERSION}"
+    compileOnly "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    compileOnly "javax.annotation:javax.annotation-api:${ANNOTATION_API_VERSION}"
 
-    compile project(':fbcore')
+    implementation project(':fbcore')
 
-    testCompile "junit:junit:${JUNIT_VERSION}"
-    testCompile "org.mockito:mockito-core:${MOCKITO_CORE_VERSION}"
-    testCompile("org.robolectric:robolectric:${ROBOLECTRIC_VERSION}") {
+    testImplementation "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    testImplementation "junit:junit:${JUNIT_VERSION}"
+    testImplementation "org.mockito:mockito-core:${MOCKITO_CORE_VERSION}"
+    testImplementation("org.robolectric:robolectric:${ROBOLECTRIC_VERSION}") {
         exclude group: 'commons-logging', module: 'commons-logging'
         exclude group: 'org.apache.httpcomponents', module: 'httpclient'
     }
diff --git a/fbcore/build.gradle b/fbcore/build.gradle
index 58dea2455..cdd747a26 100644
--- a/fbcore/build.gradle
+++ b/fbcore/build.gradle
@@ -5,18 +5,19 @@ project.group = GROUP
 version = VERSION_NAME
 
 dependencies {
-    provided "com.facebook.infer.annotation:infer-annotation:${INFER_ANNOTATION_VERSION}"
-    provided "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
-    provided "javax.annotation:javax.annotation-api:${ANNOTATION_API_VERSION}"
-    provided "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
-
-    testCompile "junit:junit:${JUNIT_VERSION}"
-    testCompile "org.easytesting:fest-assert-core:${FEST_ASSERT_CORE_VERSION}"
-    testCompile "org.mockito:mockito-core:${MOCKITO_CORE_VERSION}"
-    testCompile "org.powermock:powermock-api-mockito:${POWERMOCK_VERSION}"
-    testCompile "org.powermock:powermock-module-junit4-rule:${POWERMOCK_VERSION}"
-    testCompile "org.powermock:powermock-classloading-xstream:${POWERMOCK_VERSION}"
-    testCompile("org.robolectric:robolectric:${ROBOLECTRIC_VERSION}") {
+    compileOnly "com.facebook.infer.annotation:infer-annotation:${INFER_ANNOTATION_VERSION}"
+    compileOnly "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    compileOnly "javax.annotation:javax.annotation-api:${ANNOTATION_API_VERSION}"
+    compileOnly "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
+
+    testImplementation "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    testImplementation "junit:junit:${JUNIT_VERSION}"
+    testImplementation "org.easytesting:fest-assert-core:${FEST_ASSERT_CORE_VERSION}"
+    testImplementation "org.mockito:mockito-core:${MOCKITO_CORE_VERSION}"
+    testImplementation "org.powermock:powermock-api-mockito:${POWERMOCK_VERSION}"
+    testImplementation "org.powermock:powermock-module-junit4-rule:${POWERMOCK_VERSION}"
+    testImplementation "org.powermock:powermock-classloading-xstream:${POWERMOCK_VERSION}"
+    testImplementation("org.robolectric:robolectric:${ROBOLECTRIC_VERSION}") {
         exclude group: 'com.android.support', module: 'support-v4'
         exclude group: 'commons-logging', module: 'commons-logging'
         exclude group: 'org.apache.httpcomponents', module: 'httpclient'
diff --git a/gradle.properties b/gradle.properties
index 4ca7c50e1..8ec1e0d75 100644
--- a/gradle.properties
+++ b/gradle.properties
@@ -23,9 +23,9 @@ VERSION_NAME=1.6.0
 GROUP=com.facebook.fresco
 
 # Deps for gradle
-BUILD_TOOLS_VERSION=26.0.0
+BUILD_TOOLS_VERSION=27.0.2
 COMPILE_SDK_VERSION=26
-ANDROID_GRADLE_PLUGIN_VERSION=2.3.3
+ANDROID_GRADLE_PLUGIN_VERSION=3.0.1
 
 # Deps for libraries
 ANNOTATION_API_VERSION=1.2
@@ -40,7 +40,7 @@ MOCKITO_CORE_VERSION=1.10.19
 NINEOLDANDROID_VERSION=2.4.0
 POWERMOCK_VERSION=1.6.6
 ROBOLECTRIC_VERSION=3.0
-SUPPORT_LIB_VERSION=25.4.0
+SUPPORT_LIB_VERSION=27.0.2
 VOLLEY_VERSION=1.0.0
 
 # Deps for native libraries
@@ -52,6 +52,7 @@ LIBWEBP_VERSION=0.6.0
 
 # SDK versions for the samples
 MIN_SDK_VERSION=9
+SAMPLES_MIN_SDK_VERSION=14
 TARGET_SDK_VERSION=26
 
 # Deps for comparison app
diff --git a/gradle/bintray.gradle b/gradle/bintray.gradle
index 12180e79b..612c23976 100644
--- a/gradle/bintray.gradle
+++ b/gradle/bintray.gradle
@@ -2,31 +2,31 @@
 apply plugin: 'com.jfrog.bintray'
 
 def getBintrayUsername() {
-    return hasProperty('bintrayUsername') ? property('bintrayUsername') : System.getenv('BINTRAY_USERNAME')
+    return properties.get('bintrayUsername', System.getenv('BINTRAY_USERNAME'))
 }
 
 def getBintrayApiKey() {
-    return hasProperty('bintrayApiKey') ? property('bintrayApiKey') : System.getenv('BINTRAY_API_KEY')
+    return properties.get('bintrayApiKey',  System.getenv('BINTRAY_API_KEY'))
 }
 
 def getBintrayGpgPassword() {
-    return hasProperty('bintrayGpgPassword') ? property('bintrayGpgPassword') : System.getenv('BINTRAY_GPG_PASSWORD')
+    return properties.get('bintrayGpgPassword', System.getenv('BINTRAY_GPG_PASSWORD'))
 }
 
 def getMavenCentralUsername() {
-    return hasProperty('mavenCentralUsername') ? property('mavenCentralUsername') : System.getenv('MAVEN_CENTRAL_USERNAME')
+    return properties.get('mavenCentralUsername', System.getenv('MAVEN_CENTRAL_USERNAME'))
 }
 
 def getMavenCentralPassword() {
-    return hasProperty('mavenCentralPassword') ? property('mavenCentralPassword') : System.getenv('MAVEN_CENTRAL_PASSWORD')
+    return properties.get('mavenCentralPassword', System.getenv('MAVEN_CENTRAL_PASSWORD'))
 }
 
 def shouldSyncWithMavenCentral() {
-    return hasProperty('syncWithMavenCentral') ? property('syncWithMavenCentral').toBoolean() : false
+    return properties.get('syncWithMavenCentral', false)
 }
 
 def dryRunOnly() {
-    return hasProperty('dryRun') ? property('dryRun').toBoolean() : false
+    return properties.get('dryRun', false)
 }
 
 bintray {
diff --git a/gradle/wrapper/gradle-wrapper.properties b/gradle/wrapper/gradle-wrapper.properties
index b1b378be7..ce464884f 100644
--- a/gradle/wrapper/gradle-wrapper.properties
+++ b/gradle/wrapper/gradle-wrapper.properties
@@ -1,6 +1,6 @@
-#Fri Mar 03 11:40:45 GMT 2017
+#Mon Dec 11 11:29:47 GMT 2017
 distributionBase=GRADLE_USER_HOME
 distributionPath=wrapper/dists
 zipStoreBase=GRADLE_USER_HOME
 zipStorePath=wrapper/dists
-distributionUrl=https\://services.gradle.org/distributions/gradle-3.3-all.zip
+distributionUrl=https\://services.gradle.org/distributions/gradle-4.1-all.zip
diff --git a/imagepipeline-base-test/build.gradle b/imagepipeline-base-test/build.gradle
index 7a8941866..8cf26dfb8 100644
--- a/imagepipeline-base-test/build.gradle
+++ b/imagepipeline-base-test/build.gradle
@@ -18,6 +18,11 @@ android {
     buildToolsVersion rootProject.ext.buildToolsVersion
     compileSdkVersion rootProject.ext.compileSdkVersion
 
+
+    defaultConfig {
+        minSdkVersion rootProject.ext.samplesMinSdkVersion
+    }
+
 }
 
 task sourcesJar(type: Jar) {
diff --git a/imagepipeline-test/build.gradle b/imagepipeline-test/build.gradle
index dab70505a..8dff40f8e 100644
--- a/imagepipeline-test/build.gradle
+++ b/imagepipeline-test/build.gradle
@@ -31,6 +31,10 @@ android {
     buildToolsVersion rootProject.ext.buildToolsVersion
     compileSdkVersion rootProject.ext.compileSdkVersion
 
+    defaultConfig {
+        minSdkVersion rootProject.ext.samplesMinSdkVersion
+    }
+
     lintOptions {
         abortOnError false
     }
diff --git a/imagepipeline/build.gradle b/imagepipeline/build.gradle
index d793d1119..1301a85c7 100644
--- a/imagepipeline/build.gradle
+++ b/imagepipeline/build.gradle
@@ -5,27 +5,28 @@ project.group = GROUP
 version = VERSION_NAME
 
 dependencies {
-    provided "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
-    provided "com.android.support:support-core-utils:${SUPPORT_LIB_VERSION}"
-    provided "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
-    provided "com.facebook.infer.annotation:infer-annotation:${INFER_ANNOTATION_VERSION}"
-    compile "com.parse.bolts:bolts-tasks:${BOLTS_ANDROID_VERSION}"
-    provided "javax.annotation:javax.annotation-api:${ANNOTATION_API_VERSION}"
-    compile project(':fbcore')
-    compile project(':imagepipeline-base')
+    compileOnly "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
+    compileOnly "com.android.support:support-core-utils:${SUPPORT_LIB_VERSION}"
+    compileOnly "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    compileOnly "com.facebook.infer.annotation:infer-annotation:${INFER_ANNOTATION_VERSION}"
+    implementation "com.parse.bolts:bolts-tasks:${BOLTS_ANDROID_VERSION}"
+    compileOnly "javax.annotation:javax.annotation-api:${ANNOTATION_API_VERSION}"
+    implementation project(':fbcore')
+    api project(':imagepipeline-base')
 
-    testCompile project(':imagepipeline-test')
-    testCompile project(':imagepipeline-base-test')
-    testCompile "junit:junit:${JUNIT_VERSION}"
-    testCompile "org.easytesting:fest-assert-core:${FEST_ASSERT_CORE_VERSION}"
-    testCompile "org.mockito:mockito-core:${MOCKITO_CORE_VERSION}"
-    testCompile("org.powermock:powermock-api-mockito:${POWERMOCK_VERSION}") {
+    testImplementation "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    testImplementation project(':imagepipeline-test')
+    testImplementation project(':imagepipeline-base-test')
+    testImplementation "junit:junit:${JUNIT_VERSION}"
+    testImplementation "org.easytesting:fest-assert-core:${FEST_ASSERT_CORE_VERSION}"
+    testImplementation "org.mockito:mockito-core:${MOCKITO_CORE_VERSION}"
+    testImplementation("org.powermock:powermock-api-mockito:${POWERMOCK_VERSION}") {
         exclude group: 'org.mockito', module: 'mockito-all'
     }
-    testCompile "org.powermock:powermock-module-junit4:${POWERMOCK_VERSION}"
-    testCompile "org.powermock:powermock-module-junit4-rule:${POWERMOCK_VERSION}"
-    testCompile "org.powermock:powermock-classloading-xstream:${POWERMOCK_VERSION}"
-    testCompile("org.robolectric:robolectric:${ROBOLECTRIC_VERSION}") {
+    testImplementation "org.powermock:powermock-module-junit4:${POWERMOCK_VERSION}"
+    testImplementation "org.powermock:powermock-module-junit4-rule:${POWERMOCK_VERSION}"
+    testImplementation "org.powermock:powermock-classloading-xstream:${POWERMOCK_VERSION}"
+    testImplementation("org.robolectric:robolectric:${ROBOLECTRIC_VERSION}") {
         exclude group: 'commons-logging', module: 'commons-logging'
         exclude group: 'org.apache.httpcomponents', module: 'httpclient'
     }
diff --git a/release-sonatype.gradle b/release-sonatype.gradle
index 6296730dc..fd114458e 100644
--- a/release-sonatype.gradle
+++ b/release-sonatype.gradle
@@ -16,15 +16,15 @@ def isReleaseBuild() {
 }
 
 def getRepositoryUrl() {
-    return hasProperty('repositoryUrl') ? property('repositoryUrl') : "https://oss.sonatype.org/service/local/staging/deploy/maven2/"
+    return properties.get('repositoryUrl', "https://oss.sonatype.org/service/local/staging/deploy/maven2/")
 }
 
 def getRepositoryUsername() {
-    return hasProperty('repositoryUsername') ? property('repositoryUsername') : ""
+    return properties.get('repositoryUsername',  "")
 }
 
 def getRepositoryPassword() {
-    return hasProperty('repositoryPassword') ? property('repositoryPassword') : ""
+    return properties.get('repositoryPassword',  "")
 }
 
 def getPassword(String passwordName) {
diff --git a/samples/animation2/build.gradle b/samples/animation2/build.gradle
index 8545209a0..c404d10c1 100644
--- a/samples/animation2/build.gradle
+++ b/samples/animation2/build.gradle
@@ -18,7 +18,7 @@ android {
 
     defaultConfig {
         applicationId "com.facebook.samples.animation2"
-        minSdkVersion rootProject.ext.minSdkVersion
+        minSdkVersion rootProject.ext.samplesMinSdkVersion
         targetSdkVersion rootProject.ext.targetSdkVersion
         versionCode 1
         versionName "${VERSION_NAME}"
diff --git a/samples/comparison/build.gradle b/samples/comparison/build.gradle
index da9ff381f..39494d395 100644
--- a/samples/comparison/build.gradle
+++ b/samples/comparison/build.gradle
@@ -1,25 +1,25 @@
 apply plugin: 'com.android.application'
 
 dependencies {
-    provided "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
-    compile "com.github.bumptech.glide:glide:${GLIDE_VERSION}"
-    compile "com.android.volley:volley:${VOLLEY_VERSION}"
-    compile "com.nostra13.universalimageloader:universal-image-loader:${UIL_VERSION}"
-    compile "com.squareup.picasso:picasso:${PICASSO_VERSION}"
-    compile "com.jakewharton.picasso:picasso2-okhttp3-downloader:1.0.2"
-    compile "com.android.support:appcompat-v7:${SUPPORT_LIB_VERSION}"
-    compile "com.android.support:recyclerview-v7:${SUPPORT_LIB_VERSION}"
-    compile "com.googlecode.android-query:android-query:${AQUERY_VERSION}"
-    compile "com.facebook.stetho:stetho-okhttp3:${STETHO_VERSION}"
-
-    compile project(':drawee')
-    compile project(':drawee-backends:drawee-pipeline')
-    compile project(':drawee-backends:drawee-volley')
-    compile project(':fbcore')
-    compile project(':imagepipeline')
-    compile project(':imagepipeline-backends:imagepipeline-okhttp3')
-    compile project(':animated-gif')
-    compile project(':tools:stetho')
+    compileOnly "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    implementation "com.github.bumptech.glide:glide:${GLIDE_VERSION}"
+    implementation "com.android.volley:volley:${VOLLEY_VERSION}"
+    implementation "com.nostra13.universalimageloader:universal-image-loader:${UIL_VERSION}"
+    implementation "com.squareup.picasso:picasso:${PICASSO_VERSION}"
+    implementation "com.jakewharton.picasso:picasso2-okhttp3-downloader:1.0.2"
+    implementation "com.android.support:appcompat-v7:${SUPPORT_LIB_VERSION}"
+    implementation "com.android.support:recyclerview-v7:${SUPPORT_LIB_VERSION}"
+    implementation "com.googlecode.android-query:android-query:${AQUERY_VERSION}"
+    implementation "com.facebook.stetho:stetho-okhttp3:${STETHO_VERSION}"
+
+    implementation project(':drawee')
+    implementation project(':drawee-backends:drawee-pipeline')
+    implementation project(':drawee-backends:drawee-volley')
+    implementation project(':fbcore')
+    implementation project(':imagepipeline')
+    implementation project(':imagepipeline-backends:imagepipeline-okhttp3')
+    implementation project(':animated-gif')
+    implementation project(':tools:stetho')
 }
 
 android {
@@ -30,7 +30,7 @@ android {
 
     defaultConfig {
         applicationId "com.facebook.samples.comparison"
-        minSdkVersion rootProject.ext.minSdkVersion
+        minSdkVersion rootProject.ext.samplesMinSdkVersion
         targetSdkVersion rootProject.ext.targetSdkVersion
         versionCode 1
         versionName "${VERSION_NAME}"
diff --git a/samples/comparison/src/main/java/com/facebook/samples/comparison/MainActivity.java b/samples/comparison/src/main/java/com/facebook/samples/comparison/MainActivity.java
index b75b49931..eab4e1334 100644
--- a/samples/comparison/src/main/java/com/facebook/samples/comparison/MainActivity.java
+++ b/samples/comparison/src/main/java/com/facebook/samples/comparison/MainActivity.java
@@ -27,7 +27,7 @@
 import android.provider.MediaStore;
 import android.support.v4.app.ActivityCompat;
 import android.support.v4.content.ContextCompat;
-import android.support.v7.app.ActionBarActivity;
+import android.support.v7.app.AppCompatActivity;
 import android.support.v7.widget.GridLayoutManager;
 import android.support.v7.widget.RecyclerView;
 import android.view.Display;
@@ -58,7 +58,7 @@
 import java.util.List;
 import java.util.Locale;
 
-public class MainActivity extends ActionBarActivity {
+public class MainActivity extends AppCompatActivity {
 
   private static final String TAG = "FrescoSample";
 
diff --git a/samples/kotlin/build.gradle b/samples/kotlin/build.gradle
index 4b6d81c72..828b23b61 100644
--- a/samples/kotlin/build.gradle
+++ b/samples/kotlin/build.gradle
@@ -21,7 +21,7 @@ android {
 
     defaultConfig {
         applicationId "com.facebook.fresco.samples.kotlin"
-        minSdkVersion rootProject.ext.minSdkVersion
+        minSdkVersion rootProject.ext.samplesMinSdkVersion
         targetSdkVersion rootProject.ext.targetSdkVersion
         versionCode 1
         versionName "${VERSION_NAME}"
diff --git a/samples/scrollperf/build.gradle b/samples/scrollperf/build.gradle
index 5b87e0716..1be5f99f4 100644
--- a/samples/scrollperf/build.gradle
+++ b/samples/scrollperf/build.gradle
@@ -6,7 +6,7 @@ android {
 
     defaultConfig {
         applicationId "com.facebook.samples.scrollperf"
-        minSdkVersion rootProject.ext.minSdkVersion
+        minSdkVersion rootProject.ext.samplesMinSdkVersion
         targetSdkVersion rootProject.ext.targetSdkVersion
         versionCode 1
         versionName "1.0"
diff --git a/samples/showcase/build.gradle b/samples/showcase/build.gradle
index c0ae81525..712a3d0c0 100644
--- a/samples/showcase/build.gradle
+++ b/samples/showcase/build.gradle
@@ -11,7 +11,7 @@ android {
 
     defaultConfig {
         applicationId "com.facebook.fresco.samples.showcase"
-        minSdkVersion rootProject.ext.minSdkVersion
+        minSdkVersion rootProject.ext.samplesMinSdkVersion
         targetSdkVersion rootProject.ext.targetSdkVersion
         versionCode 1
         versionName "${VERSION_NAME}"
@@ -27,8 +27,11 @@ android {
             proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), '../../proguard-fresco.pro', 'proguard-showcase.pro'
         }
     }
+    flavorDimensions "main"
     productFlavors {
+        main
         instantRunConfig {
+            dimension "main"
             minSdkVersion 21
         }
     }
@@ -49,29 +52,29 @@ android {
 }
 
 dependencies {
-    provided "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
-    provided "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
-    compile "com.android.support:appcompat-v7:${SUPPORT_LIB_VERSION}"
-    compile "com.android.support:design:${SUPPORT_LIB_VERSION}"
-    compile "com.android.support:preference-v7:${SUPPORT_LIB_VERSION}"
-    compile "com.android.support:recyclerview-v7:${SUPPORT_LIB_VERSION}"
-    compile "com.android.support:cardview-v7:${SUPPORT_LIB_VERSION}"
-    compile "com.facebook.stetho:stetho-okhttp3:${STETHO_VERSION}"
+    compileOnly "com.google.code.findbugs:jsr305:${JSR_305_VERSION}"
+    compileOnly "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
+    implementation "com.android.support:appcompat-v7:${SUPPORT_LIB_VERSION}"
+    implementation "com.android.support:design:${SUPPORT_LIB_VERSION}"
+    implementation "com.android.support:preference-v7:${SUPPORT_LIB_VERSION}"
+    implementation "com.android.support:recyclerview-v7:${SUPPORT_LIB_VERSION}"
+    implementation "com.android.support:cardview-v7:${SUPPORT_LIB_VERSION}"
+    implementation "com.android.support:support-v4:${SUPPORT_LIB_VERSION}"
+    implementation "com.facebook.stetho:stetho-okhttp3:${STETHO_VERSION}"
 
-    compile project(':animated-base')
-    compile project(':animated-gif')
-    compile project(':animated-webp')
-    compile project(':static-webp')
+    implementation project(':animated-base')
+    implementation project(':animated-gif')
+    implementation project(':animated-webp')
+    implementation project(':static-webp')
 
-    compile project(':drawee-backends:drawee-pipeline')
-    compile project(':drawee-span')
-    compile project(':imagepipeline-backends:imagepipeline-okhttp3')
-    compile project(':tools:stetho')
-    compile project(path: ':imagepipeline-backends:imagepipeline-okhttp3')
+    implementation project(':drawee-backends:drawee-pipeline')
+    implementation project(':drawee-span')
+    implementation project(':imagepipeline-backends:imagepipeline-okhttp3')
+    implementation project(':tools:stetho')
+    implementation project(path: ':imagepipeline-backends:imagepipeline-okhttp3')
 
-    compile 'com.android.support:support-v4:25.3.1'
-    compile 'com.facebook.keyframes:keyframes:1.0'
+    implementation 'com.facebook.keyframes:keyframes:1.0'
 
     // Only used for the custom SVG decoder
-    compile 'com.caverock:androidsvg:1.2.1'
+    implementation 'com.caverock:androidsvg:1.2.1'
 }
diff --git a/samples/zoomableapp/build.gradle b/samples/zoomableapp/build.gradle
index da6c60437..b0935ef2e 100644
--- a/samples/zoomableapp/build.gradle
+++ b/samples/zoomableapp/build.gradle
@@ -6,7 +6,7 @@ android {
 
     defaultConfig {
         applicationId "com.facebook.samples.zoomableapp"
-        minSdkVersion rootProject.ext.minSdkVersion
+        minSdkVersion rootProject.ext.samplesMinSdkVersion
         targetSdkVersion rootProject.ext.targetSdkVersion
         versionCode 1
         versionName "${VERSION_NAME}"
@@ -15,6 +15,8 @@ android {
         testInstrumentationRunner "android.test.InstrumentationTestRunner"
     }
 
+    flavorDimensions "main"
+
     productFlavors {
         internal
     }
@@ -46,9 +48,9 @@ configurations {
 }
 
 dependencies {
-    provided "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
-    compile "com.android.support:support-core-ui:${SUPPORT_LIB_VERSION}"
+    compileOnly "com.android.support:support-annotations:${SUPPORT_LIB_VERSION}"
+    implementation "com.android.support:support-core-ui:${SUPPORT_LIB_VERSION}"
 
     internalCompile project(':drawee-backends:drawee-pipeline')
-    compile project(path: ':samples:zoomable')
+    implementation project(path: ':samples:zoomable')
 }
