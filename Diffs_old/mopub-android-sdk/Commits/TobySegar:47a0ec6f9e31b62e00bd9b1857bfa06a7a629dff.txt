diff --git a/.gitmodules b/.gitmodules
index a1adcc65..5dfd1054 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -1,3 +1,3 @@
-[submodule "mopub-android-mediation"]
-	path = mopub-android-mediation
-	url = ../mopub-android-mediation.git
+[submodule "mopub-sdk-common"]
+	path = mopub-sdk-common
+	url = git@github.com:mopub/mopub-sdk-common.git
diff --git a/CHANGELOG.md b/CHANGELOG.md
index e818626b..96807e14 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,6 +1,32 @@
+## Version 5.7.0 (May 20, 2019)
+- **Features**
+  - Impression Level Revenue Data - a data object that includes revenue information associated with each impression.
+  - Verizon Ads SDK now supported as a mediated network.
+  - Upgraded Gradle dependency to 5.4.1
+  - Upgraded Robolectric dependency to 4.2.1.
+  - Upgraded com.android.tools.build:gradle to 3.4.0.
+  - Sample app improvements.
+
+- **Bug Fixes**
+  - Handle empty impression trackers in VAST.
+  - Improved impression handling when MoPubView is reattached to the screen.
+
+## Version 5.6.0 (March 18, 2019)
+- **Features**
+  - Enabled debug logging when using a debug Google Advertising ID (one that ends with "10ca1ad1abe1").
+  - Upgraded ExoPlayer dependency to 2.9.5.
+  - Upgraded MoPub-Volley dependency to 2.1.0.
+
+- **Bug Fixes**
+  - Banners no longer refresh when they are expanded. They will resume refreshing when the expanded view is closed.
+  - Setting orientation on an expanded banner no longer locks the orientation after the expanded view is closed.
+  - Improved click detection.
+  - Catch `MissingWebViewPackageException` in `ConsentDialogLayoutWebView`.
+  - Reduce ANRs by removing synchronization from `Networking#getUserAgent(Context)`.
+
 ## Version 5.5.0 (January 28, 2019)
 - **Features**
-  - Advanced Bidding automatically initializes. See [https://developers.mopub.com/docs/android/initialization/] for more information about initialization.
+  - Advanced Bidding automatically initializes. See https://developers.mopub.com/docs/android/initialization/ for more information about initialization.
   - GDPR legitimate interest API now available; publishers may opt into allowing supported networks to collect user information on the basis of legitimate interest.
   - Improved logging from the SDK. Set the log level with `SdkConfiguration.Builder#withLogLevel(LogLevel)` in initialization to change the logging granularity.
   - Upgraded Gradle dependency to 4.8
@@ -272,11 +298,11 @@ If you would like to opt out of viewability measurement but do not want to modif
 
 ## Version 4.0.0 (October 6, 2015)
 
-Version 4.0.0 includes a number of improvements to our Native Ads systems under the hood. This means a few changes for publishers integrating the ads. The [Native Ads Integration Guide](https://github.com/mopub/mopub-android-sdk/wiki/Native-Ads-Integration) describes all the steps you'll need to integrate 4.0.0.
+Version 4.0.0 includes a number of improvements to our Native Ads systems under the hood. This means a few changes for publishers integrating the ads. The [Native Ads Integration Guide](https://developers.mopub.com/docs/android/native/) describes all the steps you'll need to integrate 4.0.0.
 
 **Native Ads Changes**
  - `MoPubNativeAdRenderer` has been replaced by `MoPubStaticNativeRenderer` 
- - When requesting ads using `MoPubNative`, you must instantiate and register a `MoPubStaticNativeAdRenderer`. See the [Integration Document](https://github.com/mopub/mopub-android-sdk/wiki/Manual-Integration-of-Native-Ads) for more details.
+ - When requesting ads using `MoPubNative`, you must instantiate and register a `MoPubStaticNativeAdRenderer`. See the [Integration Document](https://developers.mopub.com/docs/android/native/#method-3-manual-integration) for more details.
  - `NativeResponse` has been replaced with `NativeAd`
  - `NativeAd` has a new API that supports creating and rendering `View`s for Native Ads.
    - `#createAdView` returns a `View` that can hold data for the `NativeAd`
@@ -317,7 +343,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 
 - Added **VAST 3.0** standard support for video ads.
 - Improved **video player UX**.
-- Added **RecyclerView** support for native ads. See the [integration guide](https://github.com/mopub/mopub-android-sdk/wiki/Native-Ads-with-Recycler-View).
+- Added **RecyclerView** support for native ads. See the [integration guide](https://developers.mopub.com/docs/android/native/).
 - Improved **deep link** handling.
 - Bug Fixes:
   - MRAID video interstitials now play automatically when displayed on Jellybean MR1 and newer.
@@ -359,7 +385,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 
 ## Version 3.5.0 (March 10, 2015)
 
- - Dependency changes in Maven and Gradle. No new dependencies have been added, but your build script will need to change slightly to include JCenter. See our [Getting Started Guide](https://github.com/mopub/mopub-android-sdk/wiki/Getting-Started#adding-the-support-libraries-to-your-project) for complete instructions.
+ - Dependency changes in Maven and Gradle. No new dependencies have been added, but your build script will need to change slightly to include JCenter. See our [Getting Started Guide](https://developers.mopub.com/docs/android/getting-started/) for complete instructions.
  - Security Improvement: removed the @JavascriptInterface annotation for WebViews.
  - Fixed a bug where video playback would sometimes fail to stop when an ad was dismissed.
  - Fixed a bug where it was not possible to disable ad refresh; Fixes [issue #148](https://github.com/mopub/mopub-android-sdk/issues/148)
@@ -367,7 +393,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 
 ## Version 3.4.0 (January 30, 2015)
 
-  - **Volley networking stack** MoPub for Android now uses Google's Volley library for HTTP requests. You will need to add our bundled Volley JAR (available at `mopub-sdk/libs/mopub-volley-1.0.0.jar`) as a compile-time dependency. See instructions in our [integration page](https://dev.twitter.com/mopub/android/getting-started).
+  - **Volley networking stack** MoPub for Android now uses Google's Volley library for HTTP requests. You will need to add our bundled Volley JAR (available at `mopub-sdk/libs/mopub-volley-1.0.0.jar`) as a compile-time dependency. See instructions in our [integration page](https://developers.mopub.com/docs/android/getting-started/).
   - **Updated Vungle Support** Certified the `VungleInterstitial` custom event against Vungle SDK 3.2.2
   - **VAST Video Bug Fixes**
     - Fixed inability to parse VAST tags referencing URLs that contain 3rd party macros
@@ -376,7 +402,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 
 ## Version 3.3.0 (December 8, 2014)
 
-  - **MRAID 2.0 Support** - The MoPub SDK is now compliant with the MRAID 2.0 specification to enable rich media ads in banners and interstitial ad units. Learn more about MRAID from the [IAB](http://www.iab.net/MRAID#MRAID).
+  - **MRAID 2.0 Support** - The MoPub SDK is now compliant with the MRAID 2.0 specification to enable rich media ads in banners and interstitial ad units. Learn more about MRAID from the [IAB](https://www.iab.com/guidelines/mobile-rich-media-ad-interface-definitions-mraid/).
   - **Location Polling Updates** - Changed the interaction between application- and device-provided location data: more recent location data is now always used (in the past, application-provided location data was always preferred).
 
     As before, you may still disable MoPub SDK's location polling by calling `MoPub.setLocationAwareness(LocationAwareness.DISABLED)`.
@@ -425,7 +451,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 ## Version 2.4.0 (August 28, 2014)
 
   - **Minimum Android version now at API Level 9.** To use the new SDK, your app must run on Android 2.3.1 (Version 9, Gingerbread) or higher.
-  - **Simplified APIs for inserting native ads.** See [Native Ads Integration](https://github.com/mopub/mopub-android-sdk/wiki/Native-Ads-Integration) for details.
+  - **Simplified APIs for inserting native ads.** See [Native Ads Integration](https://developers.mopub.com/docs/android/native/) for details.
   - **Automatic ad caching for smooth scrolling.** For native ads, the SDK will now automatically pre-load ads, resulting in smoother scrolling.
   - **Performance improvements** The SDK now makes more efficient use of memory for image caching and avoids allocating temporary objects while scrolling, resulting in fewer garbage collections.
   - **Sample app improvements.** An improved sample app allows saving ad unit IDs for testing.
@@ -435,7 +461,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 ## Version 2.3 (July 17, 2014)
 
   - **Improved impression tracking for Native Ads** Impression tracking for native ads is now more accurate and more efficient.
-  - **Streamlined Maven Build and Dependencies** MoPub's Android SDK now depends on the Android v4 Support Library shipped with the Android Build tools. The MoPub Sample App also depends on Google Play Services to use the Android Advertising ID. We recommend building against Play Services in your app as well. For integration instructions, see the [wiki](https://github.com/mopub/mopub-android-sdk/wiki/Getting-Started).
+  - **Streamlined Maven Build and Dependencies** MoPub's Android SDK now depends on the Android v4 Support Library shipped with the Android Build tools. The MoPub Sample App also depends on Google Play Services to use the Android Advertising ID. We recommend building against Play Services in your app as well. For integration instructions, see the [getting started page](https://developers.mopub.com/docs/android/getting-started/).
   - **Removed AdMob Custom Events and JAR** AdMob's SDK is deprecated by Google and the APIs have been moved to Google Play Services. Existing AdMob adunits will now invoke the appropriate Google Play Services custom event. Developers must update their integration to use the Google Play Services custom events located in the extras folder by August 1.
   - **Updated Third-Party Network Compatibility** MoPub's provided Custom Events (included in the extras/ folder) are now compatible with the latest SDK releases from Millennial Media (5.3.0), Vungle (3.1.0), InMobi (4.4.1) and Google Play Services (5.0.77).
   - Fixed intermittent NullPointerException in MoPubNative#requestNativeAd; fixes [Github issue #97] (https://github.com/mopub/mopub-android-sdk/issues/97)
@@ -443,7 +469,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 
 ## Version 2.2 (June 19, 2014)
 
-  - **Native ads mediation** release; integration instructions and documentation are available on the [GitHub wiki](https://github.com/mopub/mopub-android-sdk/wiki/Integrating-Native-Third-Party-Ad-Networks). Added custom event native implementations to the native extras directory of the SDK (`/extras/src/com/mopub/nativeads`), with initial support for the following networks:
+  - **Native ads mediation** release; integration instructions and documentation are available on our [help page](https://developers.mopub.com/docs/android/integrating-networks/). Added custom event native implementations to the native extras directory of the SDK (`/extras/src/com/mopub/nativeads`), with initial support for the following networks:
   	- Facebook Audience Network (`FacebookNative.java`)
   	- InMobi Native Ads (`InMobiNative.java`)
   - **Native ads content filtering**: Added the ability to specify which native ad elements you want to receive from the MoPub Marketplace to optimize bandwidth use and download only required assets, via `RequestParameters.Builder#desiredAssets(…)`. This feature only works for the six standard Marketplace assets, found in `RequestParameters.NativeAdAsset`. Any additional elements added in direct sold ads will always be sent down in the extras.
@@ -453,7 +479,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 
 ## Version 2.1 (May 15, 2014)
 
-  - Added custom events for Facebook ads. `FacebookBanner` and `FacebookInterstitial` can be found in the extras directory of the SDK (`/extras/src/com/mopub/mobileads`). For more information, please see the [help page for Facebook custom events](http://help.mopub.com/customer/portal/articles/1552301-how-to-integrate-facebook-audience-network-using-custom-events).
+  - Added custom events for Facebook ads. `FacebookBanner` and `FacebookInterstitial` can be found in the extras directory of the SDK (`/extras/src/com/mopub/mobileads`). For more information, please see the [help page for integrating third party ad networks](https://developers.mopub.com/docs/android/integrating-networks/).
   - Significant improvements to video ads
     - Added overlay including a "Learn More" button, video length, and time left until the video may be skipped
     - Added support for companion banners (shown upon video completion)
@@ -466,7 +492,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 
 ## Version 2.0 (April 22, 2014)
 
-  - **Native Ads** public release; integration instructions and documentation available on the [GitHub wiki](https://github.com/mopub/mopub-android-sdk/wiki/Native-Ads-Integration)
+  - **Native Ads** public release; integration instructions and documentation available on our [support website](https://developers.mopub.com/docs/android/native/)
   - Changed minimum supported Android version to Froyo (Android 2.2, API level 8)
   - Added support for Google Play Services advertising identifier
   - Renamed the `com.mopub.mobileads.MraidBrowser` Activity to `com.mopub.common.MoPubBrowser`.
@@ -573,7 +599,7 @@ Version 4.0.0 includes a number of improvements to our Native Ads systems under
 
 ## Version 1.15 (August 21, 2013)
 
-Includes support for ads in the MRAID 2.0 format. MRAID 2.0 allows advertisers to create ads with rich media functionality, including adding calendar events, storing pictures and playing videos in the native video player. To learn more about MRAID 2.0, read our [help article](http://j.mp/16MKSci).
+Includes support for ads in the MRAID 2.0 format. MRAID 2.0 allows advertisers to create ads with rich media functionality, including adding calendar events, storing pictures and playing videos in the native video player. To learn more about MRAID 2.0, read our [help article](https://developers.mopub.com/docs/ad-formats/mraid/).
 
   - Added the following MRAID 2.0 features: `createCalendarEvent` (Android 4.0 and above), `playVideo`, `storePicture`, and `supports`
   - Hardware Acceleration is now enabled by default for `MraidInterstitial`s on Android 4.0 and above
diff --git a/README.md b/README.md
index 7dd0a8d5..fd1fd247 100644
--- a/README.md
+++ b/README.md
@@ -37,7 +37,7 @@ The MoPub SDK is available via:
     }
 
     dependencies {
-        implementation('com.mopub:mopub-sdk:5.5.0@aar') {
+        implementation('com.mopub:mopub-sdk:5.7.0@aar') {
             transitive = true
         }
     }
@@ -59,27 +59,27 @@ The MoPub SDK is available via:
         // ... other project dependencies
 
         // For banners
-        implementation('com.mopub:mopub-sdk-banner:5.5.0@aar') {
+        implementation('com.mopub:mopub-sdk-banner:5.7.0@aar') {
             transitive = true
         }
         
         // For interstitials
-        implementation('com.mopub:mopub-sdk-interstitial:5.5.0@aar') {
+        implementation('com.mopub:mopub-sdk-interstitial:5.7.0@aar') {
             transitive = true
         }
 
         // For rewarded videos. This will automatically also include interstitials
-        implementation('com.mopub:mopub-sdk-rewardedvideo:5.5.0@aar') {
+        implementation('com.mopub:mopub-sdk-rewardedvideo:5.7.0@aar') {
             transitive = true
         }
 
         // For native static (images).
-        implementation('com.mopub:mopub-sdk-native-static:5.5.0@aar') {
+        implementation('com.mopub:mopub-sdk-native-static:5.7.0@aar') {
             transitive = true
         }
 
         // For native video. This will automatically also include native static
-        implementation('com.mopub:mopub-sdk-native-video:5.5.0@aar') {
+        implementation('com.mopub:mopub-sdk-native-video:5.7.0@aar') {
             transitive = true
         }
     }
@@ -108,15 +108,16 @@ The MoPub SDK is available via:
 Please view the [changelog](https://github.com/mopub/mopub-android-sdk/blob/master/CHANGELOG.md) for a complete list of additions, fixes, and enhancements in the latest release.
 
 - **Features**
-  - Advanced Bidding automatically initializes. See [https://developers.mopub.com/docs/android/initialization/] for more information about initialization.
-  - GDPR legitimate interest API now available; publishers may opt into allowing supported networks to collect user information on the basis of legitimate interest.
-  - Improved logging from the SDK. Set the log level with `SdkConfiguration.Builder#withLogLevel(LogLevel)` in initialization to change the logging granularity.
-  - Upgraded Gradle dependency to 4.8
-  - Upgraded Android Plugin dependency to 3.2.0
+  - Impression Level Revenue Data - a data object that includes revenue information associated with each impression.
+  - Verizon Ads SDK now supported as a mediated network.
+  - Upgraded Gradle dependency to 5.4.1
+  - Upgraded Robolectric dependency to 4.2.1.
+  - Upgraded com.android.tools.build:gradle to 3.4.0.
+  - Sample app improvements.
 
 - **Bug Fixes**
-  - Addresses an ANR when requesting an ad immediately after initialization.
-  - MRAID isReady is now called after the load is finished instead of when the ad is shown.
+  - Handle empty impression trackers in VAST.
+  - Improved impression handling when MoPubView is reattached to the screen.
 
 ## Requirements
 
@@ -124,8 +125,8 @@ Please view the [changelog](https://github.com/mopub/mopub-android-sdk/blob/mast
 - android-support-v4.jar, r28 (**Updated in 5.4.0**)
 - android-support-annotations.jar, r28 (**Updated in 5.4.0**)
 - android-support-v7-recyclerview.jar, r28 (**Updated in 5.4.0**)
-- MoPub Volley Library (mopub-volley-2.0.0.jar - available on JCenter) (**Updated in 5.0.0**)
-- **Recommended** Google Play Services 15.0.1
+- MoPub Volley Library (mopub-volley-2.1.0.jar - available on JCenter) (**Updated in 5.6.0**)
+- **Recommended** Google Play Services (com.google.android.gms:play-services-ads-identifier:16.0.0 and com.google.android.gms:play-services-base:16.0.1) (**Updated in 5.6.0**)
 
 ## Upgrading to SDK 5.0
 
@@ -145,7 +146,7 @@ Normally, to add the MoPub SDK to your app via JCenter, your `build.gradle` woul
 
 ```	
 dependencies {
-    implementation('com.mopub:mopub-sdk:5.5.0@aar') {
+    implementation('com.mopub:mopub-sdk:5.7.0@aar') {
         transitive = true
     }
 }
@@ -154,7 +155,7 @@ Update to the following to exclude one or both viewability vendors:
 
 ```
 dependencies {
-    implementation('com.mopub:mopub-sdk:5.5.0@aar') {
+    implementation('com.mopub:mopub-sdk:5.7.0@aar') {
         transitive = true
         exclude module: 'libAvid-mopub' // To exclude AVID
         exclude module: 'moat-mobile-app-kit' // To exclude Moat
@@ -169,7 +170,7 @@ mopub.avidEnabled=false
 mopub.moatEnabled=false
 ```
 ##### Disable via API
-If you would like to opt out of viewability measurement but do not want to modify the MoPub SDK, a function is provided for your convenience. At any point, call `MoPub.disableViewability(vendor);`. This method can can be called with any of the enum values available in `ExternalViewabilitySessionManager.ViewabilityVendor`: `AVID` will disable AVID but leave Moat enabled, `MOAT` will disable Moat but leave AVID enabled, and `ALL` will disable all viewability measurement.
+If you would like to opt out of viewability measurement but do not want to modify the MoPub SDK, a function is provided for your convenience. At any point, call `MoPub.disableViewability(vendor);`. This method can be called with any of the enum values available in `ExternalViewabilitySessionManager.ViewabilityVendor`: `AVID` will disable AVID but leave Moat enabled, `MOAT` will disable Moat but leave AVID enabled, and `ALL` will disable all viewability measurement.
 
 ## Working with Android 6.0 Runtime Permissions
 If your app's target SDK is 23 or higher _**and**_ the user's device is running Android 6.0 or higher, you are responsible for supporting [runtime permissions](http://developer.android.com/training/permissions/requesting.html), one of the [changes](http://developer.android.com/about/versions/marshmallow/android-6.0-changes.html) introduced in Android 6.0 (API level 23). In addition to listing any dangerous permissions your app needs in the manifest, your app also has to explicitly request the dangerous permission(s) during runtime by calling method `requestPermissions()` in the [`ActivityCompat`](http://developer.android.com/reference/android/support/v4/app/ActivityCompat.html) class.
diff --git a/build.gradle b/build.gradle
index f0e3464a..e3aaf275 100644
--- a/build.gradle
+++ b/build.gradle
@@ -9,11 +9,7 @@ buildscript {
     }
 
     dependencies {
-        classpath 'com.android.tools.build:gradle:3.2.0'
-        classpath 'com.novoda:bintray-release:0.8.0'
+        classpath 'com.android.tools.build:gradle:3.4.0'
+        classpath 'com.novoda:bintray-release:0.9'
     }
 }
-
-task wrapper(type: Wrapper) {
-    gradleVersion = '4.8'
-}
diff --git a/extras/README.md b/extras/README.md
deleted file mode 100644
index dae4df22..00000000
--- a/extras/README.md
+++ /dev/null
@@ -1,5 +0,0 @@
-# MoPub Android SDK
-
-We are formally separating network adapters from our MoPub SDK. This is to enable an independent release cadence resulting in faster updates and certification cycles. New mediation location is accessible [here](https://github.com/mopub/mopub-android-mediation).  
-
-We have also added an additional tool, making it easy for publishers to get up and running with the mediation integration. Check out https://developers.mopub.com/docs/mediation/integrate/ and integration instructions at https://developers.mopub.com/docs/android/integrating-networks/.
diff --git a/gradle/wrapper/gradle-wrapper.jar b/gradle/wrapper/gradle-wrapper.jar
index 13372aef..5c2d1cf0 100644
Binary files a/gradle/wrapper/gradle-wrapper.jar and b/gradle/wrapper/gradle-wrapper.jar differ
diff --git a/gradle/wrapper/gradle-wrapper.properties b/gradle/wrapper/gradle-wrapper.properties
index 22b6ea34..f4d7b2bf 100644
--- a/gradle/wrapper/gradle-wrapper.properties
+++ b/gradle/wrapper/gradle-wrapper.properties
@@ -1,6 +1,5 @@
-#Mon Oct 01 14:32:21 PDT 2018
 distributionBase=GRADLE_USER_HOME
 distributionPath=wrapper/dists
+distributionUrl=https\://services.gradle.org/distributions/gradle-5.4.1-bin.zip
 zipStoreBase=GRADLE_USER_HOME
 zipStorePath=wrapper/dists
-distributionUrl=https\://services.gradle.org/distributions/gradle-4.8-all.zip
diff --git a/gradlew b/gradlew
index 9d82f789..b0d6d0ab 100755
--- a/gradlew
+++ b/gradlew
@@ -1,4 +1,20 @@
-#!/usr/bin/env bash
+#!/usr/bin/env sh
+
+#
+# Copyright 2015 the original author or authors.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#      http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 
 ##############################################################################
 ##
@@ -6,20 +22,38 @@
 ##
 ##############################################################################
 
-# Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
-DEFAULT_JVM_OPTS=""
+# Attempt to set APP_HOME
+# Resolve links: $0 may be a link
+PRG="$0"
+# Need this for relative symlinks.
+while [ -h "$PRG" ] ; do
+    ls=`ls -ld "$PRG"`
+    link=`expr "$ls" : '.*-> \(.*\)$'`
+    if expr "$link" : '/.*' > /dev/null; then
+        PRG="$link"
+    else
+        PRG=`dirname "$PRG"`"/$link"
+    fi
+done
+SAVED="`pwd`"
+cd "`dirname \"$PRG\"`/" >/dev/null
+APP_HOME="`pwd -P`"
+cd "$SAVED" >/dev/null
 
 APP_NAME="Gradle"
 APP_BASE_NAME=`basename "$0"`
 
+# Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
+DEFAULT_JVM_OPTS='"-Xmx64m" "-Xms64m"'
+
 # Use the maximum available, or set MAX_FD != -1 to use that value.
 MAX_FD="maximum"
 
-warn ( ) {
+warn () {
     echo "$*"
 }
 
-die ( ) {
+die () {
     echo
     echo "$*"
     echo
@@ -30,6 +64,7 @@ die ( ) {
 cygwin=false
 msys=false
 darwin=false
+nonstop=false
 case "`uname`" in
   CYGWIN* )
     cygwin=true
@@ -40,26 +75,11 @@ case "`uname`" in
   MINGW* )
     msys=true
     ;;
+  NONSTOP* )
+    nonstop=true
+    ;;
 esac
 
-# Attempt to set APP_HOME
-# Resolve links: $0 may be a link
-PRG="$0"
-# Need this for relative symlinks.
-while [ -h "$PRG" ] ; do
-    ls=`ls -ld "$PRG"`
-    link=`expr "$ls" : '.*-> \(.*\)$'`
-    if expr "$link" : '/.*' > /dev/null; then
-        PRG="$link"
-    else
-        PRG=`dirname "$PRG"`"/$link"
-    fi
-done
-SAVED="`pwd`"
-cd "`dirname \"$PRG\"`/" >/dev/null
-APP_HOME="`pwd -P`"
-cd "$SAVED" >/dev/null
-
 CLASSPATH=$APP_HOME/gradle/wrapper/gradle-wrapper.jar
 
 # Determine the Java command to use to start the JVM.
@@ -85,7 +105,7 @@ location of your Java installation."
 fi
 
 # Increase the maximum file descriptors if we can.
-if [ "$cygwin" = "false" -a "$darwin" = "false" ] ; then
+if [ "$cygwin" = "false" -a "$darwin" = "false" -a "$nonstop" = "false" ] ; then
     MAX_FD_LIMIT=`ulimit -H -n`
     if [ $? -eq 0 ] ; then
         if [ "$MAX_FD" = "maximum" -o "$MAX_FD" = "max" ] ; then
@@ -150,11 +170,19 @@ if $cygwin ; then
     esac
 fi
 
-# Split up the JVM_OPTS And GRADLE_OPTS values into an array, following the shell quoting and substitution rules
-function splitJvmOpts() {
-    JVM_OPTS=("$@")
+# Escape application args
+save () {
+    for i do printf %s\\n "$i" | sed "s/'/'\\\\''/g;1s/^/'/;\$s/\$/' \\\\/" ; done
+    echo " "
 }
-eval splitJvmOpts $DEFAULT_JVM_OPTS $JAVA_OPTS $GRADLE_OPTS
-JVM_OPTS[${#JVM_OPTS[*]}]="-Dorg.gradle.appname=$APP_BASE_NAME"
+APP_ARGS=$(save "$@")
+
+# Collect all arguments for the java command, following the shell quoting and substitution rules
+eval set -- $DEFAULT_JVM_OPTS $JAVA_OPTS $GRADLE_OPTS "\"-Dorg.gradle.appname=$APP_BASE_NAME\"" -classpath "\"$CLASSPATH\"" org.gradle.wrapper.GradleWrapperMain "$APP_ARGS"
+
+# by default we should be in the correct project dir, but when run from Finder on Mac, the cwd is wrong
+if [ "$(uname)" = "Darwin" ] && [ "$HOME" = "$PWD" ]; then
+  cd "$(dirname "$0")"
+fi
 
-exec "$JAVACMD" "${JVM_OPTS[@]}" -classpath "$CLASSPATH" org.gradle.wrapper.GradleWrapperMain "$@"
+exec "$JAVACMD" "$@"
diff --git a/gradlew.bat b/gradlew.bat
index 41a6cb9e..15e1ee37 100644
--- a/gradlew.bat
+++ b/gradlew.bat
@@ -1,6 +1,18 @@
-@rem Copyright 2018-2019 Twitter, Inc.
-@rem Licensed under the MoPub SDK License Agreement
-@rem http://www.mopub.com/legal/sdk-license-agreement/
+@rem
+@rem Copyright 2015 the original author or authors.
+@rem
+@rem Licensed under the Apache License, Version 2.0 (the "License");
+@rem you may not use this file except in compliance with the License.
+@rem You may obtain a copy of the License at
+@rem
+@rem      http://www.apache.org/licenses/LICENSE-2.0
+@rem
+@rem Unless required by applicable law or agreed to in writing, software
+@rem distributed under the License is distributed on an "AS IS" BASIS,
+@rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+@rem See the License for the specific language governing permissions and
+@rem limitations under the License.
+@rem
 
 @if "%DEBUG%" == "" @echo off
 @rem ##########################################################################
@@ -12,14 +24,14 @@
 @rem Set local scope for the variables with windows NT shell
 if "%OS%"=="Windows_NT" setlocal
 
-@rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
-set DEFAULT_JVM_OPTS=
-
 set DIRNAME=%~dp0
 if "%DIRNAME%" == "" set DIRNAME=.
 set APP_BASE_NAME=%~n0
 set APP_HOME=%DIRNAME%
 
+@rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
+set DEFAULT_JVM_OPTS="-Xmx64m" "-Xms64m"
+
 @rem Find java.exe
 if defined JAVA_HOME goto findJavaFromJavaHome
 
@@ -50,10 +62,9 @@ echo location of your Java installation.
 goto fail
 
 :init
-@rem Get command-line arguments, handling Windowz variants
+@rem Get command-line arguments, handling Windows variants
 
 if not "%OS%" == "Windows_NT" goto win9xME_args
-if "%@eval[2+2]" == "4" goto 4NT_args
 
 :win9xME_args
 @rem Slurp the command line arguments.
@@ -64,11 +75,6 @@ set _SKIP=2
 if "x%~1" == "x" goto execute
 
 set CMD_LINE_ARGS=%*
-goto execute
-
-:4NT_args
-@rem Get arguments from the 4NT Shell from JP Software
-set CMD_LINE_ARGS=%$
 
 :execute
 @rem Setup the command line
diff --git a/mopub-sample/AndroidManifest.xml b/mopub-sample/AndroidManifest.xml
index 12ed2728..87c17497 100644
--- a/mopub-sample/AndroidManifest.xml
+++ b/mopub-sample/AndroidManifest.xml
@@ -1,53 +1,86 @@
 <?xml version="1.0" encoding="utf-8"?>
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-      package="com.mopub.simpleadsdemo"
-      android:versionCode="66"
-      android:versionName="5.5.0">
+    xmlns:tools="http://schemas.android.com/tools"
+    package="com.mopub.simpleadsdemo">
 
     <uses-permission android:name="android.permission.INTERNET" />
     <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
     <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
 
+    <!-- This is added as a workaround for the manifest merger duplicating exoplayer
+         and play services permissions. -->
+    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
+
     <!--WRITE_EXTERNAL_STORAGE is optional and only required for MRAID 2.0 storePicture ads.-->
-    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
+    <uses-permission
+        android:name="android.permission.WRITE_EXTERNAL_STORAGE"
+        tools:remove="android:maxSdkVersion" />
 
     <application
+        android:allowBackup="true"
         android:icon="@drawable/icon"
         android:label="@string/app_name"
         android:networkSecurityConfig="@xml/network_security_config"
-        android:supportsRtl="true">
-	    <activity android:name="com.mopub.simpleadsdemo.MoPubSampleActivity"
-	            android:label="@string/app_name"
-                android:launchMode="singleTask"
-                android:configChanges="orientation|screenSize">
-	        <intent-filter>
-	            <action android:name="android.intent.action.MAIN" />
-	            <category android:name="android.intent.category.LAUNCHER" />
-	        </intent-filter>
+        android:supportsRtl="true"
+        android:theme="@style/AppTheme">
+        <activity
+            android:name="com.mopub.simpleadsdemo.MoPubSampleActivity"
+            android:configChanges="orientation|screenSize"
+            android:label="@string/app_name"
+            android:launchMode="singleTask"
+            android:theme="@style/AppTheme.NoActionBar">
+            <intent-filter>
+                <action android:name="android.intent.action.MAIN" />
+                <category android:name="android.intent.category.LAUNCHER" />
+            </intent-filter>
             <intent-filter>
                 <action android:name="android.intent.action.VIEW" />
+
                 <category android:name="android.intent.category.BROWSABLE" />
                 <category android:name="android.intent.category.DEFAULT" />
-                <data android:scheme="mopub"
-                      android:host="load" />
+
+                <data
+                    android:host="load"
+                    android:scheme="mopub" />
             </intent-filter>
-	    </activity>
-        <activity android:name="com.mopub.mobileads.MoPubActivity"
-                android:configChanges="keyboardHidden|orientation|screenSize"/>
-        <activity android:name="com.mopub.mobileads.MraidActivity"
-                android:configChanges="keyboardHidden|orientation|screenSize"/>
-        <activity android:name="com.mopub.common.MoPubBrowser"
-                android:configChanges="keyboardHidden|orientation|screenSize"/>
-        <activity android:name="com.mopub.mobileads.MraidVideoPlayerActivity"
-                android:configChanges="keyboardHidden|orientation|screenSize"/>
-        <activity android:name="com.mopub.mobileads.RewardedMraidActivity"
-                  android:configChanges="keyboardHidden|orientation|screenSize"/>
-
-        <activity android:name="com.mopub.common.privacy.ConsentDialogActivity"
-                  android:configChanges="keyboardHidden|orientation|screenSize"/>
-
-        <meta-data android:name="com.google.android.gms.version"
-                   android:value="@integer/google_play_services_version" />
+        </activity>
+        <activity
+            android:name="com.mopub.mobileads.MoPubActivity"
+            android:configChanges="keyboardHidden|orientation|screenSize" />
+        <activity
+            android:name="com.mopub.mobileads.MraidActivity"
+            android:configChanges="keyboardHidden|orientation|screenSize" />
+        <activity
+            android:name="com.mopub.common.MoPubBrowser"
+            android:configChanges="keyboardHidden|orientation|screenSize" />
+        <activity
+            android:name="com.mopub.mobileads.MraidVideoPlayerActivity"
+            android:configChanges="keyboardHidden|orientation|screenSize" />
+        <activity
+            android:name="com.mopub.mobileads.RewardedMraidActivity"
+            android:configChanges="keyboardHidden|orientation|screenSize" />
+
+        <activity
+            android:name="com.mopub.common.privacy.ConsentDialogActivity"
+            android:configChanges="keyboardHidden|orientation|screenSize" />
+
+        <!-- AppLovin -->
+        <meta-data
+            android:name="applovin.sdk.key"
+            android:value="g9p0buIGwmV205uzWu93fLFLsxAwz_ve9hflay_UiVXiaQf5Iq8yAOI0JTwHSqxcVaL4XLZEs5yQVcWpRelb21" />
+
+        <!-- Google Ads -->
+        <!-- note: this is the sample app id from Google's documentation -->
+        <!-- https://developers.google.com/admob/android/quick-start#update_your_androidmanifestxml -->
+        <meta-data
+            android:name="com.google.android.gms.ads.APPLICATION_ID"
+            android:value="ca-app-pub-3940256099942544~3347511713" />
+
+        <!-- Google Play Services -->
+        <meta-data
+            android:name="com.google.android.gms.version"
+            android:value="@integer/google_play_services_version" />
+
     </application>
 
 </manifest>
diff --git a/mopub-sample/build.gradle b/mopub-sample/build.gradle
index e1dea141..b9a534c6 100644
--- a/mopub-sample/build.gradle
+++ b/mopub-sample/build.gradle
@@ -8,6 +8,15 @@ repositories {
     flatDir {
         dirs '../libs'
     }
+    maven {
+        name "Tapjoy's maven repo"
+        url "https://tapjoy.bintray.com/maven"
+    }
+    maven {
+        url "https://adcolony.bintray.com/AdColony"
+    }
+    maven { url 'https://jitpack.io' }  // For Vungle
+    maven { url "https://dl.bintray.com/ironsource-mobile/android-sdk" } // For IronSource
     maven { url "https://s3.amazonaws.com/moat-sdk-builds" }
 }
 
@@ -15,21 +24,36 @@ apply plugin: 'com.android.application'
 
 project.group = 'com.mopub'
 project.description = '''MoPub Sample App'''
-project.version = '5.5.0'
+project.version = '5.7.0'
 
 android {
     compileSdkVersion 28
     lintOptions { abortOnError false }
 
+    compileOptions {
+        sourceCompatibility JavaVersion.VERSION_1_7
+        targetCompatibility JavaVersion.VERSION_1_8
+    }
+
     defaultConfig {
-        versionCode 66
+        versionCode 68
         versionName version
         minSdkVersion 16
         targetSdkVersion 28
+        multiDexEnabled true
 
         testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
     }
 
+    flavorDimensions "default"
+    productFlavors {
+        external {
+            versionName "external"
+            dimension "default"
+        }
+
+    }
+
     buildTypes {
         release {
             minifyEnabled true
@@ -48,7 +72,7 @@ android {
             resources.srcDirs = ['src/main/java']
             aidl.srcDirs = ['src/main']
             renderscript.srcDirs = ['src/main']
-            res.srcDirs = ['res']
+            res.srcDirs = ['res/main']
             assets.srcDirs = ['assets']
         }
     }
@@ -60,11 +84,41 @@ android {
 }
 
 dependencies {
+    // Third party Custom Network Adapters
+    implementation 'com.adcolony:sdk:3.3.10'
+    implementation 'com.google.android.gms:play-services-ads:17.2.0'
+    implementation "com.applovin:applovin-sdk:9.4.2"
+//    implementation name: 'chartboost-7.3.1'
+    implementation 'com.facebook.android:audience-network-sdk:5.3.0'
+    implementation 'com.flurry.android:ads:11.6.0'
+    implementation 'com.flurry.android:analytics:11.6.0'
+    implementation 'com.ironsource.sdk:mediationsdk:6.8.3@jar'
+    implementation 'com.tapjoy:tapjoy-android-sdk:12.2.1@aar'
+    implementation 'com.unity3d.ads:unity-ads:3.0.3@aar'
+    implementation 'com.verizon.ads:android-vas-standard-edition:1.0.2'
+    // Vungle and its dependencies.
+    implementation 'com.github.vungle:vungle-android-sdk:6.3.24'
+
+    // MoPub Custom Network Adapters
+    implementation 'com.mopub.mediation:adcolony:3.3.10.0'
+    implementation 'com.mopub.mediation:admob:17.2.0.1'
+    implementation 'com.mopub.mediation:applovin:9.4.2.0'
+//    implementation 'com.mopub.mediation:chartboost:7.3.1.4'
+    implementation 'com.mopub.mediation:facebookaudiencenetwork:5.3.0.0'
+    implementation 'com.mopub.mediation:flurry:11.6.0.0'
+    implementation 'com.mopub.mediation:ironsource:6.8.3.0'
+    implementation 'com.mopub.mediation:tapjoy:12.2.1.1'
+    implementation 'com.mopub.mediation:unityads:3.0.3.0'
+    implementation 'com.mopub.mediation:verizon:1.0.2.1'
+    implementation 'com.mopub.mediation:vungle:6.3.24.2'
+
     implementation 'com.android.support:customtabs:28.0.0'
     implementation 'com.android.support:support-v4:28.0.0'
+    implementation 'com.android.support:design:28.0.0'
+    implementation 'com.android.support:recyclerview-v7:28.0.0'
+    implementation 'com.android.support.constraint:constraint-layout:1.1.3'
     implementation 'com.google.android.gms:play-services-ads-identifier:16.0.0'
     implementation 'com.google.android.gms:play-services-base:16.0.1'
-    implementation 'com.android.support:recyclerview-v7:28.0.0'
     implementation project(':mopub-sdk')
 
     // Instrumentation testing-only dependencies
diff --git a/mopub-sample/res/internal/values/strings.xml b/mopub-sample/res/internal/values/strings.xml
new file mode 100644
index 00000000..03ed05e1
--- /dev/null
+++ b/mopub-sample/res/internal/values/strings.xml
@@ -0,0 +1,222 @@
+<?xml version="1.0" encoding="utf-8"?>
+<resources>
+    <!--Macaw - Exchange test ad units-->
+    <string name="ad_unit_id_macaw_interstitial_portrait">2971114e05df4bb6bfeb83aefd2cb13f</string>
+    <string name="ad_unit_id_macaw_banner">1901a8606d8a45c9bf2358be5dc220e9</string>
+    <string name="ad_unit_id_macaw_mrect">7dfc45083ef04ea6b7533f1b2b8f5f6b</string>
+    <string name="ad_unit_id_macaw_leaderboard">ad21b1b40cfb45d38ca27e996e538005</string>
+    <string name="ad_unit_id_macaw_interstitial_landscape">181294542e6b4b33bd80cf1563dc4724</string>
+    <string name="ad_unit_id_macaw_tablet_interstitial_portrait">c6380a094a444657836884e12b86e013</string>
+    <string name="ad_unit_id_macaw_tablet_interstitial_landscape">d9f040c7f29a4da6b9262a1d504dc057</string>
+    <string name="ad_unit_id_macaw_skyscraper">f12e1691e6614496a1530b530bde85cc</string>
+    <string name="ad_unit_id_macaw_native">5d73b139cd3f402f8a6767670c4cf6fb</string>
+
+    <!--Release Testing ad units-->
+    <string name="ad_unit_id_rt_banner_image">64561445aa894576b6899e364c3cf003</string>
+    <string name="ad_unit_id_rt_banner_html">977c3ca769ce488293edac7a7a85ce99</string>
+    <string name="ad_unit_id_rt_banner_mraid_expanding_device">af50074dfa38476d85449391523ba2aa</string>
+    <string name="ad_unit_id_rt_banner_mraid_expanding_landscape">e31935dc878b412dba363b7b61484df0</string>
+    <string name="ad_unit_id_rt_banner_mraid_expanding_portrait">5b1917e405a34e238f0816371124590d</string>
+    <string name="ad_unit_id_rt_banner_resizing">26c38be32221456e9b5bdfba15211afe</string>
+
+    <string name="ad_unit_id_rt_mrect_image">560b3ba10bbe485ebc9e37a2e1cbbe4b</string>
+    <string name="ad_unit_id_rt_mrect_html">a0d719ae192748c2959f32235db68daf</string>
+    <string name="ad_unit_id_rt_mrect_expanding_device">4badb91a5c344cbda602a0a83d8937f2</string>
+    <string name="ad_unit_id_rt_mrect_expanding_landscape">01b88873d7c74dff9531ea744c4431e3</string>
+    <string name="ad_unit_id_rt_mrect_expanding_portrait">7b3189920ec646acb8f61d4d5013d7e3</string>
+    <string name="ad_unit_id_rt_mrect_resizing">53373b5f681a42438d9df71aa74165c4</string>
+    <string name="ad_unit_id_rt_mrect_html_video">5a85ad2677c34bffb2ae0b45eb18efdd</string>
+
+    <string name="ad_unit_id_rt_leaderboard_image">ab496e83496243e7b27c6b0636d9e9a2</string>
+    <string name="ad_unit_id_rt_leaderboard_html">37309343b1cc46b6ae5f2f4b0728f4f4</string>
+    <string name="ad_unit_id_rt_leaderboard_mraid_expanding_device">cc630d7fe5bf4f918e98d4f3ab6e0e51</string>
+    <string name="ad_unit_id_rt_leaderboard_mraid_expanding_landscape">cda9d79b0d704407ad1f0a1b6c3b837e</string>
+    <string name="ad_unit_id_rt_leaderboard_mraid_expanding_portrait">4f8a48f1ed4346408e793c3e1b83b2fe</string>
+    <string name="ad_unit_id_rt_leaderboard_mraid_resizing_offscreen">a652687cc74c41e19f4999bac37b854d</string>
+    <string name="ad_unit_id_rt_leaderboard_mraid_resizing_no_offscreen">2ff3c7b2d6234798a01ead84a6afda21</string>
+
+    <string name="ad_unit_id_rt_interstitial_vast_no_ext_companion_landscape">eab0db43a021431c9ae43e6ff1dd8fac</string>
+    <string name="ad_unit_id_rt_interstitial_vast_no_ext_no_companion_landscape">3d752afaad8f41f2a32de0c9e83a6b49</string>
+    <string name="ad_unit_id_rt_interstitial_vast_ext_companion_device">4e56aa03c3ad48338b70d8cc890553b0</string>
+    <string name="ad_unit_id_rt_interstitial_vast_ext_companion_landscape">2bc078315efe4edda00d2bae478e894b</string>
+    <string name="ad_unit_id_rt_interstitial_vast_ext_companion_portrait">0ee47e89697a44789a60b3d83dacd526</string>
+    <string name="ad_unit_id_rt_interstitial_vast_ext_no_companion_device">212d6c826d78476f8d01fa32726b4b98</string>
+    <string name="ad_unit_id_rt_interstitial_vast_ext_no_companion_landscape">3521c7acd9dd41358a6564cff5eddedf</string>
+    <string name="ad_unit_id_rt_interstitial_vast_ext_no_companion_portrait">468abb57b71147559d7bcb972e23c91a</string>
+
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_vast_no_ext_companion_landscape">abf919e86136493cbe0237f6067ee1eb</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_vast_no_ext_no_companion_landscape">f1faff48504e4e3db51fcecb64a6e12b</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_vast_ext_companion_device">2393fd574c424602a514d0a47cfb82fb</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_vast_ext_companion_landscape">5ccb97c1c11d4453915e3b8c9a10adad</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_vast_ext_companion_portrait">697bb483986f4f77862e589c785f0f8a</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_vast_ext_no_companion_device">c3630d063505462a92e132cf04ac345b</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_vast_ext_no_companion_landscape">8521f18a728c4ddd8dacba5ae365919c</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_vast_ext_no_companion_portrait">21f931b01a24422db56fe43f10123c2e</string>
+
+    <string name="ad_unit_id_rt_rewarded_single_currency_vast_no_ext_companion_landscape">5b8c27f29c324b32b8c1a2f886533334</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_vast_no_ext_no_companion_landscape">d344c1d0fcc24b4cbd23cea9a9b584f6</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_vast_ext_companion_device">fe419b86c7a94c5da8b92c30725e2cac</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_vast_ext_companion_landscape">5dd4cb47c72e42a0a6232480cdfffbeb</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_vast_ext_companion_portrait">cf225b3cbec346faa3f135c92d6ed29a</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_vast_ext_no_companion_device">371b5b7466f648e0813bcdc6892f4f8d</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_vast_ext_no_companion_landscape">73969508231d4307bbfa0db2d0a0661e</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_vast_ext_no_companion_portrait">7ca95e3c3cd743cf9dceb832024a1bb6</string>
+
+    <string name="ad_unit_id_rt_rewarded_multi_currency_vast_no_ext_companion_landscape">d02ea0fd104f4cf78dd7923512d708f8</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_vast_no_ext_no_companion_landscape">069a58386a604bde86910864b5c75595</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_vast_ext_companion_device">96c8fae1fc944df48490787d9e0357b0</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_vast_ext_companion_landscape">2b64e0a3fe104d42897cb76f8a3480cb</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_vast_ext_companion_portrait">edaec97a7f294a64b85c5276ef2167e8</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_vast_ext_no_companion_device">77017a8d78494d26bb4efff5a2afda37</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_vast_ext_no_companion_landscape">9aea5f9dce844469b6d38067c18c1a03</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_vast_ext_no_companion_portrait">e2979c25a56b4605aa6220cd44c6ae61</string>
+
+    <string name="ad_unit_id_rt_native_image_default">e33263a0d07849858d20718e1f6bd262</string>
+    <string name="ad_unit_id_rt_native_image_custom">06f544793ab94b519c64a8935b97fef8</string>
+    <string name="ad_unit_id_rt_native_video_default">321fce78cfe643bfb1307f68b4ffbc56</string>
+    <string name="ad_unit_id_rt_native_video_custom">28376225b2ea4a34a5dd4d0c258f42b1</string>
+    <string name="ad_unit_id_rt_native_image_default_table">e33263a0d07849858d20718e1f6bd262</string>
+    <string name="ad_unit_id_rt_native_image_custom_table">576d8faa86bf43ed885086428ec12ab7</string>
+    <string name="ad_unit_id_rt_native_video_default_table">321fce78cfe643bfb1307f68b4ffbc56</string>
+    <string name="ad_unit_id_rt_native_video_custom_table">a4ec9929ee58404eb95e8376a0666277</string>
+    <string name="ad_unit_id_rt_native_image_default_collection">e33263a0d07849858d20718e1f6bd262</string>
+    <string name="ad_unit_id_rt_native_image_custom_collection">4d28445bbd95448d9b3fefb6d97fdc41</string>
+    <string name="ad_unit_id_rt_native_video_default_collection">321fce78cfe643bfb1307f68b4ffbc56</string>
+    <string name="ad_unit_id_rt_native_video_custom_collection">ec2b5696162249c0b54098dd0b69c07a</string>
+
+    <string name="ad_unit_id_rt_interstitial_image_landscape_phone">4477f9af6c9344bd808e992ca007e59d</string>
+    <string name="ad_unit_id_rt_interstitial_image_portrait_phone">5cbfe91d79da4329b286901d6182c74a</string>
+    <string name="ad_unit_id_rt_interstitial_html_basic_landscape_phone">f42ae53ecdd4470887672764f12ec835</string>
+    <string name="ad_unit_id_rt_interstitial_html_basic_portrait_phone">1252adbc258b4bc788a5e9cfb943f466</string>
+    <string name="ad_unit_id_rt_interstitial_mraid_basic_device_phone">092db09cfb80492787ce53085aac6a28</string>
+    <string name="ad_unit_id_rt_interstitial_mraid_basic_landscape_phone">ef93604eafc3459cab3c79adc5c09049</string>
+    <string name="ad_unit_id_rt_interstitial_mraid_basic_portrait_phone">f9719cc678a741229dacc64f81e87628</string>
+    <string name="ad_unit_id_rt_interstitial_html_video_landscape_phone">3ae5fe30cc8347ccb5af452b9e027eba</string>
+    <string name="ad_unit_id_rt_interstitial_html_video_portrait_phone">66129990cd3948b08c8003a4294e3def</string>
+
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_mraid_device_phone">f2054a24efac4ecf9b6bfd914e06e23c</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_mraid_landscape_phone">ca84ae968d2c4bea93899f32eda5b643</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_mraid_portrait_phone">7465977860334b348eb2c5d6694948f2</string>
+
+    <string name="ad_unit_id_rt_rewarded_single_currency_mraid_device_phone">02b8b6d870934b29b2bff23327493ee0</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_mraid_landscape_phone">13026731e30c4717a6b7dcf2487a25ac</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_mraid_portrait_phone">4dc7af75c20649e7b0a1001f9aa12085</string>
+
+    <string name="ad_unit_id_rt_rewarded_multi_currency_mraid_device_phone">84c1c08648ca4314a9824face0c6c04d</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_mraid_landscape_phone">f0f5a7c4e0da43a697095a0e957f1f5f</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_mraid_portrait_phone">48d51627826d45c2af0a8b6b0246e67c</string>
+
+    <string name="ad_unit_id_rt_interstitial_image_landscape_tablet">7a78e378b2074e00b3f9769166f74fa2</string>
+    <string name="ad_unit_id_rt_interstitial_image_portrait_tablet">bdc5ef94de78401484df684787221b4e</string>
+    <string name="ad_unit_id_rt_interstitial_html_basic_landscape_tablet">716ee330cba0402bbea1d245d0ea8176</string>
+    <string name="ad_unit_id_rt_interstitial_html_basic_portrait_tablet">5309c6f83dec4f529d534d41ee58098c</string>
+    <string name="ad_unit_id_rt_interstitial_mraid_basic_device_tablet">1d6d1ff7e76b45beb72e7d5f43b177fb</string>
+    <string name="ad_unit_id_rt_interstitial_mraid_basic_landscape_tablet">4a21aec9b6da4c2283868d63017431b6</string>
+    <string name="ad_unit_id_rt_interstitial_mraid_basic_portrait_tablet">adb11b502c1e4d90a5f71754958c8f4f</string>
+    <string name="ad_unit_id_rt_interstitial_html_video_landscape_tablet">9367c4d4b7444bceab89d7df077b9b5f</string>
+    <string name="ad_unit_id_rt_interstitial_html_video_portrait_tablet">6acc18636c214b5696142099916b9ccc</string>
+
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_mraid_device_tablet">7a402b5890ca44a4a28c2a8c02e59db8</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_mraid_landscape_tablet">66d700fdee0446a7ad67d3def71da5aa</string>
+    <string name="ad_unit_id_rt_rewarded_legacy_currency_mraid_portrait_tablet">c5ce794be004487e8815680cf4ce9f66</string>
+
+    <string name="ad_unit_id_rt_rewarded_single_currency_mraid_device_tablet">846d915b5fa74fda8e95c5c9519ec16b</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_mraid_landscape_tablet">81c2c5bfd8254f4e9f1cf9f9f3548581</string>
+    <string name="ad_unit_id_rt_rewarded_single_currency_mraid_portrait_tablet">84cc08ecb0e3415eb6fa399b9dcbcd5b</string>
+
+    <string name="ad_unit_id_rt_rewarded_multi_currency_mraid_device_tablet">8e658b5231824280833226ba9f0ee433</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_mraid_landscape_tablet">d552acc66aec4c4cb85e61d14439b580</string>
+    <string name="ad_unit_id_rt_rewarded_multi_currency_mraid_portrait_tablet">969e1e14f93448b1ad334a7a5e46e512</string>
+
+    <!--Top Grossing-->
+    <string name="ad_unit_id_top_grossing_banner_phone">321da3e82353435cac072116cab84b23</string>
+    <string name="ad_unit_id_top_grossing_mrect_phone">e4ec5b5d8b224ef895d6d93094dc6949</string>
+    <string name="ad_unit_id_top_grossing_interstitial_phone">ebe9132e1ec748ddbc1e333089e95113</string>
+    <string name="ad_unit_id_top_grossing_rewarded_phone">23ba06fc2a9a4b6383812bd7003b3fd9</string>
+    <string name="ad_unit_id_top_grossing_native_phone">554e7a6c341242228f122b653e12417e</string>
+
+    <string name="ad_unit_id_top_grossing_banner_tablet">b87326a1a64746c88b996f0234efd7e3</string>
+    <string name="ad_unit_id_top_grossing_mrect_tablet">be678056f327430b91d62a861cbebd0f</string>
+    <string name="ad_unit_id_top_grossing_leaderboard_tablet">dd85ff2a8dd64318b8fb0a17e35c8f0a</string>
+    <string name="ad_unit_id_top_grossing_interstitial_tablet">1baf215709034ef19ad4cd80e6396e00</string>
+    <string name="ad_unit_id_top_grossing_rewarded_tablet">a83d73f6b65848eb98529a1b168a3708</string>
+    <string name="ad_unit_id_top_grossing_native_tablet">eecebc103df84c0aa0acfb4ea6b93237</string>
+
+    <!--Twitter Audience Platform-->
+    <string name="ad_unit_id_tap_banner">f684d7bf6a104bbdab3993cc291255dd</string>
+    <string name="ad_unit_id_tap_banner_tablet">b4a6dba86aa84c159098335320b22f89</string>
+    <string name="ad_unit_id_tap_interstitial_landscape">bdb933f863d940d4ba0d48c32c31a461</string>
+    <string name="ad_unit_id_tap_interstitial_landscape_tablet">6e554b8347aa41c68df0c1b8024f141c</string>
+    <string name="ad_unit_id_tap_interstitial_portrait">5de9a132df214abcb500c37c447b339c</string>
+    <string name="ad_unit_id_tap_interstitial_portrait_tablet">2905c14f6e4f43b0b9bbaed1705b9296</string>
+    <string name="ad_unit_id_tap_tweet_interstitial_landscape">d3c1cd039dcc4326ad64d4d6fde6a4a5</string>
+    <string name="ad_unit_id_tap_tweet_interstitial_landscape_tablet">2118107dd5bf46409ec2df6b447836dd</string>
+    <string name="ad_unit_id_tap_tweet_interstitial_portrait">efe8c053bf074771b27ea976d82b6a5b</string>
+    <string name="ad_unit_id_tap_tweet_interstitial_portrait_tablet">00b1cf7dcb25410da6e9e6b59f82fc09</string>
+    <string name="ad_unit_id_tap_video_interstitial_device">490a81eec0974e0e9567b87d2fd6b81a</string>
+    <string name="ad_unit_id_tap_video_interstitial_device_tablet">6ea242b72ab849e1a668dbe70715a5f3</string>
+    <string name="ad_unit_id_tap_video_interstitial_landscape">a239770e3b7849988c888a284d7718f0</string>
+    <string name="ad_unit_id_tap_video_interstitial_landscape_tablet">f7eb5bf595964bcc8e047b4a1e7e7817</string>
+    <string name="ad_unit_id_tap_video_interstitial_portrait">28f0dad82c984c5995592f7802b059d7</string>
+    <string name="ad_unit_id_tap_video_interstitial_portrait_tablet">9adfcc1aeb1749dfa90a725d63e6d8b4</string>
+    <string name="ad_unit_id_tap_leaderboard">6a763eac135a446594c530a50c35e5d4</string>
+    <string name="ad_unit_id_tap_mrect">f36e9fdc947d4b4faaeb15aa3e29a2ec</string>
+    <string name="ad_unit_id_tap_mrect_tablet">0f56c33f03754018842aaa794abbe719</string>
+    <string name="ad_unit_id_tap_native_static">09d4e470ca534795b71041c6ca79bac4</string>
+    <string name="ad_unit_id_tap_native_static_tablet">68c0539952f0451093a76c5359d4eecc</string>
+    <string name="ad_unit_id_tap_rewarded_video_device">2cbbe2727b1f43a48abe702fd5900412</string>
+    <string name="ad_unit_id_tap_rewarded_video_device_tablet">ecfb2fe99c754acb8637624c2b522425</string>
+    <string name="ad_unit_id_tap_rewarded_video_landscape">e0cfc0942c7f4fb195dee8456af49149</string>
+    <string name="ad_unit_id_tap_rewarded_video_landscape_tablet">abe2a3157872408289059af8d4f1c9c1</string>
+    <string name="ad_unit_id_tap_rewarded_video_portrait">87fa6ad3da6f4b419bec69e328397c77</string>
+    <string name="ad_unit_id_tap_rewarded_video_portrait_tablet">aa837da50377422d95fe43cd0117d3a7</string>
+
+    <!--AdColony-->
+    <string name="ad_unit_id_adcolony_interstitial">953d93d50ae343168ad44c3c536cdb1a</string>
+    <string name="ad_unit_id_adcolony_rewarded_video">339929134a55413d9c0a85496b250057</string>
+
+    <!--AdMob-->
+    <string name="ad_unit_id_admob_banner">83cff4cec21148cd820470462f6efeca</string>
+    <string name="ad_unit_id_admob_interstitial">278161384e0445b6a6c2d00596caa006</string>
+    <string name="ad_unit_id_admob_rewarded_video">f7cc70b82da549a09f19a73f83bdbfba</string>
+    <string name="ad_unit_id_admob_native">f3ec720ff0e94a81a5bcd4773e98bab9</string>
+
+    <!--AppLovin-->
+    <string name="ad_unit_id_applovin_banner">3bb1e241a91040d79c4194dd476b9c60</string>
+    <string name="ad_unit_id_applovin_interstitial">d960ac7f90d041c8a4d817726a76a2fa</string>
+    <string name="ad_unit_id_applovin_rewarded_video">b28c982f77dd4c68a9e36ab7a1a87c1a</string>
+
+    <!--Chartboost-->
+    <string name="ad_unit_id_chartboost_interstitial">376366b49d324dedae3d5edb360c27b4</string>
+    <string name="ad_unit_id_chartboost_rewarded_video">df605ab15b56400285c99e521ecc2cb1</string>
+
+    <!--Facebook Audience Network-->
+    <string name="ad_unit_id_fan_banner">b40a96dd275e4ce5be2cdf5faa92007d</string>
+    <string name="ad_unit_id_fan_interstitial">9792d876011f4359887d2d26380e8a84</string>
+    <string name="ad_unit_id_fan_rewarded_video">7220c37b8e93499a8f0aff2eb4f0ad3d</string>
+    <string name="ad_unit_id_fan_native">f97733db27f44defbeb39ce495047779</string>
+
+    <!--Flurry-->
+    <string name="ad_unit_id_flurry_interstitial">716519f41a9144ff9c7afc35b80d6ce8</string>
+    <string name="ad_unit_id_flurry_native">17e0b51cac33483f9890fce08bedfed2</string>
+
+    <!--ironSource-->
+    <string name="ad_unit_id_ironsource_interstitial">9556b7f57e724cb4b5eba926b8258e3c</string>
+    <string name="ad_unit_id_ironsource_rewarded_video">885b4f0c25884d468da2c8d657b0d95b</string>
+
+    <!--Tapjoy-->
+    <string name="ad_unit_id_tapjoy_interstitial">aee78cf481994c67b7e7cb983340a5f3</string>
+    <string name="ad_unit_id_tapjoy_rewarded_video">f2be86b5ae52440a83ef24d426074d2e</string>
+
+    <!--Unity Ads-->
+    <string name="ad_unit_id_unity_interstitial">3db70dc7af6d4fb3ababa860bb4b9062</string>
+    <string name="ad_unit_id_unity_rewarded_video">fa84b7823f4147d883f6bb967f8ef15f</string>
+
+    <!--Verizon-->
+    <string name="ad_unit_id_verizon_banner">cdbdbe29679c442aa9b00c4dd41109a5</string>
+    <string name="ad_unit_id_verizon_interstitial">f655c6e61c67465db58fb0665eb86de7</string>
+
+    <!--Vungle-->
+    <string name="ad_unit_id_vungle_interstitial">5635d28cda6c4dab965b9cf7a99d5af5</string>
+    <string name="ad_unit_id_vungle_rewarded_video">e97347b0a04d417ea178d3ec22766490</string>
+</resources>
diff --git a/mopub-sample/res/layout/ad_unit_list_fragment.xml b/mopub-sample/res/layout/ad_unit_list_fragment.xml
deleted file mode 100644
index 3abcabbe..00000000
--- a/mopub-sample/res/layout/ad_unit_list_fragment.xml
+++ /dev/null
@@ -1,29 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
-    android:layout_width="match_parent"
-    android:layout_height="match_parent"
-    android:orientation="vertical"
-    android:paddingBottom="15dp"
-    android:textDirection="locale">
-
-    <ListView
-        android:id="@android:id/list"
-        android:layout_width="match_parent"
-        android:layout_height="0dp"
-        android:layout_marginBottom="10dp"
-        android:layout_weight="1" />
-
-    <Button
-        android:id="@+id/add_ad_unit_button"
-        android:layout_width="wrap_content"
-        android:layout_height="wrap_content"
-        android:layout_gravity="center_horizontal"
-        android:text="@string/add_ad_unit_button" />
-
-    <TextView
-        android:id="@+id/version_code"
-        android:layout_width="wrap_content"
-        android:layout_height="wrap_content"
-        android:layout_gravity="center_horizontal"
-        android:textSize="@dimen/detail_text_size" />
-</LinearLayout>
diff --git a/mopub-sample/res/main/drawable-hdpi/baseline_cancel_black_36.png b/mopub-sample/res/main/drawable-hdpi/baseline_cancel_black_36.png
new file mode 100755
index 00000000..6df2e3c5
Binary files /dev/null and b/mopub-sample/res/main/drawable-hdpi/baseline_cancel_black_36.png differ
diff --git a/mopub-sample/res/main/drawable-mdpi/baseline_cancel_black_36.png b/mopub-sample/res/main/drawable-mdpi/baseline_cancel_black_36.png
new file mode 100755
index 00000000..8f141bdd
Binary files /dev/null and b/mopub-sample/res/main/drawable-mdpi/baseline_cancel_black_36.png differ
diff --git a/mopub-sample/res/main/drawable-xhdpi/baseline_cancel_black_36.png b/mopub-sample/res/main/drawable-xhdpi/baseline_cancel_black_36.png
new file mode 100755
index 00000000..38c3aa82
Binary files /dev/null and b/mopub-sample/res/main/drawable-xhdpi/baseline_cancel_black_36.png differ
diff --git a/mopub-sample/res/main/drawable-xxhdpi/baseline_cancel_black_36.png b/mopub-sample/res/main/drawable-xxhdpi/baseline_cancel_black_36.png
new file mode 100755
index 00000000..fd11173e
Binary files /dev/null and b/mopub-sample/res/main/drawable-xxhdpi/baseline_cancel_black_36.png differ
diff --git a/mopub-sample/res/main/drawable-xxxhdpi/baseline_cancel_black_36.png b/mopub-sample/res/main/drawable-xxxhdpi/baseline_cancel_black_36.png
new file mode 100755
index 00000000..8d2ff458
Binary files /dev/null and b/mopub-sample/res/main/drawable-xxxhdpi/baseline_cancel_black_36.png differ
diff --git a/mopub-sample/res/main/drawable/baseline_cancel_black_36.png b/mopub-sample/res/main/drawable/baseline_cancel_black_36.png
new file mode 100755
index 00000000..8d2ff458
Binary files /dev/null and b/mopub-sample/res/main/drawable/baseline_cancel_black_36.png differ
diff --git a/mopub-sample/res/drawable/icon.png b/mopub-sample/res/main/drawable/icon.png
similarity index 100%
rename from mopub-sample/res/drawable/icon.png
rename to mopub-sample/res/main/drawable/icon.png
diff --git a/mopub-sample/res/drawable/logo.png b/mopub-sample/res/main/drawable/logo.png
similarity index 100%
rename from mopub-sample/res/drawable/logo.png
rename to mopub-sample/res/main/drawable/logo.png
diff --git a/mopub-sample/res/main/drawable/mopub.png b/mopub-sample/res/main/drawable/mopub.png
new file mode 100644
index 00000000..c85cab32
Binary files /dev/null and b/mopub-sample/res/main/drawable/mopub.png differ
diff --git a/mopub-sample/res/main/drawable/side_nav_bar.xml b/mopub-sample/res/main/drawable/side_nav_bar.xml
new file mode 100644
index 00000000..8ef428d1
--- /dev/null
+++ b/mopub-sample/res/main/drawable/side_nav_bar.xml
@@ -0,0 +1,9 @@
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="rectangle">
+    <gradient
+        android:angle="135"
+        android:centerColor="#009688"
+        android:endColor="#00695C"
+        android:startColor="#4DB6AC"
+        android:type="linear" />
+</shape>
diff --git a/mopub-sample/res/drawable/spacer.png b/mopub-sample/res/main/drawable/spacer.png
similarity index 100%
rename from mopub-sample/res/drawable/spacer.png
rename to mopub-sample/res/main/drawable/spacer.png
diff --git a/mopub-sample/res/main/layout/activity_main.xml b/mopub-sample/res/main/layout/activity_main.xml
new file mode 100644
index 00000000..6d0e6526
--- /dev/null
+++ b/mopub-sample/res/main/layout/activity_main.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<android.support.v4.widget.DrawerLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:id="@+id/drawer_layout"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:fitsSystemWindows="true"
+    tools:openDrawer="start"
+    android:contentDescription="@string/app_name">
+
+    <include
+        layout="@layout/app_bar_main"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent" />
+
+    <android.support.design.widget.NavigationView
+        android:id="@+id/nav_view"
+        android:layout_width="wrap_content"
+        android:layout_height="match_parent"
+        android:layout_gravity="start"
+        android:fitsSystemWindows="true"
+        app:headerLayout="@layout/nav_header_main"
+        app:menu="@menu/activity_main_drawer" />
+
+</android.support.v4.widget.DrawerLayout>
diff --git a/mopub-sample/res/layout/ad_config_dialog.xml b/mopub-sample/res/main/layout/ad_config_dialog.xml
similarity index 100%
rename from mopub-sample/res/layout/ad_config_dialog.xml
rename to mopub-sample/res/main/layout/ad_config_dialog.xml
diff --git a/mopub-sample/res/layout/ad_configuration_list_item.xml b/mopub-sample/res/main/layout/ad_configuration_list_item.xml
similarity index 100%
rename from mopub-sample/res/layout/ad_configuration_list_item.xml
rename to mopub-sample/res/main/layout/ad_configuration_list_item.xml
diff --git a/mopub-sample/res/main/layout/ad_unit_list_fragment.xml b/mopub-sample/res/main/layout/ad_unit_list_fragment.xml
new file mode 100644
index 00000000..c317b243
--- /dev/null
+++ b/mopub-sample/res/main/layout/ad_unit_list_fragment.xml
@@ -0,0 +1,78 @@
+<?xml version="1.0" encoding="utf-8"?>
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:orientation="vertical"
+    android:paddingBottom="8dp"
+    android:textDirection="locale">
+
+    <EditText
+        android:id="@+id/search_bar_et"
+        android:layout_width="match_parent"
+        android:layout_height="50dp"
+        android:layout_alignParentTop="true"
+        android:autofillHints="@string/filter_ads"
+        android:hint="@string/filter_ads"
+        android:imeActionId="6"
+        android:imeOptions="actionDone"
+        android:inputType="text"
+        android:maxLines="1"
+        android:paddingStart="5dp"
+        android:paddingLeft="5dp"
+        android:paddingEnd="38dp"
+        android:paddingRight="38dp" />
+
+    <Button
+        android:id="@+id/search_bar_clear_button"
+        android:layout_width="26dp"
+        android:layout_height="26dp"
+        android:layout_alignEnd="@id/search_bar_et"
+        android:layout_alignRight="@id/search_bar_et"
+        android:layout_marginTop="8dp"
+        android:layout_marginEnd="7dp"
+        android:layout_marginRight="7dp"
+        android:background="@drawable/baseline_cancel_black_36" />
+
+
+    <ListView
+        android:id="@android:id/list"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:layout_above="@id/status_change_notification"
+        android:layout_below="@id/search_bar_et"
+        android:layout_marginBottom="10dp" />
+
+    <EditText
+        android:id="@+id/status_change_notification"
+        style="@android:style/TextAppearance.DeviceDefault.Small.Inverse"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_above="@id/add_ad_unit_button"
+        android:autofillHints="@string/consent_change_status"
+        android:background="@android:color/background_dark"
+        android:focusable="false"
+        android:gravity="center_horizontal"
+        android:hint="@string/consent_change_status"
+        android:inputType="none"
+        android:lines="1"
+        android:maxLines="1"
+        android:visibility="gone"
+        tools:ignore="UnusedAttribute" />
+
+    <Button
+        android:id="@+id/add_ad_unit_button"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_above="@id/version_code"
+        android:layout_centerHorizontal="true"
+        android:text="@string/add_ad_unit_button" />
+
+    <TextView
+        android:id="@+id/version_code"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_alignParentBottom="true"
+        android:layout_centerHorizontal="true"
+        android:textSize="@dimen/detail_text_size" />
+</RelativeLayout>
diff --git a/mopub-sample/res/main/layout/app_bar_main.xml b/mopub-sample/res/main/layout/app_bar_main.xml
new file mode 100644
index 00000000..7f23a338
--- /dev/null
+++ b/mopub-sample/res/main/layout/app_bar_main.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<android.support.design.widget.CoordinatorLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    tools:context=".MoPubSampleActivity">
+
+    <android.support.design.widget.AppBarLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:theme="@style/AppTheme.AppBarOverlay">
+
+        <android.support.v7.widget.Toolbar
+            android:id="@+id/toolbar"
+            android:layout_width="match_parent"
+            android:layout_height="?attr/actionBarSize"
+            android:background="?attr/colorPrimary"
+            app:popupTheme="@style/AppTheme.PopupOverlay" />
+
+    </android.support.design.widget.AppBarLayout>
+
+    <include layout="@layout/main" />
+
+</android.support.design.widget.CoordinatorLayout>
diff --git a/mopub-sample/res/layout/banner_detail_fragment.xml b/mopub-sample/res/main/layout/banner_detail_fragment.xml
similarity index 100%
rename from mopub-sample/res/layout/banner_detail_fragment.xml
rename to mopub-sample/res/main/layout/banner_detail_fragment.xml
diff --git a/mopub-sample/res/main/layout/fragment_impressions_info.xml b/mopub-sample/res/main/layout/fragment_impressions_info.xml
new file mode 100644
index 00000000..2e641f5c
--- /dev/null
+++ b/mopub-sample/res/main/layout/fragment_impressions_info.xml
@@ -0,0 +1,35 @@
+<?xml version="1.0" encoding="utf-8"?>
+<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:id="@+id/infoFragmentId"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+
+    <TextView
+        android:id="@+id/text_no_impressions"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="@string/empty_list"
+        android:textSize="@dimen/sample_text_size"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <android.support.v7.widget.RecyclerView
+        android:id="@+id/impressions_recycler_view"
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toTopOf="@+id/close_btn"
+        app:layout_constraintTop_toTopOf="parent"
+        tools:listitem="@android:layout/simple_selectable_list_item" />
+
+    <Button
+        android:id="@+id/close_btn"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="@string/close"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toStartOf="parent" />
+</android.support.constraint.ConstraintLayout>
diff --git a/mopub-sample/res/layout/interstitial_detail_fragment.xml b/mopub-sample/res/main/layout/interstitial_detail_fragment.xml
similarity index 100%
rename from mopub-sample/res/layout/interstitial_detail_fragment.xml
rename to mopub-sample/res/main/layout/interstitial_detail_fragment.xml
diff --git a/mopub-sample/res/layout/main.xml b/mopub-sample/res/main/layout/main.xml
similarity index 64%
rename from mopub-sample/res/layout/main.xml
rename to mopub-sample/res/main/layout/main.xml
index 620cb5e2..7d499df4 100644
--- a/mopub-sample/res/layout/main.xml
+++ b/mopub-sample/res/main/layout/main.xml
@@ -2,4 +2,5 @@
 <FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
     android:id="@+id/fragment_container"
     android:layout_width="match_parent"
-    android:layout_height="match_parent"></FrameLayout>
+    android:layout_height="match_parent"
+    android:layout_marginTop="?attr/actionBarSize"></FrameLayout>
diff --git a/mopub-sample/res/main/layout/native_ad_fan_list_item.xml b/mopub-sample/res/main/layout/native_ad_fan_list_item.xml
new file mode 100644
index 00000000..e96f0437
--- /dev/null
+++ b/mopub-sample/res/main/layout/native_ad_fan_list_item.xml
@@ -0,0 +1,89 @@
+<?xml version="1.0" encoding="utf-8"?>
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/native_outer_view"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:background="@android:color/white"
+    android:textDirection="locale">
+
+    <com.facebook.ads.AdIconView
+        android:id="@+id/native_icon"
+        android:layout_width="64dp"
+        android:layout_height="64dp"
+        android:layout_alignParentLeft="true"
+        android:layout_alignParentStart="true"
+        android:layout_alignParentTop="true"
+        android:layout_marginLeft="10dp"
+        android:layout_marginStart="10dp"
+        android:layout_marginTop="10dp"
+        android:background="@null" />
+
+    <TextView
+        android:id="@+id/native_title"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_alignParentLeft="true"
+        android:layout_alignParentStart="true"
+        android:layout_alignParentTop="true"
+        android:layout_marginLeft="84dp"
+        android:layout_marginStart="84dp"
+        android:layout_marginTop="32dp"
+        android:textColor="@android:color/darker_gray"
+        android:textStyle="bold" />
+
+    <TextView
+        android:id="@+id/native_text"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_alignParentLeft="true"
+        android:layout_alignParentStart="true"
+        android:layout_below="@+id/native_icon"
+        android:layout_marginLeft="10dp"
+        android:layout_marginStart="10dp"
+        android:layout_marginTop="10dp"
+        android:textColor="@android:color/darker_gray" />
+
+
+    <com.facebook.ads.MediaView
+        android:id="@+id/native_media_view"
+        android:layout_width="match_parent"
+        android:layout_height="@dimen/native_main_image_height"
+        android:layout_alignParentLeft="true"
+        android:layout_alignParentStart="true"
+        android:layout_below="@+id/native_text"
+        android:layout_marginLeft="10dp"
+        android:layout_marginRight="10dp"
+        android:layout_marginTop="10dp"
+        android:background="@null"
+        android:contentDescription="@string/native_main_image"
+        android:scaleType="centerCrop" />
+
+    <Button
+        android:id="@+id/native_cta"
+        android:layout_width="wrap_content"
+        android:layout_height="35dp"
+        android:layout_alignParentEnd="true"
+        android:layout_alignParentRight="true"
+        android:layout_below="@+id/native_media_view"
+        android:layout_marginEnd="10dp"
+        android:layout_marginRight="10dp"
+        android:layout_marginTop="10dp"
+        android:clickable="true"
+        android:focusable="true"
+        android:paddingBottom="10dp"
+        android:text="@string/learn_more"
+        android:textColor="@android:color/black"
+        android:textSize="12sp"
+        android:textStyle="bold" />
+
+    <RelativeLayout
+        android:id="@+id/native_privacy_information_icon_layout"
+        android:layout_width="100dp"
+        android:layout_height="40dp"
+        android:layout_alignParentEnd="true"
+        android:layout_alignParentRight="true"
+        android:layout_alignParentTop="true"
+        android:contentDescription="@string/native_privacy_information_icon_image"
+        android:padding="10dp" />
+
+</RelativeLayout>
diff --git a/mopub-sample/res/main/layout/native_ad_flurry_list_item.xml b/mopub-sample/res/main/layout/native_ad_flurry_list_item.xml
new file mode 100644
index 00000000..096064be
--- /dev/null
+++ b/mopub-sample/res/main/layout/native_ad_flurry_list_item.xml
@@ -0,0 +1,117 @@
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/flurry_native_outer_view"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:background="@android:color/white">
+
+    <ImageView
+        android:id="@+id/flurry_native_icon_image"
+        android:layout_width="64dp"
+        android:layout_height="64dp"
+        android:layout_alignParentStart="true"
+        android:layout_alignParentLeft="true"
+        android:layout_alignParentTop="true"
+        android:layout_marginStart="10dp"
+        android:layout_marginLeft="10dp"
+        android:layout_marginTop="10dp"
+        android:background="@null" />
+
+    <TextView
+        android:id="@+id/flurry_native_title"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_alignParentStart="true"
+        android:layout_alignParentLeft="true"
+        android:layout_alignParentTop="true"
+        android:layout_marginStart="84dp"
+        android:layout_marginLeft="84dp"
+        android:layout_marginTop="32dp"
+        android:textColor="@android:color/darker_gray"
+        android:textStyle="bold" />
+
+    <ImageView
+        android:id="@+id/flurry_star_rating_image"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_below="@+id/flurry_native_title"
+        android:layout_marginStart="84dp"
+        android:layout_marginLeft="84dp" />
+
+    <TextView
+        android:id="@+id/flurry_app_category"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_below="@+id/flurry_star_rating_image"
+        android:layout_marginStart="84dp"
+        android:layout_marginLeft="84dp"
+        android:textColor="@android:color/black" />
+
+    <TextView
+        android:id="@+id/flurry_native_text"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_below="@+id/flurry_native_icon_image"
+        android:layout_alignParentStart="true"
+        android:layout_alignParentLeft="true"
+        android:layout_marginStart="10dp"
+        android:layout_marginLeft="10dp"
+        android:layout_marginTop="10dp"
+        android:textColor="@android:color/darker_gray" />
+
+    <ImageView
+        android:id="@+id/flurry_native_main_image"
+        android:layout_width="match_parent"
+        android:layout_height="@dimen/native_main_image_height"
+        android:layout_below="@+id/flurry_native_text"
+        android:layout_alignParentStart="true"
+        android:layout_alignParentLeft="true"
+        android:layout_marginLeft="10dp"
+        android:layout_marginTop="10dp"
+        android:layout_marginRight="10dp"
+        android:background="@null"
+        android:contentDescription="@string/native_main_image"
+        android:scaleType="centerCrop" />
+
+    <FrameLayout
+        android:id="@+id/flurry_native_video_view"
+        android:layout_width="match_parent"
+        android:layout_height="@dimen/native_main_image_height"
+        android:layout_below="@+id/flurry_native_text"
+        android:layout_alignParentStart="true"
+        android:layout_alignParentLeft="true"
+        android:layout_marginLeft="10dp"
+        android:layout_marginTop="10dp"
+        android:layout_marginRight="10dp"
+        android:contentDescription="@string/native_main_image"
+        android:scaleType="centerCrop" />
+
+    <ImageView
+        android:id="@+id/flurry_native_brand_logo"
+        android:layout_width="20dp"
+        android:layout_height="20dp"
+        android:layout_below="@+id/flurry_native_main_image"
+        android:layout_marginLeft="10dp"
+        android:layout_marginTop="15dp"
+        android:layout_marginEnd="10dp"
+        android:layout_marginRight="10dp"
+        android:scaleType="fitXY" />
+
+    <Button
+        android:id="@+id/flurry_native_cta"
+        android:layout_width="wrap_content"
+        android:layout_height="35dp"
+        android:layout_below="@+id/flurry_native_main_image"
+        android:layout_alignParentEnd="true"
+        android:layout_alignParentRight="true"
+        android:layout_marginTop="10dp"
+        android:layout_marginEnd="10dp"
+        android:layout_marginRight="10dp"
+        android:clickable="true"
+        android:focusable="true"
+        android:paddingBottom="10dp"
+        android:text="@string/learn_more"
+        android:textColor="@android:color/black"
+        android:textSize="12sp"
+        android:textStyle="bold" />
+
+</RelativeLayout>
diff --git a/mopub-sample/res/layout/native_ad_list_item.xml b/mopub-sample/res/main/layout/native_ad_list_item.xml
similarity index 100%
rename from mopub-sample/res/layout/native_ad_list_item.xml
rename to mopub-sample/res/main/layout/native_ad_list_item.xml
diff --git a/mopub-sample/res/layout/native_gallery_content.xml b/mopub-sample/res/main/layout/native_gallery_content.xml
similarity index 100%
rename from mopub-sample/res/layout/native_gallery_content.xml
rename to mopub-sample/res/main/layout/native_gallery_content.xml
diff --git a/mopub-sample/res/layout/native_gallery_fragment.xml b/mopub-sample/res/main/layout/native_gallery_fragment.xml
similarity index 100%
rename from mopub-sample/res/layout/native_gallery_fragment.xml
rename to mopub-sample/res/main/layout/native_gallery_fragment.xml
diff --git a/mopub-sample/res/layout/native_list_view_fragment.xml b/mopub-sample/res/main/layout/native_list_view_fragment.xml
similarity index 100%
rename from mopub-sample/res/layout/native_list_view_fragment.xml
rename to mopub-sample/res/main/layout/native_list_view_fragment.xml
diff --git a/mopub-sample/res/main/layout/nav_header_main.xml b/mopub-sample/res/main/layout/nav_header_main.xml
new file mode 100644
index 00000000..2269c832
--- /dev/null
+++ b/mopub-sample/res/main/layout/nav_header_main.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="@dimen/nav_header_height"
+    android:background="@drawable/side_nav_bar"
+    android:gravity="bottom"
+    android:orientation="vertical"
+    android:theme="@style/ThemeOverlay.AppCompat.Dark">
+
+    <ImageView
+        android:id="@+id/image_mopub_logo"
+        android:layout_width="wrap_content"
+        android:layout_height="70dp"
+        android:layout_marginBottom="@dimen/nav_header_vertical_spacing"
+        android:scaleType="centerInside"
+        app:srcCompat="@drawable/mopub"
+        android:contentDescription="@string/mopub_logo_descr" />
+
+    <TextView
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="@string/nav_header_title"
+        android:layout_marginBottom="@dimen/nav_header_vertical_spacing"
+        android:textAppearance="@style/TextAppearance.AppCompat.Body1" />
+
+</LinearLayout>
diff --git a/mopub-sample/res/main/layout/networks_info_fragment.xml b/mopub-sample/res/main/layout/networks_info_fragment.xml
new file mode 100644
index 00000000..7dfcb346
--- /dev/null
+++ b/mopub-sample/res/main/layout/networks_info_fragment.xml
@@ -0,0 +1,36 @@
+<?xml version="1.0" encoding="utf-8"?>
+<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:id="@+id/networksFragmentId"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+
+    <TextView
+        android:id="@+id/text_no_adapters"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="@string/no_network_adapters_found"
+        android:textSize="@dimen/sample_text_size"
+        app:layout_constraintBottom_toTopOf="@id/networks_close_btn"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <android.support.v7.widget.RecyclerView
+        android:id="@+id/networks_recycler_view"
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toTopOf="@+id/networks_close_btn"
+        app:layout_constraintTop_toTopOf="parent"
+        tools:listitem="@android:layout/simple_selectable_list_item" />
+
+    <Button
+        android:id="@+id/networks_close_btn"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="@string/close"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintEnd_toEndOf="@id/networks_recycler_view"
+        app:layout_constraintStart_toStartOf="@+id/networks_recycler_view" />
+</android.support.constraint.ConstraintLayout>
diff --git a/mopub-sample/res/main/layout/privacy_info_divider.xml b/mopub-sample/res/main/layout/privacy_info_divider.xml
new file mode 100644
index 00000000..4db5df38
--- /dev/null
+++ b/mopub-sample/res/main/layout/privacy_info_divider.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:background="@color/colorLightGreay">
+
+    <TextView
+        android:id="@+id/text_divider"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_marginStart="16dp"
+        android:layout_marginLeft="16dp"
+        android:layout_marginTop="16dp"
+        android:layout_marginBottom="8dp"
+        android:fontFamily="sans-serif-medium"
+        android:textAllCaps="true"
+        android:textSize="15sp"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="parent"
+        tools:text="@tools:sample/full_names" />
+
+</android.support.constraint.ConstraintLayout>
diff --git a/mopub-sample/res/main/layout/privacy_info_fragment.xml b/mopub-sample/res/main/layout/privacy_info_fragment.xml
new file mode 100644
index 00000000..ea9b5cd9
--- /dev/null
+++ b/mopub-sample/res/main/layout/privacy_info_fragment.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:id="@+id/privacyFrarmentId"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+
+    <android.support.v7.widget.RecyclerView
+        android:id="@+id/privacy_recycler_view"
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toTopOf="@+id/privacy_close_btn"
+        app:layout_constraintTop_toTopOf="parent"
+        tools:listitem="@layout/privacy_info_item" />
+
+    <Button
+        android:id="@+id/privacy_close_btn"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="@string/close"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintEnd_toEndOf="@id/privacy_recycler_view"
+        app:layout_constraintStart_toStartOf="@+id/privacy_recycler_view" />
+</android.support.constraint.ConstraintLayout>
diff --git a/mopub-sample/res/main/layout/privacy_info_item.xml b/mopub-sample/res/main/layout/privacy_info_item.xml
new file mode 100644
index 00000000..94d3c3e5
--- /dev/null
+++ b/mopub-sample/res/main/layout/privacy_info_item.xml
@@ -0,0 +1,43 @@
+<?xml version="1.0" encoding="utf-8"?>
+<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:padding="8dp">
+
+    <TextView
+        android:id="@+id/privacy_title_view"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_margin="4dp"
+        android:textColor="@color/textDark"
+        android:textSize="16sp"
+        app:layout_constraintBottom_toTopOf="@+id/privacy_desc_view"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="parent"
+        tools:text="@tools:sample/full_names" />
+
+    <TextView
+        android:id="@+id/privacy_desc_view"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_marginStart="4dp"
+        android:layout_marginLeft="4dp"
+        android:layout_marginBottom="4dp"
+        android:textColor="@color/textDark"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toBottomOf="@+id/privacy_title_view"
+        tools:text="@tools:sample/lorem[4:10]" />
+
+    <TextView
+        android:id="@+id/privacy_value_view"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_margin="8dp"
+        android:textColor="@color/textDark"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintTop_toTopOf="parent"
+        tools:text="@tools:sample/date/hhmm" />
+</android.support.constraint.ConstraintLayout>
diff --git a/mopub-sample/res/layout/recycler_view_fragment.xml b/mopub-sample/res/main/layout/recycler_view_fragment.xml
similarity index 100%
rename from mopub-sample/res/layout/recycler_view_fragment.xml
rename to mopub-sample/res/main/layout/recycler_view_fragment.xml
diff --git a/mopub-sample/res/layout/video_ad_list_item.xml b/mopub-sample/res/main/layout/video_ad_list_item.xml
similarity index 100%
rename from mopub-sample/res/layout/video_ad_list_item.xml
rename to mopub-sample/res/main/layout/video_ad_list_item.xml
diff --git a/mopub-sample/res/main/menu/activity_main_drawer.xml b/mopub-sample/res/main/menu/activity_main_drawer.xml
new file mode 100644
index 00000000..32f2cbe2
--- /dev/null
+++ b/mopub-sample/res/main/menu/activity_main_drawer.xml
@@ -0,0 +1,58 @@
+<?xml version="1.0" encoding="utf-8"?>
+<menu xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
+    tools:showIn="navigation_view">
+
+    <item android:title="@string/api_endpoint">
+        <menu>
+            <group android:checkableBehavior="single">
+                <item
+                    android:id="@+id/nav_production"
+                    android:checkable="true"
+                    android:icon="@drawable/ic_menu_slideshow"
+                    android:title="@string/production" />
+                <item
+                    android:id="@+id/nav_staging"
+                    android:checkable="true"
+                    android:icon="@drawable/ic_menu_manage"
+                    android:title="@string/staging" />
+            </group>
+        </menu>
+    </item>
+
+    <item android:title="@string/privacy">
+        <menu>
+            <item
+                android:id="@+id/nav_privacy_info"
+                android:icon="@drawable/ic_menu_adapters"
+                android:title="@string/information" />
+            <group android:checkableBehavior="single">
+                <item
+                    android:id="@+id/nav_privacy_grant"
+                    android:checkable="true"
+                    android:icon="@drawable/ic_menu_lock"
+                    android:title="@string/grant_consent" />
+                <item
+                    android:id="@+id/nav_privacy_revoke"
+                    android:checkable="true"
+                    android:icon="@drawable/ic_menu_unlock"
+                    android:title="@string/revoke_consent" />
+            </group>
+            <item
+                android:id="@+id/nav_force_gdpr"
+                android:checkable="true"
+                android:icon="@drawable/ic_menu_info"
+                android:title="@string/force_gdpr_applicable" />
+        </menu>
+    </item>
+
+    <item android:title="@string/info">
+        <menu>
+            <item
+                android:id="@+id/nav_adapters_info"
+                android:icon="@drawable/ic_menu_adapters"
+                android:title="@string/network_adapters" />
+        </menu>
+    </item>
+
+</menu>
diff --git a/mopub-sample/res/main/menu/main.xml b/mopub-sample/res/main/menu/main.xml
new file mode 100644
index 00000000..966d6451
--- /dev/null
+++ b/mopub-sample/res/main/menu/main.xml
@@ -0,0 +1,15 @@
+<?xml version="1.0" encoding="utf-8"?>
+<menu xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item
+        android:id="@+id/action_impressions"
+        android:orderInCategory="100"
+        android:title="@string/impressions_text"
+        app:showAsAction="never" />
+
+    <item
+        android:id="@+id/action_clear_logs"
+        android:orderInCategory="101"
+        android:title="@string/clear_logs"
+        app:showAsAction="never" />
+</menu>
diff --git a/mopub-sample/res/values-sw400dp/dimens.xml b/mopub-sample/res/main/values-sw400dp/dimens.xml
similarity index 100%
rename from mopub-sample/res/values-sw400dp/dimens.xml
rename to mopub-sample/res/main/values-sw400dp/dimens.xml
diff --git a/mopub-sample/res/values-sw600dp/dimens.xml b/mopub-sample/res/main/values-sw600dp/dimens.xml
similarity index 100%
rename from mopub-sample/res/values-sw600dp/dimens.xml
rename to mopub-sample/res/main/values-sw600dp/dimens.xml
diff --git a/mopub-sample/res/values-sw800dp/dimens.xml b/mopub-sample/res/main/values-sw800dp/dimens.xml
similarity index 100%
rename from mopub-sample/res/values-sw800dp/dimens.xml
rename to mopub-sample/res/main/values-sw800dp/dimens.xml
diff --git a/mopub-sample/res/main/values-v21/styles.xml b/mopub-sample/res/main/values-v21/styles.xml
new file mode 100644
index 00000000..fd7a0584
--- /dev/null
+++ b/mopub-sample/res/main/values-v21/styles.xml
@@ -0,0 +1,8 @@
+<resources>
+
+    <style name="AppTheme.NoActionBar">
+        <item name="windowActionBar">false</item>
+        <item name="windowNoTitle">true</item>
+        <item name="android:statusBarColor">@android:color/transparent</item>
+    </style>
+</resources>
diff --git a/mopub-sample/res/main/values-v28/styles.xml b/mopub-sample/res/main/values-v28/styles.xml
new file mode 100644
index 00000000..a434e28e
--- /dev/null
+++ b/mopub-sample/res/main/values-v28/styles.xml
@@ -0,0 +1,8 @@
+<resources>
+    <style name="AppTheme.NoActionBar">
+        <item name="windowActionBar">false</item>
+        <item name="windowNoTitle">true</item>
+        <item name="android:statusBarColor">@android:color/transparent</item>
+        <item name="android:windowLayoutInDisplayCutoutMode">never</item>
+    </style>
+</resources>
diff --git a/mopub-sample/res/main/values/colors.xml b/mopub-sample/res/main/values/colors.xml
new file mode 100644
index 00000000..b81dd08e
--- /dev/null
+++ b/mopub-sample/res/main/values/colors.xml
@@ -0,0 +1,10 @@
+<?xml version="1.0" encoding="utf-8"?>
+<resources>
+    <color name="colorPrimary">#008577</color>
+    <color name="colorPrimaryDark">#00574B</color>
+    <color name="colorAccent">#FF40C4FF</color>
+    <color name="colorLightGreay">#46cccccc</color>
+    <color name="textDark">#ff070707</color>
+    <color name="listLight">#ffffffff</color>
+    <color name="listDark">#fff2f2f2</color>
+</resources>
diff --git a/mopub-sample/res/values/dimens.xml b/mopub-sample/res/main/values/dimens.xml
similarity index 71%
rename from mopub-sample/res/values/dimens.xml
rename to mopub-sample/res/main/values/dimens.xml
index 75ede747..403f81f7 100644
--- a/mopub-sample/res/values/dimens.xml
+++ b/mopub-sample/res/main/values/dimens.xml
@@ -13,4 +13,10 @@
     <dimen name="leaderboard_height">90dp</dimen>
     <dimen name="skyscraper_width">160dp</dimen>
     <dimen name="skyscraper_height">600dp</dimen>
-</resources>
\ No newline at end of file
+
+    <!-- Navigation dimensions -->
+    <dimen name="activity_horizontal_margin">16dp</dimen>
+    <dimen name="activity_vertical_margin">16dp</dimen>
+    <dimen name="nav_header_vertical_spacing">8dp</dimen>
+    <dimen name="nav_header_height">176dp</dimen>
+</resources>
diff --git a/mopub-sample/res/main/values/drawables.xml b/mopub-sample/res/main/values/drawables.xml
new file mode 100644
index 00000000..1e963693
--- /dev/null
+++ b/mopub-sample/res/main/values/drawables.xml
@@ -0,0 +1,8 @@
+<resources xmlns:android="http://schemas.android.com/apk/res/android">
+    <item name="ic_menu_unlock" type="drawable">@android:drawable/ic_lock_idle_lock</item>
+    <item name="ic_menu_lock" type="drawable">@android:drawable/ic_lock_lock</item>
+    <item name="ic_menu_slideshow" type="drawable">@android:drawable/ic_menu_slideshow</item>
+    <item name="ic_menu_manage" type="drawable">@android:drawable/ic_menu_manage</item>
+    <item name="ic_menu_adapters" type="drawable">@android:drawable/ic_menu_info_details</item>
+    <item name="ic_menu_info" type="drawable">@android:drawable/ic_dialog_info</item>
+</resources>
diff --git a/mopub-sample/res/values/strings.xml b/mopub-sample/res/main/values/strings.xml
similarity index 50%
rename from mopub-sample/res/values/strings.xml
rename to mopub-sample/res/main/values/strings.xml
index 44afbbb6..48695da3 100644
--- a/mopub-sample/res/values/strings.xml
+++ b/mopub-sample/res/main/values/strings.xml
@@ -28,4 +28,36 @@
     <string name="ad_unit_id_rewarded_rich_media">a96ae2ef41d44822af45c6328c4e1eb1</string>
     <string name="ad_unit_id_native">11a17b188668469fb0412708c3d16813</string>
     <string name="swipe_text"><![CDATA[< Swipe Left & Right >]]></string>
+
+    <string name="navigation_drawer_open">Open navigation drawer</string>
+    <string name="navigation_drawer_close">Close navigation drawer</string>
+    <string name="nav_header_title">MoPub Sample App</string>
+    <string name="nav_header_subtitle">android.studio@android.com</string>
+    <string name="nav_header_desc">Navigation header</string>
+    <string name="action_settings">Settings</string>
+    <string name="consent_whitelisted">Consent changed to Potentially whitelisted</string>
+    <string name="consent_denied">Consent changed to Denied</string>
+    <string name="close">Close</string>
+    <string name="no_network_adapters_found">No network adapters found</string>
+    <string name="mopub_logo_descr">Mopub logo</string>
+    <string name="consent_change_status">Consent change status</string>
+    <string name="donottrack_text">Do Not Track is on</string>
+    <string name="api_endpoint">API ENDPOINT</string>
+    <string name="production">Production</string>
+    <string name="staging">Staging</string>
+    <string name="privacy">PRIVACY</string>
+    <string name="information">Information</string>
+    <string name="grant_consent">Grant Consent</string>
+    <string name="revoke_consent">Revoke Consent</string>
+    <string name="force_gdpr_applicable">Force GDPR Applicable</string>
+    <string name="info">INFO</string>
+    <string name="network_adapters">Network Adapters</string>
+    <string name="pim_is_not_available">getPersonalInformationManager() returned null</string>
+    <string name="list_fragment_not_found">Can\'t find MoPubListFragment.</string>
+    <string name="filter_ads">Filter ads</string>
+    <string name="impressions_text">Impressions</string>
+    <string name="clear_logs">Clear logs</string>
+    <string name="empty_list">Empty list</string>
+    <string name="share_impression">Share Impression</string>
+
 </resources>
diff --git a/mopub-sample/res/main/values/styles.xml b/mopub-sample/res/main/values/styles.xml
new file mode 100644
index 00000000..545b9c6d
--- /dev/null
+++ b/mopub-sample/res/main/values/styles.xml
@@ -0,0 +1,20 @@
+<resources>
+
+    <!-- Base application theme. -->
+    <style name="AppTheme" parent="Theme.AppCompat.Light.DarkActionBar">
+        <!-- Customize your theme here. -->
+        <item name="colorPrimary">@color/colorPrimary</item>
+        <item name="colorPrimaryDark">@color/colorPrimaryDark</item>
+        <item name="colorAccent">@color/colorAccent</item>
+    </style>
+
+    <style name="AppTheme.NoActionBar">
+        <item name="windowActionBar">false</item>
+        <item name="windowNoTitle">true</item>
+    </style>
+
+    <style name="AppTheme.AppBarOverlay" parent="ThemeOverlay.AppCompat.Dark.ActionBar" />
+
+    <style name="AppTheme.PopupOverlay" parent="ThemeOverlay.AppCompat.Light" />
+
+</resources>
diff --git a/mopub-sample/res/xml/network_security_config.xml b/mopub-sample/res/main/xml/network_security_config.xml
similarity index 100%
rename from mopub-sample/res/xml/network_security_config.xml
rename to mopub-sample/res/main/xml/network_security_config.xml
diff --git a/mopub-sample/src/external/java/com/mopub/simpleadsdemo/SampleAppDefaultAdUnits.java b/mopub-sample/src/external/java/com/mopub/simpleadsdemo/SampleAppDefaultAdUnits.java
new file mode 100644
index 00000000..1aa53bb5
--- /dev/null
+++ b/mopub-sample/src/external/java/com/mopub/simpleadsdemo/SampleAppDefaultAdUnits.java
@@ -0,0 +1,59 @@
+package com.mopub.simpleadsdemo;
+
+import android.content.Context;
+import android.support.annotation.NonNull;
+
+import com.mopub.common.Preconditions;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.BANNER;
+import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.CUSTOM_NATIVE;
+import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.INTERSTITIAL;
+import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.LEADERBOARD;
+import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.LIST_VIEW;
+import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.MRECT;
+import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.RECYCLER_VIEW;
+import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.REWARDED_VIDEO;
+
+enum SampleAppDefaultAdUnits {
+    SAMPLE_BANNER(R.string.ad_unit_id_banner, BANNER, "MoPub Banner Sample"),
+    SAMPLE_MRECT(R.string.ad_unit_id_mrect, MRECT, "MoPub Mrect Sample"),
+    SAMPLE_LEADERBOARD(R.string.ad_unit_id_leaderboard, LEADERBOARD, "MoPub Leaderboard Sample"),
+    SAMPLE_INTERSTITIAL(R.string.ad_unit_id_interstitial, INTERSTITIAL,
+            "MoPub Interstitial Sample"),
+    SAMPLE_REWARDED_VIDEO(R.string.ad_unit_id_rewarded_video, REWARDED_VIDEO,
+            "MoPub Rewarded Video Sample"),
+    SAMPLE_REWARDED_RICH_MEDIA(R.string.ad_unit_id_rewarded_rich_media, REWARDED_VIDEO,
+            "MoPub Rewarded Rich Media Sample"),
+    SAMPLE_NATIVE_LIST_VIEW(R.string.ad_unit_id_native, LIST_VIEW, "MoPub Ad Placer Sample"),
+    SAMPLE_NATIVE_RECYCLER_VIEW(R.string.ad_unit_id_native, RECYCLER_VIEW,
+            "MoPub Recycler View Sample"),
+    SAMPLE_NATIVE_VIEW_PAGER(R.string.ad_unit_id_native, CUSTOM_NATIVE, "MoPub View Pager Sample");
+
+    private int mAdUnitIdStringKey;
+    @NonNull private MoPubSampleAdUnit.AdType mAdType;
+    @NonNull private String mDescription;
+
+    SampleAppDefaultAdUnits(final int adUnitIdStringKey,
+            @NonNull final MoPubSampleAdUnit.AdType adType, @NonNull final String description) {
+        mAdUnitIdStringKey = adUnitIdStringKey;
+        mAdType = adType;
+        mDescription = description;
+    }
+
+    static List<MoPubSampleAdUnit> getDefaultAdUnits(@NonNull final Context context) {
+        Preconditions.checkNotNull(context);
+
+        final List<MoPubSampleAdUnit> adUnitList = new ArrayList<>();
+        for (SampleAppDefaultAdUnits adUnit : SampleAppDefaultAdUnits.values()) {
+            adUnitList.add(
+                    new com.mopub.simpleadsdemo.MoPubSampleAdUnit
+                            .Builder(context.getString(adUnit.mAdUnitIdStringKey), adUnit.mAdType)
+                            .description(adUnit.mDescription)
+                            .build());
+        }
+        return adUnitList;
+    }
+}
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/AdUnitDataSource.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/AdUnitDataSource.java
index c6aa5073..03f42e39 100644
--- a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/AdUnitDataSource.java
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/AdUnitDataSource.java
@@ -25,14 +25,6 @@
 import static com.mopub.simpleadsdemo.MoPubSQLiteHelper.COLUMN_USER_GENERATED;
 import static com.mopub.simpleadsdemo.MoPubSQLiteHelper.TABLE_AD_CONFIGURATIONS;
 import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType;
-import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.BANNER;
-import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.CUSTOM_NATIVE;
-import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.INTERSTITIAL;
-import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.LEADERBOARD;
-import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.LIST_VIEW;
-import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.MRECT;
-import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.RECYCLER_VIEW;
-import static com.mopub.simpleadsdemo.MoPubSampleAdUnit.AdType.REWARDED_VIDEO;
 
 class AdUnitDataSource {
     private Context mContext;
@@ -129,65 +121,14 @@ private void deleteAllAdUnitsWithAdUnitIdAndAdType(@NonNull final String adUnitI
         return adConfigurations;
     }
 
-    List<MoPubSampleAdUnit> getDefaultAdUnits() {
-        final List<MoPubSampleAdUnit> adUnitList = new ArrayList<>();
-        adUnitList.add(
-                new MoPubSampleAdUnit
-                        .Builder(mContext.getString(R.string.ad_unit_id_banner), BANNER)
-                        .description("MoPub Banner Sample")
-                        .build());
-        adUnitList.add(
-                new MoPubSampleAdUnit
-                        .Builder(mContext.getString(R.string.ad_unit_id_mrect), MRECT)
-                        .description("MoPub Mrect Sample")
-                        .build());
-        adUnitList.add(
-                new MoPubSampleAdUnit
-                        .Builder(mContext.getString(R.string.ad_unit_id_leaderboard), LEADERBOARD)
-                        .description("MoPub Leaderboard Sample")
-                        .build());
-        adUnitList.add(
-                new MoPubSampleAdUnit
-                        .Builder(mContext.getString(R.string.ad_unit_id_interstitial), INTERSTITIAL)
-                        .description("MoPub Interstitial Sample")
-                        .build());
-        adUnitList.add(
-                new MoPubSampleAdUnit
-                        .Builder(mContext.getString(R.string.ad_unit_id_rewarded_video),
-                        REWARDED_VIDEO)
-                        .description("MoPub Rewarded Video Sample")
-                        .build());
-        adUnitList.add(
-                new MoPubSampleAdUnit
-                        .Builder(mContext.getString(R.string.ad_unit_id_rewarded_rich_media),
-                        REWARDED_VIDEO)
-                        .description("MoPub Rewarded Rich Media Sample")
-                        .build());
-        adUnitList.add(
-                new MoPubSampleAdUnit
-                        .Builder(mContext.getString(R.string.ad_unit_id_native), LIST_VIEW)
-                        .description("MoPub Ad Placer Sample")
-                        .build());
-        adUnitList.add(
-                new MoPubSampleAdUnit
-                        .Builder(mContext.getString(R.string.ad_unit_id_native), RECYCLER_VIEW)
-                        .description("MoPub Recycler View Sample")
-                        .build());
-        adUnitList.add(
-                new MoPubSampleAdUnit
-                        .Builder(mContext.getString(R.string.ad_unit_id_native), CUSTOM_NATIVE)
-                        .description("MoPub View Pager Sample")
-                        .build());
-        return adUnitList;
-    }
-
     private void populateDefaultSampleAdUnits() {
         final HashSet<MoPubSampleAdUnit> allAdUnits = new HashSet<>();
         for (final MoPubSampleAdUnit adUnit : getAllAdUnits()) {
             allAdUnits.add(adUnit);
         }
 
-        for (final MoPubSampleAdUnit defaultAdUnit : getDefaultAdUnits()) {
+        for (final MoPubSampleAdUnit defaultAdUnit :
+                SampleAppDefaultAdUnits.getDefaultAdUnits(mContext)) {
             if (!allAdUnits.contains(defaultAdUnit)) {
                 createDefaultSampleAdUnit(defaultAdUnit);
             }
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/ImpressionsInfoFragment.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/ImpressionsInfoFragment.java
new file mode 100644
index 00000000..c15eec16
--- /dev/null
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/ImpressionsInfoFragment.java
@@ -0,0 +1,180 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.simpleadsdemo;
+
+import android.app.Activity;
+import android.content.Context;
+import android.content.Intent;
+import android.os.Bundle;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+import android.support.v4.app.Fragment;
+import android.support.v7.widget.DividerItemDecoration;
+import android.support.v7.widget.LinearLayoutManager;
+import android.support.v7.widget.RecyclerView;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.Button;
+import android.widget.TextView;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import static android.support.v7.widget.DividerItemDecoration.VERTICAL;
+import static android.view.ViewGroup.FOCUS_AFTER_DESCENDANTS;
+
+/**
+ * A simple {@link Fragment} subclass.
+ * Use the {@link ImpressionsInfoFragment#newInstance} factory method to
+ * create an instance of this fragment.
+ */
+public class ImpressionsInfoFragment extends Fragment {
+    private static final String ARG_IMPRESSIONS_LIST = "list_of_impressions";
+
+    @Nullable
+    private ImpressionsInfoAdapter adapter;
+    private View fragmentView;
+
+    public ImpressionsInfoFragment() {
+    }
+
+    /**
+     * Use this factory method to create a new instance of
+     * this fragment using the provided parameter.
+     *
+     * @param impressions - list of impressions.
+     * @return A new instance of fragment ImpressionsInfoFragment.
+     */
+    public static ImpressionsInfoFragment newInstance(@NonNull ArrayList<String> impressions) {
+        final ImpressionsInfoFragment fragment = new ImpressionsInfoFragment();
+        final Bundle args = new Bundle();
+        args.putStringArrayList(ARG_IMPRESSIONS_LIST, impressions);
+        fragment.setArguments(args);
+        return fragment;
+    }
+
+    @Override
+    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
+                             Bundle savedInstanceState) {
+        ArrayList<String> impressionsList = null;
+        if (getArguments() != null) {
+            impressionsList = getArguments().getStringArrayList(ARG_IMPRESSIONS_LIST);
+        }
+
+        // Inflate the layout for this fragment
+        fragmentView = inflater.inflate(R.layout.fragment_impressions_info, container, false);
+
+        final RecyclerView recyclerView = fragmentView.findViewById(R.id.impressions_recycler_view);
+        recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
+        adapter = new ImpressionsInfoAdapter(container.getContext(), impressionsList);
+        recyclerView.setAdapter(adapter);
+        recyclerView.addItemDecoration(new DividerItemDecoration(recyclerView.getContext(), VERTICAL));
+        recyclerView.setDescendantFocusability(FOCUS_AFTER_DESCENDANTS);
+
+        if (adapter.stringList.size() > 0) {
+            fragmentView.findViewById(R.id.text_no_impressions).setVisibility(View.GONE);
+        }
+
+        final Button closeButton = fragmentView.findViewById(R.id.close_btn);
+        closeButton.setOnClickListener(new View.OnClickListener() {
+            @Override
+            public void onClick(View v) {
+                final Activity activity = getActivity();
+                if (activity != null) {
+                    activity.onBackPressed();
+                }
+            }
+        });
+
+        return fragmentView;
+    }
+
+    void onClear() {
+        fragmentView.findViewById(R.id.text_no_impressions).setVisibility(View.VISIBLE);
+        if (adapter != null) {
+            adapter.stringList.clear();
+            adapter.notifyDataSetChanged();
+        }
+    }
+
+    /**
+     * RecyclerView adapter for the impression data list
+     */
+    static class ImpressionsInfoAdapter extends RecyclerView.Adapter<ImpressionsInfoAdapter.ImpressionsViewHolder> {
+        private final int mBackgroundLight;
+        private final int mBackgroundDark;
+
+        @NonNull
+        final List<String> stringList;
+
+        ImpressionsInfoAdapter(@NonNull final Context context, @Nullable final List<String> list) {
+            mBackgroundDark = context.getResources().getColor(R.color.listDark);
+            mBackgroundLight = context.getResources().getColor(R.color.listLight);
+
+            if (list != null) {
+                stringList = list;
+            } else {
+                stringList = new ArrayList<>();
+            }
+        }
+
+        @NonNull
+        @Override
+        public ImpressionsViewHolder onCreateViewHolder(@NonNull ViewGroup viewGroup, int i) {
+            final View itemView = LayoutInflater.from(viewGroup.getContext())
+                    .inflate(android.R.layout.simple_list_item_1, viewGroup, false);
+            return new ImpressionsViewHolder(itemView);
+        }
+
+        @Override
+        public void onBindViewHolder(@NonNull ImpressionsViewHolder viewHolder, int i) {
+            final int color = (i & 1) == 0 ? mBackgroundDark : mBackgroundLight;
+            viewHolder.bindViewHolder(stringList.get(i), color);
+        }
+
+        @Override
+        public int getItemCount() {
+            return stringList.size();
+        }
+
+        /**
+         * ViewHolder
+         */
+        static class ImpressionsViewHolder extends RecyclerView.ViewHolder {
+            @NonNull
+            final TextView infoTextView;
+
+            ImpressionsViewHolder(View itemView) {
+                super(itemView);
+                itemView.setTag(this);
+                infoTextView = itemView.findViewById(android.R.id.text1);
+                infoTextView.setOnLongClickListener(new View.OnLongClickListener() {
+                    @Override
+                    public boolean onLongClick(View v) {
+                        shareImpressionData(infoTextView);
+                        return true;
+                    }
+                });
+            }
+
+            void bindViewHolder(final String text, final int color) {
+                itemView.setBackgroundColor(color);
+                infoTextView.setText(text);
+            }
+
+            private void shareImpressionData(@NonNull final TextView textView) {
+                final Intent impressionIntent = new Intent(android.content.Intent.ACTION_SEND);
+                impressionIntent.setType("text/plain");
+                impressionIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
+                impressionIntent.putExtra(Intent.EXTRA_SUBJECT, "impression data");
+                impressionIntent.putExtra(Intent.EXTRA_TEXT, textView.getText().toString());
+
+                textView.getContext().startActivity(Intent.createChooser(impressionIntent,
+                        textView.getResources().getString(R.string.share_impression)));
+            }
+        }
+    }
+}
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubListFragment.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubListFragment.java
index 3f8e94f3..cc1f861b 100644
--- a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubListFragment.java
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubListFragment.java
@@ -15,7 +15,9 @@
 import android.support.v4.app.Fragment;
 import android.support.v4.app.FragmentTransaction;
 import android.support.v4.app.ListFragment;
+import android.text.Editable;
 import android.text.TextUtils;
+import android.text.TextWatcher;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
@@ -30,6 +32,8 @@
 import com.mopub.common.MoPub;
 import com.mopub.common.Preconditions;
 import com.mopub.common.logging.MoPubLog;
+import com.mopub.common.privacy.ConsentStatus;
+import com.mopub.common.privacy.PersonalInfoManager;
 
 import java.util.ArrayList;
 import java.util.List;
@@ -51,6 +55,8 @@
 
     private MoPubSampleListAdapter mAdapter;
     private AdUnitDataSource mAdUnitDataSource;
+    private EditText mSearchBar;
+    private Button mSearchBarClearButton;
 
     private static final AdType[] adTypes = AdType.values();
 
@@ -102,6 +108,36 @@ public void onClick(final View view) {
             }
         });
 
+        mSearchBar = view.findViewById(R.id.search_bar_et);
+        mSearchBarClearButton = view.findViewById(R.id.search_bar_clear_button);
+
+        mSearchBarClearButton.setOnClickListener(new View.OnClickListener() {
+            @Override
+            public void onClick(View v) {
+                if (mSearchBar != null) {
+                    mSearchBar.getText().clear();
+                }
+            }
+        });
+
+        mSearchBar.addTextChangedListener(new TextWatcher() {
+            @Override
+            public void beforeTextChanged(CharSequence s, int start, int count, int after) {
+            }
+
+            @Override
+            public void onTextChanged(CharSequence s, int start, int before, int count) {
+            }
+
+            @Override
+            public void afterTextChanged(final Editable text) {
+                final MoPubSampleListAdapter adapter = mAdapter;
+                if (adapter != null && text != null) {
+                    adapter.getFilter().filter(text.toString());
+                }
+            }
+        });
+
         return view;
     }
 
@@ -224,6 +260,36 @@ void deleteAdUnit(final MoPubSampleAdUnit moPubSampleAdUnit) {
         mAdapter.sort(MoPubSampleAdUnit.COMPARATOR);
     }
 
+    /**
+     * Call this function to grant or revoke user consent
+     * @param consentGranted - true to grant consent, false to revoke
+     * @return - true successfully completed operation, false failed for some reason
+     */
+    boolean onChangeConsent(final boolean consentGranted) {
+        final PersonalInfoManager personalInfoManager = MoPub.getPersonalInformationManager();
+        final View view = getView();
+        if (personalInfoManager == null || view == null) {
+            MoPubLog.log(MoPubLog.SdkLogEvent.CUSTOM, getString(R.string.pim_is_not_available));
+            return false;
+        }
+
+        final EditText text = view.findViewById(R.id.status_change_notification);
+        text.setVisibility(View.VISIBLE);
+        if (consentGranted) {
+            personalInfoManager.grantConsent();
+            text.setText(R.string.consent_whitelisted);
+        } else {
+            if (personalInfoManager.getPersonalInfoConsentStatus().equals(ConsentStatus.DNT)) {
+                text.setText(R.string.donottrack_text);
+                return false;
+            }
+            personalInfoManager.revokeConsent();
+            text.setText(R.string.consent_denied);
+        }
+
+        return true;
+    }
+
     public static class DeleteDialogFragment extends DialogFragment {
         public static DeleteDialogFragment newInstance(MoPubSampleAdUnit adUnit) {
             final DeleteDialogFragment deleteDialogFragment = new DeleteDialogFragment();
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubSampleActivity.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubSampleActivity.java
index 10f51e7b..b4954715 100644
--- a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubSampleActivity.java
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubSampleActivity.java
@@ -10,30 +10,58 @@
 import android.os.Bundle;
 import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
+import android.support.design.widget.NavigationView;
 import android.support.v4.app.ActivityCompat;
-import android.support.v4.app.FragmentActivity;
+import android.support.v4.app.FragmentManager;
+import android.support.v4.view.GravityCompat;
+import android.support.v4.widget.DrawerLayout;
+import android.support.v7.app.ActionBarDrawerToggle;
+import android.support.v7.app.AppCompatActivity;
+import android.support.v7.widget.Toolbar;
+import android.view.Menu;
+import android.view.MenuItem;
 import android.webkit.WebView;
 
+import com.facebook.ads.AdSettings;
+import com.mopub.common.Constants;
 import com.mopub.common.MoPub;
 import com.mopub.common.SdkConfiguration;
 import com.mopub.common.SdkInitializationListener;
+import com.mopub.common.logging.MoPubLog;
+import com.mopub.common.privacy.ConsentData;
 import com.mopub.common.privacy.ConsentDialogListener;
 import com.mopub.common.privacy.ConsentStatus;
 import com.mopub.common.privacy.ConsentStatusChangeListener;
 import com.mopub.common.privacy.PersonalInfoManager;
 import com.mopub.common.util.DeviceUtils;
+import com.mopub.common.util.Reflection;
+import com.mopub.mobileads.FlurryAdapterConfiguration;
 import com.mopub.mobileads.MoPubErrorCode;
+import com.mopub.mobileads.TapjoyAdapterConfiguration;
+import com.mopub.mobileads.TapjoyInterstitial;
+import com.mopub.network.ImpressionData;
+import com.mopub.network.ImpressionListener;
+import com.mopub.network.ImpressionsEmitter;
 
+import org.json.JSONException;
+
+import java.lang.reflect.Field;
 import java.util.ArrayList;
+import java.util.HashMap;
 import java.util.List;
+import java.util.Map;
+import java.util.concurrent.LinkedBlockingDeque;
 
 import static android.Manifest.permission.ACCESS_COARSE_LOCATION;
 import static android.Manifest.permission.WRITE_EXTERNAL_STORAGE;
 import static com.mopub.common.Constants.UNUSED_REQUEST_CODE;
 import static com.mopub.common.logging.MoPubLog.LogLevel.DEBUG;
 import static com.mopub.common.logging.MoPubLog.LogLevel.INFO;
+import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
+import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM_WITH_THROWABLE;
 
-public class MoPubSampleActivity extends FragmentActivity {
+public class MoPubSampleActivity extends AppCompatActivity
+        implements NavigationView.OnNavigationItemSelectedListener {
     private static final List<String> REQUIRED_DANGEROUS_PERMISSIONS = new ArrayList<>();
 
     static {
@@ -58,13 +86,23 @@ private static void setWebDebugging() {
     @Nullable
     PersonalInfoManager mPersonalInfoManager;
 
+    @Nullable DrawerLayout mDrawerLayout;
+
     @Nullable
     private ConsentStatusChangeListener mConsentStatusChangeListener;
 
+    @NonNull
+    private final LinkedBlockingDeque<String> mImpressionsList = new LinkedBlockingDeque<>();
+    private ImpressionListener mImpressionListener;
+
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        setContentView(R.layout.main);
+        setContentView(R.layout.activity_main);
+        Toolbar toolbar = findViewById(R.id.toolbar);
+        setSupportActionBar(toolbar);
+
+        setupNavigationDrawer(toolbar);
 
         List<String> permissionsToBeRequested = new ArrayList<>();
         for (String permission : REQUIRED_DANGEROUS_PERMISSIONS) {
@@ -87,12 +125,25 @@ protected void onCreate(Bundle savedInstanceState) {
             createMoPubListFragment(getIntent());
         }
 
-        final SdkConfiguration.Builder configBuilder = new SdkConfiguration.Builder("b195f8dd8ded45fe847ad89ed1d016da");
+        final SdkConfiguration.Builder configBuilder = new SdkConfiguration.Builder(
+                "b195f8dd8ded45fe847ad89ed1d016da");
         if (BuildConfig.DEBUG) {
             configBuilder.withLogLevel(DEBUG);
         } else {
             configBuilder.withLogLevel(INFO);
         }
+
+        final Map<String, String> flurryConfig = new HashMap<>();
+        flurryConfig.put("apiKey", "VX85BD4YBFNW629NN2SP");
+        configBuilder.withMediatedNetworkConfiguration(FlurryAdapterConfiguration.class.getName(),
+                flurryConfig);
+
+        final Map<String, String> tapjoyConfig = new HashMap<>();
+        tapjoyConfig.put(TapjoyInterstitial.SDK_KEY,
+                "cSOY1BYrRsSyJljkFWPdsgECRpZaaWDkWwXH1N1hIUbz1-c0o-DKATsLtckr");
+        configBuilder.withMediatedNetworkConfiguration(TapjoyAdapterConfiguration.class.getName(),
+                tapjoyConfig);
+
         MoPub.initializeSdk(this, configBuilder.build(), initSdkListener());
 
         mConsentStatusChangeListener = initConsentChangeListener();
@@ -104,6 +155,11 @@ protected void onCreate(Bundle savedInstanceState) {
         // Intercepts all logs including Level.FINEST so we can show a toast
         // that is not normally user-facing. This is only used for native ads.
         LoggingUtils.enableCanaryLogging(this);
+        // For Facebook, request for test ads
+        AdSettings.setTestMode(true);
+
+        mImpressionListener = createImpressionsListener();
+        ImpressionsEmitter.addListener(mImpressionListener);
     }
 
     @Override
@@ -113,6 +169,8 @@ protected void onDestroy() {
             mPersonalInfoManager.unsubscribeConsentStatusChangeListener(mConsentStatusChangeListener);
         }
         mConsentStatusChangeListener = null;
+
+        ImpressionsEmitter.removeListener(mImpressionListener);
         super.onDestroy();
     }
 
@@ -121,7 +179,7 @@ private void createMoPubListFragment(@NonNull final Intent intent) {
             mMoPubListFragment = new MoPubListFragment();
             mMoPubListFragment.setArguments(intent.getExtras());
             getSupportFragmentManager().beginTransaction()
-                    .replace(R.id.fragment_container, mMoPubListFragment).commit();
+                    .replace(R.id.fragment_container, mMoPubListFragment, LIST_FRAGMENT_TAG).commit();
 
             mDeeplinkIntent = intent;
         }
@@ -146,6 +204,7 @@ private SdkInitializationListener initSdkListener() {
 
             @Override
             public void onInitializationFinished() {
+                syncNavigationMenu();
                 Utils.logToast(MoPubSampleActivity.this, "SDK initialized.");
                 if (mPersonalInfoManager != null && mPersonalInfoManager.shouldShowConsentDialog()) {
                     mPersonalInfoManager.loadConsentDialog(initDialogLoadListener());
@@ -185,4 +244,208 @@ public void onConsentDialogLoadFailed(@NonNull MoPubErrorCode moPubErrorCode) {
             }
         };
     }
+
+    @Override
+    public void onBackPressed() {
+        if (mDrawerLayout != null && mDrawerLayout.isDrawerOpen(GravityCompat.START)) {
+            mDrawerLayout.closeDrawer(GravityCompat.START);
+        } else {
+            super.onBackPressed();
+        }
+    }
+
+    /*
+        MoPub Sample specific test code
+     */
+    private static final String PROD_HOST = Constants.HOST;
+    private static final String TEST_HOST = "ads-staging.mopub.com";
+    private static final String PRIVACY_FRAGMENT_TAG = "privacy_info_fragment";
+    private static final String NETWORKS_FRAGMENT_TAG = "networks_info_fragment";
+    private static final String LIST_FRAGMENT_TAG = "list_fragment";
+    private static final String IMPRESSIONS_FRAGMENT_TAG = "impressions_info_fragment";
+
+    @Override
+    public boolean onCreateOptionsMenu(Menu menu) {
+        // Inflate the menu; this adds items to the action bar if it is present.
+        getMenuInflater().inflate(R.menu.main, menu);
+        return true;
+    }
+
+    private void setupNavigationDrawer(Toolbar toolbar) {
+        mDrawerLayout = findViewById(R.id.drawer_layout);
+        final ActionBarDrawerToggle toggle = new ActionBarDrawerToggle(this,
+                mDrawerLayout, toolbar, R.string.navigation_drawer_open, R.string.navigation_drawer_close);
+        mDrawerLayout.addDrawerListener(toggle);
+        toggle.syncState();
+
+        final NavigationView navigationView = findViewById(R.id.nav_view);
+        navigationView.setNavigationItemSelectedListener(this);
+    }
+
+    private void syncNavigationMenu() {
+        final NavigationView navigationView = findViewById(R.id.nav_view);
+
+        final String host = Constants.HOST;
+        final boolean production = PROD_HOST.equalsIgnoreCase(host);
+        navigationView.getMenu().findItem(R.id.nav_production).setChecked(production);
+        navigationView.getMenu().findItem(R.id.nav_staging).setChecked(!production);
+
+        final PersonalInfoManager manager = MoPub.getPersonalInformationManager();
+        if (manager != null) {
+            final ConsentData consentData = manager.getConsentData();
+            navigationView.getMenu().findItem(R.id.nav_force_gdpr).setChecked(consentData.isForceGdprApplies());
+
+            final ConsentStatus consentStatus = manager.getPersonalInfoConsentStatus();
+
+            if (consentStatus.equals(ConsentStatus.POTENTIAL_WHITELIST)) {
+                navigationView.getMenu().findItem(R.id.nav_privacy_grant).setChecked(true);
+            } else if (consentStatus.equals(ConsentStatus.EXPLICIT_NO)) {
+                navigationView.getMenu().findItem(R.id.nav_privacy_revoke).setChecked(true);
+            }
+        }
+    }
+
+    @Override
+    public boolean onOptionsItemSelected(MenuItem item) {
+        switch (item.getItemId()) {
+            case R.id.action_impressions:
+                onImpressionsMenu();
+                return true;
+            case R.id.action_clear_logs:
+                onClearLogs();
+                return true;
+            default:
+                return super.onContextItemSelected(item);
+        }
+    }
+
+    @Override
+    public boolean onNavigationItemSelected(@NonNull MenuItem menuItem) {
+        switch (menuItem.getItemId()) {
+            case R.id.nav_production:
+                onNavEnvironemnt(true);
+                break;
+            case R.id.nav_staging:
+                onNavEnvironemnt(false);
+                break;
+            case R.id.nav_privacy_info:
+                onNavPrivacyInfo();
+                break;
+            case R.id.nav_privacy_grant:
+                onNavChangeConsent(true);
+                break;
+            case R.id.nav_privacy_revoke:
+                onNavChangeConsent(false);
+                break;
+            case R.id.nav_force_gdpr:
+                onNavForceGdpr();
+                break;
+            case R.id.nav_adapters_info:
+                onNavAdaptersInfo();
+                break;
+        }
+
+        syncNavigationMenu();
+
+        if (mDrawerLayout != null) {
+            mDrawerLayout.closeDrawers();
+        }
+
+        return false;
+    }
+
+    private void onImpressionsMenu() {
+        final FragmentManager manager = getSupportFragmentManager();
+        if (manager.findFragmentByTag(IMPRESSIONS_FRAGMENT_TAG) == null) {
+            ImpressionsInfoFragment fragment = ImpressionsInfoFragment.newInstance(new ArrayList<>(mImpressionsList));
+            manager.beginTransaction()
+                    .replace(R.id.fragment_container, fragment, IMPRESSIONS_FRAGMENT_TAG)
+                    .addToBackStack(IMPRESSIONS_FRAGMENT_TAG)
+                    .commit();
+        }
+    }
+
+    private void onNavEnvironemnt(boolean production) {
+        setEndpoint(production ? PROD_HOST : TEST_HOST);
+    }
+
+    private void onNavPrivacyInfo() {
+        final FragmentManager manager = getSupportFragmentManager();
+        if (manager.findFragmentByTag(PRIVACY_FRAGMENT_TAG) == null) {
+            manager.beginTransaction()
+                    .replace(R.id.fragment_container, new PrivacyInfoFragment(), PRIVACY_FRAGMENT_TAG)
+                    .addToBackStack(PRIVACY_FRAGMENT_TAG)
+                    .commit();
+        }
+    }
+
+    private void onNavChangeConsent(boolean grant) {
+        final FragmentManager manager = getSupportFragmentManager();
+        final MoPubListFragment listFragment = (MoPubListFragment) manager.findFragmentByTag(LIST_FRAGMENT_TAG);
+        if (listFragment == null) {
+            MoPubLog.log(CUSTOM, getString(R.string.list_fragment_not_found));
+            return; // fragment is not ready to update the consent
+        }
+        if (!listFragment.onChangeConsent(grant)) {
+            return; // fragment is not ready to update the consent
+        }
+
+        final NavigationView navigationView = findViewById(R.id.nav_view);
+        navigationView.getMenu().findItem(R.id.nav_privacy_grant).setChecked(grant);
+        navigationView.getMenu().findItem(R.id.nav_privacy_revoke).setChecked(!grant);
+    }
+
+    private void onNavForceGdpr() {
+        final PersonalInfoManager manager = MoPub.getPersonalInformationManager();
+        if (manager != null) {
+            manager.forceGdprApplies();
+        }
+    }
+
+    private void onNavAdaptersInfo() {
+        final FragmentManager manager = getSupportFragmentManager();
+        if (manager.findFragmentByTag(NETWORKS_FRAGMENT_TAG) == null) {
+            manager.beginTransaction()
+                    .replace(R.id.fragment_container, new NetworksInfoFragment(), NETWORKS_FRAGMENT_TAG)
+                    .addToBackStack(NETWORKS_FRAGMENT_TAG)
+                    .commit();
+        }
+    }
+
+    private void setEndpoint(@NonNull String host) {
+        try {
+            Field field = Reflection.getPrivateField(com.mopub.common.Constants.class, "HOST");
+            field.set(null, host);
+        } catch (Exception e) {
+            MoPubLog.log(CUSTOM_WITH_THROWABLE, "Can't change HOST.", e);
+        }
+    }
+
+    private void onClearLogs() {
+        FragmentManager manager = getSupportFragmentManager();
+        final ImpressionsInfoFragment fragment = (ImpressionsInfoFragment) manager.findFragmentByTag(IMPRESSIONS_FRAGMENT_TAG);
+        if (fragment != null) {
+            fragment.onClear();
+        }
+        mImpressionsList.clear();
+    }
+
+    private ImpressionListener createImpressionsListener() {
+        return new ImpressionListener() {
+            @Override
+            public void onImpression(@NonNull final String adUnitId, @Nullable final ImpressionData impressionData) {
+                MoPubLog.log(CUSTOM, "impression for adUnitId= " + adUnitId);
+
+                if (impressionData == null) {
+                    mImpressionsList.addFirst("adUnitId= " + adUnitId + "\ndata= null");
+                } else {
+                    try {
+                        mImpressionsList.addFirst(impressionData.getJsonRepresentation().toString(2));
+                    } catch (JSONException e) {
+                        MoPubLog.log(CUSTOM_WITH_THROWABLE, "Can't format impression data.", e);
+                    }
+                }
+            }
+        };
+    }
 }
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubSampleAdUnit.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubSampleAdUnit.java
index 5b728c5b..9236367a 100644
--- a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubSampleAdUnit.java
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/MoPubSampleAdUnit.java
@@ -237,4 +237,10 @@ public boolean equals(Object o) {
                 that.mDescription.equals(this.mDescription) &&
                 that.mAdUnitId.equals(this.mAdUnitId);
     }
+
+    @Override
+    @NonNull
+    public String toString() {
+        return mDescription == null ? "" : mDescription;
+    }
 }
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeGalleryFragment.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeGalleryFragment.java
index 187a68be..5e3c7d0f 100644
--- a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeGalleryFragment.java
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeGalleryFragment.java
@@ -16,6 +16,11 @@
 import android.view.ViewGroup;
 import android.widget.TextView;
 
+import com.mopub.nativeads.FacebookAdRenderer;
+import com.mopub.nativeads.FlurryCustomEventNative;
+import com.mopub.nativeads.FlurryNativeAdRenderer;
+import com.mopub.nativeads.FlurryViewBinder;
+import com.mopub.nativeads.GooglePlayServicesAdRenderer;
 import com.mopub.nativeads.MediaViewBinder;
 import com.mopub.nativeads.MoPubNativeAdLoadedListener;
 import com.mopub.nativeads.MoPubStaticNativeAdRenderer;
@@ -25,6 +30,8 @@
 import com.mopub.nativeads.ViewBinder;
 
 import java.util.EnumSet;
+import java.util.HashMap;
+import java.util.Map;
 
 import static com.mopub.nativeads.RequestParameters.NativeAdAsset;
 
@@ -102,10 +109,56 @@ public void onClick(View view) {
                         .privacyInformationIconImageId(R.id.native_privacy_information_icon_image)
                         .build());
 
+        // Set up a renderer for Facebook video ads.
+        final FacebookAdRenderer facebookAdRenderer = new FacebookAdRenderer(
+                new FacebookAdRenderer.FacebookViewBinder.Builder(R.layout.native_ad_fan_list_item)
+                        .titleId(R.id.native_title)
+                        .textId(R.id.native_text)
+                        .mediaViewId(R.id.native_media_view)
+                        .adIconViewId(R.id.native_icon)
+                        .callToActionId(R.id.native_cta)
+                        .adChoicesRelativeLayoutId(R.id.native_privacy_information_icon_layout)
+                        .build());
+
+        // Set up a renderer for Flurry ads.
+        Map<String, Integer> extraToResourceMap = new HashMap<>(3);
+        extraToResourceMap.put(FlurryCustomEventNative.EXTRA_SEC_BRANDING_LOGO,
+                R.id.flurry_native_brand_logo);
+        extraToResourceMap.put(FlurryCustomEventNative.EXTRA_APP_CATEGORY,
+                R.id.flurry_app_category);
+        extraToResourceMap.put(FlurryCustomEventNative.EXTRA_STAR_RATING_IMG,
+                R.id.flurry_star_rating_image);
+        ViewBinder flurryBinder = new ViewBinder.Builder(R.layout.native_ad_flurry_list_item)
+                .titleId(R.id.flurry_native_title)
+                .textId(R.id.flurry_native_text)
+                .mainImageId(R.id.flurry_native_main_image)
+                .iconImageId(R.id.flurry_native_icon_image)
+                .callToActionId(R.id.flurry_native_cta)
+                .addExtras(extraToResourceMap)
+                .build();
+        FlurryViewBinder flurryViewBinder = new FlurryViewBinder.Builder(flurryBinder)
+                .videoViewId(R.id.flurry_native_video_view)
+                .build();
+        final FlurryNativeAdRenderer flurryRenderer = new FlurryNativeAdRenderer(flurryViewBinder);
+
+        // Set up a renderer for AdMob ads.
+        final GooglePlayServicesAdRenderer googlePlayServicesAdRenderer = new GooglePlayServicesAdRenderer(
+                new MediaViewBinder.Builder(R.layout.video_ad_list_item)
+                        .titleId(R.id.native_title)
+                        .textId(R.id.native_text)
+                        .mediaLayoutId(R.id.native_media_layout)
+                        .iconImageId(R.id.native_icon_image)
+                        .callToActionId(R.id.native_cta)
+                        .privacyInformationIconImageId(R.id.native_privacy_information_icon_image)
+                        .build());
+
         // This ad placer is used to automatically insert ads into the ViewPager.
         mStreamAdPlacer = new MoPubStreamAdPlacer(getActivity());
+        mStreamAdPlacer.registerAdRenderer(googlePlayServicesAdRenderer);
+        mStreamAdPlacer.registerAdRenderer(flurryRenderer);
         mStreamAdPlacer.registerAdRenderer(moPubStaticNativeAdRenderer);
         mStreamAdPlacer.registerAdRenderer(moPubVideoNativeAdRenderer);
+        mStreamAdPlacer.registerAdRenderer(facebookAdRenderer);
         mStreamAdPlacer.setAdLoadedListener(this);
 
         mPagerAdapter = new CustomPagerAdapter(getChildFragmentManager(), mStreamAdPlacer);
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeListViewFragment.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeListViewFragment.java
index a031a998..aeccf651 100644
--- a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeListViewFragment.java
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeListViewFragment.java
@@ -13,6 +13,11 @@
 import android.widget.ArrayAdapter;
 import android.widget.ListView;
 
+import com.mopub.nativeads.FacebookAdRenderer;
+import com.mopub.nativeads.FlurryCustomEventNative;
+import com.mopub.nativeads.FlurryNativeAdRenderer;
+import com.mopub.nativeads.FlurryViewBinder;
+import com.mopub.nativeads.GooglePlayServicesAdRenderer;
 import com.mopub.nativeads.MediaViewBinder;
 import com.mopub.nativeads.MoPubAdAdapter;
 import com.mopub.nativeads.MoPubStaticNativeAdRenderer;
@@ -21,6 +26,8 @@
 import com.mopub.nativeads.ViewBinder;
 
 import java.util.EnumSet;
+import java.util.HashMap;
+import java.util.Map;
 
 import static com.mopub.nativeads.MoPubNativeAdPositioning.MoPubServerPositioning;
 import static com.mopub.nativeads.RequestParameters.NativeAdAsset;
@@ -105,10 +112,55 @@ public void onClick(View view) {
                         .privacyInformationIconImageId(R.id.native_privacy_information_icon_image)
                         .build());
 
+        // Set up a renderer for Facebook video ads.
+        final FacebookAdRenderer facebookAdRenderer = new FacebookAdRenderer(
+                new FacebookAdRenderer.FacebookViewBinder.Builder(R.layout.native_ad_fan_list_item)
+                        .titleId(R.id.native_title)
+                        .textId(R.id.native_text)
+                        .mediaViewId(R.id.native_media_view)
+                        .adIconViewId(R.id.native_icon)
+                        .callToActionId(R.id.native_cta)
+                        .adChoicesRelativeLayoutId(R.id.native_privacy_information_icon_layout)
+                        .build());
+
+        // Set up a renderer for Flurry ads.
+        Map<String, Integer> extraToResourceMap = new HashMap<>(3);
+        extraToResourceMap.put(FlurryCustomEventNative.EXTRA_SEC_BRANDING_LOGO,
+                R.id.flurry_native_brand_logo);
+        extraToResourceMap.put(FlurryCustomEventNative.EXTRA_APP_CATEGORY,
+                R.id.flurry_app_category);
+        extraToResourceMap.put(FlurryCustomEventNative.EXTRA_STAR_RATING_IMG,
+                R.id.flurry_star_rating_image);
+        ViewBinder flurryBinder = new ViewBinder.Builder(R.layout.native_ad_flurry_list_item)
+                .titleId(R.id.flurry_native_title)
+                .textId(R.id.flurry_native_text)
+                .mainImageId(R.id.flurry_native_main_image)
+                .iconImageId(R.id.flurry_native_icon_image)
+                .callToActionId(R.id.flurry_native_cta)
+                .addExtras(extraToResourceMap)
+                .build();
+        FlurryViewBinder flurryViewBinder = new FlurryViewBinder.Builder(flurryBinder)
+                .videoViewId(R.id.flurry_native_video_view)
+                .build();
+        final FlurryNativeAdRenderer flurryRenderer = new FlurryNativeAdRenderer(flurryViewBinder);
+
+        // Set up a renderer for AdMob ads.
+        final GooglePlayServicesAdRenderer googlePlayServicesAdRenderer = new GooglePlayServicesAdRenderer(
+                new MediaViewBinder.Builder(R.layout.video_ad_list_item)
+                        .titleId(R.id.native_title)
+                        .textId(R.id.native_text)
+                        .mediaLayoutId(R.id.native_media_layout)
+                        .iconImageId(R.id.native_icon_image)
+                        .callToActionId(R.id.native_cta)
+                        .privacyInformationIconImageId(R.id.native_privacy_information_icon_image)
+                        .build());
 
         // Register the renderers with the MoPubAdAdapter and then set the adapter on the ListView.
+        mAdAdapter.registerAdRenderer(googlePlayServicesAdRenderer);
+        mAdAdapter.registerAdRenderer(flurryRenderer);
         mAdAdapter.registerAdRenderer(videoAdRenderer);
         mAdAdapter.registerAdRenderer(staticAdRender);
+        mAdAdapter.registerAdRenderer(facebookAdRenderer);
         listView.setAdapter(mAdAdapter);
 
         mAdAdapter.loadAds(mAdConfiguration.getAdUnitId(), mRequestParameters);
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeRecyclerViewFragment.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeRecyclerViewFragment.java
index a67eb059..75b7de1e 100644
--- a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeRecyclerViewFragment.java
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NativeRecyclerViewFragment.java
@@ -18,16 +18,23 @@
 import android.widget.Button;
 import android.widget.TextView;
 
+import com.mopub.nativeads.FacebookAdRenderer;
+import com.mopub.nativeads.FlurryCustomEventNative;
+import com.mopub.nativeads.FlurryNativeAdRenderer;
+import com.mopub.nativeads.FlurryViewBinder;
+import com.mopub.nativeads.GooglePlayServicesAdRenderer;
 import com.mopub.nativeads.MediaViewBinder;
 import com.mopub.nativeads.MoPubNativeAdPositioning;
-import com.mopub.nativeads.MoPubStaticNativeAdRenderer;
 import com.mopub.nativeads.MoPubRecyclerAdapter;
+import com.mopub.nativeads.MoPubStaticNativeAdRenderer;
 import com.mopub.nativeads.MoPubVideoNativeAdRenderer;
 import com.mopub.nativeads.RequestParameters;
 import com.mopub.nativeads.ViewBinder;
 
 import java.util.EnumSet;
+import java.util.HashMap;
 import java.util.Locale;
+import java.util.Map;
 
 public class NativeRecyclerViewFragment extends Fragment {
     private MoPubRecyclerAdapter mRecyclerAdapter;
@@ -116,8 +123,54 @@ public void onClick(final View v) {
                         .privacyInformationIconImageId(R.id.native_privacy_information_icon_image)
                         .build());
 
+        // Set up a renderer for Facebook video ads.
+        final FacebookAdRenderer facebookAdRenderer = new FacebookAdRenderer(
+                new FacebookAdRenderer.FacebookViewBinder.Builder(R.layout.native_ad_fan_list_item)
+                        .titleId(R.id.native_title)
+                        .textId(R.id.native_text)
+                        .mediaViewId(R.id.native_media_view)
+                        .adIconViewId(R.id.native_icon)
+                        .callToActionId(R.id.native_cta)
+                        .adChoicesRelativeLayoutId(R.id.native_privacy_information_icon_layout)
+                        .build());
+
+        // Set up a renderer for Flurry ads.
+        Map<String, Integer> extraToResourceMap = new HashMap<>(3);
+        extraToResourceMap.put(FlurryCustomEventNative.EXTRA_SEC_BRANDING_LOGO,
+                R.id.flurry_native_brand_logo);
+        extraToResourceMap.put(FlurryCustomEventNative.EXTRA_APP_CATEGORY,
+                R.id.flurry_app_category);
+        extraToResourceMap.put(FlurryCustomEventNative.EXTRA_STAR_RATING_IMG,
+                R.id.flurry_star_rating_image);
+        ViewBinder flurryBinder = new ViewBinder.Builder(R.layout.native_ad_flurry_list_item)
+                .titleId(R.id.flurry_native_title)
+                .textId(R.id.flurry_native_text)
+                .mainImageId(R.id.flurry_native_main_image)
+                .iconImageId(R.id.flurry_native_icon_image)
+                .callToActionId(R.id.flurry_native_cta)
+                .addExtras(extraToResourceMap)
+                .build();
+        FlurryViewBinder flurryViewBinder = new FlurryViewBinder.Builder(flurryBinder)
+                .videoViewId(R.id.flurry_native_video_view)
+                .build();
+        final FlurryNativeAdRenderer flurryRenderer = new FlurryNativeAdRenderer(flurryViewBinder);
+
+        // Set up a renderer for AdMob ads.
+        final GooglePlayServicesAdRenderer googlePlayServicesAdRenderer = new GooglePlayServicesAdRenderer(
+                new MediaViewBinder.Builder(R.layout.video_ad_list_item)
+                        .titleId(R.id.native_title)
+                        .textId(R.id.native_text)
+                        .mediaLayoutId(R.id.native_media_layout)
+                        .iconImageId(R.id.native_icon_image)
+                        .callToActionId(R.id.native_cta)
+                        .privacyInformationIconImageId(R.id.native_privacy_information_icon_image)
+                        .build());
+
+        mRecyclerAdapter.registerAdRenderer(googlePlayServicesAdRenderer);
+        mRecyclerAdapter.registerAdRenderer(flurryRenderer);
         mRecyclerAdapter.registerAdRenderer(moPubStaticNativeAdRenderer);
         mRecyclerAdapter.registerAdRenderer(moPubVideoNativeAdRenderer);
+        mRecyclerAdapter.registerAdRenderer(facebookAdRenderer);
 
         mRecyclerView.setAdapter(mRecyclerAdapter);
         mRecyclerView.setLayoutManager(new LinearLayoutManager(getActivity()));
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NetworksInfoFragment.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NetworksInfoFragment.java
new file mode 100644
index 00000000..35ad3a34
--- /dev/null
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/NetworksInfoFragment.java
@@ -0,0 +1,93 @@
+package com.mopub.simpleadsdemo;
+
+import android.app.Activity;
+import android.os.Bundle;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+import android.support.v4.app.Fragment;
+import android.support.v7.widget.DividerItemDecoration;
+import android.support.v7.widget.LinearLayoutManager;
+import android.support.v7.widget.RecyclerView;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.Button;
+import android.widget.TextView;
+
+import com.mopub.common.MoPub;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import static android.support.v7.widget.DividerItemDecoration.VERTICAL;
+
+public class NetworksInfoFragment extends Fragment {
+    @Override
+    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
+        final View view = inflater.inflate(R.layout.networks_info_fragment, container, false);
+
+        final List<String> networks = MoPub.getAdapterConfigurationInfo();
+        if (networks != null && !networks.isEmpty()) {
+            RecyclerView recyclerView = view.findViewById(R.id.networks_recycler_view);
+            recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
+            recyclerView.setAdapter(new NetworksInfoAdapter(networks));
+            recyclerView.addItemDecoration(new DividerItemDecoration(recyclerView.getContext(), VERTICAL));
+
+            view.findViewById(R.id.text_no_adapters).setVisibility(View.GONE);
+        }
+
+        final Button closeButton = view.findViewById(R.id.networks_close_btn);
+        closeButton.setOnClickListener(new View.OnClickListener() {
+            @Override
+            public void onClick(View v) {
+                final Activity activity = getActivity();
+                if (activity != null) {
+                    activity.onBackPressed();
+                }
+            }
+        });
+        return view;
+    }
+
+    class NetworksInfoAdapter extends RecyclerView.Adapter<NetworksInfoAdapter.ViewHolder> {
+        @NonNull
+        final List<String> mNetworksInfo;
+
+        NetworksInfoAdapter(@Nullable final List<String> networksInfo) {
+            if (networksInfo != null) {
+                mNetworksInfo = networksInfo;
+            } else {
+                mNetworksInfo = new ArrayList<>();
+            }
+        }
+
+        @NonNull
+        @Override
+        public NetworksInfoAdapter.ViewHolder onCreateViewHolder(@NonNull ViewGroup viewGroup, int i) {
+            final View itemView = LayoutInflater.from(viewGroup.getContext())
+                    .inflate(android.R.layout.simple_selectable_list_item, viewGroup, false);
+            final NetworksInfoAdapter.ViewHolder viewHolder = new NetworksInfoAdapter.ViewHolder(itemView);
+            itemView.setTag(viewHolder);
+            return viewHolder;
+        }
+
+        @Override
+        public void onBindViewHolder(@NonNull NetworksInfoAdapter.ViewHolder viewHolder, int i) {
+            viewHolder.nameTextView.setText(mNetworksInfo.get(i));
+        }
+
+        @Override
+        public int getItemCount() {
+            return mNetworksInfo.size();
+        }
+
+        class ViewHolder extends RecyclerView.ViewHolder {
+            final TextView nameTextView;
+
+            ViewHolder(View itemView) {
+                super(itemView);
+                nameTextView = itemView.findViewById(android.R.id.text1);
+            }
+        }
+    }
+}
diff --git a/mopub-sample/src/main/java/com/mopub/simpleadsdemo/PrivacyInfoFragment.java b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/PrivacyInfoFragment.java
new file mode 100644
index 00000000..ff80397f
--- /dev/null
+++ b/mopub-sample/src/main/java/com/mopub/simpleadsdemo/PrivacyInfoFragment.java
@@ -0,0 +1,189 @@
+package com.mopub.simpleadsdemo;
+
+import android.app.Activity;
+import android.os.Bundle;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+import android.support.v4.app.Fragment;
+import android.support.v7.widget.DividerItemDecoration;
+import android.support.v7.widget.LinearLayoutManager;
+import android.support.v7.widget.RecyclerView;
+import android.text.TextUtils;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.Button;
+import android.widget.TextView;
+
+import com.mopub.common.MoPub;
+import com.mopub.common.privacy.ConsentData;
+import com.mopub.common.privacy.ConsentStatus;
+import com.mopub.common.privacy.PersonalInfoManager;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import static android.support.v7.widget.DividerItemDecoration.VERTICAL;
+
+public class PrivacyInfoFragment extends Fragment {
+
+    private static class PrivacyItem {
+        @NonNull
+        final String mTitle;
+        @NonNull
+        final String mDescription;
+        @NonNull
+        final String mValue;
+
+        PrivacyItem(@Nullable String title, @Nullable String value, @Nullable String description) {
+            mTitle = title == null ? "" : title;
+            mValue = value == null ? "" : value;
+            mDescription = description == null ? "" : description;
+        }
+    }
+
+    private static final int TYPE_PRIVACY_INFO = 0;
+    private static final int TYPE_DIVIDER = 1;
+
+    @Override
+    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
+        final View view = inflater.inflate(R.layout.privacy_info_fragment, container, false);
+
+        final List<PrivacyItem> privacySettings = readPrivacySettings();
+        if (privacySettings != null && !privacySettings.isEmpty()) {
+            RecyclerView recyclerView = view.findViewById(R.id.privacy_recycler_view);
+            recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
+            recyclerView.setAdapter(new PrivacyAdapter(privacySettings));
+            recyclerView.addItemDecoration(new DividerItemDecoration(recyclerView.getContext(), VERTICAL));
+        }
+
+        final Button closeButton = view.findViewById(R.id.privacy_close_btn);
+        closeButton.setOnClickListener(new View.OnClickListener() {
+            @Override
+            public void onClick(View v) {
+                final Activity activity = getActivity();
+                if (activity != null) {
+                    activity.onBackPressed();
+                }
+            }
+        });
+        return view;
+    }
+
+    class PrivacyAdapter extends RecyclerView.Adapter<RecyclerView.ViewHolder> {
+        @NonNull
+        final List<PrivacyItem> mPrivacyInfo;
+
+        PrivacyAdapter(@Nullable final List<PrivacyItem> privacyInfo) {
+            if (privacyInfo != null) {
+                mPrivacyInfo = privacyInfo;
+            } else {
+                mPrivacyInfo = new ArrayList<>();
+            }
+        }
+
+        @NonNull
+        @Override
+        public RecyclerView.ViewHolder onCreateViewHolder(@NonNull ViewGroup viewGroup, int viewType) {
+            final LayoutInflater inflater = LayoutInflater.from(viewGroup.getContext());
+            @NonNull RecyclerView.ViewHolder viewHolder;
+            if (viewType == TYPE_PRIVACY_INFO) {
+                final View itemView = inflater.inflate(R.layout.privacy_info_item, viewGroup, false);
+                viewHolder = new PrivacyAdapter.ViewHolder(itemView);
+                itemView.setTag(viewHolder);
+            } else {
+                final View itemView = inflater.inflate(R.layout.privacy_info_divider, viewGroup, false);
+                viewHolder = new PrivacyAdapter.DividerViewHolder(itemView);
+                itemView.setTag(viewHolder);
+            }
+
+            return viewHolder;
+        }
+
+        @Override
+        public void onBindViewHolder(@NonNull RecyclerView.ViewHolder viewHolder, int i) {
+            final PrivacyItem item = mPrivacyInfo.get(i);
+            if (isContentItem(item)) {
+                PrivacyAdapter.ViewHolder holder = (PrivacyAdapter.ViewHolder) viewHolder;
+                holder.titleTextView.setText(item.mTitle);
+                holder.descTextView.setText(item.mDescription);
+                holder.valueTextView.setText(item.mValue);
+            } else {
+                PrivacyAdapter.DividerViewHolder holder = (PrivacyAdapter.DividerViewHolder) viewHolder;
+                holder.dividerTextView.setText(item.mDescription);
+            }
+        }
+
+        @Override
+        public int getItemCount() {
+            return mPrivacyInfo.size();
+        }
+
+        @Override
+        public int getItemViewType(int position) {
+            final PrivacyItem item = mPrivacyInfo.get(position);
+            return isContentItem(item) ? TYPE_PRIVACY_INFO : TYPE_DIVIDER;
+        }
+
+        // viewholder
+        class ViewHolder extends RecyclerView.ViewHolder {
+            final TextView titleTextView;
+            final TextView descTextView;
+            final TextView valueTextView;
+
+            ViewHolder(View itemView) {
+                super(itemView);
+                titleTextView = itemView.findViewById(R.id.privacy_title_view);
+                descTextView = itemView.findViewById(R.id.privacy_desc_view);
+                valueTextView = itemView.findViewById(R.id.privacy_value_view);
+            }
+        }
+
+        // divider
+        class DividerViewHolder extends RecyclerView.ViewHolder {
+            final TextView dividerTextView;
+
+            DividerViewHolder(View itemView) {
+                super(itemView);
+                dividerTextView = itemView.findViewById(R.id.text_divider);
+            }
+        }
+    }
+
+    private static boolean isContentItem(@Nullable PrivacyItem item) {
+        return !(item != null && TextUtils.isEmpty(item.mTitle) && TextUtils.isEmpty(item.mValue));
+    }
+
+    private static List<PrivacyItem> readPrivacySettings() {
+        final PersonalInfoManager manager = MoPub.getPersonalInformationManager();
+        if (manager == null) {
+            return new ArrayList<>();
+        }
+
+        final ConsentData consentData = manager.getConsentData();
+        final ConsentStatus status = manager.getPersonalInfoConsentStatus();
+        final Boolean gdprApplies = manager.gdprApplies();
+
+        final String gdprAppliesString = (gdprApplies == null || gdprApplies) ? "true" : "false";
+
+        ArrayList<PrivacyItem> list = new ArrayList<>();
+        list.add(new PrivacyItem("", "", "Allowable Data Collection"));
+        list.add(new PrivacyItem("Is GDPR applicable?", gdprAppliesString, ""));
+        list.add(new PrivacyItem("Consent Status", status.getValue(), ""));
+        list.add(new PrivacyItem("Can Collect PII", manager.canCollectPersonalInformation() ? "true" : "false", ""));
+        list.add(new PrivacyItem("Should Show Consent Dialog", manager.shouldShowConsentDialog() ? "true" : "false", ""));
+        list.add(new PrivacyItem("Is Whitelisted", status.equals(ConsentStatus.POTENTIAL_WHITELIST) ? "true" : "false", ""));
+        list.add(new PrivacyItem("", "", "Current Versions"));
+        list.add(new PrivacyItem("Current Vendor List Url", "", consentData.getCurrentVendorListLink()));
+        list.add(new PrivacyItem("Current Vendor List Version", consentData.getCurrentVendorListVersion(), ""));
+        list.add(new PrivacyItem("Current Privacy Policy Url", "", consentData.getCurrentPrivacyPolicyLink()));
+        list.add(new PrivacyItem("Current Privacy Policy Version", consentData.getCurrentPrivacyPolicyVersion(), ""));
+        list.add(new PrivacyItem("Current IAB Vendor List Format", consentData.getCurrentVendorListIabFormat(), ""));
+        list.add(new PrivacyItem("", "", "Consented Versions"));
+        list.add(new PrivacyItem("Consented Vendor List Version", consentData.getConsentedVendorListVersion(), ""));
+        list.add(new PrivacyItem("Consented Privacy Policy Version", consentData.getConsentedPrivacyPolicyVersion(), ""));
+        list.add(new PrivacyItem("Consented IAB Vendor List Version", consentData.getConsentedVendorListIabFormat(), ""));
+
+        return list;
+    }
+}
diff --git a/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mobileads/CustomEventBannerAdapter.java b/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mobileads/CustomEventBannerAdapter.java
index 4d2bbc77..d0952c74 100644
--- a/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mobileads/CustomEventBannerAdapter.java
+++ b/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mobileads/CustomEventBannerAdapter.java
@@ -18,7 +18,6 @@
 import com.mopub.common.VisibleForTesting;
 import com.mopub.common.logging.MoPubLog;
 import com.mopub.common.util.ReflectionTarget;
-import com.mopub.mobileads.CustomEventBanner.CustomEventBannerListener;
 import com.mopub.mobileads.factories.CustomEventBannerFactory;
 
 import java.util.Map;
@@ -35,7 +34,7 @@
 import static com.mopub.mobileads.MoPubErrorCode.NETWORK_TIMEOUT;
 import static com.mopub.mobileads.MoPubErrorCode.UNSPECIFIED;
 
-public class CustomEventBannerAdapter implements CustomEventBannerListener {
+public class CustomEventBannerAdapter implements InternalCustomEventBannerListener {
     public static final int DEFAULT_BANNER_TIMEOUT_DELAY = Constants.TEN_SECONDS_MILLIS;
 
     private boolean mInvalidated;
@@ -239,8 +238,8 @@ public void onBannerLoaded(View bannerView) {
             if (mIsVisibilityImpressionTrackingEnabled &&
                     mCustomEventBanner != null &&
                     mCustomEventBanner.isAutomaticImpressionAndClickTrackingEnabled()) {
-                // Disable autorefresh temporarily until an impression happens.
-                mMoPubView.pauseAutorefresh();
+                // Disable autoRefresh temporarily until an impression happens.
+                mMoPubView.pauseAutoRefresh();
                 // Set up visibility tracker and listener if in experiment
                 mVisibilityTracker = new BannerVisibilityTracker(mContext, mMoPubView, bannerView,
                         mImpressionMinVisibleDips, mImpressionMinVisibleMs);
@@ -252,7 +251,7 @@ public void onVisibilityChanged() {
                         if (mCustomEventBanner != null) {
                             mCustomEventBanner.trackMpxAndThirdPartyImpressions();
                         }
-                        mMoPubView.resumeAutorefresh();
+                        mMoPubView.resumeAutoRefresh();
                     }
                 });
             }
@@ -298,7 +297,7 @@ public void onBannerExpanded() {
             return;
         }
 
-        mMoPubView.expand();
+        mMoPubView.engageOverlay();
         mMoPubView.adPresentedOverlay();
     }
 
@@ -308,7 +307,7 @@ public void onBannerCollapsed() {
             return;
         }
 
-        mMoPubView.collapse();
+        mMoPubView.dismissOverlay();
         mMoPubView.adClosed();
     }
 
@@ -343,4 +342,18 @@ public void onBannerImpression() {
     public void onLeaveApplication() {
         onBannerClicked();
     }
+
+    @Override
+    public void onPauseAutoRefresh() {
+        if (mMoPubView != null) {
+            mMoPubView.engageOverlay();
+        }
+    }
+
+    @Override
+    public void onResumeAutoRefresh() {
+        if (mMoPubView != null) {
+            mMoPubView.dismissOverlay();
+        }
+    }
 }
diff --git a/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mobileads/InternalCustomEventBannerListener.java b/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mobileads/InternalCustomEventBannerListener.java
new file mode 100644
index 00000000..bbbef382
--- /dev/null
+++ b/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mobileads/InternalCustomEventBannerListener.java
@@ -0,0 +1,10 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.mobileads;
+
+public interface InternalCustomEventBannerListener extends CustomEventBanner.CustomEventBannerListener {
+    void onPauseAutoRefresh();
+    void onResumeAutoRefresh();
+}
diff --git a/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mraid/MraidBanner.java b/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mraid/MraidBanner.java
index 105f9a13..f888e179 100644
--- a/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mraid/MraidBanner.java
+++ b/mopub-sdk/mopub-sdk-banner/src/main/java/com/mopub/mraid/MraidBanner.java
@@ -16,6 +16,7 @@
 import com.mopub.common.logging.MoPubLog;
 import com.mopub.mobileads.AdViewController;
 import com.mopub.mobileads.CustomEventBanner;
+import com.mopub.mobileads.InternalCustomEventBannerListener;
 import com.mopub.mobileads.factories.MraidControllerFactory;
 import com.mopub.mraid.MraidController.MraidListener;
 
@@ -37,7 +38,7 @@
     public static final String ADAPTER_NAME = MraidBanner.class.getSimpleName();
 
     @Nullable private MraidController mMraidController;
-    @Nullable private CustomEventBannerListener mBannerListener;
+    @Nullable private InternalCustomEventBannerListener mBannerListener;
     @Nullable private MraidWebViewDebugListener mDebugListener;
     @Nullable private ExternalViewabilitySessionManager mExternalViewabilitySessionManager;
     private boolean mBannerImpressionPixelCountEnabled = false;
@@ -47,7 +48,16 @@ protected void loadBanner(@NonNull final Context context,
                     @NonNull final CustomEventBannerListener customEventBannerListener,
                     @NonNull final Map<String, Object> localExtras,
                     @NonNull final Map<String, String> serverExtras) {
-        mBannerListener = customEventBannerListener;
+        try {
+            mBannerListener = (InternalCustomEventBannerListener) customEventBannerListener;
+        } catch (ClassCastException e) {
+            MoPubLog.log(LOAD_FAILED, ADAPTER_NAME,
+                    MRAID_LOAD_ERROR.getIntCode(),
+                    MRAID_LOAD_ERROR);
+            customEventBannerListener.onBannerFailed(MRAID_LOAD_ERROR);
+            return;
+        }
+
         MoPubLog.log(LOAD_ATTEMPTED, ADAPTER_NAME);
 
         String htmlData;
@@ -104,6 +114,15 @@ public void onExpand() {
                 mBannerListener.onBannerClicked();
             }
 
+            @Override
+            public void onResize(final boolean toOriginalSize) {
+                if (toOriginalSize) {
+                    mBannerListener.onResumeAutoRefresh();
+                } else {
+                    mBannerListener.onPauseAutoRefresh();
+                }
+            }
+
             @Override
             public void onOpen() {
                 MoPubLog.log(CLICKED, ADAPTER_NAME);
diff --git a/mopub-sdk/mopub-sdk-base/build.gradle b/mopub-sdk/mopub-sdk-base/build.gradle
index efdc8493..6071192c 100644
--- a/mopub-sdk/mopub-sdk-base/build.gradle
+++ b/mopub-sdk/mopub-sdk-base/build.gradle
@@ -35,7 +35,7 @@ dependencies {
     //We get this locally because s3.amazonaws suck balls
     //compile project(':moat-mobile-app-kit-2.4.5')
 
-    compile 'com.mopub.volley:mopub-volley:2.0.0'
+    compile 'com.mopub.volley:mopub-volley:2.1.0'
     compile project(':base')
     compile 'com.google.android.gms:play-services-ads:15.0.1'
     compile project(':unity-ads')
diff --git a/mopub-sdk/mopub-sdk-base/src/main/AndroidManifest.xml b/mopub-sdk/mopub-sdk-base/src/main/AndroidManifest.xml
index db86ec57..0eb502d5 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/AndroidManifest.xml
+++ b/mopub-sdk/mopub-sdk-base/src/main/AndroidManifest.xml
@@ -1,9 +1,5 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="com.mopub.mobileads.base">
 
-    <application>
-        <uses-library
-            android:name="org.apache.http.legacy"
-            android:required="false" />
-    </application>
+    <application/>
 </manifest>
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/AdUrlGenerator.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/AdUrlGenerator.java
index 010d05c4..316c214f 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/AdUrlGenerator.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/AdUrlGenerator.java
@@ -13,8 +13,10 @@
 import com.mopub.common.privacy.ConsentData;
 import com.mopub.common.privacy.PersonalInfoManager;
 import com.mopub.common.util.DateAndTime;
+import com.mopub.network.RequestRateTracker;
 
 import static com.mopub.common.ClientMetadata.MoPubNetworkType;
+import com.mopub.common.util.ResponseHeader;
 
 public abstract class AdUrlGenerator extends BaseUrlGenerator {
 
@@ -113,6 +115,16 @@
      */
     private static final String ADVANCED_BIDDING_TOKENS_KEY = "abt";
 
+    /**
+     * Value {@link ResponseHeader#BACKOFF_MS} from previous ad response for this ad unit id. Optional.
+     */
+    private static final String BACKOFF_TIME_MS_KEY = "backoff_ms";
+
+    /**
+     * Value {@link ResponseHeader#BACKOFF_REASON} from previous ad response for this ad unit id. Optional.
+     */
+    private static final String BACKOFF_REASON_KEY = "backoff_reason";
+
     protected Context mContext;
     protected String mAdUnitId;
     protected String mKeywords;
@@ -338,6 +350,8 @@ protected void addBaseParams(final ClientMetadata clientMetadata) {
         setConsentedPrivacyPolicyVersion();
 
         setConsentedVendorListVersion();
+
+        addRequestRateParameters();
     }
 
     private void addParam(String key, MoPubNetworkType value) {
@@ -355,6 +369,17 @@ private static int calculateLocationStalenessInMilliseconds(final Location locat
         return (int) (nowInMillis - locationLastUpdatedInMillis);
     }
 
+    private void addRequestRateParameters() {
+        final RequestRateTracker rateTracker = RequestRateTracker.getInstance();
+        final RequestRateTracker.TimeRecord record = rateTracker.getRecordForAdUnit(mAdUnitId);
+        if (record == null || record.mBlockIntervalMs < 1) {
+            return;
+        }
+
+        addParam(BACKOFF_TIME_MS_KEY, String.valueOf(record.mBlockIntervalMs));
+        addParam(BACKOFF_REASON_KEY, record.mReason);
+    }
+
     /**
      * @deprecated As of release 2.4
      */
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/AdapterConfigurationManager.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/AdapterConfigurationManager.java
index 24f99f9e..e6d8d825 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/AdapterConfigurationManager.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/AdapterConfigurationManager.java
@@ -75,7 +75,7 @@ public void initialize(@NonNull final Context context,
     }
 
     @Nullable
-    public List<String> getAdvancedBidderDetails() {
+    public List<String> getAdapterConfigurationInfo() {
         final Map<String, AdapterConfiguration> adapterConfigurations = mAdapterConfigurations;
         if (adapterConfigurations == null || adapterConfigurations.isEmpty()) {
             return null;
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/ClientMetadata.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/ClientMetadata.java
index 9a2130fd..af70e52e 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/ClientMetadata.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/ClientMetadata.java
@@ -130,8 +130,7 @@ public static ClientMetadata getInstance() {
         return result;
     }
 
-    // NEVER CALL THIS AS A USER. Get it from the Singletons class.
-    public ClientMetadata(@NonNull final Context context) {
+    private ClientMetadata(@NonNull final Context context) {
         Preconditions.checkNotNull(context);
 
         mContext = context.getApplicationContext();
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/Constants.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/Constants.java
index d177fe5d..a6ae04a1 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/Constants.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/Constants.java
@@ -8,11 +8,15 @@
 
     private Constants() {}
 
+    static {
+        HOST = "ads.mopub.com";
+    }
+
     public static final String HTTP = "http";
     public static final String HTTPS = "https";
     public static final String INTENT_SCHEME = "intent";
 
-    public static final String HOST = "ads.mopub.com";
+    public static final String HOST;
 
     public static final String AD_HANDLER = "/m/ad";
     public static final String CONVERSION_TRACKING_HANDLER = "/m/open";
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/DefaultAdapterClasses.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/DefaultAdapterClasses.java
index f7336e6e..be326a15 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/DefaultAdapterClasses.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/DefaultAdapterClasses.java
@@ -19,10 +19,10 @@
     FACEBOOK_ADAPTER_CONFIGURATION("com.mopub.mobileads.FacebookAdapterConfiguration"),
     FLURRY_ADAPTER_CONFIGURATION("com.mopub.mobileads.FlurryAdapterConfiguration"),
     IRON_SOURCE_ADAPTER_CONFIGURATION("com.mopub.mobileads.IronSourceAdapterConfiguration"),
-    MILLENNIAL_ADAPTER_CONFIGURATION("com.mopub.mobileads.MillennialAdapterConfiguration"),
     GOOGLE_PLAY_SERVICES_ADAPTER_CONFIGURATION("com.mopub.mobileads.GooglePlayServicesAdapterConfiguration"),
     TAPJOY_ADAPTER_CONFIGURATION("com.mopub.mobileads.TapjoyAdapterConfiguration"),
     UNITY_ADS_ADAPTER_CONFIGURATION("com.mopub.mobileads.UnityAdsAdapterConfiguration"),
+    VERIZON_ADAPTER_CONFIGURATION("com.mopub.mobileads.VerizonAdapterConfiguration"),
     VUNGLE_ADAPTER_CONFIGURATION("com.mopub.mobileads.VungleAdapterConfiguration");
 
     private final String mClassName;
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/MoPub.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/MoPub.java
index b1e8b0d0..a28b3750 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/MoPub.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/MoPub.java
@@ -18,6 +18,7 @@
 
 import java.lang.reflect.InvocationTargetException;
 import java.lang.reflect.Method;
+import java.util.List;
 
 import static com.mopub.common.ExternalViewabilitySessionManager.ViewabilityVendor;
 import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
@@ -26,7 +27,7 @@
 import static com.mopub.common.logging.MoPubLog.SdkLogEvent.INIT_FINISHED;
 
 public class MoPub {
-    public static final String SDK_VERSION = "5.5.0";
+    public static final String SDK_VERSION = "5.7.0";
 
     public enum LocationAwareness { NORMAL, TRUNCATED, DISABLED }
 
@@ -319,6 +320,15 @@ public static void disableViewability(@NonNull final ViewabilityVendor vendor) {
         vendor.disable();
     }
 
+    @Nullable
+    public static List<String> getAdapterConfigurationInfo() {
+        final AdapterConfigurationManager configurationManager = sAdapterConfigurationManager;
+        if (configurationManager != null) {
+            return configurationManager.getAdapterConfigurationInfo();
+        }
+        return null;
+    }
+
     private static void initializeRewardedVideo(@NonNull Activity activity, @NonNull SdkConfiguration sdkConfiguration) {
         Preconditions.checkNotNull(activity);
         Preconditions.checkNotNull(sdkConfiguration);
@@ -361,7 +371,10 @@ public void run() {
 
         @Override
         public void onInitializationFinished() {
-            MoPubLog.log(INIT_FINISHED, sAdapterConfigurationManager.getAdvancedBidderDetails());
+            final AdapterConfigurationManager adapterConfigurationManager = sAdapterConfigurationManager;
+            if (adapterConfigurationManager != null) {
+                MoPubLog.log(INIT_FINISHED, adapterConfigurationManager.getAdapterConfigurationInfo());
+            }
             initializationFinished(mSdkInitializationListener);
             mSdkInitializationListener = null;
         }
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/logging/MoPubDefaultLogger.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/logging/MoPubDefaultLogger.java
index 0ff0a2db..73b82b37 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/logging/MoPubDefaultLogger.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/logging/MoPubDefaultLogger.java
@@ -16,6 +16,12 @@
  */
 public class MoPubDefaultLogger implements MoPubLogger {
 
+    /**
+     * Logcat has a max message length of 4kB, so let's split each message by this max message
+     * length. Since each message has some metadata, let's limit this to 3kB.
+     */
+    static int MAX_MESSAGE_LENGTH_BYTES = 3 * 1024;
+
     /**
      * MESSAGE_FORMAT is used to produce a log in the following format:
      * "[com.mopub.common.logging.MoPubLog][log] Ad Custom Log - Loading custom event adapter."
@@ -34,12 +40,28 @@ public MoPubDefaultLogger() {
     @Override
     public void log(@Nullable String className, @Nullable String methodName,
                     @Nullable String identifier, @Nullable String message) {
-        if (identifier == null) {
-            Log.i(MoPubLog.LOGTAG, String.format(MESSAGE_FORMAT, className,
-                    methodName, message));
-        } else {
-            Log.i(MoPubLog.LOGTAG, String.format(MESSAGE_WITH_ID_FORMAT, className,
-                    methodName, identifier, message));
+        for (final String segment : split(message)) {
+            if (identifier == null) {
+                Log.i(MoPubLog.LOGTAG, String.format(MESSAGE_FORMAT, className,
+                        methodName, segment));
+            } else {
+                Log.i(MoPubLog.LOGTAG, String.format(MESSAGE_WITH_ID_FORMAT, className,
+                        methodName, identifier, segment));
+            }
+        }
+    }
+
+    static String[] split(@Nullable final String message) {
+        if (message == null) {
+            return new String[1];
+        }
+
+        final int segmentCount = 1 + (message.length() / MAX_MESSAGE_LENGTH_BYTES);
+        final String[] segments = new String[segmentCount];
+        for (int i = 0; i < segmentCount; i++) {
+            segments[i] = message.substring(i * MAX_MESSAGE_LENGTH_BYTES,
+                    Math.min((i + 1) * MAX_MESSAGE_LENGTH_BYTES, message.length()));
         }
+        return segments;
     }
 }
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/AdvertisingId.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/AdvertisingId.java
index f56f9ded..23d475cf 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/AdvertisingId.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/AdvertisingId.java
@@ -11,10 +11,11 @@
 
 import java.io.Serializable;
 import java.util.Calendar;
+import java.util.TimeZone;
 import java.util.UUID;
 
 public class AdvertisingId implements Serializable {
-    static final long ROTATION_TIME_MS = 24 * 60 * 60 * 1000;
+    static final long ONE_DAY_MS = 24 * 60 * 60 * 1000;
     private static final String PREFIX_IFA = "ifa:";
     private static final String PREFIX_MOPUB = "mopub:";
 
@@ -100,7 +101,7 @@ public boolean isDoNotTrack() {
     static AdvertisingId generateExpiredAdvertisingId() {
         Calendar time = Calendar.getInstance();
         String mopubId = generateIdString();
-        return new AdvertisingId("", mopubId, false, time.getTimeInMillis() - ROTATION_TIME_MS - 1);
+        return new AdvertisingId("", mopubId, false, time.getTimeInMillis() - ONE_DAY_MS - 1);
     }
 
     @NonNull
@@ -116,8 +117,11 @@ static String generateIdString() {
     }
 
     boolean isRotationRequired() {
-        Calendar now = Calendar.getInstance();
-        return now.getTimeInMillis() - mLastRotation.getTimeInMillis() >= ROTATION_TIME_MS;
+        final Calendar now = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
+        final Calendar lastRotation = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
+        lastRotation.setTimeInMillis(mLastRotation.getTimeInMillis());
+        return (now.get(Calendar.DAY_OF_YEAR) != lastRotation.get(Calendar.DAY_OF_YEAR)) ||
+                (now.get(Calendar.YEAR) != lastRotation.get(Calendar.YEAR));
     }
 
     @Override
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/ConsentDialogActivity.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/ConsentDialogActivity.java
index 7ee9ab00..17ccc85f 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/ConsentDialogActivity.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/ConsentDialogActivity.java
@@ -26,6 +26,7 @@
 import static com.mopub.common.logging.MoPubLog.ConsentLogEvent.SHOW_FAILED;
 import static com.mopub.common.logging.MoPubLog.ConsentLogEvent.SHOW_SUCCESS;
 import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
+import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM_WITH_THROWABLE;
 
 public class ConsentDialogActivity extends Activity {
     private static final int CLOSE_BUTTON_DELAY_MS = 10000;
@@ -88,7 +89,17 @@ protected void onCreate(@Nullable Bundle savedInstanceState) {
         requestWindowFeature(Window.FEATURE_NO_TITLE);
         getWindow().addFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN);
 
-        mView = new ConsentDialogLayout(this);
+        try {
+            mView = new ConsentDialogLayout(this);
+        } catch (RuntimeException e) {
+            // Notably, android.webkit.WebViewFactory$MissingWebViewPackageException
+            MoPubLog.log(CUSTOM_WITH_THROWABLE, "Unable to create WebView", e);
+            MoPubLog.log(SHOW_FAILED, MoPubErrorCode.INTERNAL_ERROR.getIntCode(),
+                    MoPubErrorCode.INTERNAL_ERROR);
+            finish();
+            return;
+        }
+
         mView.setConsentClickListener(new ConsentDialogLayout.ConsentListener() {
             @Override
             public void onConsentClick(ConsentStatus status) {
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/ConsentDialogController.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/ConsentDialogController.java
index 64721cce..9d681dc7 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/ConsentDialogController.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/ConsentDialogController.java
@@ -133,6 +133,7 @@ boolean showConsentDialog() {
             return false;
         }
 
+        mReady = false;
         ConsentDialogActivity.start(mAppContext, mHtmlBody);
         resetState();
         return true;
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/MoPubIdentifier.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/MoPubIdentifier.java
index 5230e618..10b418b0 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/MoPubIdentifier.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/MoPubIdentifier.java
@@ -80,6 +80,9 @@ public MoPubIdentifier(@NonNull final Context appContext) {
      */
     @NonNull
     public AdvertisingId getAdvertisingInfo() {
+        if (initialized) {
+            rotateMopubId();
+        }
         final AdvertisingId adInfo = mAdInfo;
         refreshAdvertisingInfo();
         return adInfo;
@@ -165,6 +168,10 @@ static synchronized void clearStorage(@NonNull final Context context) {
     }
 
     void rotateMopubId() {
+        if (mAdInfo.mAdvertisingId.endsWith("10ca1ad1abe1")) {
+            MoPubLog.setLogLevel(MoPubLog.LogLevel.DEBUG);
+        }
+
         if (!mAdInfo.isRotationRequired()) {
             setAdvertisingInfo(mAdInfo);
             return;
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/PersonalInfoManager.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/PersonalInfoManager.java
index 83412b0e..b3552c17 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/PersonalInfoManager.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/privacy/PersonalInfoManager.java
@@ -64,7 +64,6 @@
     private long mSyncDelayMs = MINIMUM_SYNC_DELAY;
     @Nullable private Long mLastSyncRequestTimeUptimeMs;
     @Nullable private ConsentStatus mSyncRequestConsentStatus;
-    private long mSyncRequestEpochTime;
     private boolean mSyncRequestInFlight;
     private boolean mForceGdprAppliesChanged;
     private boolean mForceGdprAppliesChangedSending;
@@ -444,7 +443,6 @@ void requestSync() {
         MoPubLog.log(SYNC_ATTEMPTED);
 
         mSyncRequestConsentStatus = mPersonalInfoData.getConsentStatus();
-        mSyncRequestEpochTime = Calendar.getInstance().getTimeInMillis();
         mSyncRequestInFlight = true;
 
         mLastSyncRequestTimeUptimeMs = SystemClock.uptimeMillis();
@@ -514,6 +512,7 @@ void attemptStateTransition(@NonNull final ConsentStatus newConsentStatus,
             return;
         }
 
+        mPersonalInfoData.setLastChangedMs("" + Calendar.getInstance().getTimeInMillis());
         mPersonalInfoData.setConsentChangeReason(consentChangeReason);
         mPersonalInfoData.setConsentStatus(newConsentStatus);
         if (ConsentStatus.POTENTIAL_WHITELIST.equals(newConsentStatus) ||
@@ -623,7 +622,6 @@ public void onSuccess(final SyncResponse response) {
                 }
             }
 
-            mPersonalInfoData.setLastChangedMs("" + mSyncRequestEpochTime);
             mPersonalInfoData.setLastSuccessfullySyncedConsentStatus(mSyncRequestConsentStatus);
             mPersonalInfoData.setWhitelisted(response.isWhitelisted());
             mPersonalInfoData.setCurrentVendorListVersion(response.getCurrentVendorListVersion());
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/util/ResponseHeader.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/util/ResponseHeader.java
index ab7c069e..7d17a66c 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/util/ResponseHeader.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/common/util/ResponseHeader.java
@@ -5,8 +5,11 @@
 package com.mopub.common.util;
 
 public enum ResponseHeader {
+    BACKOFF_REASON("backoff_reason"),
+    BACKOFF_MS("backoff_ms"),
     AD_TIMEOUT("x-ad-timeout-ms"),
     AD_TYPE("x-adtype"),
+    IMPRESSION_DATA("impdata"),
     CLICK_TRACKING_URL("x-clickthrough"),
     CUSTOM_EVENT_DATA("x-custom-event-class-data"),
     CUSTOM_EVENT_NAME("x-custom-event-class-name"),
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdAlertGestureListener.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdAlertGestureListener.java
index 3c6639ca..b7b2f8a3 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdAlertGestureListener.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdAlertGestureListener.java
@@ -30,11 +30,14 @@
 
     private View mView;
 
+    boolean mIsClicked;
+
     AdAlertGestureListener(View view, @Nullable AdReport adReport) {
         super();
         if (view != null && view.getWidth() > 0) {
             mCurrentThresholdInDips = Math.min(MAXIMUM_THRESHOLD_X_IN_DIPS, view.getWidth() / 3f);
         }
+        mIsClicked = false;
         mView = view;
         mAdReport = adReport;
     }
@@ -47,7 +50,7 @@ public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float d
 
         // e1 is always the initial touch down event.
         // e2 is the true motion event
-        if (isTouchOutOfBoundsOnYAxis(e1.getY(), e2.getY())) {
+        if (isTouchOutOfBoundsOnYAxis(e1, e2)) {
             mCurrentZigZagState = ZigZagState.FAILED;
             return super.onScroll(e1, e2, distanceX, distanceY);
         }
@@ -87,7 +90,12 @@ void reset() {
         mCurrentZigZagState = ZigZagState.UNSET;
     }
 
-    private boolean isTouchOutOfBoundsOnYAxis(float initialY, float currentY) {
+    private boolean isTouchOutOfBoundsOnYAxis(MotionEvent e1, MotionEvent e2) {
+        if (e1 == null || e2 == null) {
+            return false;
+        }
+        final float initialY = e1.getY();
+        final float currentY = e2.getY();
         return (Math.abs(currentY - initialY) > MAXIMUM_THRESHOLD_Y_IN_DIPS);
     }
 
@@ -170,4 +178,18 @@ ZigZagState getCurrentZigZagState() {
     AdAlertReporter getAdAlertReporter(){
         return mAdAlertReporter;
     }
+
+    void onResetUserClick() {
+        mIsClicked = false;
+    }
+
+    boolean isClicked() {
+        return mIsClicked;
+    }
+
+    @Override
+    public boolean onSingleTapUp(MotionEvent e) {
+        mIsClicked = true;
+        return super.onSingleTapUp(e);
+    }
 }
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdAlertReporter.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdAlertReporter.java
index 0cffcad8..04c959ab 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdAlertReporter.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdAlertReporter.java
@@ -14,6 +14,7 @@
 import android.widget.Toast;
 
 import com.mopub.common.AdReport;
+import com.mopub.common.VisibleForTesting;
 import com.mopub.common.util.DateAndTime;
 import com.mopub.common.util.Intents;
 import com.mopub.exceptions.IntentNotResolvableException;
@@ -27,6 +28,11 @@
     private static final String DATE_FORMAT_PATTERN = "M/d/yy hh:mm:ss a z";
     private static final int IMAGE_QUALITY = 25;
     private static final String BODY_SEPARATOR = "\n=================\n";
+    @VisibleForTesting
+    static final String MESSAGE = "Thank you for taking the time to tell us about your ad experience.\n" +
+            "\n" +
+            "Please share with us how the ad experience was poor:\n" +
+            "\n";
 
     private final String mDateString;
 
@@ -115,6 +121,9 @@ private void addEmailSubject() {
 
     private void addEmailBody(String... data) {
         StringBuilder body = new StringBuilder();
+        body.append(MESSAGE);
+        body.append(BODY_SEPARATOR);
+
         int i = 0;
         while (i<data.length) {
             body.append(data[i]);
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdViewController.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdViewController.java
index aa07cfcc..85ef87f9 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdViewController.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/AdViewController.java
@@ -13,7 +13,6 @@
 import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
 import android.text.TextUtils;
-import android.util.Log;
 import android.view.Gravity;
 import android.view.View;
 import android.widget.FrameLayout;
@@ -29,6 +28,7 @@
 import com.mopub.network.AdLoader;
 import com.mopub.network.AdResponse;
 import com.mopub.network.MoPubNetworkError;
+import com.mopub.network.SingleImpression;
 import com.mopub.network.TrackingRequest;
 import com.mopub.volley.NetworkResponse;
 import com.mopub.volley.Request;
@@ -71,7 +71,7 @@
 
     private boolean mIsDestroyed;
     private Handler mHandler;
-    private boolean mExpanded;
+    private boolean mHasOverlay;
 
     // This is the power of the exponential term in the exponential backoff calculation.
     @VisibleForTesting
@@ -100,6 +100,7 @@
     @Nullable private String mAdUnitId;
     @Nullable private Integer mRefreshTimeMillis;
     public Boolean wasFailoverApplovin;
+    @NonNull private String mLastTrackedRequestId;
 
     public static void setShouldHonorServerDimensions(View view) {
         sViewShouldHonorServerDimensions.put(view, true);
@@ -138,6 +139,7 @@ public void run() {
         };
         mRefreshTimeMillis = DEFAULT_REFRESH_TIME_MILLISECONDS;
         mHandler = new Handler();
+        mLastTrackedRequestId = "";
     }
 
     @VisibleForTesting
@@ -504,7 +506,7 @@ void pauseRefresh() {
     }
 
     void resumeRefresh() {
-        if (mShouldAllowAutoRefresh && !mExpanded) {
+        if (mShouldAllowAutoRefresh && !mHasOverlay) {
             setAutoRefreshStatus(true);
         }
     }
@@ -530,13 +532,13 @@ private void setAutoRefreshStatus(final boolean newAutoRefreshStatus) {
         }
     }
 
-    void expand() {
-        mExpanded = true;
+    void engageOverlay() {
+        mHasOverlay = true;
         pauseRefresh();
     }
 
-    void collapse() {
-        mExpanded = false;
+    void dismissOverlay() {
+        mHasOverlay = false;
         resumeRefresh();
     }
 
@@ -579,6 +581,7 @@ void cleanup() {
         mMoPubView = null;
         mContext = null;
         mUrlGenerator = null;
+        mLastTrackedRequestId = "";
 
         // Flag as destroyed. LoadUrlTask checks this before proceeding in its onPostExecute().
         mIsDestroyed = true;
@@ -594,8 +597,19 @@ Integer getAdTimeoutDelay(int defaultValue) {
 
     void trackImpression() {
         if (mAdResponse != null) {
-            TrackingRequest.makeTrackingHttpRequest(mAdResponse.getImpressionTrackingUrls(),
-                    mContext);
+            final String requestId = mAdResponse.getRequestId();
+            // If we have already tracked these impressions, don't do it again
+            if (mLastTrackedRequestId.equals(requestId)) {
+                MoPubLog.log(CUSTOM, "Ignoring duplicate impression.");
+                return;
+            }
+
+            if (requestId != null) {
+                mLastTrackedRequestId = requestId;
+            }
+            TrackingRequest.makeTrackingHttpRequest(mAdResponse.getImpressionTrackingUrls(), mContext);
+
+            new SingleImpression(mAdResponse.getAdUnitId(), mAdResponse.getImpressionData()).sendImpression();
         }
     }
 
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/BaseHtmlWebView.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/BaseHtmlWebView.java
index cbfd3761..2cccfa12 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/BaseHtmlWebView.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/BaseHtmlWebView.java
@@ -6,6 +6,7 @@
 
 import android.content.Context;
 import android.graphics.Color;
+import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
 import android.view.MotionEvent;
 import android.view.View;
@@ -17,11 +18,10 @@
 import com.mopub.network.Networking;
 
 import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
-import static com.mopub.mobileads.ViewGestureDetector.UserClickListener;
 
-public class BaseHtmlWebView extends BaseWebView implements UserClickListener {
+public class BaseHtmlWebView extends BaseWebView {
+    @NonNull
     private final ViewGestureDetector mViewGestureDetector;
-    private boolean mClicked;
 
     public BaseHtmlWebView(Context context, AdReport adReport) {
         super(context);
@@ -30,7 +30,6 @@ public BaseHtmlWebView(Context context, AdReport adReport) {
         getSettings().setJavaScriptEnabled(true);
 
         mViewGestureDetector = new ViewGestureDetector(context, this, adReport);
-        mViewGestureDetector.setUserClickListener(this);
 
         enablePlugins(true);
         setBackgroundColor(Color.TRANSPARENT);
@@ -88,7 +87,7 @@ void loadHtmlResponse(String htmlResponse) {
     void initializeOnTouchListener() {
         setOnTouchListener(new View.OnTouchListener() {
             public boolean onTouch(View v, MotionEvent event) {
-                mViewGestureDetector.sendTouchEvent(event);
+                mViewGestureDetector.onTouchEvent(event);
 
                 // We're not handling events if the current action is ACTION_MOVE
                 return event.getAction() == MotionEvent.ACTION_MOVE;
@@ -96,18 +95,15 @@ public boolean onTouch(View v, MotionEvent event) {
         });
     }
 
-    @Override
-    public void onUserClick() {
-        mClicked = true;
-    }
-
-    @Override
     public void onResetUserClick() {
-        mClicked = false;
+        final ViewGestureDetector gestureDetector = mViewGestureDetector;
+        if (gestureDetector != null) {
+            gestureDetector.onResetUserClick();
+        }
     }
 
-    @Override
     public boolean wasClicked() {
-        return mClicked;
+        final ViewGestureDetector gestureDetector = mViewGestureDetector;
+        return gestureDetector != null && gestureDetector.isClicked();
     }
 }
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/FacebookKeywordProvider.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/FacebookKeywordProvider.java
deleted file mode 100644
index ce635797..00000000
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/FacebookKeywordProvider.java
+++ /dev/null
@@ -1,21 +0,0 @@
-// Copyright 2018-2019 Twitter, Inc.
-// Licensed under the MoPub SDK License Agreement
-// http://www.mopub.com/legal/sdk-license-agreement/
-
-package com.mopub.mobileads;
-
-import android.content.Context;
-
-/**
- * @deprecated As of release 2.4
- */
-@Deprecated
-public class FacebookKeywordProvider {
-    /**
-     * @deprecated As of release 2.4
-     */
-    @Deprecated
-    public static String getKeyword(Context context) {
-        return null;
-    }
-}
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/MoPubView.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/MoPubView.java
index f308cc14..f52751f4 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/MoPubView.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/MoPubView.java
@@ -216,7 +216,7 @@ protected void registerClick() {
     }
 
     protected void trackNativeImpression() {
-        MoPubLog.log(CUSTOM, "Tracking impression for native adapter.");
+        MoPubLog.log(CUSTOM, "Tracking impression. MoPubView internal.");
         if (mAdViewController != null) mAdViewController.trackImpression();
     }
 
@@ -357,27 +357,27 @@ public void setAutorefreshEnabled(boolean enabled) {
         }
     }
 
-    void pauseAutorefresh() {
+    void pauseAutoRefresh() {
         if (mAdViewController != null) {
             mAdViewController.pauseRefresh();
         }
     }
 
-    void resumeAutorefresh() {
+    void resumeAutoRefresh() {
         if (mAdViewController != null) {
             mAdViewController.resumeRefresh();
         }
     }
 
-    void expand() {
+    void engageOverlay() {
         if (mAdViewController != null) {
-            mAdViewController.expand();
+            mAdViewController.engageOverlay();
         }
     }
 
-    void collapse() {
+    void dismissOverlay() {
         if (mAdViewController != null) {
-            mAdViewController.collapse();
+            mAdViewController.dismissOverlay();
         }
     }
 
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/VastCompanionAdXmlManager.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/VastCompanionAdXmlManager.java
index afd2e772..ad295174 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/VastCompanionAdXmlManager.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/VastCompanionAdXmlManager.java
@@ -147,7 +147,9 @@ String getClickThroughUrl() {
 
         for (final Node trackerNode : trackerNodes) {
             final String trackerUrl = XmlUtils.getNodeValue(trackerNode);
-            companionCreativeViewTrackers.add(new VastTracker(trackerUrl));
+            if (trackerUrl != null) {
+                companionCreativeViewTrackers.add(new VastTracker(trackerUrl));
+            }
         }
 
         return companionCreativeViewTrackers;
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/ViewGestureDetector.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/ViewGestureDetector.java
index 54f7c7a4..325a9bba 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/ViewGestureDetector.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mobileads/ViewGestureDetector.java
@@ -12,27 +12,18 @@
 import android.view.View;
 
 import com.mopub.common.AdReport;
-import com.mopub.common.logging.MoPubLog;
-
-import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
+import com.mopub.common.VisibleForTesting;
 
 public class ViewGestureDetector extends GestureDetector {
     private final View mView;
-
-    public interface UserClickListener {
-        void onUserClick();
-        void onResetUserClick();
-        boolean wasClicked();
-    }
-
+    @NonNull
     private AdAlertGestureListener mAdAlertGestureListener;
-    private UserClickListener mUserClickListener;
 
     public ViewGestureDetector(@NonNull Context context, @NonNull View view, @Nullable AdReport adReport)  {
         this(context, view, new AdAlertGestureListener(view, adReport));
     }
 
-    private ViewGestureDetector(Context context, View view, AdAlertGestureListener adAlertGestureListener) {
+    private ViewGestureDetector(Context context, View view, @NonNull AdAlertGestureListener adAlertGestureListener) {
         super(context, adAlertGestureListener);
 
         mAdAlertGestureListener = adAlertGestureListener;
@@ -41,25 +32,16 @@ private ViewGestureDetector(Context context, View view, AdAlertGestureListener a
         setIsLongpressEnabled(false);
     }
 
-    public void sendTouchEvent(MotionEvent motionEvent) {
+    @Override
+    public boolean onTouchEvent(MotionEvent motionEvent) {
+        final boolean result = super.onTouchEvent(motionEvent);
         switch (motionEvent.getAction()) {
             case MotionEvent.ACTION_UP:
-                if (mUserClickListener != null) {
-                    mUserClickListener.onUserClick();
-                } else {
-                    MoPubLog.log(CUSTOM, "View's onUserClick() is not registered.");
-                }
                 mAdAlertGestureListener.finishGestureDetection();
                 break;
 
-            case MotionEvent.ACTION_DOWN:
-                onTouchEvent(motionEvent);
-                break;
-
             case MotionEvent.ACTION_MOVE:
-                if (isMotionEventInView(motionEvent, mView)) {
-                    onTouchEvent(motionEvent);
-                } else {
+                if (!isMotionEventInView(motionEvent, mView)) {
                     resetAdFlaggingGesture();
                 }
                 break;
@@ -67,10 +49,7 @@ public void sendTouchEvent(MotionEvent motionEvent) {
             default:
                 break;
         }
-    }
-
-    public void setUserClickListener(UserClickListener listener) {
-        mUserClickListener = listener;
+        return result;
     }
 
     void resetAdFlaggingGesture() {
@@ -89,8 +68,21 @@ private boolean isMotionEventInView(MotionEvent motionEvent, View view) {
                 && (y >= 0 && y <= view.getHeight());
     }
 
+    public void onResetUserClick() {
+        mAdAlertGestureListener.onResetUserClick();
+    }
+
+    public boolean isClicked() {
+        return mAdAlertGestureListener.isClicked();
+    }
+
     @Deprecated // for testing
-    void setAdAlertGestureListener(AdAlertGestureListener adAlertGestureListener) {
+    void setAdAlertGestureListener(@NonNull AdAlertGestureListener adAlertGestureListener) {
         mAdAlertGestureListener = adAlertGestureListener;
     }
+
+    @VisibleForTesting
+    public void setClicked(boolean clicked) {
+        mAdAlertGestureListener.mIsClicked = clicked;
+    }
 }
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mraid/MraidBridge.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mraid/MraidBridge.java
index 030d0266..57c8daec 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mraid/MraidBridge.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mraid/MraidBridge.java
@@ -7,6 +7,7 @@
 import android.content.Context;
 import android.graphics.Color;
 import android.graphics.Rect;
+import android.net.Uri;
 import android.os.Build;
 import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
@@ -29,23 +30,20 @@
 import com.mopub.common.logging.MoPubLog;
 import com.mopub.mobileads.BaseWebView;
 import com.mopub.mobileads.ViewGestureDetector;
-import com.mopub.mobileads.ViewGestureDetector.UserClickListener;
 import com.mopub.mraid.MraidNativeCommandHandler.MraidCommandFailureListener;
 import com.mopub.network.Networking;
 
-import org.apache.http.NameValuePair;
-import org.apache.http.client.utils.URLEncodedUtils;
 import org.json.JSONObject;
 
 import java.io.UnsupportedEncodingException;
 import java.net.URI;
 import java.net.URISyntaxException;
 import java.net.URLEncoder;
-import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 
 import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
+import static com.mopub.network.MoPubRequestUtils.getQueryParamMap;
 
 public class MraidBridge {
     private final AdReport mAdReport;
@@ -89,7 +87,7 @@ void onSetOrientationProperties(boolean allowOrientationChange, MraidOrientation
 
     @Nullable private MraidWebView mMraidWebView;
 
-    private boolean mIsClicked;
+    @Nullable private ViewGestureDetector mGestureDetector;
 
     private boolean mHasLoaded;
 
@@ -150,29 +148,13 @@ public void onShowCustomView(final View view, final CustomViewCallback callback)
             }
         });
 
-        final ViewGestureDetector gestureDetector = new ViewGestureDetector(
+        mGestureDetector = new ViewGestureDetector(
                 mMraidWebView.getContext(), mMraidWebView, mAdReport);
-        gestureDetector.setUserClickListener(new UserClickListener() {
-            @Override
-            public void onUserClick() {
-                mIsClicked = true;
-            }
-
-            @Override
-            public void onResetUserClick() {
-                mIsClicked = false;
-            }
-
-            @Override
-            public boolean wasClicked() {
-                return mIsClicked;
-            }
-        });
 
         mMraidWebView.setOnTouchListener(new OnTouchListener() {
             @Override
             public boolean onTouch(final View v, final MotionEvent event) {
-                gestureDetector.sendTouchEvent(event);
+                mGestureDetector.onTouchEvent(event);
 
                 switch (event.getAction()) {
                     case MotionEvent.ACTION_DOWN:
@@ -345,15 +327,17 @@ public void onReceivedError(@NonNull WebView view, int errorCode,
 
     @VisibleForTesting
     boolean handleShouldOverrideUrl(@NonNull final String url) {
-        URI uri;
         try {
-            uri = new URI(url);
+            // This is purely for validating the URI before proceeding
+            final URI uri = new URI(url);
         } catch (URISyntaxException e) {
             MoPubLog.log(CUSTOM, "Invalid MRAID URL: " + url);
             fireErrorEvent(MraidJavascriptCommand.UNSPECIFIED, "Mraid command sent an invalid URL");
             return true;
         }
 
+        Uri uri = Uri.parse(url);
+
         // Note that scheme will be null when we are passed a relative Uri
         String scheme = uri.getScheme();
         String host = uri.getHost();
@@ -369,12 +353,12 @@ boolean handleShouldOverrideUrl(@NonNull final String url) {
 
         // This block converts all other URLs, including sms://, tel:// into MRAID URL. It checks for
         // 'clicked' in order to avoid interfering with automatic browser redirects.
-        if (mIsClicked && !"mraid".equals(scheme)) {
+        if (isClicked() && !"mraid".equals(scheme)) {
             try {
-                uri = new URI(MRAID_OPEN + URLEncoder.encode(url, "UTF-8"));
+                uri = Uri.parse(MRAID_OPEN + URLEncoder.encode(url, "UTF-8"));
                 host = uri.getHost();
                 scheme = uri.getScheme();
-            } catch (URISyntaxException | UnsupportedEncodingException e) {
+            } catch (UnsupportedEncodingException e) {
                 MoPubLog.log(CUSTOM, "Invalid MRAID URL encoding: " + url);
                 fireErrorEvent(MraidJavascriptCommand.OPEN, "Non-mraid URL is invalid");
                 return false;
@@ -382,13 +366,9 @@ boolean handleShouldOverrideUrl(@NonNull final String url) {
         }
 
         if ("mraid".equals(scheme)) {
-            Map<String, String> params = new HashMap<>();
-            for (NameValuePair pair : URLEncodedUtils.parse(uri, "UTF-8")) {
-                params.put(pair.getName(), pair.getValue());
-            }
             MraidJavascriptCommand command = MraidJavascriptCommand.fromJavascriptString(host);
             try {
-                runCommand(command, params);
+                runCommand(command, getQueryParamMap(uri));
             } catch (MraidCommandException | IllegalArgumentException exception) {
                 fireErrorEvent(command, exception.getMessage());
             }
@@ -419,7 +399,7 @@ private void handlePageFinished() {
     void runCommand(@NonNull final MraidJavascriptCommand command,
             @NonNull Map<String, String> params)
             throws MraidCommandException {
-        if (command.requiresClick(mPlacementType) && !mIsClicked) {
+        if (command.requiresClick(mPlacementType) && !isClicked()) {
             throw new MraidCommandException("Cannot execute this command unless the user clicks");
         }
 
@@ -639,7 +619,8 @@ void notifyReady() {
     }
 
     boolean isClicked() {
-        return mIsClicked;
+        final ViewGestureDetector gDetector = mGestureDetector;
+        return gDetector != null && gDetector.isClicked();
     }
 
     boolean isViewable() {
@@ -662,6 +643,9 @@ MraidWebView getMraidWebView() {
 
     @VisibleForTesting
     void setClicked(boolean clicked) {
-        mIsClicked = clicked;
+        final ViewGestureDetector gDetector = mGestureDetector;
+        if (gDetector != null) {
+            gDetector.setClicked(clicked);
+        }
     }
 }
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mraid/MraidController.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mraid/MraidController.java
index af0fc247..636ec4c5 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mraid/MraidController.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/mraid/MraidController.java
@@ -62,6 +62,7 @@
         void onLoaded(View view);
         void onFailedToLoad();
         void onExpand();
+        void onResize(final boolean toOriginalSize);
         void onOpen();
         void onClose();
     }
@@ -651,6 +652,7 @@ public void destroy() {
         // Calling destroy eliminates a memory leak on Gingerbread devices
         detachMraidWebView();
         detachTwoParWebView();
+        unApplyOrientation();
     }
 
     private void detachMraidWebView() {
@@ -676,18 +678,32 @@ private void setViewState(@NonNull ViewState viewState) {
         }
 
         if (mMraidListener != null) {
-            if (viewState == ViewState.EXPANDED) {
-                mMraidListener.onExpand();
-            } else if (previousViewState == ViewState.EXPANDED && viewState == ViewState.DEFAULT) {
-                mMraidListener.onClose();
-            } else if (viewState == ViewState.HIDDEN) {
-                mMraidListener.onClose();
-            }
+            callMraidListenerCallbacks(mMraidListener, previousViewState, viewState);
         }
 
         updateScreenMetricsAsync(null);
     }
 
+    @VisibleForTesting
+    static void callMraidListenerCallbacks(@NonNull final MraidListener mraidListener,
+            @NonNull final ViewState previousViewState, @NonNull final ViewState currentViewState) {
+        Preconditions.checkNotNull(mraidListener);
+        Preconditions.checkNotNull(previousViewState);
+        Preconditions.checkNotNull(currentViewState);
+
+        if (currentViewState == ViewState.EXPANDED) {
+            mraidListener.onExpand();
+        } else if (previousViewState == ViewState.EXPANDED && currentViewState == ViewState.DEFAULT) {
+            mraidListener.onClose();
+        } else if (currentViewState == ViewState.HIDDEN) {
+            mraidListener.onClose();
+        } else if (previousViewState == ViewState.RESIZED && currentViewState == ViewState.DEFAULT) {
+            mraidListener.onResize(true);
+        } else if (currentViewState == ViewState.RESIZED) {
+            mraidListener.onResize(false);
+        }
+    }
+
     int clampInt(int min, int target, int max) {
         return Math.max(min, Math.min(target, max));
     }
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/AdLoader.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/AdLoader.java
index b4c8f000..5c58894c 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/AdLoader.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/AdLoader.java
@@ -143,6 +143,7 @@ public boolean hasMoreAds() {
         if (mRunning) {
             return mMultiAdRequest;
         }
+
         if (mFailed) {
             // call back using handler to make sure it is always async.
             mHandler.post(new Runnable() {
@@ -158,7 +159,19 @@ public void run() {
 
             // not running and not failed: start it for the first time
             if (mMultiAdResponse == null) {
-                return fetchAd(mMultiAdRequest, mContext.get());
+                if (RequestRateTracker.getInstance().isBlockedByRateLimit(mMultiAdRequest.mAdUnitId)) {
+                    // report no fill
+                    MoPubLog.log(MoPubLog.SdkLogEvent.CUSTOM, mMultiAdRequest.mAdUnitId + " is blocked by request rate limiting.");
+                    mHandler.post(new Runnable() {
+                        @Override
+                        public void run() {
+                            deliverError(new MoPubNetworkError(MoPubNetworkError.Reason.NO_FILL));
+                        }
+                    });
+                    return null;
+                } else {
+                    return fetchAd(mMultiAdRequest, mContext.get()); // first request
+                }
             }
 
             // report creative download error to the server
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/AdResponse.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/AdResponse.java
index 0444fa3c..7183bffd 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/AdResponse.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/AdResponse.java
@@ -15,7 +15,6 @@
 
 import java.io.Serializable;
 import java.util.ArrayList;
-import java.util.Arrays;
 import java.util.List;
 import java.util.Map;
 import java.util.TreeMap;
@@ -46,6 +45,8 @@
     private final Integer mRewardedDuration;
     private final boolean mShouldRewardOnClick;
 
+    @Nullable
+    private final ImpressionData mImpressionData;
     @Nullable
     private final String mClickTrackingUrl;
     @NonNull
@@ -102,6 +103,7 @@ private AdResponse(@NonNull Builder builder) {
         mRewardedDuration = builder.rewardedDuration;
         mShouldRewardOnClick = builder.shouldRewardOnClick;
 
+        mImpressionData = builder.impressionData;
         mClickTrackingUrl = builder.clickTrackingUrl;
         mImpressionTrackingUrls = builder.impressionTrackingUrls;
         mFailoverUrl = builder.failoverUrl;
@@ -186,6 +188,11 @@ public boolean shouldRewardOnClick() {
         return mShouldRewardOnClick;
     }
 
+    @Nullable
+    public ImpressionData getImpressionData() {
+        return mImpressionData;
+    }
+
     @Nullable
     public String getClickTrackingUrl() {
         return mClickTrackingUrl;
@@ -283,6 +290,7 @@ public Builder toBuilder() {
                 .setRewardedVideoCompletionUrl(mRewardedVideoCompletionUrl)
                 .setRewardedDuration(mRewardedDuration)
                 .setShouldRewardOnClick(mShouldRewardOnClick)
+                .setImpressionData(mImpressionData)
                 .setClickTrackingUrl(mClickTrackingUrl)
                 .setImpressionTrackingUrls(mImpressionTrackingUrls)
                 .setFailoverUrl(mFailoverUrl)
@@ -314,6 +322,7 @@ public Builder toBuilder() {
         private Integer rewardedDuration;
         private boolean shouldRewardOnClick;
 
+        private ImpressionData impressionData;
         private String clickTrackingUrl;
         private List<String> impressionTrackingUrls = new ArrayList<>();
         private String failoverUrl;
@@ -390,6 +399,11 @@ public Builder setShouldRewardOnClick(final boolean shouldRewardOnClick) {
             return this;
         }
 
+        public Builder setImpressionData(@Nullable ImpressionData impressionData) {
+            this.impressionData = impressionData;
+            return this;
+        }
+
         public Builder setClickTrackingUrl(@Nullable final String clickTrackingUrl) {
             this.clickTrackingUrl = clickTrackingUrl;
             return this;
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/HeaderUtils.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/HeaderUtils.java
index aa46dafa..9169b65b 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/HeaderUtils.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/HeaderUtils.java
@@ -36,6 +36,18 @@ public static String extractHeader(@Nullable final JSONObject headers,
         return headers.optString(responseHeader.getKey());
     }
 
+    @Nullable
+    public static JSONObject extractJsonObjectHeader(@Nullable final JSONObject headers,
+                                                     @NonNull final ResponseHeader responseHeader) {
+        Preconditions.checkNotNull(responseHeader);
+
+        if (headers == null) {
+            return null;
+        }
+
+        return headers.optJSONObject(responseHeader.getKey());
+    }
+
     @Nullable
     public static Integer extractIntegerHeader(JSONObject headers, ResponseHeader responseHeader) {
         return formatIntHeader(extractHeader(headers, responseHeader));
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/ImpressionData.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/ImpressionData.java
new file mode 100644
index 00000000..50dbfb3f
--- /dev/null
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/ImpressionData.java
@@ -0,0 +1,169 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.network;
+
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+
+import com.mopub.common.logging.MoPubLog;
+import com.mopub.mobileads.base.BuildConfig;
+
+import org.json.JSONException;
+import org.json.JSONObject;
+
+import java.io.IOException;
+import java.io.ObjectInputStream;
+import java.io.ObjectOutputStream;
+import java.io.Serializable;
+
+import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
+
+@SuppressWarnings({"WeakerAccess"})
+public class ImpressionData implements Serializable {
+    private static final long serialVersionUID = BuildConfig.VERSION_CODE;
+
+    public static final String ADUNIT_ID = "adunit_id";
+    public static final String ADUNIT_NAME = "adunit_name";
+    public static final String ADUNIT_FORMAT = "adunit_format";
+    public static final String IMPRESSION_ID = "id";
+    public static final String CURRENCY = "currency";
+    public static final String PUBLISHER_REVENUE = "publisher_revenue";
+    public static final String ADGROUP_ID = "adgroup_id";
+    public static final String ADGROUP_NAME = "adgroup_name";
+    public static final String ADGROUP_TYPE = "adgroup_type";
+    public static final String ADGROUP_PRIORITY = "adgroup_priority";
+    public static final String COUNTRY = "country";
+    public static final String PRECISION = "precision";
+    public static final String NETWORK_NAME = "network_name";
+    public static final String NETWORK_PLACEMENT_ID = "network_placement_id";
+
+    @NonNull
+    private SerializableJson mJson;
+
+    private ImpressionData(@NonNull final JSONObject json) throws JSONException {
+        mJson = new SerializableJson(json);
+    }
+
+    @Nullable
+    static ImpressionData create(@Nullable final JSONObject jsonObject) {
+        if (jsonObject == null) {
+            return null;
+        }
+
+        try {
+            return new ImpressionData(jsonObject);
+        } catch (Exception ex) {
+            MoPubLog.log(CUSTOM, ex.toString());
+        }
+
+        return null;
+    }
+
+    @Nullable
+    public String getAdUnitId() {
+        return mJson.optString(ADUNIT_ID, null);
+    }
+
+    @Nullable
+    public String getAdUnitName() {
+        return mJson.optString(ADUNIT_NAME, null);
+    }
+
+    @Nullable
+    public String getAdUnitFormat() {
+        return mJson.optString(ADUNIT_FORMAT, null);
+    }
+
+    @Nullable
+    public String getImpressionId() {
+        return mJson.optString(IMPRESSION_ID, null);
+    }
+
+    @Nullable
+    public String getCurrency() {
+        return mJson.optString(CURRENCY, null);
+    }
+
+    @Nullable
+    public Double getPublisherRevenue() {
+        try {
+            return mJson.getDouble(PUBLISHER_REVENUE);
+        } catch (Exception ex) {
+            return null;
+        }
+    }
+
+    @Nullable
+    public String getAdGroupId() {
+        return mJson.optString(ADGROUP_ID, null);
+    }
+
+    @Nullable
+    public String getAdGroupName() {
+        return mJson.optString(ADGROUP_NAME, null);
+    }
+
+    @Nullable
+    public String getAdGroupType() {
+        return mJson.optString(ADGROUP_TYPE, null);
+    }
+
+    @Nullable
+    public Integer getAdGroupPriority() {
+        try {
+            return mJson.getInt(ADGROUP_PRIORITY);
+        } catch (Exception ex) {
+            return null;
+        }
+    }
+
+    @Nullable
+    public String getCountry() {
+        return mJson.optString(COUNTRY, null);
+    }
+
+    @Nullable
+    public String getPrecision() {
+        return mJson.optString(PRECISION, null);
+    }
+
+    @Nullable
+    public String getNetworkName() {
+        return mJson.optString(NETWORK_NAME, null);
+    }
+
+    @Nullable
+    public String getNetworkPlacementId() {
+        return mJson.optString(NETWORK_PLACEMENT_ID, null);
+    }
+
+    /**
+     * @return - original JSON object from the server.
+     */
+    @NonNull
+    public JSONObject getJsonRepresentation() {
+        return mJson;
+    }
+
+    private void writeObject(ObjectOutputStream oos) throws IOException {
+        oos.defaultWriteObject();
+        oos.writeUTF(mJson.toString());
+    }
+
+    private void readObject(ObjectInputStream ois) throws ClassNotFoundException, IOException, JSONException {
+        ois.defaultReadObject();
+        mJson = new SerializableJson(ois.readUTF());
+    }
+
+    private static class SerializableJson extends JSONObject implements Serializable {
+        SerializableJson(@NonNull final JSONObject json) throws JSONException {
+            super(json.toString());
+        }
+
+        SerializableJson(@NonNull final String json) throws JSONException {
+            super(json);
+        }
+    }
+}
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/ImpressionListener.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/ImpressionListener.java
new file mode 100644
index 00000000..1db2afac
--- /dev/null
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/ImpressionListener.java
@@ -0,0 +1,26 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.network;
+
+import android.support.annotation.AnyThread;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+
+/**
+ * ImpressionListener is an interface to notify the application about ad impressions for all
+ * ad formats.
+ */
+public interface ImpressionListener {
+    /**
+     * SDK will call method onImpression once the ad becomes visible for the first time.
+     *
+     * @param adUnitId  - ad unit ID of the ad.
+     * @param impressionData - extended information about the ad including revenue per impression.
+     *                       This value can be null if impression level revenue data is not enabled
+     *                       for this MoPub account.
+     */
+    @AnyThread
+    void onImpression(@NonNull String adUnitId, @Nullable ImpressionData impressionData);
+}
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/ImpressionsEmitter.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/ImpressionsEmitter.java
new file mode 100644
index 00000000..dab4ed1d
--- /dev/null
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/ImpressionsEmitter.java
@@ -0,0 +1,76 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.network;
+
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+
+import com.mopub.common.Preconditions;
+import com.mopub.common.VisibleForTesting;
+
+import java.util.HashSet;
+import java.util.Set;
+
+/**
+ * Single source of impression level revenue data. Implement interface {@link ImpressionListener}
+ * and subscribe to events from ImpressionEmitter to receive detailed impression data.
+ * This class is not linked to the activity lifecycle. It is recommended to subscribe to events
+ * when application starts even before the first activity created.
+ */
+@SuppressWarnings("WeakerAccess")
+public class ImpressionsEmitter {
+    private static final HashSet<ImpressionListener> mListeners = new HashSet<>();
+
+    /**
+     * Call this method to start listening for impression level revenue data events.
+     *
+     * @param listener - {@link ImpressionListener} interface implementation
+     */
+    public static void addListener(@NonNull final ImpressionListener listener) {
+        Preconditions.checkNotNull(listener);
+
+        synchronized (ImpressionsEmitter.class) {
+            mListeners.add(listener);
+        }
+    }
+
+    /**
+     * Call this method to unsubscribe from impression level revenue data events.
+     *
+     * @param listener - previously submitted to addListener() {@link ImpressionListener}
+     */
+    public static void removeListener(@NonNull final ImpressionListener listener) {
+        Preconditions.checkNotNull(listener);
+
+        synchronized (ImpressionsEmitter.class) {
+            mListeners.remove(listener);
+        }
+    }
+
+    /**
+     * MoPub SDK internal method. Should not be used by publishers.
+     */
+    static void send(@NonNull final String adUnitId, @Nullable final ImpressionData impressionData) {
+        Preconditions.checkNotNull(adUnitId);
+
+        Set<ImpressionListener> listenerSet = cloneListeners();
+        for (ImpressionListener listener : listenerSet) {
+            listener.onImpression(adUnitId, impressionData);
+        }
+    }
+
+    private static Set<ImpressionListener> cloneListeners() {
+        synchronized (ImpressionsEmitter.class) {
+            return new HashSet<>(mListeners);
+        }
+    }
+
+    @VisibleForTesting
+    static void clear() {
+        synchronized (ImpressionsEmitter.class) {
+            mListeners.clear();
+        }
+    }
+}
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/MoPubRequestUtils.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/MoPubRequestUtils.java
index ae277ab8..a3b15d56 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/MoPubRequestUtils.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/MoPubRequestUtils.java
@@ -66,9 +66,16 @@ public static int chooseMethod(String url) {
         Preconditions.checkNotNull(context);
         Preconditions.checkNotNull(url);
 
-        final Map<String, String> params = new HashMap<>();
         HurlStack.UrlRewriter rewriter = Networking.getUrlRewriter(context);
         final Uri uri = Uri.parse(rewriter.rewriteUrl(url));
+        return getQueryParamMap(uri);
+    }
+
+    @NonNull
+    public static Map<String, String> getQueryParamMap(@NonNull final Uri uri) {
+        Preconditions.checkNotNull(uri);
+
+        final Map<String, String> params = new HashMap<>();
         for (final String queryParam : uri.getQueryParameterNames()) {
             params.put(queryParam, TextUtils.join(",", uri.getQueryParameters(queryParam)));
         }
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/MultiAdResponse.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/MultiAdResponse.java
index c40fbe40..d6cd2832 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/MultiAdResponse.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/MultiAdResponse.java
@@ -41,6 +41,7 @@
 import static com.mopub.network.HeaderUtils.extractBooleanHeader;
 import static com.mopub.network.HeaderUtils.extractHeader;
 import static com.mopub.network.HeaderUtils.extractIntegerHeader;
+import static com.mopub.network.HeaderUtils.extractJsonObjectHeader;
 import static com.mopub.network.HeaderUtils.extractPercentHeaderString;
 import static com.mopub.network.HeaderUtils.extractStringArray;
 
@@ -90,6 +91,10 @@ public MultiAdResponse(@NonNull final Context appContext,
         mFailUrl = jsonObject.optString(ResponseHeader.FAIL_URL.getKey());
         String requestId = jsonObject.optString(ResponseHeader.REQUEST_ID.getKey());
 
+        final Integer backoffMs = extractIntegerHeader(jsonObject, ResponseHeader.BACKOFF_MS);
+        final String backoffReason = extractHeader(jsonObject, ResponseHeader.BACKOFF_REASON);
+        RequestRateTracker.getInstance().registerRateLimit(adUnitId, backoffMs, backoffReason);
+
         final boolean invalidateConsent = extractBooleanHeader(jsonObject,
                 ResponseHeader.INVALIDATE_CONSENT, false);
         final boolean forceExplicitNo = extractBooleanHeader(jsonObject,
@@ -113,6 +118,13 @@ public MultiAdResponse(@NonNull final Context appContext,
             }
         }
 
+        final boolean enableDebugLogging = extractBooleanHeader(jsonObject,
+                ResponseHeader.ENABLE_DEBUG_LOGGING, false);
+
+        if (enableDebugLogging) {
+            MoPubLog.setLogLevel(MoPubLog.LogLevel.DEBUG);
+        }
+
         JSONArray adResponses = jsonObject.getJSONArray(ResponseHeader.AD_RESPONSES.getKey());
         int ADS_PER_RESPONSE = 3;
         List<AdResponse> list = new ArrayList<>(ADS_PER_RESPONSE);
@@ -239,6 +251,9 @@ protected static AdResponse parseSingleAdResponse(@NonNull final Context appCont
         String networkType = extractHeader(jsonHeaders, ResponseHeader.NETWORK_TYPE);
         builder.setNetworkType(networkType);
 
+        JSONObject impressionJson = extractJsonObjectHeader(jsonHeaders, ResponseHeader.IMPRESSION_DATA);
+        builder.setImpressionData(ImpressionData.create(impressionJson));
+
         // X-Clickthrough is parsed into the AdResponse as the click tracker
         // Used by AdViewController, Rewarded Video, Native Adapter, MoPubNative
         String clickTrackingUrl = extractHeader(jsonHeaders, ResponseHeader.CLICK_TRACKING_URL);
@@ -424,12 +439,6 @@ protected static AdResponse parseSingleAdResponse(@NonNull final Context appCont
             builder.setShouldRewardOnClick(shouldRewardOnClick);
         }
 
-        // Enabled debug logging
-        if (extractBooleanHeader(jsonHeaders,
-                ResponseHeader.ENABLE_DEBUG_LOGGING, false)) {
-            MoPubLog.setLogLevel(MoPubLog.LogLevel.DEBUG);
-        }
-
         return builder.build();
     }
 
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/Networking.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/Networking.java
index e45cfff2..a14bacc6 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/Networking.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/Networking.java
@@ -11,12 +11,14 @@
 import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
 import android.support.v4.util.LruCache;
+import android.text.TextUtils;
 import android.webkit.WebSettings;
 import android.webkit.WebView;
 
 import com.mopub.common.Constants;
 import com.mopub.common.Preconditions;
 import com.mopub.common.VisibleForTesting;
+import com.mopub.common.logging.MoPubLog;
 import com.mopub.common.util.DeviceUtils;
 import com.mopub.volley.Cache;
 import com.mopub.volley.Network;
@@ -31,10 +33,22 @@
 
 import javax.net.ssl.SSLSocketFactory;
 
+import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
+
 public class Networking {
     @VisibleForTesting
     static final String CACHE_DIRECTORY_NAME = "mopub-volley-cache";
-    private static final String DEFAULT_USER_AGENT = System.getProperty("http.agent");
+    @NonNull private static final String DEFAULT_USER_AGENT;
+
+    static {
+        String userAgent = "";
+        try {
+            userAgent = System.getProperty("http.agent", "");
+        } catch (SecurityException e) {
+            MoPubLog.log(CUSTOM, "Unable to get system user agent.");
+        }
+        DEFAULT_USER_AGENT = userAgent;
+    }
 
     // These are volatile so that double-checked locking works.
     // See https://en.wikipedia.org/wiki/Double-checked_locking#Usage_in_Java
@@ -139,36 +153,34 @@ public void putBitmap(final String key, final Bitmap bitmap) {
     public static String getUserAgent(@NonNull Context context) {
         Preconditions.checkNotNull(context);
 
-        String userAgent = sUserAgent;
-        if (userAgent == null) {
-            synchronized (Networking.class) {
-                userAgent = sUserAgent;
-                if (userAgent == null) {
-                    try {
-                        // WebViews may only be instantiated on the UI thread. If anything goes
-                        // wrong with getting a user agent, use the system-specific user agent.
-                        if (Looper.myLooper() == Looper.getMainLooper()) {
-                            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR1) {
-                                userAgent = WebSettings.getDefaultUserAgent(context);
-                            } else {
-                                userAgent = new WebView(context).getSettings().getUserAgentString();
-                            }
-                        } else {
-                            // Since we are not on the main thread, return the default user agent
-                            // for now. Defer to when this is run on the main thread to actually
-                            // set the user agent.
-                            return DEFAULT_USER_AGENT;
-                        }
-                    } catch (Exception e) {
-                        // Some custom ROMs may fail to get a user agent. If that happens, return
-                        // the Android system user agent.
-                        userAgent = DEFAULT_USER_AGENT;
-                    }
-                    sUserAgent = userAgent;
-                }
-            }
+        final String volatileUserAgentCopy = sUserAgent;
+        if (!TextUtils.isEmpty(volatileUserAgentCopy)) {
+            return volatileUserAgentCopy;
+        }
+
+        // WebViews may only be instantiated on the UI thread. If anything goes
+        // wrong with getting a user agent, use the system-specific user agent.
+        if (Looper.myLooper() != Looper.getMainLooper()) {
+            // Since we are not on the main thread, return the default user agent
+            // for now. Defer to when this is run on the main thread to actually
+            // set the user agent.
+            return DEFAULT_USER_AGENT;
         }
 
+        // Some custom ROMs may fail to get a user agent. If that happens, return
+        // the Android system user agent.
+        String userAgent = DEFAULT_USER_AGENT;
+        try {
+            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR1) {
+                userAgent = WebSettings.getDefaultUserAgent(context);
+            } else {
+                userAgent = new WebView(context).getSettings().getUserAgentString();
+            }
+        } catch (Exception e) {
+            MoPubLog.log(CUSTOM,
+                    "Failed to get a user agent. Defaulting to the system user agent.");
+        }
+        sUserAgent = userAgent;
         return userAgent;
     }
 
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/RequestRateTracker.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/RequestRateTracker.java
new file mode 100644
index 00000000..792516ce
--- /dev/null
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/RequestRateTracker.java
@@ -0,0 +1,96 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.network;
+
+import android.os.SystemClock;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+import android.text.TextUtils;
+
+import com.mopub.common.VisibleForTesting;
+
+import java.util.Collections;
+import java.util.HashMap;
+import java.util.Map;
+
+/**
+ * Singleton to cache ad request rate limit time interval and reason.
+ */
+public class RequestRateTracker {
+
+    public static class TimeRecord {
+        final long mBlockStartTime;
+        public final int mBlockIntervalMs;
+        @NonNull
+        public final String mReason;
+
+        TimeRecord(int interval, @Nullable final String reason) {
+            mBlockStartTime = currentTimeMs();
+            mBlockIntervalMs = interval;
+            mReason = reason == null ? "unknown" : reason;
+        }
+
+        long getTargetTime() {
+            return mBlockStartTime + mBlockIntervalMs;
+        }
+    }
+
+    @NonNull
+    private Map<String, TimeRecord> mTimeRecordMap;
+
+    private static class Helper {
+        @NonNull
+        private static RequestRateTracker sInstance = new RequestRateTracker();
+    }
+
+    RequestRateTracker() {
+        mTimeRecordMap = Collections.synchronizedMap(new HashMap<String, TimeRecord>());
+    }
+
+    @NonNull
+    public static RequestRateTracker getInstance() {
+        return Helper.sInstance;
+    }
+
+    void registerRateLimit(@Nullable final String adUnit, @Nullable final Integer blockIntervalMs, @Nullable final String reason) {
+        if (TextUtils.isEmpty(adUnit)) {
+            return;
+        }
+
+        if (blockIntervalMs != null && blockIntervalMs > 0) {
+            mTimeRecordMap.put(adUnit, new TimeRecord(blockIntervalMs, reason));
+        } else {
+            mTimeRecordMap.remove(adUnit);
+        }
+    }
+
+    boolean isBlockedByRateLimit(@Nullable final String adUnitId) {
+        return getTimeUntilLimitEnds(adUnitId) > 0;
+    }
+
+    @Nullable
+    public TimeRecord getRecordForAdUnit(@Nullable final String adUnitId) {
+        return mTimeRecordMap.get(adUnitId);
+    }
+
+    private long getTimeUntilLimitEnds(@Nullable final String adUnitId) {
+        final TimeRecord record = mTimeRecordMap.get(adUnitId);
+        if (record == null) {
+            return 0;
+        }
+
+        return record.getTargetTime() - currentTimeMs();
+    }
+
+    private static long currentTimeMs() {
+        return SystemClock.elapsedRealtime();
+    }
+
+    @Deprecated
+    @VisibleForTesting
+    static void setInstance(@NonNull RequestRateTracker mockInstance) {
+        Helper.sInstance = mockInstance;
+    }
+}
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/SingleImpression.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/SingleImpression.java
new file mode 100644
index 00000000..2e94d2f6
--- /dev/null
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/SingleImpression.java
@@ -0,0 +1,31 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.network;
+
+import android.support.annotation.Nullable;
+
+import com.mopub.common.logging.MoPubLog;
+
+import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
+
+public class SingleImpression {
+    @Nullable
+    private final String mAdUnitId;
+    @Nullable
+    private final ImpressionData mImpressionData;
+
+    public SingleImpression(@Nullable String adUnitid, @Nullable ImpressionData data) {
+        mAdUnitId = adUnitid;
+        mImpressionData = data;
+    }
+
+    public void sendImpression() {
+        if (mAdUnitId != null) {
+            ImpressionsEmitter.send(mAdUnitId, mImpressionData);
+        } else {
+            MoPubLog.log(CUSTOM, "SingleImpression ad unit id may not be null.");
+        }
+    }
+}
diff --git a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/TrackingRequest.java b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/TrackingRequest.java
index b52d3b3a..4bbe3b58 100644
--- a/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/TrackingRequest.java
+++ b/mopub-sdk/mopub-sdk-base/src/main/java/com/mopub/network/TrackingRequest.java
@@ -11,6 +11,7 @@
 
 import com.mopub.common.Preconditions;
 import com.mopub.common.logging.MoPubLog;
+import com.mopub.common.util.Utils;
 import com.mopub.mobileads.VastErrorCode;
 import com.mopub.mobileads.VastMacroHelper;
 import com.mopub.mobileads.VastTracker;
@@ -146,7 +147,7 @@ public static void makeTrackingHttpRequest(@Nullable final String url,
     public static void makeTrackingHttpRequest(@Nullable final String url,
             @Nullable final Context context,
             @Nullable Listener listener) {
-        if (url != null) {
+        if (!TextUtils.isEmpty(url)) {
             makeTrackingHttpRequest(Arrays.asList(url), context, listener);
         }
     }
diff --git a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/BaseInterstitialActivity.java b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/BaseInterstitialActivity.java
index c9fabf52..a0caeb37 100644
--- a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/BaseInterstitialActivity.java
+++ b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/BaseInterstitialActivity.java
@@ -70,6 +70,11 @@ Long getBroadcastIdentifier() {
         return mBroadcastIdentifier;
     }
 
+    @Nullable
+    String getResponseString() {
+        return getResponseString(mAdReport);
+    }
+
     protected void showInterstitialCloseButton() {
         if (mCloseableLayout != null) {
             mCloseableLayout.setCloseVisible(true);
@@ -97,4 +102,9 @@ protected static AdReport getAdReportFromIntent(Intent intent) {
             return null;
         }
     }
+
+    @Nullable
+    static String getResponseString(AdReport adReport) {
+        return adReport != null ? adReport.getResponseString() : null;
+    }
 }
diff --git a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/HtmlInterstitial.java b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/HtmlInterstitial.java
index 6d179810..898cbb3a 100644
--- a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/HtmlInterstitial.java
+++ b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/HtmlInterstitial.java
@@ -34,13 +34,13 @@ protected void extractExtras(Map<String, String> serverExtras) {
     @Override
     protected void preRenderHtml(CustomEventInterstitialListener customEventInterstitialListener) {
         MoPubLog.log(LOAD_ATTEMPTED, ADAPTER_NAME);
-        MoPubActivity.preRenderHtml(this, mContext, mAdReport, customEventInterstitialListener, mHtmlData, mClickthroughUrl, mBroadcastIdentifier);
+        MoPubActivity.preRenderHtml(this, mContext, mAdReport, customEventInterstitialListener, mClickthroughUrl, mBroadcastIdentifier);
     }
 
     @Override
     public void showInterstitial() {
         MoPubLog.log(SHOW_ATTEMPTED, ADAPTER_NAME);
-        MoPubActivity.start(mContext, mHtmlData, mAdReport, mClickthroughUrl, mOrientation,
+        MoPubActivity.start(mContext, mAdReport, mClickthroughUrl, mOrientation,
                 mBroadcastIdentifier);
     }
 
diff --git a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/MoPubActivity.java b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/MoPubActivity.java
index 145ea8a4..f1d1037f 100644
--- a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/MoPubActivity.java
+++ b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/MoPubActivity.java
@@ -28,18 +28,17 @@
 import static com.mopub.common.DataKeys.BROADCAST_IDENTIFIER_KEY;
 import static com.mopub.common.DataKeys.CLICKTHROUGH_URL_KEY;
 import static com.mopub.common.DataKeys.CREATIVE_ORIENTATION_KEY;
-import static com.mopub.common.DataKeys.HTML_RESPONSE_BODY_KEY;
 import static com.mopub.common.IntentActions.ACTION_INTERSTITIAL_CLICK;
 import static com.mopub.common.IntentActions.ACTION_INTERSTITIAL_DISMISS;
 import static com.mopub.common.IntentActions.ACTION_INTERSTITIAL_FAIL;
 import static com.mopub.common.IntentActions.ACTION_INTERSTITIAL_SHOW;
 import static com.mopub.common.logging.MoPubLog.AdLogEvent.CLICKED;
+import static com.mopub.common.logging.MoPubLog.AdLogEvent.CUSTOM;
 import static com.mopub.common.logging.MoPubLog.AdLogEvent.DID_DISAPPEAR;
 import static com.mopub.common.logging.MoPubLog.AdLogEvent.LOAD_ATTEMPTED;
 import static com.mopub.common.logging.MoPubLog.AdLogEvent.LOAD_FAILED;
 import static com.mopub.common.logging.MoPubLog.AdLogEvent.LOAD_SUCCESS;
 import static com.mopub.common.logging.MoPubLog.AdLogEvent.SHOW_ATTEMPTED;
-import static com.mopub.common.logging.MoPubLog.AdLogEvent.CUSTOM;
 import static com.mopub.common.logging.MoPubLog.AdLogEvent.SHOW_SUCCESS;
 import static com.mopub.common.logging.MoPubLog.AdLogEvent.WILL_LEAVE_APPLICATION;
 import static com.mopub.common.util.JavaScriptWebViewCallbacks.WEB_VIEW_DID_APPEAR;
@@ -53,10 +52,10 @@
     @Nullable private HtmlInterstitialWebView mHtmlInterstitialWebView;
     @Nullable private ExternalViewabilitySessionManager mExternalViewabilitySessionManager;
 
-    public static void start(Context context, String htmlData, AdReport adReport, String clickthroughUrl,
-            CreativeOrientation creativeOrientation, long broadcastIdentifier) {
+    public static void start(Context context, AdReport adReport, String clickthroughUrl,
+                             CreativeOrientation creativeOrientation, long broadcastIdentifier) {
         MoPubLog.log(SHOW_ATTEMPTED);
-        Intent intent = createIntent(context, htmlData, adReport, clickthroughUrl,
+        Intent intent = createIntent(context, adReport, clickthroughUrl,
                 creativeOrientation, broadcastIdentifier);
         try {
             context.startActivity(intent);
@@ -66,10 +65,9 @@ public static void start(Context context, String htmlData, AdReport adReport, St
     }
 
     static Intent createIntent(Context context,
-            String htmlData, AdReport adReport, String clickthroughUrl,
-            CreativeOrientation orientation, long broadcastIdentifier) {
+                               AdReport adReport, String clickthroughUrl,
+                               CreativeOrientation orientation, long broadcastIdentifier) {
         Intent intent = new Intent(context, MoPubActivity.class);
-        intent.putExtra(HTML_RESPONSE_BODY_KEY, htmlData);
         intent.putExtra(CLICKTHROUGH_URL_KEY, clickthroughUrl);
         intent.putExtra(BROADCAST_IDENTIFIER_KEY, broadcastIdentifier);
         intent.putExtra(AD_REPORT_KEY, adReport);
@@ -82,7 +80,6 @@ static void preRenderHtml(final Interstitial baseInterstitial,
             final Context context,
             final AdReport adReport,
             final CustomEventInterstitialListener customEventInterstitialListener,
-            final String htmlData,
             final String clickthroughUrl,
             final long broadcastIdentifier) {
         MoPubLog.log(LOAD_ATTEMPTED);
@@ -109,7 +106,7 @@ public boolean shouldOverrideUrlLoading(WebView view, String url) {
                 new ExternalViewabilitySessionManager(context);
         externalViewabilitySessionManager.createDisplaySession(context, htmlInterstitialWebView, true);
 
-        htmlInterstitialWebView.loadHtmlResponse(htmlData);
+        htmlInterstitialWebView.loadHtmlResponse(getResponseString(adReport));
         WebViewCacheService.storeWebViewConfig(broadcastIdentifier, baseInterstitial,
                 htmlInterstitialWebView, externalViewabilitySessionManager, null);
     }
@@ -117,8 +114,8 @@ public boolean shouldOverrideUrlLoading(WebView view, String url) {
     @Override
     public View getAdView() {
         Intent intent = getIntent();
-        String clickthroughUrl = intent.getStringExtra(CLICKTHROUGH_URL_KEY);
-        String htmlResponse = intent.getStringExtra(HTML_RESPONSE_BODY_KEY);
+        final String clickthroughUrl = intent.getStringExtra(CLICKTHROUGH_URL_KEY);
+        final String htmlData = getResponseString();
 
         final Long broadcastIdentifier = getBroadcastIdentifier();
         if (broadcastIdentifier != null) {
@@ -146,7 +143,7 @@ public View getAdView() {
         
         mExternalViewabilitySessionManager = new ExternalViewabilitySessionManager(this);
         mExternalViewabilitySessionManager.createDisplaySession(this, mHtmlInterstitialWebView, true);
-        mHtmlInterstitialWebView.loadHtmlResponse(htmlResponse);
+        mHtmlInterstitialWebView.loadHtmlResponse(htmlData);
         return mHtmlInterstitialWebView;
     }
 
diff --git a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/MraidActivity.java b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/MraidActivity.java
index e6d5a9ca..37204e2d 100644
--- a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/MraidActivity.java
+++ b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mobileads/MraidActivity.java
@@ -10,6 +10,7 @@
 import android.os.Bundle;
 import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
+import android.text.TextUtils;
 import android.util.Log;
 import android.view.View;
 import android.view.WindowManager;
@@ -40,7 +41,6 @@
 import static com.mopub.common.DataKeys.AD_REPORT_KEY;
 import static com.mopub.common.DataKeys.BROADCAST_IDENTIFIER_KEY;
 import static com.mopub.common.DataKeys.CREATIVE_ORIENTATION_KEY;
-import static com.mopub.common.DataKeys.HTML_RESPONSE_BODY_KEY;
 import static com.mopub.common.IntentActions.ACTION_INTERSTITIAL_CLICK;
 import static com.mopub.common.IntentActions.ACTION_INTERSTITIAL_DISMISS;
 import static com.mopub.common.IntentActions.ACTION_INTERSTITIAL_FAIL;
@@ -67,7 +67,6 @@
     public static void preRenderHtml(@NonNull final Interstitial mraidInterstitial,
             @NonNull final Context context,
             @NonNull final CustomEventInterstitialListener customEventInterstitialListener,
-            @Nullable final String htmlData,
             @NonNull final Long broadcastIdentifier,
             @Nullable final AdReport adReport) {
         Preconditions.checkNotNull(mraidInterstitial);
@@ -157,11 +156,10 @@ public void onReceivedError(final WebView view, final int errorCode,
 
     public static void start(@NonNull final Context context,
             @Nullable final AdReport adreport,
-            @Nullable final String htmlData,
             final long broadcastIdentifier,
             @Nullable final CreativeOrientation orientation) {
         MoPubLog.log(SHOW_ATTEMPTED);
-        final Intent intent = createIntent(context, adreport, htmlData, broadcastIdentifier,
+        final Intent intent = createIntent(context, adreport, broadcastIdentifier,
                 orientation);
         try {
             context.startActivity(intent);
@@ -175,11 +173,9 @@ public static void start(@NonNull final Context context,
     @VisibleForTesting
     protected static Intent createIntent(@NonNull final Context context,
             @Nullable final AdReport adReport,
-            @Nullable final String htmlData,
             final long broadcastIdentifier,
             @Nullable final CreativeOrientation orientation) {
         Intent intent = new Intent(context, MraidActivity.class);
-        intent.putExtra(HTML_RESPONSE_BODY_KEY, htmlData);
         intent.putExtra(BROADCAST_IDENTIFIER_KEY, broadcastIdentifier);
         intent.putExtra(AD_REPORT_KEY, adReport);
         intent.putExtra(CREATIVE_ORIENTATION_KEY, orientation);
@@ -189,8 +185,8 @@ protected static Intent createIntent(@NonNull final Context context,
 
     @Override
     public View getAdView() {
-        String htmlData = getIntent().getStringExtra(HTML_RESPONSE_BODY_KEY);
-        if (htmlData == null) {
+        final String htmlData = getResponseString();
+        if (TextUtils.isEmpty(htmlData)) {
             MoPubLog.log(CUSTOM, "MraidActivity received a null HTML body. Finishing the activity.");
             finish();
             return new View(this);
@@ -239,6 +235,11 @@ public void onExpand() {
                 // No-op. The interstitial is always expanded.
             }
 
+            @Override
+            public void onResize(final boolean toOriginalSize) {
+                // No-op. The interstitial is always expanded.
+            }
+
             @Override
             public void onOpen() {
                 MoPubLog.log(DID_APPEAR);
diff --git a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mraid/MraidInterstitial.java b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mraid/MraidInterstitial.java
index e606d578..2c557ffa 100644
--- a/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mraid/MraidInterstitial.java
+++ b/mopub-sdk/mopub-sdk-interstitial/src/main/java/com/mopub/mraid/MraidInterstitial.java
@@ -35,14 +35,14 @@ protected void extractExtras(Map<String, String> serverExtras) {
     protected void preRenderHtml(@NonNull CustomEventInterstitialListener
             customEventInterstitialListener) {
         MoPubLog.log(LOAD_ATTEMPTED, ADAPTER_NAME);
-        MraidActivity.preRenderHtml(this, mContext, customEventInterstitialListener, mHtmlData,
+        MraidActivity.preRenderHtml(this, mContext, customEventInterstitialListener,
                 mBroadcastIdentifier, mAdReport);
     }
 
     @Override
     public void showInterstitial() {
         MoPubLog.log(SHOW_ATTEMPTED, ADAPTER_NAME);
-        MraidActivity.start(mContext, mAdReport, mHtmlData, mBroadcastIdentifier, mOrientation);
+        MraidActivity.start(mContext, mAdReport, mBroadcastIdentifier, mOrientation);
     }
 
     @Override
diff --git a/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/MoPubNative.java b/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/MoPubNative.java
index ca177e07..4e66c876 100644
--- a/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/MoPubNative.java
+++ b/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/MoPubNative.java
@@ -232,8 +232,7 @@ public void onNativeAdLoaded(@NonNull final BaseNativeAd nativeAd) {
                         }
 
                         mMoPubNativeNetworkListener.onNativeLoad(new NativeAd(context,
-                                        response.getImpressionTrackingUrls(),
-                                        response.getClickTrackingUrl(),
+                                        response,
                                         mAdUnitId,
                                         nativeAd,
                                         renderer)
diff --git a/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/NativeAd.java b/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/NativeAd.java
index f9cd79d8..23a33912 100644
--- a/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/NativeAd.java
+++ b/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/NativeAd.java
@@ -13,6 +13,8 @@
 import com.mopub.common.VisibleForTesting;
 import com.mopub.nativeads.MoPubCustomEventNative.MoPubStaticNativeAd;
 import com.mopub.network.AdResponse;
+import com.mopub.network.ImpressionData;
+import com.mopub.network.SingleImpression;
 import com.mopub.network.TrackingRequest;
 
 import java.util.HashSet;
@@ -59,6 +61,7 @@
     @NonNull private final Set<String> mImpressionTrackers;
     @NonNull private final Set<String> mClickTrackers;
     @NonNull private final String mAdUnitId;
+    @Nullable private ImpressionData mImpressionData;
     @Nullable private MoPubNativeEventListener mMoPubNativeEventListener;
 
     private boolean mRecordedImpression;
@@ -74,6 +77,7 @@ public NativeAd(@NonNull final Context context,
         mContext = context.getApplicationContext();
 
         mAdUnitId = adUnitId;
+        mImpressionData = null;
 
         mImpressionTrackers = new HashSet<String>();
         mImpressionTrackers.addAll(moPubImpressionTrackerUrls);
@@ -99,6 +103,15 @@ public void onAdClicked() {
         mMoPubAdRenderer = moPubAdRenderer;
     }
 
+    NativeAd(@NonNull final Context context,
+             @NonNull final AdResponse adResponse,
+             @NonNull final String adUnitId,
+             @NonNull final BaseNativeAd baseNativeAd,
+             @NonNull final MoPubAdRenderer moPubAdRenderer){
+        this(context, adResponse.getImpressionTrackingUrls(), adResponse.getClickTrackingUrl(), adUnitId, baseNativeAd, moPubAdRenderer);
+        mImpressionData = adResponse.getImpressionData();
+    }
+
     @Override
     public String toString() {
         final StringBuilder stringBuilder = new StringBuilder("\n");
@@ -207,12 +220,14 @@ void recordImpression(@Nullable final View view) {
             return;
         }
 
+        mRecordedImpression = true;
+
         TrackingRequest.makeTrackingHttpRequest(mImpressionTrackers, mContext);
         if (mMoPubNativeEventListener != null) {
             mMoPubNativeEventListener.onImpression(view);
         }
 
-        mRecordedImpression = true;
+        new SingleImpression(mAdUnitId, mImpressionData).sendImpression();
     }
 
     @VisibleForTesting
diff --git a/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/NativeAdSource.java b/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/NativeAdSource.java
index cdff8e1c..61dcad18 100644
--- a/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/NativeAdSource.java
+++ b/mopub-sdk/mopub-sdk-native-static/src/main/java/com/mopub/nativeads/NativeAdSource.java
@@ -27,7 +27,7 @@
  * To take an ad out of the cache, call {@link #dequeueAd}.
  *
  * The cache size may be automatically adjusted by the MoPub server based on an app's usage and
- * ad fill rate. Cached ads have a maximum TTL of 15 minutes before which they expire.
+ * ad fill rate. Cached ads have a maximum TTL of 4 hours before which they expire.
  *
  * The ad source also takes care of retrying failed ad requests, with a reasonable back-off to
  * avoid spamming the server.
diff --git a/mopub-sdk/mopub-sdk-native-video/build.gradle b/mopub-sdk/mopub-sdk-native-video/build.gradle
index 23c5dbb0..e85c7326 100644
--- a/mopub-sdk/mopub-sdk-native-video/build.gradle
+++ b/mopub-sdk/mopub-sdk-native-video/build.gradle
@@ -4,9 +4,16 @@
 
 apply from: '../shared-build.gradle'
 
+android {
+    compileOptions {
+        sourceCompatibility JavaVersion.VERSION_1_8
+        targetCompatibility JavaVersion.VERSION_1_8
+    }
+}
+
 dependencies {
-    compile project(':mopub-sdk-native-static')
-    compile 'com.google.android.exoplayer:exoplayer:2.8.3'
+    api project(':mopub-sdk:mopub-sdk-native-static')
+    api 'com.google.android.exoplayer:exoplayer:2.9.5'
 }
 
 project.description = 'MoPub Android SDK - Native Video'
diff --git a/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/HttpDiskCompositeDataSource.java b/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/HttpDiskCompositeDataSource.java
deleted file mode 100644
index d3230d39..00000000
--- a/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/HttpDiskCompositeDataSource.java
+++ /dev/null
@@ -1,471 +0,0 @@
-// Copyright 2018-2019 Twitter, Inc.
-// Licensed under the MoPub SDK License Agreement
-// http://www.mopub.com/legal/sdk-license-agreement/
-
-package com.mopub.nativeads;
-
-import android.content.Context;
-import android.net.Uri;
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
-import android.text.TextUtils;
-
-import com.google.android.exoplayer2.upstream.DataSource;
-import com.google.android.exoplayer2.upstream.DataSpec;
-import com.google.android.exoplayer2.upstream.DefaultHttpDataSource;
-import com.google.android.exoplayer2.upstream.HttpDataSource;
-import com.mopub.common.CacheService;
-import com.mopub.common.Preconditions;
-import com.mopub.common.VisibleForTesting;
-import com.mopub.common.logging.MoPubLog;
-
-import org.json.JSONArray;
-import org.json.JSONException;
-import org.json.JSONObject;
-
-import java.io.IOException;
-import java.util.TreeSet;
-
-import static com.mopub.common.logging.MoPubLog.SdkLogEvent.CUSTOM;
-import static com.mopub.common.logging.MoPubLog.SdkLogEvent.ERROR;
-
-/**
- * This data source caches data on disk as it is read from an {@link HttpDataSource}. This expects
- * relatively large files, and this will segment the files. If any segment becomes invalid, the
- * entire file is effectively cleared from the cache.
- */
-public class HttpDiskCompositeDataSource implements DataSource {
-
-    // Keys are prefixed since URLs can end basically however they want, and key names could
-    // potentially be part of the URL and get the cache confused.
-    @VisibleForTesting static final String INTERVALS_KEY_PREFIX = "intervals-sorted-";
-    @VisibleForTesting static final String EXPECTED_FILE_SIZE_KEY_PREFIX = "expectedsize-";
-
-    // These are used to serialize/deserialize the intervals list
-    private static final String START = "start";
-    private static final String LENGTH = "length";
-
-    /**
-     * The constant used in {@link DefaultHttpDataSource} is private even though this is a pretty
-     * standard constant used in Exoplayer. This represents the constant that tells the HTTP
-     * connection to get all remaining bytes available.
-     */
-    @VisibleForTesting static final int LENGTH_UNBOUNDED = -1;
-
-    /**
-     * HTTP response 416 means trying to request for bytes that the server does not have.
-     */
-    private static final int HTTP_RESPONSE_REQUESTED_RANGE_NOT_SATISFIABLE = 416;
-
-    /**
-     * The current block size is arbitrarily set at 500KiB. This has to be bigger than the biggest
-     * read request from the consumer of this class's read method. This also has to be reasonably
-     * small to accommodate devices that don't have a lot of memory to work with.
-     */
-    @VisibleForTesting static final int BLOCK_SIZE = 500 * 1024;
-
-    /**
-     * The network data source
-     */
-    @NonNull private final HttpDataSource mHttpDataSource;
-
-    /**
-     * Bytes from disk. This is the in-memory working copy.
-     */
-    @Nullable private byte[] mCachedBytes;
-
-    /**
-     * Base key of the cache. This is the URI of the {@link DataSpec}.
-     */
-    @Nullable private String mKey;
-
-    /**
-     * This is the set of intervals that the cache thinks are valid. Intervals have a start and a
-     * length.
-     */
-    @NonNull private final TreeSet<IntInterval> mIntervals;
-
-    /**
-     * The absolute index of the first byte that is currently being requested.
-     */
-    private int mStartInFile;
-
-    /**
-     * The total number of bytes read in the current block. This indicates the current cursor
-     * position. mDataBlockOffset plus mStartInFile is the cursor position for the file.
-     * mDataBlockOffset plus mStartInDataBlock is the cursor position for the current data block.
-     */
-    private int mDataBlockOffset;
-
-    /**
-     * Which segment of the file the current block is on.
-     */
-    private int mSegment;
-
-    /**
-     * The index of the physical byte array for the current block.
-     */
-    private int mStartInDataBlock;
-
-    /**
-     * Whether or not this has an {@link HttpDataSource} that is already open.
-     */
-    private boolean mIsHttpSourceOpen;
-
-    /**
-     * The expected size of the entire file.
-     */
-    @Nullable private Integer mExpectedFileLength = null;
-
-    /**
-     * Data needed to open another {@link HttpDataSource}.
-     */
-    @Nullable private DataSpec mDataSpec;
-
-    /**
-     * Whether or not the cache has been written to during the current session.
-     */
-    private boolean mIsDirty;
-
-    public HttpDiskCompositeDataSource(@NonNull final Context context,
-            @NonNull final String userAgent) {
-        this(context, userAgent, new DefaultHttpDataSource(userAgent, null));
-    }
-
-    @VisibleForTesting
-    HttpDiskCompositeDataSource(@NonNull final Context context,
-            @NonNull final String userAgent,
-            @NonNull final HttpDataSource httpDataSource) {
-        mHttpDataSource = httpDataSource;
-        CacheService.initialize(context);
-        mIntervals = new TreeSet<IntInterval>();
-    }
-
-    @Override
-    public long open(@NonNull final DataSpec dataSpec) throws IOException {
-        Preconditions.checkNotNull(dataSpec);
-        if (dataSpec.uri == null) {
-            return LENGTH_UNBOUNDED;
-        }
-
-        mIsDirty = false;
-
-        mDataSpec = dataSpec;
-        mKey = dataSpec.uri.toString();
-        if (mKey == null) {
-            return LENGTH_UNBOUNDED;
-        }
-        mStartInFile = (int) dataSpec.absoluteStreamPosition;
-        mSegment = mStartInFile / BLOCK_SIZE;
-        mCachedBytes = CacheService.getFromDiskCache(mSegment + mKey);
-        mStartInDataBlock = mStartInFile % BLOCK_SIZE;
-        mDataBlockOffset = 0;
-
-        mExpectedFileLength = getExpectedFileLengthFromDisk(mKey);
-
-        populateIntervalsFromDisk(mKey, mIntervals);
-
-        int mDataRequestStartPoint = getFirstContiguousPointAfter(mStartInFile, mIntervals);
-
-        // Cache miss
-        if (mCachedBytes == null) {
-            mCachedBytes = new byte[BLOCK_SIZE];
-
-            // It's not in the cache, but we expected it to be there.
-            if (mDataRequestStartPoint > mStartInFile) {
-                MoPubLog.log(CUSTOM, "Cache segment " + mSegment + " was evicted. Invalidating cache");
-                mIntervals.clear();
-                mDataRequestStartPoint = (int) dataSpec.absoluteStreamPosition;
-            }
-        }
-
-        long size;
-        // If we think there are more bytes left to read from the network
-        if (mExpectedFileLength == null || mDataRequestStartPoint != mExpectedFileLength) {
-            final long lengthToUse;
-            if (mDataSpec.length == LENGTH_UNBOUNDED) {
-                lengthToUse = LENGTH_UNBOUNDED;
-            } else {
-                // Make sure to take into account that the start point is at a later point
-                lengthToUse = mDataSpec.length - (mDataRequestStartPoint - mStartInFile);
-            }
-            // Modify the data spec to include the new params
-            DataSpec modifiedDataSpec = new DataSpec(dataSpec.uri, mDataRequestStartPoint,
-                    lengthToUse, dataSpec.key, dataSpec.flags);
-
-            try {
-                size = mHttpDataSource.open(modifiedDataSpec);
-                if (mExpectedFileLength == null && lengthToUse == LENGTH_UNBOUNDED) {
-                    // If we don't have an expected file length set, set it if we requested the
-                    // rest of the file.
-                    mExpectedFileLength = (int) (mStartInFile + size);
-                    CacheService.putToDiskCache(EXPECTED_FILE_SIZE_KEY_PREFIX + mKey,
-                            String.valueOf(mExpectedFileLength).getBytes());
-                }
-                mIsHttpSourceOpen = true;
-            } catch (HttpDataSource.InvalidResponseCodeException e) {
-                // This shouldn't happen anymore, but if we accidentally requested too many bytes
-                // because we already had the bytes before that point, then it's still fine.
-                if (e.responseCode == HTTP_RESPONSE_REQUESTED_RANGE_NOT_SATISFIABLE) {
-                    size = mExpectedFileLength == null ? mDataRequestStartPoint - mStartInFile : mExpectedFileLength - mStartInFile;
-                } else {
-                    throw e;
-                }
-                mIsHttpSourceOpen = false;
-            }
-        } else {
-            size = dataSpec.length == LENGTH_UNBOUNDED ? mExpectedFileLength - mStartInFile : dataSpec.length;
-        }
-        return size;
-    }
-
-    private static void populateIntervalsFromDisk(@NonNull final String key,
-            @NonNull final TreeSet<IntInterval> intervals) {
-        Preconditions.checkNotNull(key);
-        Preconditions.checkNotNull(intervals);
-
-        intervals.clear();
-        byte[] intervalsFromDisk = CacheService.getFromDiskCache(INTERVALS_KEY_PREFIX + key);
-        if (intervalsFromDisk != null) {
-            String intervalsStringData = new String(intervalsFromDisk);
-            try {
-                JSONArray jsonIntervalArray = new JSONArray(intervalsStringData);
-                for (int i = 0; i < jsonIntervalArray.length(); i++) {
-                    JSONObject jsonInterval = new JSONObject((String) jsonIntervalArray.get(i));
-                    intervals.add(new IntInterval(jsonInterval.getInt(START),
-                            jsonInterval.getInt(LENGTH)));
-                }
-            } catch (JSONException e) {
-                MoPubLog.log(ERROR, "clearing cache since invalid json intervals found", e);
-                intervals.clear();
-            } catch (ClassCastException e) {
-                MoPubLog.log(CUSTOM, "clearing cache since unable to read json data");
-                intervals.clear();
-            }
-        }
-    }
-
-    private static Integer getExpectedFileLengthFromDisk(@NonNull final String key) {
-        Preconditions.checkNotNull(key);
-
-        byte[] maxSizeByteArray = CacheService.getFromDiskCache(
-                EXPECTED_FILE_SIZE_KEY_PREFIX + key);
-        if (maxSizeByteArray != null) {
-            try {
-                return Integer.parseInt(new String(maxSizeByteArray));
-            } catch (NumberFormatException e) {
-                return null;
-            }
-        }
-        return null;
-    }
-
-    @Override
-    public Uri getUri() {
-        return mDataSpec != null ? mDataSpec.uri : null;
-    }
-
-    @Override
-    public void close() throws IOException {
-        if (!TextUtils.isEmpty(mKey) && mCachedBytes != null) {
-            CacheService.putToDiskCache(mSegment + mKey, mCachedBytes);
-            addNewInterval(mIntervals, mStartInFile, mDataBlockOffset);
-            writeIntervalsToDisk(mIntervals, mKey);
-        }
-        mCachedBytes = null;
-
-        mHttpDataSource.close();
-        mIsHttpSourceOpen = false;
-        mStartInFile = 0;
-        mDataBlockOffset = 0;
-        mStartInDataBlock = 0;
-        mExpectedFileLength = null;
-        mIsDirty = false;
-    }
-
-    private static void writeIntervalsToDisk(@NonNull final TreeSet<IntInterval> intervals,
-            @NonNull final String key) {
-        Preconditions.checkNotNull(intervals);
-        Preconditions.checkNotNull(key);
-
-        final JSONArray jsonIntervals = new JSONArray();
-        for (IntInterval interval : intervals) {
-            jsonIntervals.put(interval);
-        }
-        CacheService.putToDiskCache(INTERVALS_KEY_PREFIX + key,
-                jsonIntervals.toString().getBytes());
-    }
-
-    @Override
-    public int read(final byte[] buffer, final int offset, final int length) throws IOException {
-        if (length > BLOCK_SIZE) {
-            MoPubLog.log(CUSTOM,
-                    "Reading more than the block size (" + BLOCK_SIZE + " bytes) at once is not possible. length = " + length);
-            return -1;
-        }
-        if (mDataSpec == null) {
-            MoPubLog.log(CUSTOM, "Unable to read from data source when no spec provided");
-            return -1;
-        }
-        if (mCachedBytes == null) {
-            MoPubLog.log(CUSTOM, "No cache set up. Call open before read.");
-            return -1;
-        }
-
-        // Number of bytes available in the current block
-        final int bytesAvailableInCurrentBlock = BLOCK_SIZE - mStartInDataBlock - mDataBlockOffset;
-
-        // The position of the next expected break (could be end of file)
-        final int farthestContiguousPoint = getFirstContiguousPointAfter(
-                mStartInFile + mDataBlockOffset, mIntervals);
-        // Amount of data expected to be in the cache
-        final int validBytesLeftInCache = farthestContiguousPoint - mStartInFile - mDataBlockOffset;
-        // The number of expected bytes to be able to read from the cache
-        final int bytesToRead = Math.min(validBytesLeftInCache, length);
-        // To keep track of actual bytes read from the cache
-        int bytesReadFromDisk = 0;
-        // If the data is available at least partially on disk
-        if (areBytesAvailableInCache(farthestContiguousPoint, mStartInFile, mDataBlockOffset)) {
-            // The case of when all of the bytes are available in the current block
-            if (bytesToRead <= bytesAvailableInCurrentBlock) {
-                System.arraycopy(mCachedBytes, mStartInDataBlock + mDataBlockOffset, buffer, offset,
-                        bytesToRead);
-                mDataBlockOffset += bytesToRead;
-                bytesReadFromDisk += bytesToRead;
-            } else {
-                // Read all of the available bytes in the current block
-                System.arraycopy(mCachedBytes, mStartInDataBlock + mDataBlockOffset, buffer, offset,
-                        bytesAvailableInCurrentBlock);
-                mDataBlockOffset += bytesAvailableInCurrentBlock;
-                bytesReadFromDisk += bytesAvailableInCurrentBlock;
-
-                // Flush the cache
-                writeCacheToDiskAndClearVariables();
-
-                // Read in the next segment from disk
-                mCachedBytes = CacheService.getFromDiskCache(mSegment + mKey);
-                if (mCachedBytes == null) {
-                    // If there is a mismatch between expected bytes available in the cache and what
-                    // is actually in the cache, this is an unrecoverable problem. Reset the cache
-                    // and clear the data and open a new HTTP connection starting at the current position.
-                    MoPubLog.log(CUSTOM, "Unexpected cache miss. Invalidating cache");
-                    mIntervals.clear();
-                    mCachedBytes = new byte[BLOCK_SIZE];
-                    mHttpDataSource.close();
-
-                    mHttpDataSource.open(
-                            new DataSpec(mDataSpec.uri, mStartInFile + mDataBlockOffset,
-                                    LENGTH_UNBOUNDED, mDataSpec.key, mDataSpec.flags));
-                    mIsHttpSourceOpen = true;
-                } else {
-                    // If the data is available in the cache, read the remaining bytes into the
-                    // buffer, additionally offset by what has already been written to the buffer.
-                    System.arraycopy(mCachedBytes, mStartInDataBlock + mDataBlockOffset, buffer,
-                            offset + bytesReadFromDisk,
-                            bytesToRead - bytesReadFromDisk);
-                    mDataBlockOffset += bytesToRead - bytesReadFromDisk;
-                    bytesReadFromDisk = bytesToRead;
-                }
-            }
-        }
-
-        // If we have read enough data from disk, don't ask for network data
-        final int bytesToReadFromNetwork = length - bytesReadFromDisk;
-        if (bytesToReadFromNetwork <= 0) {
-            return bytesReadFromDisk;
-        }
-
-        mIsDirty = true;
-
-        // This should never happen, but if we lose network or something, this might happen
-        if (!mIsHttpSourceOpen) {
-            MoPubLog.log(CUSTOM, "end of cache reached. No http source open");
-            return -1;
-        }
-
-        // Read from network and store to disk
-        int bytesReadFromNetwork = mHttpDataSource.read(buffer, offset + bytesReadFromDisk,
-                bytesToReadFromNetwork);
-
-        final int bytesAvailableInCurrentBlockForNetwork =
-                BLOCK_SIZE - mStartInDataBlock - mDataBlockOffset;
-        if (bytesAvailableInCurrentBlockForNetwork < bytesReadFromNetwork) {
-            // If there is not enough room in the current block, write up to the end of the current
-            // block, set up a new segment (which may have data in the cache already), and write
-            // the rest of the data.
-            System.arraycopy(buffer, offset + bytesReadFromDisk, mCachedBytes,
-                    mStartInDataBlock + mDataBlockOffset, bytesAvailableInCurrentBlockForNetwork);
-            mDataBlockOffset += bytesAvailableInCurrentBlockForNetwork;
-
-            writeCacheToDiskAndClearVariables();
-
-            mCachedBytes = CacheService.getFromDiskCache(mSegment + mKey);
-            if (mCachedBytes == null) {
-                mCachedBytes = new byte[BLOCK_SIZE];
-            }
-
-            System.arraycopy(buffer,
-                    offset + bytesAvailableInCurrentBlockForNetwork + bytesReadFromDisk,
-                    mCachedBytes, mStartInDataBlock + mDataBlockOffset,
-                    bytesReadFromNetwork - bytesAvailableInCurrentBlockForNetwork);
-            mDataBlockOffset += bytesReadFromNetwork - bytesAvailableInCurrentBlockForNetwork;
-        } else {
-            System.arraycopy(buffer, offset + bytesReadFromDisk, mCachedBytes,
-                    mStartInDataBlock + mDataBlockOffset, bytesReadFromNetwork);
-            mDataBlockOffset += bytesReadFromNetwork;
-        }
-
-        return bytesReadFromNetwork + bytesReadFromDisk;
-    }
-
-    private static boolean areBytesAvailableInCache(final int farthestContiguousPoint,
-            final int startInFile, final int dataBlockOffset) {
-        return farthestContiguousPoint > startInFile + dataBlockOffset;
-    }
-
-    private void writeCacheToDiskAndClearVariables() {
-        CacheService.putToDiskCache(mSegment + mKey, mCachedBytes);
-        addNewInterval(mIntervals, mStartInFile, mDataBlockOffset);
-        mStartInDataBlock = 0;
-        mStartInFile = mStartInFile + mDataBlockOffset;
-        mDataBlockOffset = 0;
-        mSegment = mStartInFile / BLOCK_SIZE;
-    }
-
-    /**
-     * Gets the first contiguous point from disk that we have starting from the given point. If
-     * there is no segment that contains this point, return that point.
-     */
-    @VisibleForTesting
-    static int getFirstContiguousPointAfter(int point,
-            @NonNull final TreeSet<IntInterval> intervals) {
-        Preconditions.checkNotNull(intervals);
-
-        int lastContiguousPoint = point;
-        for (final IntInterval interval : intervals) {
-            if (interval.getStart() <= lastContiguousPoint) {
-                lastContiguousPoint = Math.max(lastContiguousPoint,
-                        interval.getStart() + interval.getLength());
-            }
-        }
-        return lastContiguousPoint;
-    }
-
-    /**
-     * Adds the interval if the interval does not already exist.
-     *
-     * @param intervals The current set of intervals
-     * @param start     The starting point of this interval
-     * @param length    The length of this interval
-     */
-    @VisibleForTesting
-    static void addNewInterval(@NonNull final TreeSet<IntInterval> intervals, final int start,
-            final int length) {
-        Preconditions.checkNotNull(intervals);
-
-        if (getFirstContiguousPointAfter(start, intervals) >= start + length) {
-            return;
-        }
-        intervals.add(new IntInterval(start, length));
-    }
-}
diff --git a/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/MoPubCache.java b/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/MoPubCache.java
new file mode 100644
index 00000000..ae8b02fc
--- /dev/null
+++ b/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/MoPubCache.java
@@ -0,0 +1,60 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.nativeads;
+
+import android.content.Context;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+
+import com.google.android.exoplayer2.upstream.cache.Cache;
+import com.google.android.exoplayer2.upstream.cache.LeastRecentlyUsedCacheEvictor;
+import com.google.android.exoplayer2.upstream.cache.SimpleCache;
+import com.mopub.common.Preconditions;
+import com.mopub.common.VisibleForTesting;
+import com.mopub.common.util.DeviceUtils;
+
+import java.io.File;
+
+class MoPubCache {
+
+    private static final String NATIVE_CACHE_NAME = "mopub-native-cache";
+
+    private volatile static Cache sInstance = null;
+
+    @Nullable
+    static Cache getCacheInstance(@NonNull final Context context) {
+        Preconditions.checkNotNull(context);
+
+        Cache instance = sInstance;
+        if (instance == null) {
+            synchronized (MoPubCache.class) {
+                instance = sInstance;
+                if (instance == null) {
+                    final File cacheDir = context.getApplicationContext().getCacheDir();
+
+                    if (cacheDir != null) {
+                        final File nativeCacheDir = new File(cacheDir.getPath()
+                                + File.separator
+                                + NATIVE_CACHE_NAME);
+                        final long cacheSize = DeviceUtils.diskCacheSizeBytes(cacheDir);
+                        final LeastRecentlyUsedCacheEvictor lruEvictor = new LeastRecentlyUsedCacheEvictor(cacheSize);
+                        instance = new SimpleCache(nativeCacheDir, lruEvictor);
+                        sInstance = instance;
+                    }
+                }
+            }
+        }
+
+        return instance;
+    }
+
+    @VisibleForTesting
+    static void resetInstance() {
+        if (sInstance != null) {
+            sInstance.release();
+            sInstance = null;
+        }
+    }
+}
diff --git a/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/NativeVideoController.java b/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/NativeVideoController.java
index bf155e52..e9157382 100644
--- a/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/NativeVideoController.java
+++ b/mopub-sdk/mopub-sdk-native-video/src/main/java/com/mopub/nativeads/NativeVideoController.java
@@ -40,16 +40,19 @@
 import com.google.android.exoplayer2.trackselection.TrackSelector;
 import com.google.android.exoplayer2.upstream.DataSource;
 import com.google.android.exoplayer2.upstream.DefaultAllocator;
+import com.google.android.exoplayer2.upstream.DefaultHttpDataSource;
+import com.google.android.exoplayer2.upstream.cache.Cache;
+import com.google.android.exoplayer2.upstream.cache.CacheDataSource;
 import com.google.android.exoplayer2.video.MediaCodecVideoRenderer;
 
 import com.mopub.common.Preconditions;
+import com.mopub.common.VisibilityTracker.VisibilityChecker;
 import com.mopub.common.VisibleForTesting;
 import com.mopub.common.logging.MoPubLog;
 import com.mopub.mobileads.RepeatingHandlerRunnable;
 import com.mopub.mobileads.VastTracker;
 import com.mopub.mobileads.VastVideoConfig;
 import com.mopub.nativeads.NativeVideoController.NativeVideoProgressRunnable.ProgressListener;
-import com.mopub.common.VisibilityTracker.VisibilityChecker;
 import com.mopub.network.TrackingRequest;
 
 import java.lang.ref.WeakReference;
@@ -415,7 +418,15 @@ private void preparePlayer() {
             final DataSource.Factory dataSourceFactory = new DataSource.Factory() {
                 @Override
                 public DataSource createDataSource() {
-                    return new HttpDiskCompositeDataSource(mContext, "exo_demo");
+                    DataSource dataSource = new DefaultHttpDataSource("exo_demo",
+                            null);
+                    final Cache cache = MoPubCache.getCacheInstance(mContext);
+
+                    if (cache != null) {
+                        dataSource = new CacheDataSource(cache, dataSource);
+                    }
+
+                    return dataSource;
                 }
             };
 
diff --git a/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/AdLoaderRewardedVideo.java b/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/AdLoaderRewardedVideo.java
index 8746f0d9..79a06f9e 100644
--- a/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/AdLoaderRewardedVideo.java
+++ b/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/AdLoaderRewardedVideo.java
@@ -12,6 +12,7 @@
 import com.mopub.common.Preconditions;
 import com.mopub.network.AdLoader;
 import com.mopub.network.AdResponse;
+import com.mopub.network.SingleImpression;
 import com.mopub.network.TrackingRequest;
 
 import java.util.Collections;
@@ -72,6 +73,9 @@ void trackImpression(@NonNull Context context) {
         TrackingRequest.makeTrackingHttpRequest(
                 getImpressionUrls(),
                 context);
+
+        final String adUnitId = mLastDeliveredResponse.getAdUnitId();
+        new SingleImpression(adUnitId, mLastDeliveredResponse.getImpressionData()).sendImpression();
     }
 
     void trackClick(@NonNull Context context) {
diff --git a/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/MoPubRewardedVideoManager.java b/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/MoPubRewardedVideoManager.java
index 2402ab49..47806418 100644
--- a/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/MoPubRewardedVideoManager.java
+++ b/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/MoPubRewardedVideoManager.java
@@ -307,11 +307,6 @@ private void fetchAd(@NonNull String adUnitId, @NonNull String adUrlString, @Nul
                     "unit %s. A request is already pending.", adUnitId));
             return;
         }
-        if (rewardedAdsLoaders.isLoading(adUnitId)) {
-            MoPubLog.log(CUSTOM, String.format(Locale.US, "Did not queue rewarded ad request for ad " +
-                    "unit %s. A request is already pending.", adUnitId));
-            return;
-        }
 
         // Issue MoPub request
         MoPubLog.log(CUSTOM, String.format(Locale.US,
@@ -522,11 +517,10 @@ public void run() {
                         "Updating init settings for custom event %s with params %s",
                         customEventClassName, serverExtrasJsonString));
 
-                // https://github.com/robolectric/robolectric/issues/3641
                 sCustomEventSharedPrefs
                         .edit()
                         .putString(customEventClassName, serverExtrasJsonString)
-                        .commit();
+                        .apply();
             }
 
             // Load custom event
diff --git a/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/RewardedMraidActivity.java b/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/RewardedMraidActivity.java
index a9ca1d02..b6aca649 100644
--- a/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/RewardedMraidActivity.java
+++ b/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mobileads/RewardedMraidActivity.java
@@ -29,7 +29,6 @@
 
 import static com.mopub.common.DataKeys.AD_REPORT_KEY;
 import static com.mopub.common.DataKeys.BROADCAST_IDENTIFIER_KEY;
-import static com.mopub.common.DataKeys.HTML_RESPONSE_BODY_KEY;
 import static com.mopub.common.DataKeys.REWARDED_AD_DURATION_KEY;
 import static com.mopub.common.DataKeys.SHOULD_REWARD_ON_CLICK_KEY;
 import static com.mopub.common.IntentActions.ACTION_INTERSTITIAL_CLICK;
@@ -46,7 +45,6 @@
     public static void preRenderHtml(@NonNull final Interstitial mraidInterstitial,
             @NonNull final Context context,
             @NonNull final CustomEventInterstitial.CustomEventInterstitialListener customEventInterstitialListener,
-            @Nullable final String htmlData,
             @NonNull final Long broadcastIdentifier,
             @Nullable final AdReport adReport,
             final int rewardedDuration) {
@@ -55,16 +53,16 @@ public static void preRenderHtml(@NonNull final Interstitial mraidInterstitial,
         Preconditions.checkNotNull(customEventInterstitialListener);
         Preconditions.checkNotNull(broadcastIdentifier);
 
-        preRenderHtml(mraidInterstitial, customEventInterstitialListener, htmlData,
+        preRenderHtml(mraidInterstitial, customEventInterstitialListener, getResponseString(adReport),
                 new MraidBridge.MraidWebView(context), broadcastIdentifier,
                 new RewardedMraidController(context, adReport, PlacementType.INTERSTITIAL,
                         rewardedDuration, broadcastIdentifier));
     }
 
     public static void start(@NonNull Context context, @Nullable AdReport adreport,
-            @Nullable String htmlData, long broadcastIdentifier, int rewardedDuration,
-            boolean shouldRewardOnClick) {
-        final Intent intent = createIntent(context, adreport, htmlData, broadcastIdentifier,
+                             long broadcastIdentifier, int rewardedDuration,
+                             boolean shouldRewardOnClick) {
+        final Intent intent = createIntent(context, adreport, broadcastIdentifier,
                 rewardedDuration, shouldRewardOnClick);
         try {
             Intents.startActivity(context, intent);
@@ -76,10 +74,9 @@ public static void start(@NonNull Context context, @Nullable AdReport adreport,
 
     @VisibleForTesting
     protected static Intent createIntent(@NonNull Context context, @Nullable AdReport adReport,
-            @Nullable String htmlData, long broadcastIdentifier, int rewardedDuration,
-            boolean shouldRewardOnClick) {
+                                         long broadcastIdentifier, int rewardedDuration,
+                                         boolean shouldRewardOnClick) {
         Intent intent = new Intent(context, RewardedMraidActivity.class);
-        intent.putExtra(HTML_RESPONSE_BODY_KEY, htmlData);
         intent.putExtra(BROADCAST_IDENTIFIER_KEY, broadcastIdentifier);
         intent.putExtra(AD_REPORT_KEY, adReport);
         intent.putExtra(REWARDED_AD_DURATION_KEY, rewardedDuration);
@@ -90,7 +87,7 @@ protected static Intent createIntent(@NonNull Context context, @Nullable AdRepor
     @Override
     public View getAdView() {
         final Intent intent = getIntent();
-        final String htmlData = intent.getStringExtra(HTML_RESPONSE_BODY_KEY);
+        final String htmlData = getResponseString();
         if (TextUtils.isEmpty(htmlData)) {
             MoPubLog.log(CUSTOM, "RewardedMraidActivity received a null HTML body. Finishing the activity.");
             finish();
@@ -148,6 +145,11 @@ public void onExpand() {
                 // No-op. The interstitial is always expanded.
             }
 
+            @Override
+            public void onResize(final boolean toOriginalSize) {
+                // No-op. The interstitial is always expanded.
+            }
+
             @Override
             public void onOpen() {
                 if (shouldRewardOnClick) {
diff --git a/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mraid/RewardedMraidInterstitial.java b/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mraid/RewardedMraidInterstitial.java
index 1fed1e1c..36f80a94 100644
--- a/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mraid/RewardedMraidInterstitial.java
+++ b/mopub-sdk/mopub-sdk-rewardedvideo/src/main/java/com/mopub/mraid/RewardedMraidInterstitial.java
@@ -71,14 +71,14 @@ protected void preRenderHtml(@NonNull CustomEventInterstitialListener
 
         }
         RewardedMraidActivity.preRenderHtml(this, mContext,
-                customEventInterstitialListener, mHtmlData, mBroadcastIdentifier, mAdReport,
+                customEventInterstitialListener, mBroadcastIdentifier, mAdReport,
                 mRewardedDuration);
     }
 
     @Override
     public void showInterstitial() {
         MoPubLog.log(SHOW_ATTEMPTED, ADAPTER_NAME);
-        RewardedMraidActivity.start(mContext, mAdReport, mHtmlData, mBroadcastIdentifier,
+        RewardedMraidActivity.start(mContext, mAdReport, mBroadcastIdentifier,
                 mRewardedDuration, mShouldRewardOnClick);
     }
 
diff --git a/mopub-sdk/publisher.gradle b/mopub-sdk/publisher.gradle
index 785ffac7..b180dd43 100644
--- a/mopub-sdk/publisher.gradle
+++ b/mopub-sdk/publisher.gradle
@@ -54,8 +54,8 @@ publish {
     groupId = project.group
     artifactId = project.ext.projectName
     uploadName = project.ext.uploadName
-    version = project.version
-    description = project.description
+    publishVersion = project.version
+    desc = project.description
     website = siteUrl
     repository = gitUrl
 
diff --git a/mopub-sdk/shared-build.gradle b/mopub-sdk/shared-build.gradle
index f4018039..480dd9b0 100644
--- a/mopub-sdk/shared-build.gradle
+++ b/mopub-sdk/shared-build.gradle
@@ -16,16 +16,15 @@ repositories {
 }
 
 project.group = 'com.mopub'
-project.version = '5.5.0'
+project.version = '5.7.0'
 
 android {
     compileSdkVersion 27
     buildToolsVersion '27.0.3'
     lintOptions { abortOnError false }
-    useLibrary 'org.apache.http.legacy'
 
     defaultConfig {
-        versionCode 66
+        versionCode 68
         versionName version
         minSdkVersion 16
         targetSdkVersion 27
diff --git a/mopub-sdk/src/main/AndroidManifest.xml b/mopub-sdk/src/main/AndroidManifest.xml
index 786dbbe6..e1746fda 100644
--- a/mopub-sdk/src/main/AndroidManifest.xml
+++ b/mopub-sdk/src/main/AndroidManifest.xml
@@ -1,8 +1,7 @@
 <?xml version="1.0" encoding="utf-8"?>
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-    package="com.mopub.mobileads"
-    android:versionCode="1"
-    android:versionName="1.0">
-    <application/>
+    package="com.mopub.mobileads">
+
+    <application />
 </manifest>
 
diff --git a/mopub-sdk/src/test/java/com/mopub/common/AdReportTest.java b/mopub-sdk/src/test/java/com/mopub/common/AdReportTest.java
index 84c6d0a6..40274f43 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/AdReportTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/AdReportTest.java
@@ -115,6 +115,28 @@ public void constructor_shouldHandleInvalidAdConfigurationValues() {
         assertThat(subject.toString()).isEqualTo(expectedParameters);
     }
 
+    @Test
+    public void getResponseString_shouldReturnAdResponseStringBody() {
+        final String stringBody = "this is the ad response string body";
+        when(mockAdResponse.getStringBody()).thenReturn(stringBody);
+        when(mockClientMetadata.getMoPubIdentifier()).thenReturn(new MoPubIdentifier(context));
+
+        subject = new AdReport("testAdunit", mockClientMetadata, mockAdResponse);
+
+        assertThat(subject.getResponseString()).isEqualTo(stringBody);
+    }
+
+    @Test
+    public void getResponseString_withNullStringBody_shouldReturnNull() {
+        final String stringBody = null;
+        when(mockAdResponse.getStringBody()).thenReturn(stringBody);
+        when(mockClientMetadata.getMoPubIdentifier()).thenReturn(new MoPubIdentifier(context));
+
+        subject = new AdReport("testAdunit", mockClientMetadata, mockAdResponse);
+
+        assertThat(subject.getResponseString()).isNull();
+    }
+
     private String getCurrentDateTime() {
         SimpleDateFormat dateFormat = new SimpleDateFormat("M/d/yy hh:mm:ss a z", Locale.US);
         return dateFormat.format(now);
diff --git a/mopub-sdk/src/test/java/com/mopub/common/AdapterConfigurationManagerTest.java b/mopub-sdk/src/test/java/com/mopub/common/AdapterConfigurationManagerTest.java
index 1e416860..296818d9 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/AdapterConfigurationManagerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/AdapterConfigurationManagerTest.java
@@ -103,7 +103,7 @@ public void initialize_withAdapterConfigurationClass_shouldMergeInitializationPa
                 context, CUSTOM_EVENT_PREF_NAME);
         sharedPreferences.edit().putString(
                 ACMTestAdapterConfiguration.class.getName(),
-                "{\"key1\":\"oldValue\",\"key5\":\"value5\"}").commit();
+                "{\"key1\":\"oldValue\",\"key5\":\"value5\"}").apply();
 
         subject.initialize(context, set, networkMediationConfigurations, moPubRequestOptions);
 
diff --git a/mopub-sdk/src/test/java/com/mopub/common/BaseAdapterConfigurationTest.java b/mopub-sdk/src/test/java/com/mopub/common/BaseAdapterConfigurationTest.java
index 8fbab395..2fc9fa7b 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/BaseAdapterConfigurationTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/BaseAdapterConfigurationTest.java
@@ -42,7 +42,7 @@ public void setup() {
     public void tearDown() {
         final SharedPreferences sharedPreferences = SharedPreferencesHelper.getSharedPreferences(
                 context, CUSTOM_EVENT_PREF_NAME);
-        sharedPreferences.edit().clear().commit();
+        sharedPreferences.edit().clear().apply();
     }
 
     @Test
@@ -66,7 +66,7 @@ public void getCachedInitializationParameters_withInitializationParameters_shoul
         final SharedPreferences sharedPreferences = SharedPreferencesHelper.getSharedPreferences(
                 context, CUSTOM_EVENT_PREF_NAME);
         sharedPreferences.edit().putString(TestAdapterConfiguration.class.getName(),
-                "{\"key1\":\"value1\",\"key2\":\"value2\"}").commit();
+                "{\"key1\":\"value1\",\"key2\":\"value2\"}").apply();
 
         final Map<String, String> initializationParameters =
                 subject.getCachedInitializationParameters(context);
@@ -82,7 +82,7 @@ public void getCachedInitializationParameters_withInvalidInitializationParameter
                 context, CUSTOM_EVENT_PREF_NAME);
         // missing the last curly brace
         sharedPreferences.edit().putString(TestAdapterConfiguration.class.getName(),
-                "{\"key1\":\"value1\",\"key2\":\"value2\"").commit();
+                "{\"key1\":\"value1\",\"key2\":\"value2\"").apply();
 
         final Map<String, String> initializationParameters =
                 subject.getCachedInitializationParameters(context);
diff --git a/mopub-sdk/src/test/java/com/mopub/common/GpsHelperTest.java b/mopub-sdk/src/test/java/com/mopub/common/GpsHelperTest.java
index df31154c..7ec9b666 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/GpsHelperTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/GpsHelperTest.java
@@ -138,7 +138,7 @@ public void isLimitAdTrackingEnabled_whenGooglePlayServicesIsLinkedAndLimitAdTra
         SharedPreferencesHelper.getSharedPreferences(context)
                 .edit()
                 .putBoolean(GpsHelper.IS_LIMIT_AD_TRACKING_ENABLED_KEY, adInfo.LIMIT_AD_TRACKING_ENABLED)
-                .commit();
+                .apply();
         assertThat(GpsHelper.isLimitAdTrackingEnabled(context)).isEqualTo(adInfo.LIMIT_AD_TRACKING_ENABLED);
     }
 
diff --git a/mopub-sdk/src/test/java/com/mopub/common/logging/MoPubDefaultLoggerTest.java b/mopub-sdk/src/test/java/com/mopub/common/logging/MoPubDefaultLoggerTest.java
new file mode 100644
index 00000000..ea83f340
--- /dev/null
+++ b/mopub-sdk/src/test/java/com/mopub/common/logging/MoPubDefaultLoggerTest.java
@@ -0,0 +1,62 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.common.logging;
+
+import com.mopub.common.test.support.SdkTestRunner;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import static org.fest.assertions.api.Assertions.assertThat;
+
+@RunWith(SdkTestRunner.class)
+public class MoPubDefaultLoggerTest {
+
+    private static final String SHORT_MESSAGE = "short message.";
+    private static String LONG_MESSAGE;
+
+    static {
+        final StringBuilder sb = new StringBuilder();
+        // 9990 bytes
+        for (int i = 0; i < 999; i++) {
+            sb.append("0123456789");
+        }
+        LONG_MESSAGE = sb.toString();
+    }
+
+    @Test
+    public void split_withShortMessage_shouldReturnArrayWithOneElement() {
+        final String[] result = MoPubDefaultLogger.split(SHORT_MESSAGE);
+
+        assertThat(result).isEqualTo(new String[]{SHORT_MESSAGE});
+    }
+
+    @Test
+    public void split_withLongMessage_shouldReturnArrayWithProperSegments() {
+        final String[] result = MoPubDefaultLogger.split(LONG_MESSAGE);
+
+        assertThat(result.length).isEqualTo(
+                (LONG_MESSAGE.length() / MoPubDefaultLogger.MAX_MESSAGE_LENGTH_BYTES) + 1);
+        final StringBuilder resultString = new StringBuilder();
+        for (String segment : result) {
+            resultString.append(segment);
+        }
+        assertThat(resultString.toString()).isEqualTo(LONG_MESSAGE);
+    }
+
+    @Test
+    public void split_withEmptyMessage_shouldReturnArrayWithEmptyString() {
+        final String[] result = MoPubDefaultLogger.split("");
+
+        assertThat(result).isEqualTo(new String[]{""});
+    }
+
+    @Test
+    public void split_withNullMessage_shouldReturnArrayWithNullString() {
+        final String[] result = MoPubDefaultLogger.split(null);
+
+        assertThat(result).isEqualTo(new String[]{null});
+    }
+}
diff --git a/mopub-sdk/src/test/java/com/mopub/common/privacy/AdvertisingIdTest.java b/mopub-sdk/src/test/java/com/mopub/common/privacy/AdvertisingIdTest.java
index 9ee03d3d..f0d5f68c 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/privacy/AdvertisingIdTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/privacy/AdvertisingIdTest.java
@@ -11,6 +11,7 @@
 import org.junit.runner.RunWith;
 
 import java.util.Calendar;
+import java.util.TimeZone;
 
 import static org.fest.assertions.api.Assertions.assertThat;
 
@@ -44,6 +45,8 @@ public void constructor_shouldInitializeCorrectly() {
         assertThat(subject.mDoNotTrack).isTrue();
         // return IFA even when DoNotTrack is true
         assertThat(subject.getIfaWithPrefix()).isEqualTo("ifa:" + ANDROID_ID);
+        assertThat(subject.mLastRotation.get(Calendar.DAY_OF_YEAR)).isEqualTo(
+                time.get(Calendar.DAY_OF_YEAR));
     }
 
     @Test
@@ -54,9 +57,66 @@ public void isRotationRequired_whenMoreThan24Hours_shouldReturnTrue() {
     }
 
     @Test
-    public void isRotationRequired_whenLessThan24Hours_shouldReturnFalse() {
-        // one day and ten seconds ago
-        subject = new AdvertisingId(ANDROID_ID, MOPUB_ID, false, now - ONE_DAY_MS + TEN_SECONDS_MS);
+    public void isRotationRequired_whenMidnightSameDay_shouldReturnFalse() {
+        final Calendar sameDayCalendar = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
+        sameDayCalendar.set(sameDayCalendar.get(Calendar.YEAR), sameDayCalendar.get(Calendar.MONTH),
+                sameDayCalendar.get(Calendar.DAY_OF_MONTH), 0, 0, 0);
+
+        subject = new AdvertisingId(ANDROID_ID, MOPUB_ID, false,
+                sameDayCalendar.getTimeInMillis());
+
+        assertThat(subject.isRotationRequired()).isFalse();
+    }
+
+    @Test
+    public void isRotationRequired_whenLastSecondOfTheSameDay_shouldReturnFalse() {
+        final Calendar sameDayCalendar = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
+        sameDayCalendar.set(sameDayCalendar.get(Calendar.YEAR), sameDayCalendar.get(Calendar.MONTH),
+                sameDayCalendar.get(Calendar.DAY_OF_MONTH), 23, 59, 59);
+
+        subject = new AdvertisingId(ANDROID_ID, MOPUB_ID, false,
+                sameDayCalendar.getTimeInMillis());
+
+        assertThat(subject.isRotationRequired()).isFalse();
+    }
+    @Test
+    public void isRotationRequired_whenMidnightOfNextDay_shouldReturnTrue() {
+        final Calendar sameDayCalendar = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
+        sameDayCalendar.set(sameDayCalendar.get(Calendar.YEAR), sameDayCalendar.get(Calendar.MONTH),
+                sameDayCalendar.get(Calendar.DAY_OF_MONTH), 23, 59, 59);
+        sameDayCalendar.add(Calendar.SECOND, 1);
+
+        subject = new AdvertisingId(ANDROID_ID, MOPUB_ID, false,
+                sameDayCalendar.getTimeInMillis());
+
+        assertThat(subject.isRotationRequired()).isTrue();
+    }
+
+    @Test
+    public void isRotationRequired_whenTimeZoneCausesDayDifference_shouldReturnTrue() {
+        final Calendar sameDayCalendar = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
+        sameDayCalendar.set(sameDayCalendar.get(Calendar.YEAR), sameDayCalendar.get(Calendar.MONTH),
+                sameDayCalendar.get(Calendar.DAY_OF_MONTH), 5, 0, 0);
+        sameDayCalendar.setTimeZone(TimeZone.getTimeZone("PST"));
+        sameDayCalendar.add(Calendar.DATE, -1);
+
+        subject = new AdvertisingId(ANDROID_ID, MOPUB_ID, false,
+                sameDayCalendar.getTimeInMillis());
+
+        assertThat(subject.isRotationRequired()).isTrue();
+    }
+
+    @Test
+    public void isRotationRequired_whenTimeZoneCausesNoDayDifference_shouldReturnFalse() {
+        final Calendar sameDayCalendar = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
+        sameDayCalendar.set(sameDayCalendar.get(Calendar.YEAR), sameDayCalendar.get(Calendar.MONTH),
+                sameDayCalendar.get(Calendar.DAY_OF_MONTH), 22, 0, 0);
+        sameDayCalendar.setTimeZone(TimeZone.getTimeZone("PST"));
+        sameDayCalendar.add(Calendar.DATE, -1);
+
+        subject = new AdvertisingId(ANDROID_ID, MOPUB_ID, false,
+                sameDayCalendar.getTimeInMillis());
+
         assertThat(subject.isRotationRequired()).isFalse();
     }
 
diff --git a/mopub-sdk/src/test/java/com/mopub/common/privacy/ConsentDialogControllerTest.java b/mopub-sdk/src/test/java/com/mopub/common/privacy/ConsentDialogControllerTest.java
index 09fabb0e..291e14dc 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/privacy/ConsentDialogControllerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/privacy/ConsentDialogControllerTest.java
@@ -201,6 +201,6 @@ private String generateTestUrl() {
                 "&language=en" +
                 "&gdpr_applies=1" +
                 "&force_gdpr_applies=0" +
-                "&bundle=com.mopub.mobileads";
+                "&bundle=com.mopub.mobileads.test";
     }
 }
diff --git a/mopub-sdk/src/test/java/com/mopub/common/privacy/ConsentDialogUrlGeneratorTest.java b/mopub-sdk/src/test/java/com/mopub/common/privacy/ConsentDialogUrlGeneratorTest.java
index 4c8c21e2..c9b001c1 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/privacy/ConsentDialogUrlGeneratorTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/privacy/ConsentDialogUrlGeneratorTest.java
@@ -22,6 +22,7 @@
 import org.robolectric.Robolectric;
 import org.robolectric.RobolectricTestRunner;
 
+import java.net.URLEncoder;
 import java.util.Map;
 
 import static com.mopub.common.privacy.ConsentStatus.EXPLICIT_NO;
@@ -80,7 +81,7 @@ public void constructor_withConsentStatusNull_shouldThrowException() {
     }
 
     @Test
-    public void generateUrlString_withMinimumParametersSet_shouldGenerateValidUrl() {
+    public void generateUrlString_withMinimumParametersSet_shouldGenerateValidUrl() throws java.io.UnsupportedEncodingException {
         String validUrl = createTestUrl();
 
         subject = new ConsentDialogUrlGenerator(context, AD_UNIT_ID, UNKNOWN.getValue());
@@ -140,11 +141,11 @@ public void generateUrlString_withGdprAppliesNotSet_shouldNotIncludeGdprParam()
     }
 
     // unit test utils
-    private String createTestUrl() {
+    private String createTestUrl() throws java.io.UnsupportedEncodingException {
         return "https://" + Constants.HOST + "/m/gdpr_consent_dialog" +
                 "?id=" + AD_UNIT_ID +
                 "&current_consent_status=" + UNKNOWN.getValue() +
-                "&nv=" + MoPub.SDK_VERSION +
+                "&nv=" + URLEncoder.encode(MoPub.SDK_VERSION, "UTF-8") +
                 "&language=" + CURRENT_LANGUAGE +
                 "&force_gdpr_applies=" + "0" +
                 "&bundle=" + BUNDLE;
diff --git a/mopub-sdk/src/test/java/com/mopub/common/privacy/MoPubIdentifierTest.java b/mopub-sdk/src/test/java/com/mopub/common/privacy/MoPubIdentifierTest.java
index a42f2c8b..5e285e3f 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/privacy/MoPubIdentifierTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/privacy/MoPubIdentifierTest.java
@@ -12,6 +12,7 @@
 
 import com.mopub.common.GpsHelper;
 import com.mopub.common.SdkInitializationListener;
+import com.mopub.common.logging.MoPubLog;
 import com.mopub.common.util.AsyncTasks;
 import com.mopub.common.util.Reflection;
 
@@ -39,7 +40,6 @@
 import static org.mockito.Mockito.never;
 import static org.mockito.Mockito.reset;
 import static org.mockito.Mockito.verify;
-import static org.powermock.api.mockito.PowerMockito.verifyStatic;
 
 @RunWith(RobolectricTestRunner.class)
 @PowerMockIgnore({"org.mockito.*", "org.robolectric.*", "android.*", "org.json.*"})
@@ -58,6 +58,7 @@
     private static final String AMAZON_AD_ID = "amazon_ad_id";
     private static final String TEST_IFA_ID = "test_ifa_id";
     public static final String TEST_MOPUB_ID = "test_mopub_id";
+    public static final String GOOGLE_AD_ID_DEBUG = "something_something_10ca1ad1abe1";
 
     @Before
     public void setup() {
@@ -431,6 +432,48 @@ public void refreshAdvertisingInfoBackgroundThread_withNotExpiredId_withAmazon_w
         assertThat(newId.isRotationRequired()).isFalse();
     }
 
+    @Test
+    public void rotateMoPubId_withDebugGAID_shouldSetLogLevelToDebug() throws Exception {
+        // Set log level to none and get value from MoPubLog
+        MoPubLog.setLogLevel(MoPubLog.LogLevel.NONE);
+        final MoPubLog.LogLevel beforeLogLevel = MoPubLog.getLogLevel();
+        setupGooglePlayServiceDebug(context, false);
+
+        ArgumentCaptor<AdvertisingId> oldIdClientCaptor = ArgumentCaptor.forClass(AdvertisingId.class);
+        ArgumentCaptor<AdvertisingId> newIdClientCaptor = ArgumentCaptor.forClass(AdvertisingId.class);
+
+        subject = new MoPubIdentifier(context, idChangeListener);
+
+        ShadowLooper.runUiThreadTasks();
+        verify(idChangeListener).onIdChanged(oldIdClientCaptor.capture(), newIdClientCaptor.capture());
+
+        // Get log level
+        final MoPubLog.LogLevel afterLogLevel = MoPubLog.getLogLevel();
+
+        assertThat(beforeLogLevel).isNotEqualTo(afterLogLevel);
+    }
+
+    @Test
+    public void rotateMoPubId_withoutDebugGAID_shouldNotSetLogLevel() throws Exception {
+        // Set log level to none and get value from MoPubLog
+        MoPubLog.setLogLevel(MoPubLog.LogLevel.NONE);
+        final MoPubLog.LogLevel beforeLogLevel = MoPubLog.getLogLevel();
+        setupGooglePlayService(context, false);
+
+        ArgumentCaptor<AdvertisingId> oldIdClientCaptor = ArgumentCaptor.forClass(AdvertisingId.class);
+        ArgumentCaptor<AdvertisingId> newIdClientCaptor = ArgumentCaptor.forClass(AdvertisingId.class);
+
+        subject = new MoPubIdentifier(context, idChangeListener);
+
+        ShadowLooper.runUiThreadTasks();
+        verify(idChangeListener).onIdChanged(oldIdClientCaptor.capture(), newIdClientCaptor.capture());
+
+        // Get log level
+        final MoPubLog.LogLevel afterLogLevel = MoPubLog.getLogLevel();
+
+        assertThat(beforeLogLevel).isEqualTo(afterLogLevel);
+    }
+
     // Unit tests utility functions
     public static void setupGooglePlayService(Context context, boolean limitAdTracking) {
         PowerMockito.mockStatic(GpsHelper.class);
@@ -438,6 +481,12 @@ public static void setupGooglePlayService(Context context, boolean limitAdTracki
         PowerMockito.when(GpsHelper.fetchAdvertisingInfoSync(context)).thenReturn(new GpsHelper.AdvertisingInfo(GOOGLE_AD_ID, limitAdTracking));
     }
 
+    public static void setupGooglePlayServiceDebug(Context context, boolean limitAdTracking) {
+        PowerMockito.mockStatic(GpsHelper.class);
+        PowerMockito.when(GpsHelper.isLimitAdTrackingEnabled(context)).thenReturn(limitAdTracking);
+        PowerMockito.when(GpsHelper.fetchAdvertisingInfoSync(context)).thenReturn(new GpsHelper.AdvertisingInfo(GOOGLE_AD_ID_DEBUG, limitAdTracking));
+    }
+
     public static void setupAmazonAdvertisingInfo(boolean limitAdTracking) {
         ContentResolver resolver = RuntimeEnvironment.application.getContentResolver();
         Settings.Secure.putInt(resolver, "limit_ad_tracking", limitAdTracking ? 1 : 0);
@@ -464,7 +513,7 @@ public static AdvertisingId writeAdvertisingInfoToSharedPreferences(Context cont
     }
 
     private static AdvertisingId writeExpiredAdvertisingInfoToSharedPreferences(Context context, boolean doNotTrack) throws Exception {
-        final long time = Calendar.getInstance().getTimeInMillis() - AdvertisingId.ROTATION_TIME_MS;
+        final long time = Calendar.getInstance().getTimeInMillis() - AdvertisingId.ONE_DAY_MS * 2;
         return writeAdvertisingInfoToSharedPreferences(context, doNotTrack, time);
     }
 
diff --git a/mopub-sdk/src/test/java/com/mopub/common/privacy/PersonalInfoManagerTest.java b/mopub-sdk/src/test/java/com/mopub/common/privacy/PersonalInfoManagerTest.java
index 7379d36d..ee8712a9 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/privacy/PersonalInfoManagerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/privacy/PersonalInfoManagerTest.java
@@ -82,6 +82,7 @@ public void setUp() {
         personalInfoData = subject.getPersonalInfoData();
         mockConsentStatusChangeListener = mock(ConsentStatusChangeListener.class);
         subject.subscribeConsentStatusChangeListener(mockConsentStatusChangeListener);
+        personalInfoData.setLastChangedMs("old_time");
     }
 
     @After
@@ -364,6 +365,7 @@ public void changeConsentStateFromDialog_withYes_shouldChangeStatusToExplicitYes
         assertThat(subject.getPersonalInfoConsentStatus()).isEqualTo(ConsentStatus.EXPLICIT_YES);
         assertThat(personalInfoData.getConsentChangeReason()).isEqualTo(
                 ConsentChangeReason.GRANTED_BY_USER.getReason());
+        assertThat(personalInfoData.getLastChangedMs()).isNotEqualTo("old_time");
         verify(mockConsentStatusChangeListener).onConsentStateChange(ConsentStatus.UNKNOWN,
                 ConsentStatus.EXPLICIT_YES, true);
     }
@@ -378,6 +380,7 @@ public void changeConsentStateFromDialog_withNo_shouldChangeStatusToExplicitNo()
         assertThat(subject.getPersonalInfoConsentStatus()).isEqualTo(ConsentStatus.EXPLICIT_NO);
         assertThat(personalInfoData.getConsentChangeReason()).isEqualTo(
                 ConsentChangeReason.DENIED_BY_USER.getReason());
+        assertThat(personalInfoData.getLastChangedMs()).isNotEqualTo("old_time");
         verify(mockConsentStatusChangeListener).onConsentStateChange(ConsentStatus.UNKNOWN,
                 ConsentStatus.EXPLICIT_NO, false);
     }
@@ -748,6 +751,7 @@ public void attemptStateTransition_withSameConsentStatus_shouldDoNothing() {
         subject.attemptStateTransition(ConsentStatus.EXPLICIT_YES, "no reason");
         verifyZeroInteractions(mockConsentStatusChangeListener);
         assertThat(personalInfoData.getConsentedPrivacyPolicyVersion()).isEqualTo("1");
+        assertThat(personalInfoData.getLastChangedMs()).isEqualTo("old_time");
     }
 
     @Test
@@ -767,6 +771,7 @@ public void attemptStateTransition_withUnknownToYes_shouldSetConsentedVersions_s
         assertThat(subject.getPersonalInfoConsentStatus()).isEqualTo(ConsentStatus.EXPLICIT_YES);
         verify(mockConsentStatusChangeListener).onConsentStateChange(ConsentStatus.UNKNOWN,
                 ConsentStatus.EXPLICIT_YES, true);
+        assertThat(personalInfoData.getLastChangedMs()).isNotEqualTo("old_time");
     }
 
     @Test
@@ -788,6 +793,7 @@ public void attemptStateTransition_withPotentialWhitelistToYes_shouldNotSetConse
         verify(mockConsentStatusChangeListener).onConsentStateChange(
                 ConsentStatus.POTENTIAL_WHITELIST,
                 ConsentStatus.EXPLICIT_YES, true);
+        assertThat(personalInfoData.getLastChangedMs()).isNotEqualTo("old_time");
     }
 
     @Test
@@ -809,6 +815,7 @@ public void attemptStateTransition_withYesToDnt_shouldClearPersonalDataExceptUdi
         assertThat(subject.getPersonalInfoConsentStatus()).isEqualTo(ConsentStatus.DNT);
         verify(mockConsentStatusChangeListener).onConsentStateChange(ConsentStatus.EXPLICIT_YES,
                 ConsentStatus.DNT, false);
+        assertThat(personalInfoData.getLastChangedMs()).isNotEqualTo("old_time");
     }
 
     @Test
@@ -829,6 +836,7 @@ public void attemptStateTransition_withUnknownToDnt() {
         assertThat(subject.getPersonalInfoConsentStatus()).isEqualTo(ConsentStatus.DNT);
         verify(mockConsentStatusChangeListener).onConsentStateChange(ConsentStatus.EXPLICIT_YES,
                 ConsentStatus.DNT, false);
+        assertThat(personalInfoData.getLastChangedMs()).isNotEqualTo("old_time");
     }
 
     @Test
@@ -850,6 +858,7 @@ public void attemptStateTransition_withYesToNo_shouldClearPersonalDataExceptUdid
         assertThat(subject.getPersonalInfoConsentStatus()).isEqualTo(ConsentStatus.EXPLICIT_NO);
         verify(mockConsentStatusChangeListener).onConsentStateChange(ConsentStatus.EXPLICIT_YES,
                 ConsentStatus.EXPLICIT_NO, false);
+        assertThat(personalInfoData.getLastChangedMs()).isNotEqualTo("old_time");
     }
 
     @Test
@@ -870,5 +879,6 @@ public void attemptStateTransition_withUnknownToPotentialWhitelist_shouldSetCons
                 ConsentStatus.POTENTIAL_WHITELIST);
         verify(mockConsentStatusChangeListener).onConsentStateChange(ConsentStatus.UNKNOWN,
                 ConsentStatus.POTENTIAL_WHITELIST, false);
+        assertThat(personalInfoData.getLastChangedMs()).isNotEqualTo("old_time");
     }
 }
diff --git a/mopub-sdk/src/test/java/com/mopub/common/privacy/SyncUrlGeneratorTest.java b/mopub-sdk/src/test/java/com/mopub/common/privacy/SyncUrlGeneratorTest.java
index abf57941..3b387f8b 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/privacy/SyncUrlGeneratorTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/privacy/SyncUrlGeneratorTest.java
@@ -24,6 +24,8 @@
 import org.powermock.modules.junit4.rule.PowerMockRule;
 import org.robolectric.Robolectric;
 
+import java.net.URLEncoder;
+
 import static org.fest.assertions.api.Assertions.assertThat;
 import static org.mockito.Matchers.any;
 import static org.powermock.api.mockito.PowerMockito.mock;
@@ -111,21 +113,23 @@ public void generateUrlString_withAllParams_shouldGenerateFullUrl() {
     }
 
     @Test
-    public void generateUrlString_withMinimumParams_shouldGenerateValidUrl() {
+    public void generateUrlString_withMinimumParams_shouldGenerateValidUrl() throws java.io.UnsupportedEncodingException {
         final String url = subject.generateUrlString("minurl");
 
-        assertThat(url).isEqualTo("https://minurl/m/gdpr_sync?nv=" + MoPub.SDK_VERSION +
-        "&current_consent_status=unknown&force_gdpr_applies=0&dnt=mp_tmpl_do_not_track");
+        assertThat(url).isEqualTo("https://minurl/m/gdpr_sync?nv=" +
+                URLEncoder.encode(MoPub.SDK_VERSION, "UTF-8") +
+                "&current_consent_status=unknown&force_gdpr_applies=0&dnt=mp_tmpl_do_not_track");
     }
 
     @Test
-    public void generateUrlString_withExtrasThatShouldBeUrlEncoded_shouldGenerateValidUrl() {
+    public void generateUrlString_withExtrasThatShouldBeUrlEncoded_shouldGenerateValidUrl() throws java.io.UnsupportedEncodingException {
         subject = new SyncUrlGenerator(context, ConsentStatus.EXPLICIT_YES.getValue());
         subject.withExtras("!@#$%^&*()_;'[]{}|\\");
 
         final String url = subject.generateUrlString("host");
 
-        assertThat(url).isEqualTo("https://host/m/gdpr_sync?nv=" + MoPub.SDK_VERSION +
+        assertThat(url).isEqualTo("https://host/m/gdpr_sync?nv=" +
+                URLEncoder.encode(MoPub.SDK_VERSION, "UTF-8") +
                 "&current_consent_status=explicit_yes" +
                 "&extras=!%40%23%24%25%5E%26*()_%3B'%5B%5D%7B%7D%7C%5C" +
                 "&force_gdpr_applies=0&dnt=mp_tmpl_do_not_track");
diff --git a/mopub-sdk/src/test/java/com/mopub/common/util/ManifestUtilsTest.java b/mopub-sdk/src/test/java/com/mopub/common/util/ManifestUtilsTest.java
index d905659e..243aa17d 100644
--- a/mopub-sdk/src/test/java/com/mopub/common/util/ManifestUtilsTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/common/util/ManifestUtilsTest.java
@@ -7,10 +7,8 @@
 import android.annotation.TargetApi;
 import android.app.Activity;
 import android.content.Context;
-import android.content.Intent;
 import android.content.pm.ActivityInfo;
 import android.content.pm.ApplicationInfo;
-import android.content.pm.ResolveInfo;
 
 import com.mopub.common.MoPubBrowser;
 import com.mopub.common.logging.MoPubLog;
@@ -23,7 +21,6 @@
 import org.junit.Before;
 import org.junit.Test;
 import org.junit.runner.RunWith;
-import org.mockito.Mock;
 import org.mockito.invocation.InvocationOnMock;
 import org.mockito.stubbing.Answer;
 import org.robolectric.Robolectric;
@@ -49,8 +46,6 @@
     private List<Class<? extends Activity>> requiredWebViewSdkActivities;
     private List<Class<? extends Activity>> requiredNativeSdkActivities;
 
-    @Mock private ResolveInfo mockResolveInfo;
-
     @Before
     public void setUp() throws Exception {
         context = spy(Robolectric.buildActivity(Activity.class).create().get());
@@ -120,11 +115,11 @@ public void checSdkActivitiesDeclared_shouldIncludeOneActivityDeclaration() thro
 
     @Test
     public void displayWarningForMissingActivities_withAllActivitiesDeclared_shouldNotShowLogOrToast() throws Exception {
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MraidActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, RewardedMraidActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MraidVideoPlayerActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubBrowser.class), mockResolveInfo);
+        addActivityToShadowPackageManager(context, MoPubActivity.class.getName());
+        addActivityToShadowPackageManager(context, MraidActivity.class.getName());
+        addActivityToShadowPackageManager(context, RewardedMraidActivity.class.getName());
+        addActivityToShadowPackageManager(context, MraidVideoPlayerActivity.class.getName());
+        addActivityToShadowPackageManager(context, MoPubBrowser.class.getName());
 
         ShadowLog.setupLogging();
         setDebugMode(true);
@@ -138,8 +133,8 @@ public void displayWarningForMissingActivities_withAllActivitiesDeclared_shouldN
     @Test
     public void displayWarningForMissingActivities_withoutInterstitialModule_withoutInterstitialActivitiesDeclared_shouldNotShowLogOrToast() throws Exception {
         removeInterstitialModule();
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MraidVideoPlayerActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubBrowser.class), mockResolveInfo);
+        addActivityToShadowPackageManager(context, MraidVideoPlayerActivity.class.getName());
+        addActivityToShadowPackageManager(context, MoPubBrowser.class.getName());
 
         ShadowLog.setupLogging();
         setDebugMode(true);
@@ -152,10 +147,10 @@ public void displayWarningForMissingActivities_withoutInterstitialModule_without
 
     @Test
      public void displayWarningForMissingActivities_withOneMissingActivity_shouldLogOnlyThatOne() throws Exception {
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MraidActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, RewardedMraidActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MraidVideoPlayerActivity.class), mockResolveInfo);
+        addActivityToShadowPackageManager(context, MoPubActivity.class.getName());
+        addActivityToShadowPackageManager(context, MraidActivity.class.getName());
+        addActivityToShadowPackageManager(context, RewardedMraidActivity.class.getName());
+        addActivityToShadowPackageManager(context, MraidVideoPlayerActivity.class.getName());
         // Here, we leave out MoPubBrowser on purpose
 
         ShadowLog.setupLogging();
@@ -218,11 +213,11 @@ public void displayWarningForMisconfiguredActivities_withAllActivitiesConfigured
         when(mockActivitiyConfigCheck.hasFlag(any(Class.class), anyInt(), eq(ActivityInfo.CONFIG_SCREEN_SIZE))).thenReturn(true);
         ManifestUtils.setFlagCheckUtil(mockActivitiyConfigCheck);
 
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MraidActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, RewardedMraidActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MraidVideoPlayerActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubBrowser.class), mockResolveInfo);
+        addActivityToShadowPackageManager(context, MoPubActivity.class.getName());
+        addActivityToShadowPackageManager(context, MraidActivity.class.getName());
+        addActivityToShadowPackageManager(context, RewardedMraidActivity.class.getName());
+        addActivityToShadowPackageManager(context, MraidVideoPlayerActivity.class.getName());
+        addActivityToShadowPackageManager(context, MoPubBrowser.class.getName());
 
         ShadowLog.setupLogging();
         setDebugMode(true);
@@ -252,11 +247,11 @@ public Object answer(InvocationOnMock invocationOnMock) throws Throwable {
         when(mockActivitiyConfigCheck.hasFlag(any(Class.class), anyInt(), eq(ActivityInfo.CONFIG_SCREEN_SIZE))).thenReturn(true);
         ManifestUtils.setFlagCheckUtil(mockActivitiyConfigCheck);
 
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MraidActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, RewardedMraidActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MraidVideoPlayerActivity.class), mockResolveInfo);
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubBrowser.class), mockResolveInfo);
+        addActivityToShadowPackageManager(context, MoPubActivity.class.getName());
+        addActivityToShadowPackageManager(context, MraidActivity.class.getName());
+        addActivityToShadowPackageManager(context, RewardedMraidActivity.class.getName());
+        addActivityToShadowPackageManager(context, MraidVideoPlayerActivity.class.getName());
+        addActivityToShadowPackageManager(context, MoPubBrowser.class.getName());
 
         ShadowLog.setupLogging();
 
@@ -284,7 +279,7 @@ public void displayWarningForMisconfiguredActivities_withOneMisconfiguredActivit
         when(mockActivitiyConfigCheck.hasFlag(any(Class.class), anyInt(), eq(ActivityInfo.CONFIG_SCREEN_SIZE))).thenReturn(false);
         ManifestUtils.setFlagCheckUtil(mockActivitiyConfigCheck);
 
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubActivity.class), mockResolveInfo);
+        addActivityToShadowPackageManager(context, MoPubActivity.class.getName());
 
         ShadowLog.setupLogging();
 
@@ -304,7 +299,7 @@ public void displayWarningForMisconfiguredActivities_withMisconfiguredActivities
         when(mockActivitiyConfigCheck.hasFlag(any(Class.class), anyInt(), eq(ActivityInfo.CONFIG_SCREEN_SIZE))).thenReturn(false);
         ManifestUtils.setFlagCheckUtil(mockActivitiyConfigCheck);
 
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubActivity.class), mockResolveInfo);
+        addActivityToShadowPackageManager(context, MoPubActivity.class.getName());
 
         setDebugMode(true);
 
@@ -324,7 +319,7 @@ public void displayWarningForMisconfiguredActivities_withMisconfiguredActivities
         when(mockActivitiyConfigCheck.hasFlag(any(Class.class), anyInt(), eq(ActivityInfo.CONFIG_SCREEN_SIZE))).thenReturn(false);
         ManifestUtils.setFlagCheckUtil(mockActivitiyConfigCheck);
 
-        shadowOf(context.getPackageManager()).addResolveInfoForIntent(new Intent(context, MoPubActivity.class), mockResolveInfo);
+        addActivityToShadowPackageManager(context, MoPubActivity.class.getName());
 
         setDebugMode(false);
 
@@ -425,4 +420,12 @@ private void assertLogDoesntInclude(final String... messages) {
             assertThat(logText).doesNotContain(message);
         }
     }
+
+    private static void addActivityToShadowPackageManager(final Context context, final String activityName) {
+        final ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.targetActivity = activityName;
+        activityInfo.packageName = "com.mopub.mobileads.test";
+        activityInfo.name = activityName;
+        shadowOf(context.getPackageManager()).addOrUpdateActivity(activityInfo);
+    }
 }
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/AdAlertGestureListenerTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/AdAlertGestureListenerTest.java
index ab87604b..d4a86dbe 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/AdAlertGestureListenerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/AdAlertGestureListenerTest.java
@@ -23,6 +23,7 @@
 import static com.mopub.mobileads.AdAlertGestureListener.ZigZagState.GOING_RIGHT;
 import static com.mopub.mobileads.AdAlertGestureListener.ZigZagState.UNSET;
 import static org.fest.assertions.api.Assertions.assertThat;
+import static org.mockito.Mockito.mock;
 import static org.mockito.Mockito.when;
 
 @RunWith(SdkTestRunner.class)
@@ -317,6 +318,34 @@ public void reset_shouldResetStateAndZigZagCount() throws Exception {
         assertZigZagState(UNSET);
     }
 
+    @Test
+    public void isClicked_initialStateIsFalse(){
+        assertThat(subject.isClicked()).isFalse();
+    }
+
+    @Test
+    public void isClicked_afterMotionEvent_isTrue(){
+        MotionEvent touchEvent = mock(MotionEvent.class);
+
+        subject.onSingleTapUp(touchEvent);
+
+        assertThat(subject.isClicked()).isTrue();
+    }
+
+    @Test
+    public void isClicked_afterMotionEvent_afterReset_isFalse(){
+        MotionEvent touchEvent = mock(MotionEvent.class);
+
+        subject.onSingleTapUp(touchEvent);
+        assertThat(subject.isClicked()).isTrue();
+
+        subject.onResetUserClick();
+        assertThat(subject.isClicked()).isFalse();
+    }
+
+    /*
+        Utils
+     */
     private void simulateScroll(float endX) {
         simulateScroll(endX, savedY);
     }
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/AdAlertReporterTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/AdAlertReporterTest.java
index d51e532d..29b84463 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/AdAlertReporterTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/AdAlertReporterTest.java
@@ -103,15 +103,28 @@ public void constructor_shouldCreateIntentWithImageStringAndParametersAndRespons
         emailIntent = subject.getEmailIntent();
         String emailSubject = emailIntent.getStringExtra(Intent.EXTRA_TEXT);
         String bodyParts[] = emailSubject.split("\n=================\n");
-        String parameters = bodyParts[0];
-        String response = bodyParts[1];
-        String imageString = bodyParts[2];
+        String message = bodyParts[0];
+        String parameters = bodyParts[1];
+        String response = bodyParts[2];
+        String imageString = bodyParts[3];
 
-        assertThat(bodyParts.length).isEqualTo(3);
+        assertThat(bodyParts.length).isEqualTo(4);
         //this string is the JPEG encoded version
+        assertThat(message).isEqualTo(AdAlertReporter.MESSAGE);
         assertThat(parameters).isEqualTo(subject.getParameters());
         assertThat(response).isEqualTo(subject.getResponse());
-        assertThat(imageString).isEqualTo("Qml0bWFwICgxMCB4IDEwKSBjcmVhdGVkIGZyb20gQml0bWFwIG9iamVjdCBjb21wcmVzc2VkIGFz\nIEpQRUcgd2l0aCBxdWFsaXR5IDI1\n");
+        assertThat(imageString).isEqualTo("/9j/4AAQSkZJRgABAgAAAQABAAD/2wBDACAWGBwYFCAcGhwkIiAmMFA0MCwsMGJGSjpQdGZ6eHJm\n" +
+                "cG6AkLicgIiuim5woNqirr7EztDOfJri8uDI8LjKzsb/2wBDASIkJDAqMF40NF7GhHCExsbGxsbG\n" +
+                "xsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsb/wAARCAAKAAoDASIA\n" +
+                "AhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQA\n" +
+                "AAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3\n" +
+                "ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWm\n" +
+                "p6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEA\n" +
+                "AwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSEx\n" +
+                "BhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElK\n" +
+                "U1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3\n" +
+                "uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwDn6KKK\n" +
+                "AP/Z\n");
     }
 
     @Test
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/AdLoaderRewardedVideoTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/AdLoaderRewardedVideoTest.java
index 4e188d01..14284ca0 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/AdLoaderRewardedVideoTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/AdLoaderRewardedVideoTest.java
@@ -11,6 +11,8 @@
 import com.mopub.common.util.ResponseHeader;
 import com.mopub.network.AdLoader;
 import com.mopub.network.AdResponse;
+import com.mopub.network.ImpressionListener;
+import com.mopub.network.ImpressionsEmitter;
 import com.mopub.network.MoPubNetworkError;
 import com.mopub.network.MoPubRequestQueue;
 import com.mopub.network.MultiAdRequest;
@@ -36,6 +38,7 @@
 
 import static org.fest.assertions.api.Assertions.assertThat;
 import static org.mockito.Matchers.any;
+import static org.mockito.Mockito.mock;
 import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.when;
 
@@ -147,6 +150,29 @@ public void trackImpression_shouldMakeTrackingRequest() throws JSONException, Mo
         assertThat(request.getUrl()).isEqualTo("impression_tracking_url");
     }
 
+    @Test
+    public void trackImpression_shouldMakeImpressionDataCall() throws JSONException, MoPubNetworkError, NoSuchFieldException, IllegalAccessException {
+        JSONObject serverJson = createAdResponseJson();
+        byte[] body = serverJson.toString().getBytes();
+        NetworkResponse testResponse = new NetworkResponse(body);
+        MultiAdResponse multiAdResponse = new MultiAdResponse(activity, testResponse, AdFormat.BANNER, adUnitId);
+
+        // set subject MultiAdResponse
+        Field field = getPrivateField("mMultiAdResponse");
+        field.set(subject, multiAdResponse);
+
+        // validation for basic AdLoader
+        assertThat(subject.hasMoreAds()).isTrue();
+        subject.loadNextAd(null);
+
+        ImpressionListener listener = mock(ImpressionListener.class);
+        ImpressionsEmitter.addListener(listener);
+        // call tracking
+        subject.trackImpression(activity);
+
+        verify(listener).onImpression(adUnitId, null);
+    }
+
     @Test
     public void trackImpression_withImpressionTrackingUrlsList_shouldIgnoreSingleImpressionUrl_shouldFireListOfImpressionUrls() throws JSONException, MoPubNetworkError, NoSuchFieldException, IllegalAccessException {
         final JSONObject serverJson = createAdResponseJson();
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/AdViewControllerTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/AdViewControllerTest.java
index 7ba61c72..099a22ff 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/AdViewControllerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/AdViewControllerTest.java
@@ -29,6 +29,9 @@
 import com.mopub.mobileads.test.support.ThreadUtils;
 import com.mopub.network.AdLoader;
 import com.mopub.network.AdResponse;
+import com.mopub.network.ImpressionData;
+import com.mopub.network.ImpressionListener;
+import com.mopub.network.ImpressionsEmitter;
 import com.mopub.network.MoPubNetworkError;
 import com.mopub.network.MoPubRequestQueue;
 import com.mopub.network.MultiAdRequest;
@@ -79,9 +82,12 @@
     private static final int[] HTML_ERROR_CODES = new int[]{400, 401, 402, 403, 404, 405, 407, 408,
             409, 410, 411, 412, 413, 414, 415, 416, 417, 500, 501, 502, 503, 504, 505};
 
+    private static final String mAdUnitId = "ad_unit_id";
+
     private AdViewController subject;
     @Mock private MoPubView mockMoPubView;
     @Mock private MoPubRequestQueue mockRequestQueue;
+    @Mock private ImpressionData mockImpressionData;
     private Reflection.MethodBuilder methodBuilder;
     private MoPubShadowTelephonyManager shadowTelephonyManager;
     private MoPubShadowConnectivityManager shadowConnectivityManager;
@@ -116,9 +122,11 @@ public void setup() throws Exception {
         methodBuilder = TestMethodBuilderFactory.getSingletonMock();
         reset(methodBuilder);
         response = new AdResponse.Builder()
+                .setAdUnitId(mAdUnitId)
                 .setCustomEventClassName("customEvent")
                 .setClickTrackingUrl("clickUrl")
                 .setImpressionTrackingUrls(Arrays.asList("impressionUrl1", "impressionUrl2"))
+                .setImpressionData(mockImpressionData)
                 .setDimensions(320, 50)
                 .setAdType("html")
                 .setFailoverUrl("failUrl")
@@ -391,6 +399,20 @@ public void trackImpression_noAdResponse_shouldNotAddToQueue() {
         verifyZeroInteractions(mockRequestQueue);
     }
 
+    @Test
+    public void trackImpression_shouldCallImpressonDataListener() {
+        ImpressionListener impressionListener = mock(ImpressionListener.class);
+        ImpressionsEmitter.addListener(impressionListener);
+        subject.onAdLoadSuccess(response);
+        subject.setAdUnitId(mAdUnitId);
+
+        subject.trackImpression();
+
+        verify(impressionListener).onImpression(response.getAdUnitId(), response.getImpressionData());
+        verify(mockRequestQueue).add(argThat(isUrl("impressionUrl1")));
+        verify(mockRequestQueue).add(argThat(isUrl("impressionUrl2")));
+    }
+
     @Test
     public void registerClick_shouldHttpGetTheClickthroughUrl() {
         subject.onAdLoadSuccess(response);
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/BaseHtmlWebViewTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/BaseHtmlWebViewTest.java
index 286cd681..ccefa89c 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/BaseHtmlWebViewTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/BaseHtmlWebViewTest.java
@@ -114,31 +114,25 @@ public void sendTouchEvent_shouldSetUserClicked() {
         subject.initializeOnTouchListener();
         View.OnTouchListener onTouchListener = Shadows.shadowOf(subject).getOnTouchListener();
 
+        onTouchListener.onTouch(subject, touchDown);
         onTouchListener.onTouch(subject, touchUp);
         assertThat(subject.wasClicked()).isTrue();
     }
 
     @Test
-    public void sendTouchEvent_withLotsOfRandomMotionEvents_shouldEventuallySetUserClicked() {
+    public void sendTouchEvent_withTouchDownAndTouchUp_shouldEventuallySetUserClicked() {
         subject.initializeOnTouchListener();
         View.OnTouchListener onTouchListener = Shadows.shadowOf(subject).getOnTouchListener();
 
         onTouchListener.onTouch(subject, touchDown);
         assertThat(subject.wasClicked()).isFalse();
-        onTouchListener.onTouch(subject, createMotionEvent(MotionEvent.ACTION_CANCEL));
-        assertThat(subject.wasClicked()).isFalse();
+        onTouchListener.onTouch(subject, createMotionEvent(MotionEvent.ACTION_MOVE));
+        onTouchListener.onTouch(subject, createMotionEvent(MotionEvent.ACTION_MOVE));
         onTouchListener.onTouch(subject, createMotionEvent(MotionEvent.ACTION_MOVE));
         assertThat(subject.wasClicked()).isFalse();
 
         onTouchListener.onTouch(subject, touchUp);
         assertThat(subject.wasClicked()).isTrue();
-
-        onTouchListener.onTouch(subject, touchDown);
-        assertThat(subject.wasClicked()).isTrue();
-        onTouchListener.onTouch(subject, createMotionEvent(MotionEvent.ACTION_CANCEL));
-        assertThat(subject.wasClicked()).isTrue();
-        onTouchListener.onTouch(subject, createMotionEvent(MotionEvent.ACTION_MOVE));
-        assertThat(subject.wasClicked()).isTrue();
     }
 
     @Test
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/BaseInterstitialActivityTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/BaseInterstitialActivityTest.java
index d4ee1da8..c3941b1a 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/BaseInterstitialActivityTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/BaseInterstitialActivityTest.java
@@ -10,21 +10,28 @@
 import android.view.View;
 import android.widget.FrameLayout;
 
+import com.mopub.common.AdReport;
+import com.mopub.common.DataKeys;
 import com.mopub.common.test.support.SdkTestRunner;
 
 import org.junit.Before;
 import org.junit.Test;
 import org.junit.runner.RunWith;
+import org.mockito.Mock;
 import org.robolectric.Robolectric;
 
 import static com.mopub.common.DataKeys.BROADCAST_IDENTIFIER_KEY;
 import static org.fest.assertions.api.Assertions.assertThat;
+import static org.mockito.Mockito.when;
 
 @RunWith(SdkTestRunner.class)
 public class BaseInterstitialActivityTest {
     private BaseInterstitialActivity subject;
     private long broadcastIdentifier;
 
+    @Mock
+    AdReport mockAdReport;
+
     // Make a concrete version of the abstract class for testing purposes.
     private static class TestInterstitialActivity extends BaseInterstitialActivity {
         View view;
@@ -81,6 +88,49 @@ public void getBroadcastIdentifier_withMissingBroadCastId_shouldReturnNull() thr
         assertThat(subject.getBroadcastIdentifier()).isNull();
     }
 
+    @Test
+    public void getResponseString_withNullAdReport_shouldReturnNull() {
+        Intent intent = new Intent()
+                .putExtra(DataKeys.AD_REPORT_KEY, mockAdReport)
+                .putExtra(BROADCAST_IDENTIFIER_KEY, broadcastIdentifier);
+
+        subject = Robolectric.buildActivity(TestInterstitialActivity.class, intent)
+                .create().get();
+
+        assertThat(subject.getResponseString()).isNull();
+    }
+
+    @Test
+    public void getResponseString_withNonNullAdReport_shouldReturnResponseString() {
+        final String responseString = "this is a response string";
+        when(mockAdReport.getResponseString()).thenReturn(responseString);
+
+        Intent intent = new Intent()
+                .putExtra(DataKeys.AD_REPORT_KEY, mockAdReport)
+                .putExtra(BROADCAST_IDENTIFIER_KEY, broadcastIdentifier);
+
+        subject = Robolectric.buildActivity(TestInterstitialActivity.class, intent)
+                .create().get();
+
+        assertThat(subject.getResponseString()).isEqualTo(responseString);
+    }
+
+    @Test
+    public void staticGetResponseString_withNullAdReport_shouldReturnNull() {
+        AdReport nullAdReport = null;
+
+        assertThat(BaseInterstitialActivity.getResponseString(nullAdReport)).isNull();
+    }
+
+    @Test
+    public void staticGetResponseString_withNonNullAdReport_shouldReturnResponseString() {
+        final String responseString = "this is a response string";
+        when(mockAdReport.getResponseString()).thenReturn(responseString);
+
+        assertThat(BaseInterstitialActivity.getResponseString(mockAdReport))
+                .isEqualTo(responseString);
+    }
+
     protected FrameLayout getContentView(BaseInterstitialActivity subject) {
         return subject.getCloseableLayout();
     }
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/CustomEventBannerAdapterTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/CustomEventBannerAdapterTest.java
index 6e1cbc17..becf551b 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/CustomEventBannerAdapterTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/CustomEventBannerAdapterTest.java
@@ -298,7 +298,7 @@ public void onBannerLoaded_whenViewIsHtmlBannerWebView_withVisibilityImpressionT
         verify(moPubView).creativeDownloaded();
         verify(moPubView).setAdContentView(eq(mockHtmlBannerWebView));
         verify(moPubView, never()).trackNativeImpression();
-        verify(moPubView).pauseAutorefresh();
+        verify(moPubView).pauseAutoRefresh();
     }
 
     @Test
@@ -320,7 +320,7 @@ public void onBannerLoaded_whenViewIsNotHtmlBannerWebView_withVisibilityImpressi
         verify(moPubView).creativeDownloaded();
         verify(moPubView).setAdContentView(eq(view));
         verify(moPubView, never()).trackNativeImpression();
-        verify(moPubView).pauseAutorefresh();
+        verify(moPubView).pauseAutoRefresh();
     }
 
     @Test
@@ -341,7 +341,7 @@ public void onBannerFailed_whenErrorCodeIsNull_shouldPassUnspecifiedError() thro
     public void onBannerExpanded_shouldPauseRefreshAndCallAdPresentOverlay_shouldCallExpand() throws Exception {
         subject.onBannerExpanded();
 
-        verify(moPubView).expand();
+        verify(moPubView).engageOverlay();
         verify(moPubView).adPresentedOverlay();
     }
 
@@ -351,14 +351,14 @@ public void onBannerCollapsed_shouldRestoreRefreshSettingAndCallAdClosed_shouldC
         subject.onBannerExpanded();
         reset(moPubView);
         subject.onBannerCollapsed();
-        verify(moPubView).collapse();
+        verify(moPubView).dismissOverlay();
         verify(moPubView).adClosed();
 
         when(moPubView.getAutorefreshEnabled()).thenReturn(false);
         subject.onBannerExpanded();
         reset(moPubView);
         subject.onBannerCollapsed();
-        verify(moPubView).collapse();
+        verify(moPubView).dismissOverlay();
         verify(moPubView).adClosed();
     }
 
@@ -394,6 +394,20 @@ public void onLeaveApplication_shouldRegisterClick() throws Exception {
         verify(moPubView).registerClick();
     }
 
+    @Test
+    public void onPauseAutoRefresh_shouldEngageOverlay() {
+        subject.onPauseAutoRefresh();
+
+        verify(moPubView).engageOverlay();
+    }
+
+    @Test
+    public void onResumeAutoRefresh_shouldDismissOverlay() {
+        subject.onResumeAutoRefresh();
+
+        verify(moPubView).dismissOverlay();
+    }
+
     @Test
     public void invalidate_shouldCauseLoadAdToDoNothing() throws Exception {
         subject.invalidate();
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/HtmlInterstitialTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/HtmlInterstitialTest.java
index bc10082e..30bdab61 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/HtmlInterstitialTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/HtmlInterstitialTest.java
@@ -86,7 +86,6 @@ public void showInterstitial_withMinimumExtras_shouldStartMoPubActivityWithDefau
         subject.showInterstitial();
 
         Intent nextStartedActivity = ShadowApplication.getInstance().getNextStartedActivity();
-        assertThat(nextStartedActivity.getStringExtra(HTML_RESPONSE_BODY_KEY)).isEqualTo(expectedResponse);
         assertThat(nextStartedActivity.getStringExtra(CLICKTHROUGH_URL_KEY)).isNull();
         assertThat(nextStartedActivity.getFlags() & Intent.FLAG_ACTIVITY_NEW_TASK).isNotEqualTo(0);
         assertThat(nextStartedActivity.getComponent().getClassName()).isEqualTo("com.mopub.mobileads.MoPubActivity");
@@ -100,7 +99,6 @@ public void showInterstitial_shouldStartMoPubActivityWithAllExtras() throws Exce
         subject.showInterstitial();
 
         Intent nextStartedActivity = ShadowApplication.getInstance().getNextStartedActivity();
-        assertThat(nextStartedActivity.getStringExtra(HTML_RESPONSE_BODY_KEY)).isEqualTo(expectedResponse);
         assertThat(nextStartedActivity.getStringExtra(CLICKTHROUGH_URL_KEY)).isEqualTo("clickthroughUrl");
         assertThat(nextStartedActivity.getFlags() & Intent.FLAG_ACTIVITY_NEW_TASK).isNotEqualTo(0);
         assertThat(nextStartedActivity.getComponent().getClassName()).isEqualTo("com.mopub.mobileads.MoPubActivity");
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubActivityTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubActivityTest.java
index 725c8acd..f8122e9c 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubActivityTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubActivityTest.java
@@ -72,9 +72,10 @@ public void setUp() throws Exception {
         htmlInterstitialWebView = TestHtmlInterstitialWebViewFactory.getSingletonMock();
         resetMockedView(htmlInterstitialWebView);
 
+        when(mockAdReport.getResponseString()).thenReturn(EXPECTED_HTML_DATA);
+
         Context context = Robolectric.buildActivity(Activity.class).create().get();
-        Intent moPubActivityIntent = MoPubActivity.createIntent(context,
-                EXPECTED_HTML_DATA, mockAdReport,
+        Intent moPubActivityIntent = MoPubActivity.createIntent(context, mockAdReport,
                 EXPECTED_CLICKTHROUGH_URL, EXPECTED_ORIENTATION, testBroadcastIdentifier);
 
         final ActivityController<MoPubActivity> subjectController = Robolectric.buildActivity(
@@ -97,20 +98,19 @@ public void onCreate_shouldHaveLockedOrientation() {
 
     @Test
     public void preRenderHtml_shouldPreloadTheHtml() throws Exception {
-        String htmlData = "this is nonsense";
         MoPubActivity.preRenderHtml(htmlInterstitial, subject, mockAdReport,
-                customEventInterstitialListener, htmlData,
-                "clickthroughUrl", testBroadcastIdentifier);
+                customEventInterstitialListener, "clickthroughUrl",
+                testBroadcastIdentifier);
 
         verify(htmlInterstitialWebView).enablePlugins(eq(false));
-        verify(htmlInterstitialWebView).loadHtmlResponse(htmlData);
+        verify(htmlInterstitialWebView).loadHtmlResponse(mockAdReport.getResponseString());
     }
 
     @Test
     public void preRenderHtml_shouldEnableJavascriptCachingForDummyWebView() {
         MoPubActivity.preRenderHtml(htmlInterstitial, subject, mockAdReport,
-                customEventInterstitialListener, "html_data",
-                "clickthroughUrl", testBroadcastIdentifier);
+                customEventInterstitialListener,"clickthroughUrl",
+                testBroadcastIdentifier);
 
         verify(htmlInterstitialWebView).enableJavascriptCaching();
     }
@@ -118,8 +118,8 @@ public void preRenderHtml_shouldEnableJavascriptCachingForDummyWebView() {
     @Test
     public void preRenderHtml_shouldHaveAWebViewClientThatForwardsFinishLoad() throws Exception {
         MoPubActivity.preRenderHtml(htmlInterstitial, subject, mockAdReport,
-                customEventInterstitialListener, null,
-                "clickthroughUrl", testBroadcastIdentifier);
+                customEventInterstitialListener, "clickthroughUrl",
+                testBroadcastIdentifier);
 
         ArgumentCaptor<WebViewClient> webViewClientCaptor = ArgumentCaptor.forClass(WebViewClient.class);
         verify(htmlInterstitialWebView).setWebViewClient(webViewClientCaptor.capture());
@@ -134,8 +134,8 @@ public void preRenderHtml_shouldHaveAWebViewClientThatForwardsFinishLoad() throw
     @Test
     public void preRenderHtml_shouldHaveAWebViewClientThatForwardsFailLoad() throws Exception {
         MoPubActivity.preRenderHtml(htmlInterstitial, subject, mockAdReport,
-                customEventInterstitialListener, null,
-                "clickthroughUrl", testBroadcastIdentifier);
+                customEventInterstitialListener, "clickthroughUrl",
+                testBroadcastIdentifier);
 
         ArgumentCaptor<WebViewClient> webViewClientCaptor = ArgumentCaptor.forClass(WebViewClient.class);
         verify(htmlInterstitialWebView).setWebViewClient(webViewClientCaptor.capture());
@@ -187,10 +187,9 @@ public void onDestroy_shouldFireJavascriptWebviewDidClose() throws Exception {
     public void start_shouldStartMoPubActivityWithCorrectParameters() {
         final ActivityController<MoPubActivity> activityController = Robolectric.buildActivity(MoPubActivity.class);
         final MoPubActivity activitySubject = activityController.get();
-        MoPubActivity.start(activitySubject, "expectedResponse", mockAdReport, "clickthroughUrl", CreativeOrientation.PORTRAIT, testBroadcastIdentifier);
+        MoPubActivity.start(activitySubject, mockAdReport, "clickthroughUrl", CreativeOrientation.PORTRAIT, testBroadcastIdentifier);
 
         Intent nextStartedActivity = ShadowApplication.getInstance().getNextStartedActivity();
-        assertThat(nextStartedActivity.getStringExtra(HTML_RESPONSE_BODY_KEY)).isEqualTo("expectedResponse");
         assertThat(nextStartedActivity.getStringExtra(CLICKTHROUGH_URL_KEY)).isEqualTo("clickthroughUrl");
         assertThat(nextStartedActivity.getSerializableExtra(CREATIVE_ORIENTATION_KEY)).isEqualTo(CreativeOrientation.PORTRAIT);
         assertThat(nextStartedActivity.getFlags() & Intent.FLAG_ACTIVITY_NEW_TASK).isNotEqualTo(0);
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubConversionTrackerTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubConversionTrackerTest.java
index cb5b0fca..91d64143 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubConversionTrackerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubConversionTrackerTest.java
@@ -130,7 +130,7 @@ public void reportAppOpen_shouldTrackWhenConsentIsTrueAndWantToTrack() throws Ex
         mSharedPreferences
                 .edit()
                 .putBoolean(mWantToTrack, true)
-                .commit();
+                .apply();
 
         assertThat(subject.shouldTrack()).isTrue();
     }
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubRewardedVideoManagerTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubRewardedVideoManagerTest.java
index c013d0d1..f2c37fe7 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubRewardedVideoManagerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/MoPubRewardedVideoManagerTest.java
@@ -171,7 +171,7 @@ public void tearDown() throws Exception {
         ShadowLooper.unPauseMainLooper();
         MoPubRewardedVideoManager.getRewardedAdData().clear();
         MoPubRewardedVideoManager.getAdRequestStatusMapping().clearMapping();
-        mTestCustomEventSharedPrefs.edit().clear().commit();
+        mTestCustomEventSharedPrefs.edit().clear().apply();
         MoPubIdentifierTest.clearPreferences(mActivity);
         new Reflection.MethodBuilder(null, "clearAdvancedBidders")
                 .setStatic(MoPub.class)
@@ -698,7 +698,7 @@ public void onAdSuccess_withNewInitParams_shouldUpdateInitParamsInSharedPrefs()
         // Put in {"k1":"v1","k2":"v2"} as existing init params.
         mTestCustomEventSharedPrefs.edit().putString(
                 TestCustomEvent.class.getName(),
-                "{\"k1\":\"v1\",\"k2\":\"v2\"}").commit();
+                "{\"k1\":\"v1\",\"k2\":\"v2\"}").apply();
 
         // New init params are {"k3":"v3"}.
         JSONObject jsonResponse = createRewardedJsonResponse();
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/MraidActivityTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/MraidActivityTest.java
index fba7b11a..a2ff830a 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/MraidActivityTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/MraidActivityTest.java
@@ -113,7 +113,7 @@ public void preRenderHtml_shouldLoadHtml() {
     @Test
     public void preRenderHtml_shouldSetWebViewClient() throws Exception {
         MraidActivity.preRenderHtml(mraidInterstitial, subject, customEventInterstitialListener,
-                "3:27", testBroadcastIdentifier, adReport);
+                testBroadcastIdentifier, adReport);
 
         verify(mockMraidWebView).enablePlugins(eq(false));
         verify(mraidController).setMraidListener(any(MraidListener.class));
@@ -124,7 +124,7 @@ public void preRenderHtml_shouldSetWebViewClient() throws Exception {
     @Ignore("Mraid 2.0")
     @Test
     public void preRenderHtml_shouldCallCustomEventInterstitialOnInterstitialLoaded_whenMraidListenerOnReady() throws Exception {
-        MraidActivity.preRenderHtml(mraidInterstitial, subject, customEventInterstitialListener, "",
+        MraidActivity.preRenderHtml(mraidInterstitial, subject, customEventInterstitialListener,
                 testBroadcastIdentifier, adReport);
 
         ArgumentCaptor<MraidListener> mraidListenerArgumentCaptorr = ArgumentCaptor.forClass(MraidListener.class);
@@ -139,7 +139,7 @@ public void preRenderHtml_shouldCallCustomEventInterstitialOnInterstitialLoaded_
     @Ignore("Mraid 2.0")
     @Test
     public void preRenderHtml_shouldCallCustomEventInterstitialOnInterstitialFailed_whenMraidListenerOnFailure() throws Exception {
-        MraidActivity.preRenderHtml(mraidInterstitial, subject, customEventInterstitialListener, "",
+        MraidActivity.preRenderHtml(mraidInterstitial, subject, customEventInterstitialListener,
                 testBroadcastIdentifier, adReport);
 
         ArgumentCaptor<MraidListener> mraidListenerArgumentCaptorr = ArgumentCaptor.forClass(MraidListener.class);
@@ -154,7 +154,7 @@ public void preRenderHtml_shouldCallCustomEventInterstitialOnInterstitialFailed_
     @Ignore("Mraid 2.0")
     @Test
     public void preRenderHtml_whenWebViewClientShouldOverrideUrlLoading_shouldReturnTrue() throws Exception {
-        MraidActivity.preRenderHtml(mraidInterstitial, subject, customEventInterstitialListener, "",
+        MraidActivity.preRenderHtml(mraidInterstitial, subject, customEventInterstitialListener,
                 testBroadcastIdentifier, adReport);
 
         ArgumentCaptor<WebViewClient> webViewClientArgumentCaptor = ArgumentCaptor.forClass(WebViewClient.class);
@@ -172,7 +172,7 @@ public void preRenderHtml_whenWebViewClientShouldOverrideUrlLoading_shouldReturn
     @Ignore("Mraid 2.0")
     @Test
     public void preRenderHtml_shouldCallCustomEventInterstitialOnInterstitialLoaded_whenWebViewClientOnPageFinished() throws Exception {
-        MraidActivity.preRenderHtml(mraidInterstitial, subject, customEventInterstitialListener, "",
+        MraidActivity.preRenderHtml(mraidInterstitial, subject, customEventInterstitialListener,
                 testBroadcastIdentifier, adReport);
 
         ArgumentCaptor<WebViewClient> webViewClientArgumentCaptor = ArgumentCaptor.forClass(WebViewClient.class);
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/RewardedMraidActivityTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/RewardedMraidActivityTest.java
index 71c3a1ff..3b1a3743 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/RewardedMraidActivityTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/RewardedMraidActivityTest.java
@@ -21,6 +21,7 @@
 
 import static com.mopub.mraid.RewardedMraidController.MILLIS_IN_SECOND;
 import static org.fest.assertions.api.Assertions.assertThat;
+import static org.mockito.Mockito.when;
 
 @RunWith(SdkTestRunner.class)
 public class RewardedMraidActivityTest {
@@ -42,8 +43,9 @@ public void setup() {
         broadcastIdentifier = 3333;
         shouldRewardOnClick = false;
 
+        when(mockAdReport.getResponseString()).thenReturn(HTML_DATA);
         Context context = Robolectric.buildActivity(Activity.class).create().get();
-        Intent intent = RewardedMraidActivity.createIntent(context, mockAdReport, HTML_DATA,
+        Intent intent = RewardedMraidActivity.createIntent(context, mockAdReport,
                 broadcastIdentifier, REWARDED_DURATION_IN_SECONDS, shouldRewardOnClick);
         subject = Robolectric.buildActivity(RewardedMraidActivity.class, intent)
                 .create().get();
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/VastCompanionAdConfigXmlManagerTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/VastCompanionAdConfigXmlManagerTest.java
index 07cbffee..a8c3fd7e 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/VastCompanionAdConfigXmlManagerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/VastCompanionAdConfigXmlManagerTest.java
@@ -29,6 +29,9 @@ public void setup() throws Exception {
                 "        <Tracking event=\"creativeView\">https://tracking/creativeView1</Tracking>" +
                 "        <Tracking event=\"creativeView\">https://tracking/creativeView2</Tracking>" +
                 "        <Tracking event=\"creativeView\">https://tracking/creativeView3</Tracking>" +
+                "        <Tracking event=\"creativeView\"></Tracking>" + // missing Uri
+                "        <Tracking event=\"creativeView\"/>" + // self-terminating with missing Uri
+                "        <Tracking/>" + // self-terminating with missing Uri
                 "    </TrackingEvents>" +
                 "    <CompanionClickThrough>https://clickthrough</CompanionClickThrough>" +
                 "    <CompanionClickThrough>https://second_clickthrough</CompanionClickThrough>" +
@@ -38,6 +41,8 @@ public void setup() throws Exception {
                 "    <CompanionClickTracking>" +
                 "        <![CDATA[https://clicktrackingTwo]]>" +
                 "    </CompanionClickTracking>" +
+                "    <CompanionClickTracking></CompanionClickTracking>" + // empty tracker
+                "    <CompanionClickTracking/>" + // self-terminating empty tracker
                 "    <RandomUnusedTag>This_is_unused</RandomUnusedTag>" +
                 "</Companion>";
 
@@ -90,7 +95,7 @@ public void getClickThroughUrl_shouldReturnFirstStringUrl() {
     }
 
     @Test
-    public void getClickTrackers_shouldReturnAllUrls() {
+    public void getClickTrackers_shouldReturnAllUrls_shouldNotThrowException() {
         assertThat(VastUtils.vastTrackersToStrings(subject.getClickTrackers()))
                 .containsOnly("https://clicktrackingOne",
                         "https://clicktrackingTwo");
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/ViewGestureDetectorTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/ViewGestureDetectorTest.java
index 05b5dc7a..d144a305 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/ViewGestureDetectorTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/ViewGestureDetectorTest.java
@@ -19,7 +19,6 @@
 import org.robolectric.Shadows;
 import org.robolectric.shadows.ShadowGestureDetector;
 
-import static com.mopub.mobileads.ViewGestureDetector.UserClickListener;
 import static org.fest.assertions.api.Assertions.assertThat;
 import static org.mockito.Mockito.mock;
 import static org.mockito.Mockito.never;
@@ -59,36 +58,11 @@ public void constructor_shouldDisableLongPressAndSetGestureListener() throws Exc
         assertThat(shadowGestureDetector.getListener()).isInstanceOf(AdAlertGestureListener.class);
     }
 
-    @Test
-    public void onTouchEvent_whenActionUpAndClickListener_shouldNotifyClickListenerAndCheckReportAd() throws Exception {
-        MotionEvent expectedMotionEvent = createMotionEvent(MotionEvent.ACTION_UP);
-
-        UserClickListener userClickListener = mock(UserClickListener.class);
-        subject.setUserClickListener(userClickListener);
-
-        subject.sendTouchEvent(expectedMotionEvent);
-
-        verify(userClickListener).onUserClick();
-        verify(adAlertGestureListener).finishGestureDetection();
-    }
-
-    @Test
-    public void onTouchEvent_whenActionUpButNoClickListener_shouldNotNotifyClickListenerAndCheckReportAd() throws Exception {
-        MotionEvent expectedMotionEvent = createMotionEvent(MotionEvent.ACTION_UP);
-
-        UserClickListener userClickListener = mock(UserClickListener.class);
-
-        subject.sendTouchEvent(expectedMotionEvent);
-
-        verify(userClickListener, never()).onUserClick();
-        verify(adAlertGestureListener).finishGestureDetection();
-    }
-
     @Test
     public void onTouchEvent_whenActionDown_shouldForwardOnTouchEvent() throws Exception {
         MotionEvent expectedMotionEvent = createMotionEvent(MotionEvent.ACTION_DOWN);
 
-        subject.sendTouchEvent(expectedMotionEvent);
+        subject.onTouchEvent(expectedMotionEvent);
 
         MotionEvent actualMotionEvent = Shadows.shadowOf(subject).getOnTouchEventMotionEvent();
 
@@ -98,10 +72,10 @@ public void onTouchEvent_whenActionDown_shouldForwardOnTouchEvent() throws Excep
     @Test
     public void onTouchEvent_whenActionMoveWithinView_shouldForwardOnTouchEvent() throws Exception {
         MotionEvent downEvent = createMotionEvent(MotionEvent.ACTION_DOWN);
-        subject.sendTouchEvent(downEvent);
+        subject.onTouchEvent(downEvent);
 
         MotionEvent expectedMotionEvent = createActionMove(160);
-        subject.sendTouchEvent(expectedMotionEvent);
+        subject.onTouchEvent(expectedMotionEvent);
 
         MotionEvent actualMotionEvent = Shadows.shadowOf(subject).getOnTouchEventMotionEvent();
 
@@ -109,27 +83,6 @@ public void onTouchEvent_whenActionMoveWithinView_shouldForwardOnTouchEvent() th
         verify(adAlertGestureListener, never()).reset();
     }
 
-    @Test
-    public void sendTouchEvent_whenReceiveTouchEventOutsideOfViewInXDirection_shouldResetAlertState() throws Exception {
-        subject.sendTouchEvent(createActionMove(350));
-
-        MotionEvent actualMotionEvent = Shadows.shadowOf(subject).getOnTouchEventMotionEvent();
-
-        assertThat(actualMotionEvent).isNull();
-        verify(adAlertGestureListener).reset();
-    }
-
-    @Test
-    public void sendTouchEvent_whenReceiveTouchEventOutsideOfViewInYDirection_shouldResetAlertState() throws Exception {
-        MotionEvent verticalMotion = MotionEvent.obtain(0, 0, MotionEvent.ACTION_MOVE, 160, 200, 0);
-        subject.sendTouchEvent(verticalMotion);
-
-        MotionEvent actualMotionEvent = Shadows.shadowOf(subject).getOnTouchEventMotionEvent();
-
-        assertThat(actualMotionEvent).isNull();
-        verify(adAlertGestureListener).reset();
-    }
-
     @Test
     public void resetAdFlaggingGesture_shouldNotifyAdAlertGestureListenerOfReset() throws Exception {
         subject.resetAdFlaggingGesture();
diff --git a/mopub-sdk/src/test/java/com/mopub/mobileads/WebViewAdUrlGeneratorTest.java b/mopub-sdk/src/test/java/com/mopub/mobileads/WebViewAdUrlGeneratorTest.java
index c728cc8e..31ab3568 100644
--- a/mopub-sdk/src/test/java/com/mopub/mobileads/WebViewAdUrlGeneratorTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mobileads/WebViewAdUrlGeneratorTest.java
@@ -48,6 +48,7 @@
 import com.mopub.mobileads.test.support.MoPubShadowTelephonyManager;
 import com.mopub.mraid.MraidNativeCommandHandler;
 import com.mopub.network.PlayServicesUrlRewriter;
+import com.mopub.network.RequestRateTrackerTest;
 
 import org.junit.After;
 import org.junit.Before;
@@ -183,6 +184,7 @@ public Object answer(final InvocationOnMock invocationOnMock) throws Throwable {
     public void tearDown() throws Exception {
         reset(methodBuilder);
         ClientMetadata.clearForTesting();
+        RequestRateTrackerTest.clearRequestRateTracker();
         MoPubIdentifierTest.clearPreferences(context);
         new Reflection.MethodBuilder(null, "clearAdvancedBidders")
                 .setStatic(MoPub.class)
@@ -233,6 +235,7 @@ public void generateAdUrl_shouldIncludeAllFields() throws Exception {
         when(mockPersonalInfoManager.canCollectPersonalInformation()).thenReturn(true);
 
         ClientMetadata.clearForTesting();
+        RequestRateTrackerTest.prepareRequestRateTracker("adUnitId", 99, "some_reason");
 
         final String expectedAdUrl = new AdUrlBuilder(expectedUdid)
                 .withAdUnitId("adUnitId")
@@ -246,6 +249,8 @@ public void generateAdUrl_shouldIncludeAllFields() throws Exception {
                 .withExternalStoragePermission(false)
                 .withAbt("{\"UrlGeneratorTest\":{\"token\":\"WebViewAdvancedBidderToken\"}}")
                 .withCurrentConsentStatus(ConsentStatus.UNKNOWN.getValue())
+                .withBackoffMs(99)
+                .withBackoffReason("some_reason")
                 .build();
 
         shadowTelephonyManager.setNetworkOperator("123456");
@@ -1042,6 +1047,8 @@ private String generateMinimumUrlString() {
         private String forceGdprApplies = "0";
         private String consentedPrivacyPolicyVersion = "";
         private String consentedVendorListVersion = "";
+        private String backoffMs = "";
+        private String backoffReason = "";
 
         public AdUrlBuilder(String expectedUdid) {
             this.expectedUdid = expectedUdid;
@@ -1079,6 +1086,8 @@ public String build() {
                     paramIfNotEmpty("current_consent_status", currentConsentStatus) +
                     paramIfNotEmpty("consented_privacy_policy_version", consentedPrivacyPolicyVersion) +
                     paramIfNotEmpty("consented_vendor_list_version", consentedVendorListVersion) +
+                    paramIfNotEmpty("backoff_ms", backoffMs) +
+                    paramIfNotEmpty("backoff_reason", backoffReason) +
                     "&mr=1" +
                     "&android_perms_ext_storage=" + externalStoragePermission +
                     "&vv=3";
@@ -1168,6 +1177,18 @@ public AdUrlBuilder withConsentedVendorListVersion(String consentedVendorListVer
             return this;
         }
 
+        AdUrlBuilder withBackoffMs(@Nullable final Integer backoffMs) {
+            if (backoffMs != null) {
+                this.backoffMs = String.valueOf(backoffMs);
+            }
+            return this;
+        }
+
+        AdUrlBuilder withBackoffReason(@Nullable final String backoffReason) {
+            this.backoffReason = backoffReason;
+            return this;
+        }
+
         private String paramIfNotEmpty(String key, String value) {
             if (TextUtils.isEmpty(value)) {
                 return "";
diff --git a/mopub-sdk/src/test/java/com/mopub/mraid/MraidBannerTest.java b/mopub-sdk/src/test/java/com/mopub/mraid/MraidBannerTest.java
index 5bdacf27..699bf188 100644
--- a/mopub-sdk/src/test/java/com/mopub/mraid/MraidBannerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mraid/MraidBannerTest.java
@@ -10,6 +10,9 @@
 
 import com.mopub.common.DataKeys;
 import com.mopub.common.test.support.SdkTestRunner;
+import com.mopub.mobileads.CustomEventBanner;
+import com.mopub.mobileads.InternalCustomEventBannerListener;
+import com.mopub.mobileads.MoPubErrorCode;
 import com.mopub.mobileads.test.support.TestMraidControllerFactory;
 import com.mopub.mraid.MraidController.MraidListener;
 
@@ -23,11 +26,12 @@
 import java.util.Map;
 
 import static com.mopub.common.DataKeys.HTML_RESPONSE_BODY_KEY;
-import static com.mopub.mobileads.CustomEventBanner.CustomEventBannerListener;
 import static com.mopub.mobileads.MoPubErrorCode.MRAID_LOAD_ERROR;
 import static org.fest.assertions.api.Assertions.assertThat;
 import static org.mockito.Matchers.any;
 import static org.mockito.Matchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
 import static org.mockito.Mockito.verify;
 
 @RunWith(SdkTestRunner.class)
@@ -35,7 +39,7 @@
     private static final String INPUT_HTML_DATA = "%3Chtml%3E%3C%2Fhtml%3E";
 
     MraidController mockMraidController;
-    @Mock CustomEventBannerListener mockBannerListener;
+    @Mock InternalCustomEventBannerListener mockBannerListener;
 
     private Context context;
     private Map<String, Object> localExtras;
@@ -135,6 +139,33 @@ public void bannerMraidListener_onClose_shouldNotifyBannerCollapsed() {
         verify(mockBannerListener).onBannerCollapsed();
     }
 
+    @Test
+    public void bannerMraidListener_onResizeToOriginalSizeTrue_shouldNotifyResumeAutoRefresh() {
+        MraidListener mraidListener = captureMraidListener();
+        mraidListener.onResize(true);
+
+        verify(mockBannerListener).onResumeAutoRefresh();
+    }
+
+    @Test
+    public void bannerMraidListener_onResizeToOriginalSizeFalse_shouldNotifyPauseAutoRefresh() {
+        MraidListener mraidListener = captureMraidListener();
+        mraidListener.onResize(false);
+
+        verify(mockBannerListener).onPauseAutoRefresh();
+    }
+
+    @Test
+    public void bannerMraidListener_notInstanceOfInternalListener_shouldNotifyBannerFailed() {
+        CustomEventBanner.CustomEventBannerListener mockPublicListener = mock(
+                CustomEventBanner.CustomEventBannerListener.class);
+        subject.loadBanner(context, mockPublicListener, localExtras, serverExtras);
+        ArgumentCaptor<MraidListener> listenerCaptor = ArgumentCaptor.forClass(MraidListener.class);
+        verify(mockMraidController, never()).setMraidListener(listenerCaptor.capture());
+
+        verify(mockPublicListener).onBannerFailed(MoPubErrorCode.MRAID_LOAD_ERROR);
+    }
+
     @Test
     public void trackMpxAndThirdPartyImpressions_shouldFireJavascriptWebViewDidAppear() {
         MraidListener mraidListener = captureMraidListener();
diff --git a/mopub-sdk/src/test/java/com/mopub/mraid/MraidControllerTest.java b/mopub-sdk/src/test/java/com/mopub/mraid/MraidControllerTest.java
index e33be002..a044eaeb 100644
--- a/mopub-sdk/src/test/java/com/mopub/mraid/MraidControllerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mraid/MraidControllerTest.java
@@ -57,6 +57,7 @@
 import static org.mockito.Mockito.spy;
 import static org.mockito.Mockito.times;
 import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.verifyZeroInteractions;
 import static org.mockito.Mockito.when;
 import static org.robolectric.Shadows.shadowOf;
 
@@ -1032,13 +1033,22 @@ public void unapplyOrientation_withoutLockedOrientation_shouldNotChangeRequested
     }
 
     @Test
-    public void destroy_shouldCancelLastMetricsRequest_shouldUnregisterBroadcastReceiver_shouldDetachAllBridges() {
+    public void destroy_shouldCancelLastMetricsRequest_shouldUnregisterBroadcastReceiver_shouldDetachAllBridges_shouldUnapplyOrientation() throws Exception {
+        setMockActivityInfo(true, ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED,
+                ActivityInfo.CONFIG_ORIENTATION | ActivityInfo.CONFIG_SCREEN_SIZE);
+        subject.handleSetOrientationProperties(false, MraidOrientation.LANDSCAPE);
+        subject.applyOrientation();
+        assertThat(activity.getRequestedOrientation())
+                .isEqualTo(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
+
         subject.destroy();
 
         verify(mockScreenMetricsWaiter).cancelLastRequest();
         verify(mockOrientationBroadcastReceiver).unregister();
         verify(mockBridge).detach();
         verify(mockTwoPartBridge).detach();
+        assertThat(activity.getRequestedOrientation())
+                .isEqualTo(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
     }
 
     @Test
@@ -1107,6 +1117,195 @@ public void destroy_fromResizedState_shouldRemoveCloseableAdContainerFromContent
         assertThat(rootView.getChildCount()).isEqualTo(0);
     }
 
+    @Test
+    public void callMraidListenerCallbacks_withVariousStates_shouldCallCorrectMraidListenerCallback() {
+        // Previous state LOADING
+
+        ViewState previousViewState = ViewState.LOADING;
+        ViewState currentViewState = ViewState.LOADING;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verifyZeroInteractions(mockMraidListener);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.LOADING;
+        currentViewState = ViewState.DEFAULT;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verifyZeroInteractions(mockMraidListener);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.LOADING;
+        currentViewState = ViewState.RESIZED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onResize(false);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.LOADING;
+        currentViewState = ViewState.EXPANDED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onExpand();
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.LOADING;
+        currentViewState = ViewState.HIDDEN;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onClose();
+
+
+        // Previous state DEFAULT
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.DEFAULT;
+        currentViewState = ViewState.LOADING;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verifyZeroInteractions(mockMraidListener);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.DEFAULT;
+        currentViewState = ViewState.DEFAULT;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verifyZeroInteractions(mockMraidListener);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.DEFAULT;
+        currentViewState = ViewState.RESIZED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onResize(false);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.DEFAULT;
+        currentViewState = ViewState.EXPANDED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onExpand();
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.DEFAULT;
+        currentViewState = ViewState.HIDDEN;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onClose();
+
+
+        // Previous state RESIZED
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.RESIZED;
+        currentViewState = ViewState.LOADING;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verifyZeroInteractions(mockMraidListener);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.RESIZED;
+        currentViewState = ViewState.DEFAULT;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onResize(true);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.RESIZED;
+        currentViewState = ViewState.RESIZED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onResize(false);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.RESIZED;
+        currentViewState = ViewState.EXPANDED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onExpand();
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.RESIZED;
+        currentViewState = ViewState.HIDDEN;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onClose();
+
+
+        // Previous state EXPANDED
+
+        previousViewState = ViewState.EXPANDED;
+        currentViewState = ViewState.LOADING;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verifyZeroInteractions(mockMraidListener);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.EXPANDED;
+        currentViewState = ViewState.DEFAULT;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onClose();
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.EXPANDED;
+        currentViewState = ViewState.RESIZED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onResize(false);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.EXPANDED;
+        currentViewState = ViewState.EXPANDED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onExpand();
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.EXPANDED;
+        currentViewState = ViewState.HIDDEN;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onClose();
+
+
+        // Previous state HIDDEN
+
+        previousViewState = ViewState.HIDDEN;
+        currentViewState = ViewState.LOADING;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verifyZeroInteractions(mockMraidListener);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.HIDDEN;
+        currentViewState = ViewState.DEFAULT;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verifyZeroInteractions(mockMraidListener);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.HIDDEN;
+        currentViewState = ViewState.RESIZED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onResize(false);
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.HIDDEN;
+        currentViewState = ViewState.EXPANDED;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onExpand();
+
+        reset(mockMraidListener);
+        previousViewState = ViewState.HIDDEN;
+        currentViewState = ViewState.HIDDEN;
+        MraidController.callMraidListenerCallbacks(mockMraidListener, previousViewState,
+                currentViewState);
+        verify(mockMraidListener).onClose();
+    }
+
     private void setMockActivityInfo(final boolean activityInfoFound, int screenOrientation,
             int configChanges) throws PackageManager.NameNotFoundException {
         final ActivityInfo mockActivityInfo = mock(ActivityInfo.class);
diff --git a/mopub-sdk/src/test/java/com/mopub/mraid/MraidInterstitialTest.java b/mopub-sdk/src/test/java/com/mopub/mraid/MraidInterstitialTest.java
index f4a12f04..9d1c0718 100644
--- a/mopub-sdk/src/test/java/com/mopub/mraid/MraidInterstitialTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mraid/MraidInterstitialTest.java
@@ -113,7 +113,6 @@ public void showInterstitial_shouldStartActivityWithIntent() throws Exception {
 
         assertThat(intent.getComponent().getClassName())
                 .isEqualTo("com.mopub.mobileads.MraidActivity");
-        assertThat(intent.getExtras().get(HTML_RESPONSE_BODY_KEY)).isEqualTo(EXPECTED_HTML_DATA);
         assertThat(intent.getFlags() & Intent.FLAG_ACTIVITY_NEW_TASK).isNotEqualTo(0);
     }
 
diff --git a/mopub-sdk/src/test/java/com/mopub/mraid/MraidNativeCommandHandlerTest.java b/mopub-sdk/src/test/java/com/mopub/mraid/MraidNativeCommandHandlerTest.java
index b0cf29fb..85f35868 100644
--- a/mopub-sdk/src/test/java/com/mopub/mraid/MraidNativeCommandHandlerTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mraid/MraidNativeCommandHandlerTest.java
@@ -76,6 +76,7 @@
 public class MraidNativeCommandHandlerTest {
     private static final String IMAGE_URI_VALUE = "file://tmp/expectedFile.jpg";
     private static final String REMOTE_IMAGE_URL = "https://www.mopub.com/expectedFile.jpg";
+    private static final String FILE_PATH = "/tmp/expectedFile.jpg";
     private static final int TIME_TO_PAUSE_FOR_NETWORK = 300;
     private static final String FAKE_IMAGE_DATA = "imageFileData";
     //XXX: Robolectric or JUNIT doesn't support the correct suffix ZZZZZ in the parse pattern, so replacing xx:xx with xxxx for time.
@@ -98,7 +99,7 @@ public void setUp() throws Exception {
 
         ByteArrayOutputStream baos = new ByteArrayOutputStream();
         TestDrawables.EXPECTED_FILE.getBitmap().compress(Bitmap.CompressFormat.JPEG, 100, baos);
-        FileUtils.writeBytesToFile(baos.toByteArray(), "/tmp/expectedFile.jpg");
+        FileUtils.writeBytesToFile(baos.toByteArray(), FILE_PATH);
 
         expectedFile = new File(Environment.getExternalStorageDirectory(), "Pictures" + separator + "expectedFile.jpg");
         pictureDirectory = new File(Environment.getExternalStorageDirectory(), "Pictures");
@@ -112,6 +113,7 @@ public void setUp() throws Exception {
     @After
     public void tearDown() {
         ShadowToast.reset();
+        assertThat(new File(FILE_PATH).delete()).isTrue();
     }
 
     @Test
diff --git a/mopub-sdk/src/test/java/com/mopub/mraid/RewardedMraidInterstitialTest.java b/mopub-sdk/src/test/java/com/mopub/mraid/RewardedMraidInterstitialTest.java
index d3f11cd8..0c00f6ef 100644
--- a/mopub-sdk/src/test/java/com/mopub/mraid/RewardedMraidInterstitialTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/mraid/RewardedMraidInterstitialTest.java
@@ -22,6 +22,7 @@
 import java.util.HashMap;
 import java.util.Map;
 
+import static com.mopub.common.DataKeys.AD_REPORT_KEY;
 import static com.mopub.common.DataKeys.BROADCAST_IDENTIFIER_KEY;
 import static com.mopub.common.DataKeys.HTML_RESPONSE_BODY_KEY;
 import static com.mopub.common.DataKeys.REWARDED_AD_DURATION_KEY;
@@ -128,11 +129,12 @@ public void showInterstitial_shouldStartActivityWithIntent() throws Exception {
 
         assertThat(intent.getComponent().getClassName())
                 .isEqualTo("com.mopub.mobileads.RewardedMraidActivity");
-        assertThat(intent.getExtras().get(HTML_RESPONSE_BODY_KEY)).isEqualTo(EXPECTED_HTML_DATA);
         assertThat(intent.getExtras().get(REWARDED_AD_DURATION_KEY)).isEqualTo(
                 EXPECTED_REWARDED_DURATION_SECONDS);
         assertThat(intent.getExtras().get(SHOULD_REWARD_ON_CLICK_KEY)).isEqualTo(
                 EXPECTED_SHOULD_REWARD_ON_CLICK);
+        assertThat(intent.getExtras().get(AD_REPORT_KEY)).isEqualTo(
+                localExtras.get(AD_REPORT_KEY));
     }
 
     @Test
diff --git a/mopub-sdk/src/test/java/com/mopub/nativeads/HttpDiskCompositeDataSourceTest.java b/mopub-sdk/src/test/java/com/mopub/nativeads/HttpDiskCompositeDataSourceTest.java
deleted file mode 100644
index 44b6cd63..00000000
--- a/mopub-sdk/src/test/java/com/mopub/nativeads/HttpDiskCompositeDataSourceTest.java
+++ /dev/null
@@ -1,494 +0,0 @@
-// Copyright 2018-2019 Twitter, Inc.
-// Licensed under the MoPub SDK License Agreement
-// http://www.mopub.com/legal/sdk-license-agreement/
-
-package com.mopub.nativeads;
-
-import android.app.Activity;
-import android.content.Context;
-import android.net.Uri;
-
-import com.google.android.exoplayer2.upstream.DataSpec;
-import com.google.android.exoplayer2.upstream.HttpDataSource;
-import com.mopub.common.CacheService;
-import com.mopub.common.test.support.SdkTestRunner;
-
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mockito.Mock;
-import org.mockito.invocation.InvocationOnMock;
-import org.mockito.stubbing.Answer;
-import org.robolectric.Robolectric;
-
-import java.util.Arrays;
-import java.util.Random;
-import java.util.TreeSet;
-
-import static org.fest.assertions.api.Assertions.assertThat;
-import static org.mockito.Matchers.any;
-import static org.mockito.Matchers.anyInt;
-import static org.mockito.Matchers.eq;
-import static org.mockito.Matchers.refEq;
-import static org.mockito.Mockito.verify;
-import static org.mockito.Mockito.verifyNoMoreInteractions;
-import static org.mockito.Mockito.verifyZeroInteractions;
-import static org.mockito.Mockito.when;
-
-@RunWith(SdkTestRunner.class)
-public class HttpDiskCompositeDataSourceTest {
-
-    private static final int BASE_SEED = 1234567890;
-    @Mock HttpDataSource mockHttpDataSource;
-    private HttpDiskCompositeDataSource subject;
-    private DataSpec dataSpec;
-    private Uri uri;
-
-
-    @Before
-    public void setUp() throws Exception {
-        Context context = Robolectric.buildActivity(Activity.class).create().get();
-        CacheService.initialize(context);
-        subject = new HttpDiskCompositeDataSource(context, "userAgent", mockHttpDataSource);
-        uri = new Uri.Builder().scheme("https").path("www.someurl").build();
-        dataSpec = new DataSpec(uri, 0, -1, null);
-    }
-
-    @After
-    public void tearDown() throws Exception {
-        CacheService.clearAndNullCaches();
-    }
-
-    @Test
-    public void open_withNullDataSpecUri_shouldReturnLengthUnbounded() throws Exception {
-        DataSpec dataSpecWithNullUri = new DataSpec(null);
-
-        final long result = subject.open(dataSpecWithNullUri);
-
-        assertThat(result).isEqualTo(HttpDiskCompositeDataSource.LENGTH_UNBOUNDED);
-        verifyZeroInteractions(mockHttpDataSource);
-    }
-
-    @Test
-    public void open_withNoCachedData_shouldOpenHttpDataSource() throws Exception {
-        when(mockHttpDataSource.open(any(DataSpec.class))).thenReturn(200000L);
-
-        long result = subject.open(dataSpec);
-
-        assertThat(result).isEqualTo(200000L);
-        verify(mockHttpDataSource).open(refEq(dataSpec));
-        verifyNoMoreInteractions(mockHttpDataSource);
-    }
-
-    @Test
-    public void open_withAllDataCached_shouldNotOpenHttpDataSource() throws Exception {
-        // When the entire file is cached, there's no need to open the network.
-        when(mockHttpDataSource.open(any(DataSpec.class))).thenReturn(100000L);
-        byte[] data = generateRandomByteArray(100000, 0);
-        byte[] expectedFileSize = "100000".getBytes();
-        byte[] intervals = "[\"{start : 0, length : 100000}\"]".getBytes();
-        CacheService.putToDiskCache("0" + uri.toString(), data);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.EXPECTED_FILE_SIZE_KEY_PREFIX + uri.toString(),
-                expectedFileSize);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.INTERVALS_KEY_PREFIX + uri.toString(), intervals);
-
-        long result = subject.open(dataSpec);
-
-        assertThat(result).isEqualTo(100000);
-        verifyZeroInteractions(mockHttpDataSource);
-    }
-
-    @Test
-    public void open_withSomeDataCached_shouldOpenHttpDataSourceAtAppropriateStartPoint() throws Exception {
-        // The idea behind this test is that we think we have the first 33333 bytes and need to ask
-        // the network for byte 33333 and onward.
-        when(mockHttpDataSource.open(any(DataSpec.class))).thenReturn(100000L);
-        byte[] data = generateRandomByteArray(100000, 0);
-        byte[] expectedFileSize = "100000".getBytes();
-        byte[] intervals = "[\"{start : 0, length : 33333}\"]".getBytes();
-        CacheService.putToDiskCache("0" + uri.toString(), data);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.EXPECTED_FILE_SIZE_KEY_PREFIX + uri.toString(),
-                expectedFileSize);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.INTERVALS_KEY_PREFIX + uri.toString(), intervals);
-
-        long result = subject.open(dataSpec);
-
-        assertThat(result).isEqualTo(100000);
-        DataSpec expectedDataSpec = new DataSpec(dataSpec.uri, 33333, -1, null);
-        // Using refEq because equals() is just the Java default, and they're not the same object.
-        verify(mockHttpDataSource).open(refEq(expectedDataSpec));
-    }
-
-    @Test
-    public void read_with2048ExpectedBytes_shouldFillBufferWith2048Bytes_shouldReturnNumberOfBytesRead2048() throws Exception {
-        // This is the case where we're reading from a cache that has all the necessary bytes
-        byte[] data = generateRandomByteArray(100000, 0);
-        byte[] expectedFileSize = "100000".getBytes();
-        byte[] intervals = "[\"{start : 0, length : 100000}\"]".getBytes();
-        // Pretend we have all the bytes in the cache, complete with the expected file size and
-        // a valid intervals set.
-        CacheService.putToDiskCache("0" + uri.toString(), data);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.EXPECTED_FILE_SIZE_KEY_PREFIX + uri.toString(),
-                expectedFileSize);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.INTERVALS_KEY_PREFIX + uri.toString(), intervals);
-        byte[] readBuffer = new byte[2048];
-
-        subject.open(dataSpec);
-        int bytesRead = subject.read(readBuffer, 0, 2048);
-
-        // Verify that all 2048 bytes are expected and that the return value of read() is 2048
-        assertThat(bytesRead).isEqualTo(2048);
-        byte[] expectedData = new byte[2048];
-        System.arraycopy(data, 0, expectedData, 0, 2048);
-        assertThat(readBuffer).isEqualTo(expectedData);
-        verifyZeroInteractions(mockHttpDataSource);
-    }
-
-    @Test
-    public void read_withAllDataCached_whenReadingAcrossSegmentBoundaries_shouldReturnAllBytes() throws Exception {
-        // This is the case where we're reading from a cache that has all the necessary bytes, but
-        // some of it is in the next block. We need to finish reading from the current block, set
-        // up reading from the next block, and then do it.
-        byte[] data1 = generateRandomByteArray(HttpDiskCompositeDataSource.BLOCK_SIZE, 0);
-        byte[] data2 = generateRandomByteArray(HttpDiskCompositeDataSource.BLOCK_SIZE, 1);
-        String expectedFileLengthString = String.valueOf(
-                2 * HttpDiskCompositeDataSource.BLOCK_SIZE);
-        byte[] intervals = ("[\"{start : 0, length : " + expectedFileLengthString + "}\"]").getBytes();
-        CacheService.putToDiskCache("0" + uri.toString(), data1);
-        CacheService.putToDiskCache("1" + uri.toString(), data2);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.EXPECTED_FILE_SIZE_KEY_PREFIX + uri.toString(),
-                expectedFileLengthString.getBytes());
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.INTERVALS_KEY_PREFIX + uri.toString(), intervals);
-        // Expect to read the last 1337 bytes from the first block and the rest from the second block
-        DataSpec modifiedDataSpec = new DataSpec(dataSpec.uri,
-                HttpDiskCompositeDataSource.BLOCK_SIZE - 1337, -1, null);
-        byte[] readBuffer = new byte[4096];
-
-        subject.open(modifiedDataSpec);
-        int bytesRead = subject.read(readBuffer, 0, 4096);
-
-        assertThat(bytesRead).isEqualTo(4096);
-        byte[] expectedBytes = new byte[4096];
-        System.arraycopy(data1, HttpDiskCompositeDataSource.BLOCK_SIZE - 1337, expectedBytes, 0,
-                1337);
-        System.arraycopy(data2, 0, expectedBytes, 1337, 4096 - 1337);
-        assertThat(readBuffer).isEqualTo(expectedBytes);
-        verifyZeroInteractions(mockHttpDataSource);
-    }
-
-    @Test
-    public void read_withEmptyCache_shouldReadBytesFromNetwork() throws Exception {
-        // Sets up an empty cache and read directly from the network
-        final byte[] bytesFromNetwork = generateRandomByteArray(2048, 0);
-        when(mockHttpDataSource.open(any(DataSpec.class))).thenReturn(100000L);
-        setUpMockHttpDataSourceToReturnBytesFromNetwork(bytesFromNetwork, mockHttpDataSource);
-        byte[] readBuffer = new byte[2048];
-
-        subject.open(dataSpec);
-        int bytesRead = subject.read(readBuffer, 0, 2048);
-
-        assertThat(bytesRead).isEqualTo(2048);
-        assertThat(readBuffer).isEqualTo(bytesFromNetwork);
-        verify(mockHttpDataSource).open(refEq(dataSpec));
-        verify(mockHttpDataSource).read(any(byte[].class), eq(0), eq(2048));
-        verifyNoMoreInteractions(mockHttpDataSource);
-    }
-
-    @Test
-    public void read_withSomeDataInCache_shouldReadRestOfBytesFromNetwork() throws Exception {
-        // This is the case where there is some data in the cache, and we run out of cached data.
-        // The rest of the bytes are from the network.
-        final byte[] bytesFromNetwork = generateRandomByteArray(2048, 0);
-        when(mockHttpDataSource.open(any(DataSpec.class))).thenReturn(100000L);
-        setUpMockHttpDataSourceToReturnBytesFromNetwork(bytesFromNetwork, mockHttpDataSource);
-        byte[] data = generateRandomByteArray(2048, 1);
-        byte[] segment0 = new byte[HttpDiskCompositeDataSource.BLOCK_SIZE];
-        byte[] expectedFileSize = "100000".getBytes();
-        byte[] intervals = ("[\"{start : 0, length : 2048}\"]").getBytes();
-        // So we have the first 2048 bytes in the cache
-        System.arraycopy(data, 0, segment0, 0, 2048);
-        CacheService.putToDiskCache("0" + uri.toString(), segment0);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.EXPECTED_FILE_SIZE_KEY_PREFIX + uri.toString(),
-                expectedFileSize);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.INTERVALS_KEY_PREFIX + uri.toString(), intervals);
-        // However, we want to read 4096 bytes (We have to go to the network for the rest).
-        byte[] readBuffer = new byte[4096];
-
-        subject.open(dataSpec);
-        int bytesRead = subject.read(readBuffer, 0, 4096);
-
-        // Make sure that the bytes read have both the first 2048 bytes from the cache and the 2048
-        // bytes from the network.
-        assertThat(bytesRead).isEqualTo(4096);
-        byte[] expectedBytes = new byte[4096];
-        System.arraycopy(data, 0, expectedBytes, 0, 2048);
-        System.arraycopy(bytesFromNetwork, 0, expectedBytes, 2048, 2048);
-        assertThat(readBuffer).isEqualTo(expectedBytes);
-        DataSpec modifiedDataSpec = new DataSpec(dataSpec.uri, 2048, -1, null);
-        verify(mockHttpDataSource).open(refEq(modifiedDataSpec));
-        // Verify that we stored the bytes from network starting from index 2048 for 2048 bytes
-        verify(mockHttpDataSource).read(any(byte[].class), eq(2048), eq(2048));
-        verifyNoMoreInteractions(mockHttpDataSource);
-    }
-
-    @Test
-    public void read_withSomeDataInCacheBeforeBlockBoundary_whenApproachingBlockBoundary_shouldReadBytesFromDisk_shouldReadBytesFromNetwork_shouldSetUpNextBlock() throws Exception {
-        // This is the situation where the cache ends 1024 bytes before the second block boundary.
-        // We need to read the first 1024 bytes from the cache, read the next 3072 bytes, store
-        // the first 1024 bytes in the current block, close it out, flush it, set up the next block,
-        // and store the next 2048 bytes into that block.
-        final byte[] bytesFromNetwork = generateRandomByteArray(3072, 0);
-        when(mockHttpDataSource.open(any(DataSpec.class))).thenReturn(
-                (long) (HttpDiskCompositeDataSource.BLOCK_SIZE * 4));
-        setUpMockHttpDataSourceToReturnBytesFromNetwork(bytesFromNetwork, mockHttpDataSource);
-        byte[] data = generateRandomByteArray(HttpDiskCompositeDataSource.BLOCK_SIZE, 1);
-        byte[] expectedFileSize = String.valueOf(
-                HttpDiskCompositeDataSource.BLOCK_SIZE * 4).getBytes();
-        // Typical access patterns of video is to request for the first 44 bytes, the last 3886
-        // bytes, and then start at byte 44 and request till the end of the video. We are pretending
-        // that we did that, and stopped 1024 bytes before the end of the 2nd block.
-        byte[] intervals = ("[\"{start : 0, length : 44}\", \"{start : " +
-                (HttpDiskCompositeDataSource.BLOCK_SIZE * 4 - 3886) +
-                ", length : 3886}\", \"{start : 44, length : " +
-                (HttpDiskCompositeDataSource.BLOCK_SIZE * 2 - 1024 - 44) + "}\"]")
-                .getBytes();
-        CacheService.putToDiskCache("1" + uri.toString(), data);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.EXPECTED_FILE_SIZE_KEY_PREFIX + uri.toString(),
-                expectedFileSize);
-        CacheService.putToDiskCache(
-                HttpDiskCompositeDataSource.INTERVALS_KEY_PREFIX + uri.toString(), intervals);
-        byte[] readBuffer = new byte[4096];
-        dataSpec = new DataSpec(dataSpec.uri, 2 * HttpDiskCompositeDataSource.BLOCK_SIZE - 2048, -1,
-                dataSpec.key, dataSpec.flags);
-
-        subject.open(dataSpec);
-        int bytesRead = subject.read(readBuffer, 0, 4096);
-
-        assertThat(bytesRead).isEqualTo(4096);
-        byte[] expectedBytes = new byte[4096];
-        System.arraycopy(data, HttpDiskCompositeDataSource.BLOCK_SIZE - 2048, expectedBytes, 0,
-                1024);
-        System.arraycopy(bytesFromNetwork, 0, expectedBytes, 1024, 3072);
-        assertThat(readBuffer).isEqualTo(expectedBytes);
-        DataSpec modifiedDataSpec = new DataSpec(dataSpec.uri,
-                2 * HttpDiskCompositeDataSource.BLOCK_SIZE - 1024, -1, null);
-        verify(mockHttpDataSource).open(refEq(modifiedDataSpec));
-        verify(mockHttpDataSource).read(any(byte[].class), eq(1024), eq(3072));
-        // Also verify that the 2nd block was written to disk correctly.
-        byte[] expectedBlock = new byte[HttpDiskCompositeDataSource.BLOCK_SIZE];
-        System.arraycopy(data, 0, expectedBlock, 0, HttpDiskCompositeDataSource.BLOCK_SIZE - 1024);
-        System.arraycopy(bytesFromNetwork, 0, expectedBlock,
-                HttpDiskCompositeDataSource.BLOCK_SIZE - 1024, 1024);
-        assertThat(CacheService.getFromDiskCache("1" + uri.toString())).isEqualTo(
-                expectedBlock);
-    }
-
-    @Test
-    public void close_withoutFirstCallingOpen_shouldNotWriteToDisk() throws Exception {
-        subject.close();
-
-        assertThat(CacheService.containsKeyDiskCache("0" + uri.toString())).isFalse();
-        assertThat(CacheService.containsKeyDiskCache(
-                HttpDiskCompositeDataSource.EXPECTED_FILE_SIZE_KEY_PREFIX + uri.toString())).isFalse();
-        assertThat(CacheService.containsKeyDiskCache(
-                HttpDiskCompositeDataSource.INTERVALS_KEY_PREFIX + uri.toString())).isFalse();
-    }
-
-    @Test
-    public void close_withCurrentActiveBlock_shouldWriteToDisk() throws Exception {
-        // Verifying that close() actually writes the current data to disk
-        final byte[] bytesFromNetwork = generateRandomByteArray(1000, 0);
-        when(mockHttpDataSource.open(any(DataSpec.class))).thenReturn(5000L);
-        setUpMockHttpDataSourceToReturnBytesFromNetwork(bytesFromNetwork, mockHttpDataSource);
-        byte[] readBuffer = new byte[1000];
-
-        subject.open(dataSpec);
-        subject.read(readBuffer, 0, 1000);
-        subject.close();
-
-        assertThat(readBuffer).isEqualTo(bytesFromNetwork);
-        byte[] expectedBlock = new byte[HttpDiskCompositeDataSource.BLOCK_SIZE];
-        System.arraycopy(bytesFromNetwork, 0, expectedBlock, 0, 1000);
-        assertThat(CacheService.getFromDiskCache("0" + uri.toString())).isEqualTo(expectedBlock);
-        assertThat(CacheService.getFromDiskCache(
-                HttpDiskCompositeDataSource.EXPECTED_FILE_SIZE_KEY_PREFIX + uri.toString())).isEqualTo(
-                "5000".getBytes());
-        assertThat(CacheService.getFromDiskCache(
-                HttpDiskCompositeDataSource.INTERVALS_KEY_PREFIX + uri.toString())).isEqualTo(
-                "[\"{start : 0, length : 1000}\"]".getBytes());
-    }
-
-    @Test
-    public void addNewInterval_shouldAddNewIntervalToIntervals() {
-        IntInterval interval = new IntInterval(5, 42);
-        TreeSet<IntInterval> intervalList = new TreeSet<IntInterval>();
-
-        HttpDiskCompositeDataSource.addNewInterval(intervalList, 5, 42);
-
-        assertThat(intervalList).containsOnly(interval);
-    }
-
-    @Test
-    public void addNewInterval_withExistingInterval_shouldNotAddNewInterval() {
-        IntInterval interval1 = new IntInterval(5, 42);
-        IntInterval interval2 = new IntInterval(500, 200);
-        TreeSet<IntInterval> intervalList = new TreeSet<IntInterval>();
-        intervalList.add(interval1);
-        intervalList.add(interval2);
-
-        HttpDiskCompositeDataSource.addNewInterval(intervalList, 5, 42);
-
-        assertThat(intervalList).containsOnly(interval1, interval2);
-    }
-
-    @Test
-    public void addNewInterval_withExistingIntervalInParts_shouldNotAddNewInterval() {
-        // The union of these two intervals is 5 with a length of 45 (ie. from 5 to 50).
-        // An interval from 7 to 50 (start at 7, length 43) should not be added to the interval set.
-        IntInterval interval1 = new IntInterval(10, 40);
-        IntInterval interval2 = new IntInterval(5, 20);
-        TreeSet<IntInterval> intervalList = new TreeSet<IntInterval>();
-        intervalList.add(interval1);
-        intervalList.add(interval2);
-
-        HttpDiskCompositeDataSource.addNewInterval(intervalList, 7, 43);
-
-        assertThat(intervalList).containsOnly(interval1, interval2);
-    }
-
-    @Test
-    public void addNewInterval_withNonExistingIntervals_shouldAddNewInterval() {
-        // The existing intervals here are from 10 to 100 and 150 to 250. 7 to 50 is not part of
-        // that, even though the first interval already has part of that covered, 7 to 9 is not
-        // covered by anything, so this interval should be added.
-        IntInterval interval1 = new IntInterval(10, 90);
-        IntInterval interval2 = new IntInterval(150, 100);
-        TreeSet<IntInterval> intervalList = new TreeSet<IntInterval>();
-        intervalList.add(interval1);
-        intervalList.add(interval2);
-
-        HttpDiskCompositeDataSource.addNewInterval(intervalList, 7, 43);
-
-        assertThat(intervalList).containsExactly(new IntInterval(7, 43), interval1, interval2);
-    }
-
-    @Test
-    public void getFirstContiguousPointAfter_withNoIntervals_shouldReturnInput() {
-        TreeSet<IntInterval> intervalList = new TreeSet<IntInterval>();
-        int startPoint = 12345;
-
-        int firstContiguousPointAfterStartPoint = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(
-                startPoint, intervalList);
-
-        assertThat(firstContiguousPointAfterStartPoint).isEqualTo(startPoint);
-    }
-
-    @Test
-    @SuppressWarnings("unchecked")
-    public void getFirstContiguousPointAfter_withMultipleConnectedAndDisconnectedIntervals_shouldReturnFirstContiguousPointAfterStartPoint() {
-        IntInterval[] intervalArray = new IntInterval[8];
-
-        // Goes from 500 to 1250
-        intervalArray[0] = new IntInterval(500, 200);
-        intervalArray[1] = new IntInterval(700, 300);
-        intervalArray[2] = new IntInterval(1000, 250);
-
-        // Separate section that goes from 2000 to 3000
-        intervalArray[3] = new IntInterval(2000, 1000);
-
-        // Goes from 3500 to 4500 but with various sections that overlap
-        intervalArray[4] = new IntInterval(3500, 750);
-        intervalArray[5] = new IntInterval(4000, 100);
-        intervalArray[6] = new IntInterval(4050, 200);
-        intervalArray[7] = new IntInterval(3999, 501);
-
-        TreeSet<IntInterval> intervalList = new TreeSet(Arrays.asList(intervalArray));
-
-        // Before the first section
-        int result = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(499, intervalList);
-        assertThat(result).isEqualTo(499);
-
-        // At the start of the first section
-        result = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(500, intervalList);
-        assertThat(result).isEqualTo(1250);
-
-        // In the first section
-        result = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(567, intervalList);
-        assertThat(result).isEqualTo(1250);
-
-        // Between the first section and the second section
-        result = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(1337, intervalList);
-        assertThat(result).isEqualTo(1337);
-
-        // In the second section
-        result = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(2222, intervalList);
-        assertThat(result).isEqualTo(3000);
-
-        // Between the second section and the third section
-        result = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(3232, intervalList);
-        assertThat(result).isEqualTo(3232);
-
-        // At the start of the third section
-        result = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(3500, intervalList);
-        assertThat(result).isEqualTo(4500);
-
-        // In the third section
-        result = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(3789, intervalList);
-        assertThat(result).isEqualTo(4500);
-
-        // After the third section
-        result = HttpDiskCompositeDataSource.getFirstContiguousPointAfter(4501, intervalList);
-        assertThat(result).isEqualTo(4501);
-    }
-
-    /**
-     * Creates a byte array and fills it with random data. Use the seed offset to generate
-     * subsequent random byte arrays that are not the same random byte array.
-     *
-     * @param length     How many bytes in the byte array
-     * @param seedOffset Offsets the seed so that different, random byte arrays can be created
-     * @return byte array of specified length filled with random bytes\
-     */
-    private byte[] generateRandomByteArray(int length, int seedOffset) {
-        byte[] byteArray = new byte[length];
-        new Random(BASE_SEED + seedOffset).nextBytes(byteArray);
-        return byteArray;
-    }
-
-    /**
-     * Sets up the mock http data source to return the specified bytes when queried.
-     *
-     * @param bytesFromNetwork   The bytes to write to the buffer.
-     * @param mockHttpDataSource The mock object that does this.
-     * @throws HttpDataSource.HttpDataSourceException This should never happen since this is a
-     *                                                mock.
-     */
-    private static void setUpMockHttpDataSourceToReturnBytesFromNetwork(
-            final byte[] bytesFromNetwork,
-            final HttpDataSource mockHttpDataSource) throws HttpDataSource.HttpDataSourceException {
-        when(mockHttpDataSource.read(any(byte[].class), anyInt(), anyInt())).thenAnswer(
-                new Answer<Long>() {
-                    @Override
-                    public Long answer(final InvocationOnMock invocation) throws Throwable {
-                        final Object[] args = invocation.getArguments();
-                        final byte[] byteBuffer = (byte[]) args[0];
-                        final Integer offset = (Integer) args[1];
-                        final Integer length = (Integer) args[2];
-                        System.arraycopy(bytesFromNetwork, 0, byteBuffer, offset, length);
-                        return (long) length;
-                    }
-                });
-    }
-}
diff --git a/mopub-sdk/src/test/java/com/mopub/nativeads/MoPubCacheTest.java b/mopub-sdk/src/test/java/com/mopub/nativeads/MoPubCacheTest.java
new file mode 100644
index 00000000..2a628a3a
--- /dev/null
+++ b/mopub-sdk/src/test/java/com/mopub/nativeads/MoPubCacheTest.java
@@ -0,0 +1,53 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.nativeads;
+
+import android.content.Context;
+
+import com.google.android.exoplayer2.upstream.cache.Cache;
+import com.google.android.exoplayer2.upstream.cache.SimpleCache;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+
+import java.io.File;
+
+import static org.fest.assertions.api.Assertions.assertThat;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+public class MoPubCacheTest {
+    private static final String BASE_CACHE_DIR = "/some_cache_dir";
+
+    private Context mockContext;
+
+    @Before
+    public void setUp() {
+        mockContext = mock(Context.class);
+        when(mockContext.getApplicationContext()).thenReturn(mockContext);
+    }
+
+    @Test
+    public void getCacheInstance_whenCacheDirIsNull_shouldReturnNull() {
+        when(mockContext.getCacheDir()).thenReturn(null);
+
+        Cache cache = MoPubCache.getCacheInstance(mockContext);
+        assertThat(cache).isNull();
+    }
+
+    @Test
+    public void getCacheInstance_whenCacheDirIsNonNull_shouldReturnSimpleCacheInstance() {
+        when(mockContext.getCacheDir()).thenReturn(new File(BASE_CACHE_DIR));
+
+        Cache cache = MoPubCache.getCacheInstance(mockContext);
+        assertThat(cache).isInstanceOf(SimpleCache.class);
+    }
+
+    @After
+    public void tearDown() {
+        MoPubCache.resetInstance();
+    }
+}
diff --git a/mopub-sdk/src/test/java/com/mopub/nativeads/NativeAdTest.java b/mopub-sdk/src/test/java/com/mopub/nativeads/NativeAdTest.java
index 9c4001ab..841071c7 100644
--- a/mopub-sdk/src/test/java/com/mopub/nativeads/NativeAdTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/nativeads/NativeAdTest.java
@@ -10,6 +10,10 @@
 
 import com.mopub.common.test.support.SdkTestRunner;
 import com.mopub.nativeads.BaseNativeAd.NativeEventListener;
+import com.mopub.network.AdResponse;
+import com.mopub.network.ImpressionData;
+import com.mopub.network.ImpressionListener;
+import com.mopub.network.ImpressionsEmitter;
 import com.mopub.network.MoPubRequestQueue;
 import com.mopub.network.Networking;
 
@@ -48,6 +52,7 @@
     @Mock private MoPubRequestQueue mockRequestQueue;
     @Mock private MoPubNativeEventListener mockEventListener;
     @Mock private BaseNativeAd mockBaseNativeAd;
+    @Mock private ImpressionData mockImpressionData;
 
     @Before
     public void setUp() {
@@ -182,6 +187,28 @@ public void recordImpression_whenDestroyed_shouldReturnFast() {
         verifyZeroInteractions(mockEventListener);
     }
 
+    @Test
+    public void recordImpression_shouldCallImpressionCallback() {
+        ImpressionListener listener = mock(ImpressionListener.class);
+        ImpressionsEmitter.addListener(listener);
+
+        subject.recordImpression(mockView);
+
+        verify(listener).onImpression("adunit_id", null);
+    }
+
+    @Test
+    public void recordImpression_whenImpressionDataPresent_shouldCallImpressionData() {
+        subject = new NativeAd(activity, mockAdResponse(), "adunit_id", mockBaseNativeAd, mockRenderer);
+
+        ImpressionListener listener = mock(ImpressionListener.class);
+        ImpressionsEmitter.addListener(listener);
+
+        subject.recordImpression(mockView);
+
+        verify(listener).onImpression("adunit_id", mockImpressionData);
+    }
+
     @Test
     public void handleClick_shouldTrackClicksOnce() {
         subject.handleClick(mockView);
@@ -205,4 +232,13 @@ public void handleClick_whenDestroyed_shouldReturnFast() {
         verifyZeroInteractions(mockRequestQueue);
         verifyZeroInteractions(mockEventListener);
     }
+
+    private AdResponse mockAdResponse() {
+        AdResponse response = mock(AdResponse.class);
+        when(response.getClickTrackingUrl()).thenReturn("moPubClickTrackerUrl");
+        when(response.getImpressionTrackingUrls())
+                .thenReturn(Arrays.asList("moPubImpressionTrackerUrl1", "moPubImpressionTrackerUrl2"));
+        when(response.getImpressionData()).thenReturn(mockImpressionData);
+        return response;
+    }
 }
diff --git a/mopub-sdk/src/test/java/com/mopub/nativeads/NativeUrlGeneratorTest.java b/mopub-sdk/src/test/java/com/mopub/nativeads/NativeUrlGeneratorTest.java
index f4516fd4..0b5c8400 100644
--- a/mopub-sdk/src/test/java/com/mopub/nativeads/NativeUrlGeneratorTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/nativeads/NativeUrlGeneratorTest.java
@@ -6,6 +6,8 @@
 
 import android.app.Activity;
 import android.content.Context;
+import android.content.pm.PackageInfo;
+import android.content.pm.PackageManager;
 import android.content.res.Resources;
 import android.graphics.Point;
 import android.location.Location;
@@ -52,6 +54,7 @@
 import static android.Manifest.permission.ACCESS_NETWORK_STATE;
 import static org.fest.assertions.api.Assertions.assertThat;
 import static org.mockito.Matchers.any;
+import static org.mockito.Matchers.anyInt;
 import static org.mockito.Mockito.doAnswer;
 import static org.mockito.Mockito.mock;
 import static org.mockito.Mockito.spy;
@@ -61,6 +64,7 @@
 @Config(shadows = {MoPubShadowTelephonyManager.class, MoPubShadowConnectivityManager.class})
 public class NativeUrlGeneratorTest {
     private static final String AD_UNIT_ID = "1234";
+    private static final String TEST_BUNDLE = "test.bundle";
     private static final int TEST_SCREEN_WIDTH = 320;
     private static final int TEST_SCREEN_HEIGHT = 470;
     private static final float TEST_DENSITY = 1.0f;
@@ -75,7 +79,7 @@ public void setup() throws Exception {
         context = spy(Robolectric.buildActivity(Activity.class).create().get());
         Shadows.shadowOf(context).grantPermissions(ACCESS_NETWORK_STATE);
         Shadows.shadowOf(context).grantPermissions(ACCESS_FINE_LOCATION);
-        when(context.getPackageName()).thenReturn("testBundle");
+        when(context.getPackageName()).thenReturn(TEST_BUNDLE);
         shadowTelephonyManager = (MoPubShadowTelephonyManager)
                 Shadows.shadowOf((TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE));
         shadowConnectivityManager = (MoPubShadowConnectivityManager)
@@ -93,6 +97,14 @@ public void setup() throws Exception {
         when(spyResources.getDisplayMetrics()).thenReturn(mockDisplayMetrics);
         when(context.getResources()).thenReturn(spyResources);
 
+        final Context spyApplicationContext = spy(context.getApplicationContext());
+        when(spyApplicationContext.getPackageName()).thenReturn(TEST_BUNDLE);
+        PackageManager mockPackageManager = mock(PackageManager.class);
+        PackageInfo mockPackageInfo = mock(PackageInfo.class);
+        mockPackageInfo.versionName = BuildConfig.VERSION_NAME;
+        when(mockPackageManager.getPackageInfo(any(String.class), anyInt())).thenReturn(mockPackageInfo);
+        when(spyApplicationContext.getPackageManager()).thenReturn(mockPackageManager);
+
         // Only do this on Android 17+ because getRealSize doesn't exist before then.
         // This is the default pathway.
         if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR2) {
@@ -108,7 +120,6 @@ public Object answer(final InvocationOnMock invocationOnMock) {
                 }
             }).when(mockDisplay).getRealSize(any(Point.class));
             when(mockWindowManager.getDefaultDisplay()).thenReturn(mockDisplay);
-            final Context spyApplicationContext = spy(context.getApplicationContext());
             when(spyApplicationContext.getSystemService(Context.WINDOW_SERVICE)).thenReturn(mockWindowManager);
             when(context.getApplicationContext()).thenReturn(spyApplicationContext);
         }
@@ -434,7 +445,7 @@ public void generateUrlString_withOnlyAdUnitSet_shouldReturnMinimumUrl() {
                         AD_UNIT_ID +
                         "&nv=" + Uri.encode(MoPub.SDK_VERSION) +
                         "&dn=unknown%2Crobolectric%2Crobolectric" +
-                        "&bundle=com.mopub.mobileads" +
+                        "&bundle=" + TEST_BUNDLE +
                         "&z=-0700" +
                         "&o=p" +
                         "&w=" +
diff --git a/mopub-sdk/src/test/java/com/mopub/network/AdLoaderTest.java b/mopub-sdk/src/test/java/com/mopub/network/AdLoaderTest.java
index 20f293a1..a618c13c 100644
--- a/mopub-sdk/src/test/java/com/mopub/network/AdLoaderTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/network/AdLoaderTest.java
@@ -24,6 +24,7 @@
 import org.junit.runner.RunWith;
 import org.mockito.Mock;
 import org.robolectric.Robolectric;
+import org.robolectric.shadows.ShadowLooper;
 
 import java.lang.reflect.Field;
 import java.lang.reflect.InvocationTargetException;
@@ -33,8 +34,11 @@
 
 import static com.mopub.mobileads.MoPubErrorCode.UNSPECIFIED;
 import static org.fest.assertions.api.Assertions.assertThat;
+import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.assertNull;
 import static org.mockito.Matchers.any;
 import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
 import static org.mockito.Mockito.times;
 import static org.mockito.Mockito.verify;
 
@@ -75,6 +79,7 @@ public void setup() {
 
     @After
     public void teardown() {
+        RequestRateTrackerTest.clearRequestRateTracker();
     }
 
     @Test
@@ -127,7 +132,47 @@ public void loadNextAd_whenRunning_returnsOldRequest() throws NoSuchFieldExcepti
     }
 
     @Test
-    public void loadNextAd_whenFailed_callsHandler_OnErrorresponse() throws NoSuchFieldException, IllegalAccessException {
+    public void loadNextAd_firstCall_whenBlockedByRequestRateLimit_makesNoReqeust_returnsNull() {
+        RequestRateTrackerTest.prepareRequestRateTracker(adUnitId, 100, "reason");
+
+        Request<?> request = subject.loadNextAd(null);
+
+        assertNull(request);
+        verify(mockListener).onErrorResponse(any(VolleyError.class));
+        RequestQueue requestQueue = Networking.getRequestQueue();
+        verify(requestQueue, never()).add(any(Request.class));
+    }
+
+    @Test
+    public void twoAdResponseWaterfall_whenBlockedAfterFirstRequest_shouldNotBlockSecondRequest()
+            throws JSONException, MoPubNetworkError, NoSuchFieldException, IllegalAccessException {
+        JSONObject adResponseJson1 = createAdResponseJson("trackingUrl1", "content_1");
+        JSONObject adResponseJson2 = createAdResponseJson("trackingUrl2", "content_2");
+        byte[] body = createResponseBody(null, new JSONObject[]{adResponseJson1, adResponseJson2});
+        NetworkResponse testResponse = new NetworkResponse(200, body, headers, false);
+        MultiAdResponse multiAdResponse = new MultiAdResponse(activity, testResponse, AdFormat.BANNER, adUnitId);
+
+        // set subject MultiAdResponse
+        Field field = getPrivateField("mMultiAdResponse");
+        field.set(subject, multiAdResponse);
+
+        // validation
+        assertThat(subject.hasMoreAds()).isTrue();
+        subject.loadNextAd(null);
+        verify(mockListener, times(1)).onSuccess(any(AdResponse.class));
+        assertThat(subject.hasMoreAds()).isTrue();
+
+        RequestRateTrackerTest.prepareRequestRateTracker(adUnitId, 100, "reason");
+        Request<?> request = subject.loadNextAd(UNSPECIFIED);
+
+        assertNotNull(request);
+        verify(mockListener, times(2)).onSuccess(any(AdResponse.class));
+        verify(mockListener, never()).onErrorResponse(any(VolleyError.class));
+        assertThat(subject.hasMoreAds()).isFalse();
+    }
+
+    @Test
+    public void loadNextAd_whenFailed_callsHandler_OnErrorResponse() throws NoSuchFieldException, IllegalAccessException {
         // set AdLoader.failed=true;
         Field field = getPrivateField("mFailed");
         field.setBoolean(subject, true);
diff --git a/mopub-sdk/src/test/java/com/mopub/network/HeaderUtilsTest.java b/mopub-sdk/src/test/java/com/mopub/network/HeaderUtilsTest.java
index 3e83f318..2147d47a 100644
--- a/mopub-sdk/src/test/java/com/mopub/network/HeaderUtilsTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/network/HeaderUtilsTest.java
@@ -92,4 +92,16 @@ public void extractPercentHeader_shouldReturnPercentValue() throws JSONException
         subject.put(ResponseHeader.HEIGHT.getKey(), "a%");
         assertThat(HeaderUtils.extractPercentHeader(subject, ResponseHeader.HEIGHT)).isNull();
     }
+
+    @Test
+    public void extractJsonObjectHeader_shouldReturnJsonObject() throws JSONException {
+        JSONObject testObject = new JSONObject();
+
+        subject.put(ResponseHeader.IMPRESSION_DATA.getKey(), testObject);
+        assertThat(HeaderUtils.extractJsonObjectHeader(subject, ResponseHeader.IMPRESSION_DATA)).isEqualTo(testObject);
+        assertThat(HeaderUtils.extractJsonObjectHeader(null, ResponseHeader.IMPRESSION_DATA)).isNull();
+
+        subject.remove(ResponseHeader.IMPRESSION_DATA.getKey());
+        assertThat(HeaderUtils.extractJsonObjectHeader(subject, ResponseHeader.IMPRESSION_DATA)).isNull();
+    }
 }
diff --git a/mopub-sdk/src/test/java/com/mopub/network/ImpressionDataTest.java b/mopub-sdk/src/test/java/com/mopub/network/ImpressionDataTest.java
new file mode 100644
index 00000000..ca01cca0
--- /dev/null
+++ b/mopub-sdk/src/test/java/com/mopub/network/ImpressionDataTest.java
@@ -0,0 +1,140 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.network;
+
+import com.mopub.common.test.support.SdkTestRunner;
+
+import org.apache.commons.lang3.SerializationUtils;
+import org.json.JSONException;
+import org.json.JSONObject;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.assertNull;
+import static org.junit.Assert.assertTrue;
+
+@RunWith(SdkTestRunner.class)
+public class ImpressionDataTest {
+
+    private ImpressionData subject;
+
+    @Before
+    public void setup() throws JSONException {
+        JSONObject json = new JSONObject(SAMPLE_JSON);
+        subject = ImpressionData.create(json);
+    }
+
+    @Test
+    public void create_withNullJson_shouldReturnNull() {
+        assertNull(ImpressionData.create(null));
+    }
+
+    @Test
+    public void create_withValidJson_shouldReturnValidImpressionData() {
+        assertTrue(equalsToSampleData(subject));
+    }
+
+    @Test
+    public void create_withEmptyJson_shouldReturnValidImpressiondata() {
+        subject = ImpressionData.create(new JSONObject());
+
+        assertNotNull(subject);
+        assertNull(subject.getImpressionId());
+        assertNull(subject.getAdUnitId());
+        assertNull(subject.getAdUnitName());
+        assertNull(subject.getAdUnitFormat());
+        assertNull(subject.getAdGroupId());
+        assertNull(subject.getAdGroupName());
+        assertNull(subject.getAdGroupType());
+        assertNull(subject.getAdGroupPriority());
+        assertNull(subject.getCurrency());
+        assertNull(subject.getCountry());
+        assertNull(subject.getNetworkName());
+        assertNull(subject.getNetworkPlacementId());
+        assertNull(subject.getPublisherRevenue());
+        assertNull(subject.getPrecision());
+        JSONObject jsonObject = subject.getJsonRepresentation();
+        assertFalse(jsonObject.keys().hasNext());
+    }
+
+    @Test
+    public void serialize_desirialize_shouldReturnObjectCopy() {
+        ImpressionData copy = SerializationUtils.clone(subject);
+        equalsToSampleData(copy);
+    }
+
+    @Test
+    public void serialize_deserialize_withUnicodeChars_shouldReturnValidImpressionData() throws JSONException {
+        JSONObject jsonObject = new JSONObject(SAMPLE_JSON);
+        jsonObject.put("country", "Россия");
+        subject = ImpressionData.create(jsonObject);
+        ImpressionData copy = SerializationUtils.clone(subject);
+        assert copy != null;
+        compareObjects(subject, copy);
+    }
+
+    private final String SAMPLE_JSON = "{\n" +
+            "                \"id\": \"test_ID\",\n" +
+            "                \"adunit_id\": \"test_adunit_id\",\n" +
+            "                \"adunit_name\": \"test_adunit_name\",\n" +
+            "                \"adunit_format\": \"test_adunit_format\",\n" +
+            "                \"adgroup_id\": \"test_adgroup_id\",\n" +
+            "                \"adgroup_name\": \"test_adgroup_name\",\n" +
+            "                \"adgroup_type\": \"test_adgroup_type\",\n" +
+            "                \"adgroup_priority\": 9876,\n" +
+            "                \"currency\": \"test_currency\",\n" +
+            "                \"country\": \"test_country\",\n" +
+            "                \"network_name\": \"test_network_name\",\n" +
+            "                \"network_placement_id\": \"test_network_placement_id\",\n" +
+            "                \"publisher_revenue\": 6789,\n" +
+            "                \"precision\": \"test_precision\"\n" +
+            "            }";
+
+    private static boolean equalsToSampleData(ImpressionData data) {
+        assertEquals("test_ID", data.getImpressionId());
+        assertEquals("test_adunit_id", data.getAdUnitId());
+        assertEquals("test_adunit_name", data.getAdUnitName());
+        assertEquals("test_adunit_format", data.getAdUnitFormat());
+        assertEquals("test_adgroup_id", data.getAdGroupId());
+        assertEquals("test_adgroup_name", data.getAdGroupName());
+        assertEquals("test_adgroup_type", data.getAdGroupType());
+        assertEquals(9876, data.getAdGroupPriority().intValue());
+        assertEquals("test_currency", data.getCurrency());
+        assertEquals("test_country", data.getCountry());
+        assertEquals("test_network_name", data.getNetworkName());
+        assertEquals("test_network_placement_id", data.getNetworkPlacementId());
+        assertEquals(6789d, data.getPublisherRevenue(), 0.001);
+        assertEquals("test_precision", data.getPrecision());
+
+        JSONObject json = data.getJsonRepresentation();
+
+        assertEquals("test_ID", json.optString("id"));
+        assertEquals("test_adunit_id", json.optString("adunit_id"));
+        assertEquals("test_adunit_name", json.optString("adunit_name"));
+        assertEquals("test_adunit_format", json.optString("adunit_format"));
+        assertEquals("test_adgroup_id", json.optString("adgroup_id"));
+        assertEquals("test_adgroup_name", json.optString("adgroup_name"));
+        assertEquals("test_adgroup_type", json.optString("adgroup_type"));
+        assertEquals(9876, json.optInt("adgroup_priority"));
+        assertEquals("test_currency", json.optString("currency"));
+        assertEquals("test_country", json.optString("country"));
+        assertEquals("test_network_name", json.optString("network_name"));
+        assertEquals("test_network_placement_id", json.optString("network_placement_id"));
+        assertEquals(6789, json.optDouble("publisher_revenue"), 0.001);
+        assertEquals("test_precision", json.optString("precision"));
+
+        return true;
+    }
+
+    private static void compareObjects(ImpressionData o1, ImpressionData o2) {
+        JSONObject j1 = o1.getJsonRepresentation();
+        JSONObject j2 = o2.getJsonRepresentation();
+        assertEquals(j1.toString(), j2.toString());
+    }
+}
diff --git a/mopub-sdk/src/test/java/com/mopub/network/ImpressionEmitterTest.java b/mopub-sdk/src/test/java/com/mopub/network/ImpressionEmitterTest.java
new file mode 100644
index 00000000..c937bea8
--- /dev/null
+++ b/mopub-sdk/src/test/java/com/mopub/network/ImpressionEmitterTest.java
@@ -0,0 +1,179 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.network;
+
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+
+import com.mopub.common.test.support.SdkTestRunner;
+
+import org.junit.After;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+
+import static org.junit.Assert.assertTrue;
+import static org.mockito.Matchers.any;
+import static org.mockito.Matchers.anyString;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+
+@RunWith(SdkTestRunner.class)
+public class ImpressionEmitterTest {
+
+    private static final String mAdUnitId = "ad_unit_id";
+
+    @Mock
+    ImpressionListener listener1;
+    @Mock
+    ImpressionListener listener2;
+    @Mock
+    ImpressionData impression;
+
+    @After
+    public void tearDown() {
+        ImpressionsEmitter.clear();
+    }
+
+    @Test
+    public void send_oneListener_shouldCallListener() {
+        ImpressionsEmitter.addListener(listener1);
+
+        ImpressionsEmitter.send(mAdUnitId, impression);
+        verify(listener1).onImpression(mAdUnitId, impression);
+    }
+
+    @Test
+    public void send_twoListeners_shouldCallBoth() {
+        ImpressionsEmitter.addListener(listener1);
+        ImpressionsEmitter.addListener(listener2);
+
+        ImpressionsEmitter.send(mAdUnitId, impression);
+
+        verify(listener1).onImpression(mAdUnitId, impression);
+        verify(listener2).onImpression(mAdUnitId, impression);
+    }
+
+    @Test
+    public void send_removeListener_shouldNotCallAfterRemove() {
+        ImpressionListener l1 = mock(ImpressionListener.class);
+        ImpressionsEmitter.addListener(l1);
+        ImpressionsEmitter.addListener(listener2);
+        ImpressionsEmitter.removeListener(l1);
+
+        ImpressionsEmitter.send(mAdUnitId, impression);
+
+        verify(l1, never()).onImpression(anyString(), any(ImpressionData.class));
+        verify(listener2).onImpression(mAdUnitId, impression);
+    }
+
+    @Test
+    public void send_addListenerTwice_shouldMakeSingleCallback() {
+        ImpressionsEmitter.addListener(listener1);
+        ImpressionsEmitter.addListener(listener1);
+
+        ImpressionsEmitter.send(mAdUnitId, impression);
+
+        verify(listener1, times(1)).onImpression(mAdUnitId, impression);
+
+        ImpressionsEmitter.removeListener(listener1);
+        Mockito.reset(listener1);
+
+        ImpressionsEmitter.send(mAdUnitId, impression);
+
+        verify(listener1, never()).onImpression(anyString(), any(ImpressionData.class));
+    }
+
+    @Test
+    public void send_nullImpressionData_shouldCallListener() {
+        ImpressionsEmitter.addListener(listener1);
+
+        ImpressionsEmitter.send(mAdUnitId, null);
+
+        verify(listener1).onImpression(mAdUnitId, null);
+    }
+
+    @Test
+    public void multithreading_shouldNotCrash() {
+        final int THREAD_COUNT = 10;
+        Thread[] testThreads = new Thread[THREAD_COUNT];
+        for (int i = 0; i < THREAD_COUNT; i++) {
+            testThreads[i] = createTestThread();
+        }
+        for (int i = 0; i < THREAD_COUNT; i++) {
+            testThreads[i].start();
+        }
+
+        for (Thread thread : testThreads) {
+            try {
+                thread.join();
+            } catch (InterruptedException e) {
+                e.printStackTrace();
+            }
+        }
+    }
+
+    @Test
+    public void removeListener_whileEmitterIsBusy_shouldNotWaitForEmitter() throws InterruptedException {
+        ImpressionListener listener = createDelayedListener();
+        ImpressionsEmitter.addListener(listener);
+
+        new Thread(new Runnable() {
+            @Override
+            public void run() {
+                ImpressionsEmitter.send(mAdUnitId, impression);
+            }
+        }).start();
+        Thread.sleep(100);
+
+        long t1 = System.currentTimeMillis();
+        ImpressionsEmitter.removeListener(listener);
+        long t2 = System.currentTimeMillis();
+
+        assertTrue(t2 - t1 < 100);
+    }
+
+    /*
+    Unit test utility functions
+     */
+    private Thread createTestThread() {
+
+        return new Thread(new Runnable() {
+            @Override
+            public void run() {
+                final int SIZE = 100;
+                ImpressionListener[] listeners = new ImpressionListener[SIZE];
+                for (int i = 0; i < SIZE; i++) {
+                    listeners[i] = mock(ImpressionListener.class);
+                    ImpressionsEmitter.addListener(listeners[i]);
+                }
+
+                for (int i = 0; i < 150; i++) {
+                    ImpressionsEmitter.send(mAdUnitId, mock(ImpressionData.class));
+                }
+
+                for (int i = 0; i < SIZE; i++) {
+                    ImpressionsEmitter.removeListener(listeners[i]);
+                }
+            }
+        });
+    }
+
+    private ImpressionListener createDelayedListener() {
+        return new ImpressionListener() {
+            @Override
+            public void onImpression(@NonNull String adUnitId, @Nullable ImpressionData impressionData) {
+                try {
+                    Thread.sleep(1000);
+                } catch (InterruptedException e) {
+                    e.printStackTrace();
+                }
+            }
+        };
+    }
+}
diff --git a/mopub-sdk/src/test/java/com/mopub/network/MoPubRequestUtilsTest.java b/mopub-sdk/src/test/java/com/mopub/network/MoPubRequestUtilsTest.java
index da266df6..a6f3b179 100644
--- a/mopub-sdk/src/test/java/com/mopub/network/MoPubRequestUtilsTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/network/MoPubRequestUtilsTest.java
@@ -123,6 +123,14 @@ public void convertQueryToMap_withNoQueryParams_shouldReturnEmptyMap() {
         assertThat(result).isEmpty();
     }
 
+    @Test
+    public void convertQueryToMap_withBadUriString_shouldReturnEmptyMap() {
+        final Map<String, String> result = MoPubRequestUtils.convertQueryToMap(context,
+                "https://*#&(%*$&");
+
+        assertThat(result).isEmpty();
+    }
+
     @Test
     public void generateBodyFromParams_withParamsMap_withMoPubUrl_shouldGenerateJsonString() {
         final String result = MoPubRequestUtils.generateBodyFromParams(params,
diff --git a/mopub-sdk/src/test/java/com/mopub/network/MultiAdResponseTest.java b/mopub-sdk/src/test/java/com/mopub/network/MultiAdResponseTest.java
index de30defc..7e2af37d 100644
--- a/mopub-sdk/src/test/java/com/mopub/network/MultiAdResponseTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/network/MultiAdResponseTest.java
@@ -59,6 +59,7 @@
 import com.mopub.common.Constants;
 import com.mopub.common.DataKeys;
 import com.mopub.common.MoPub;
+import com.mopub.common.logging.MoPubLog;
 import com.mopub.common.test.support.SdkTestRunner;
 import com.mopub.common.util.ResponseHeader;
 import com.mopub.mobileads.HtmlBanner;
@@ -87,6 +88,7 @@
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertNotNull;
 import static org.junit.Assert.assertNull;
+import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertTrue;
 import static org.mockito.Mockito.mock;
 import static org.mockito.Mockito.verify;
@@ -156,6 +158,7 @@ public void setup() throws JSONException {
 
     @After
     public void teardown() {
+        RequestRateTrackerTest.clearRequestRateTracker();
         Locale.setDefault(Locale.US);
     }
 
@@ -301,6 +304,70 @@ public void constructor_withResponseWarmup_shouldThrowException() throws JSONExc
         assert false;
     }
 
+    @Test
+    public void constructor_withResponseWarmup_withRateLimitSet_shouldSetBackoffTime() throws JSONException {
+        JSONObject jsonClear = createWarmupAdResponse();
+        JSONObject body = createJsonBody(FAIL_URL, jsonClear);
+        addBackoffParameters(body, 50, "reason");
+        NetworkResponse testResponse = new NetworkResponse(body.toString().getBytes());
+
+        try {
+            new MultiAdResponse(activity, testResponse, AdFormat.BANNER, adUnitId);
+        } catch (Exception ignored) {
+        }
+
+        RequestRateTracker.TimeRecord record = RequestRateTracker.getInstance().getRecordForAdUnit(adUnitId);
+        assertNotNull(record);
+        assertEquals(50, record.mBlockIntervalMs);
+        assertEquals("reason", record.mReason);
+    }
+
+    @Test
+    public void constructor_withResponseClear_withRateLimitSet_shouldSetBackoffTime() throws JSONException {
+        JSONObject jsonClear = createClearAdResponse();
+        JSONObject body = createJsonBody(FAIL_URL, jsonClear);
+        addBackoffParameters(body, 50, "reason");
+        NetworkResponse testResponse = new NetworkResponse(body.toString().getBytes());
+
+        try {
+            new MultiAdResponse(activity, testResponse, AdFormat.BANNER, adUnitId);
+        } catch (Exception ignored) {
+        }
+
+        RequestRateTracker.TimeRecord record = RequestRateTracker.getInstance().getRecordForAdUnit(adUnitId);
+        assertNotNull(record);
+        assertEquals(50, record.mBlockIntervalMs);
+        assertEquals("reason", record.mReason);
+    }
+
+    @Test
+    public void constructor_withRateLimitSetValue_shouldSetBackoffTimeLimit() throws Exception {
+        JSONObject jsonObject = createJsonBody(FAIL_URL, singleAdResponse);
+        addBackoffParameters(jsonObject, 20, "reason");
+        NetworkResponse testResponse = new NetworkResponse(jsonObject.toString().getBytes());
+
+        new MultiAdResponse(activity, testResponse, AdFormat.BANNER, adUnitId);
+
+        RequestRateTracker.TimeRecord record = RequestRateTracker.getInstance().getRecordForAdUnit(adUnitId);
+        assertNotNull(record);
+        assertThat(record.mBlockIntervalMs).isEqualTo(20);
+        assertEquals("reason", record.mReason);
+    }
+
+    @Test
+    public void constructor_withRateLimitSetZero_shouldResetBackoffTimeLimit() throws Exception {
+        RequestRateTrackerTest.prepareRequestRateTracker(adUnitId, 99, "some_reason");
+
+        JSONObject jsonObject = createJsonBody(FAIL_URL, singleAdResponse);
+        addBackoffParameters(jsonObject, 0, "reason");
+        NetworkResponse testResponse = new NetworkResponse(jsonObject.toString().getBytes());
+
+        MultiAdResponse subject = new MultiAdResponse(activity, testResponse, AdFormat.BANNER, adUnitId);
+
+        RequestRateTracker.TimeRecord record = RequestRateTracker.getInstance().getRecordForAdUnit(adUnitId);
+        assertNull(record);
+    }
+
     @Test
     public void constructor_withEmptyResponseArray_shouldThrowError_shouldUseDefaultTimeout() throws JSONException {
         byte[] body = createResponseBody(FAIL_URL, null);
@@ -405,6 +472,55 @@ public void constructor_withTwoAdResponses_withEmptyFailUrl_fullTest() throws Mo
         assertTrue(subject.isWaterfallFinished());
     }
 
+    @Test
+    public void constructor_withEnableDebugLoggingTrue_shouldSetDebugLogLevel() throws Exception {
+        // Set log level to none
+        MoPubLog.setLogLevel(MoPubLog.LogLevel.NONE);
+
+        JSONObject body = createJsonBody(FAIL_URL, singleAdResponse);
+        body.put(ResponseHeader.ENABLE_DEBUG_LOGGING.getKey(), 1); // true
+        NetworkResponse testResponse = new NetworkResponse(body.toString().getBytes());
+        MultiAdResponse subject = new MultiAdResponse(activity, testResponse, AdFormat.BANNER, adUnitId);
+
+        // Get log level and check that it is now MoPubLog.LogLevel.DEBUG
+        final MoPubLog.LogLevel afterLogLevel = MoPubLog.getLogLevel();
+        assertThat(afterLogLevel).isEqualTo(MoPubLog.LogLevel.DEBUG);
+    }
+
+    @Test
+    public void constructor_withEnableDebugLoggingFalse_shouldNotChangeLogLevel() throws Exception {
+        // Set log level to none and get value from MoPubLog
+        MoPubLog.setLogLevel(MoPubLog.LogLevel.NONE);
+        final MoPubLog.LogLevel beforeLogLevel = MoPubLog.getLogLevel();
+
+        JSONObject body = createJsonBody(FAIL_URL, singleAdResponse);
+        body.put(ResponseHeader.ENABLE_DEBUG_LOGGING.getKey(), 0); // false
+        NetworkResponse testResponse = new NetworkResponse(body.toString().getBytes());
+        MultiAdResponse subject = new MultiAdResponse(activity, testResponse, AdFormat.BANNER, adUnitId);
+
+        // Get log level
+        final MoPubLog.LogLevel afterLogLevel = MoPubLog.getLogLevel();
+        assertThat(afterLogLevel).isEqualTo(beforeLogLevel);
+    }
+
+    @Test
+    public void constructor_withoutEnableDebugLogging_shouldNotChangeLogLevel() throws Exception {
+        // Set log level to none and get value from MoPubLog
+        MoPubLog.setLogLevel(MoPubLog.LogLevel.NONE);
+        final MoPubLog.LogLevel beforeLogLevel = MoPubLog.getLogLevel();
+
+        JSONObject body = createJsonBody(FAIL_URL, singleAdResponse);
+        NetworkResponse testResponse = new NetworkResponse(body.toString().getBytes());
+        MultiAdResponse subject = new MultiAdResponse(activity, testResponse, AdFormat.BANNER, adUnitId);
+
+        // The response shouldn't have the key in the headers
+        assertFalse(body.has(ResponseHeader.ENABLE_DEBUG_LOGGING.getKey()));
+
+        // Get log level
+        final MoPubLog.LogLevel afterLogLevel = MoPubLog.getLogLevel();
+        assertThat(afterLogLevel).isEqualTo(beforeLogLevel);
+    }
+
     @Test
     public void parseNetworkResponse_forBanner_withoutImpTrackingHeaders_shouldSucceed() throws MoPubNetworkError, JSONException {
         NetworkResponse networkResponse = new NetworkResponse(singleAdResponse.toString().getBytes());
@@ -472,6 +588,42 @@ public void parseNetworkResponse_forBanner_withImpTrackingHeaders_shouldSucceed(
         assertThat(serverExtras.get(DataKeys.HTML_RESPONSE_BODY_KEY)).isEqualToIgnoringCase("content_text");
         assertThat(serverExtras.get(DataKeys.BANNER_IMPRESSION_MIN_VISIBLE_DIPS)).isEqualTo("1");
         assertThat(serverExtras.get(DataKeys.BANNER_IMPRESSION_MIN_VISIBLE_MS)).isEqualTo("2");
+        assertThat(subject.getImpressionData()).isNull();
+    }
+
+    @Test
+    public void parseNetworkResponse_forBanner_withImpressionData_shouldSucceed() throws MoPubNetworkError, JSONException {
+        // add impression data
+        JSONObject metadata = (JSONObject) singleAdResponse.get(ResponseHeader.METADATA.getKey());
+        JSONObject impJson = createImpressionData();
+        metadata.put(ResponseHeader.IMPRESSION_DATA.getKey(), impJson);
+        NetworkResponse networkResponse = new NetworkResponse(singleAdResponse.toString().getBytes());
+
+        AdResponse subject = MultiAdResponse.parseSingleAdResponse(activity.getApplicationContext(),
+                networkResponse,
+                singleAdResponse,
+                adUnitId,
+                AdFormat.BANNER,
+                REQUEST_ID_VALUE);
+
+        assertThat(subject.getAdType()).isEqualTo(AdType.HTML);
+        assertThat(subject.getAdUnitId()).isEqualTo(adUnitId);
+        ImpressionData impressionData = subject.getImpressionData();
+        assert (impressionData != null);
+        assertThat(impressionData.getImpressionId()).isEqualTo(impJson.getString("id"));
+        assertThat(impressionData.getAdUnitId()).isEqualTo(impJson.getString("adunit_id"));
+        assertThat(impressionData.getAdUnitName()).isEqualTo(impJson.getString("adunit_name"));
+        assertThat(impressionData.getAdUnitFormat()).isEqualTo(impJson.getString("adunit_format"));
+        assertThat(impressionData.getAdGroupId()).isEqualTo(impJson.getString("adgroup_id"));
+        assertThat(impressionData.getAdGroupName()).isEqualTo(impJson.getString("adgroup_name"));
+        assertThat(impressionData.getAdGroupType()).isEqualTo(impJson.getString("adgroup_type"));
+        assertThat(impressionData.getAdGroupPriority()).isEqualTo(impJson.getInt("adgroup_priority"));
+        assertThat(impressionData.getCurrency()).isEqualTo(impJson.getString("currency"));
+        assertThat(impressionData.getCountry()).isEqualTo(impJson.getString("country"));
+        assertThat(impressionData.getNetworkName()).isEqualTo(impJson.getString("network_name"));
+        assertThat(impressionData.getNetworkPlacementId()).isEqualTo(impJson.getString("network_placement_id"));
+        assertThat(impressionData.getPublisherRevenue()).isEqualTo(impJson.getDouble("publisher_revenue"));
+        assertThat(impressionData.getPrecision()).isEqualTo(impJson.getString("precision"));
     }
 
     @Test
@@ -993,4 +1145,28 @@ private static JSONObject createWarmupAdResponse() throws JSONException {
         return jsonObject;
     }
 
+    private static JSONObject createImpressionData() throws JSONException {
+        String jsonString = "{\n" +
+                        "          \"id\": \"impid\",\n" +
+                        "          \"adunit_id\": \"adunitid\",\n" +
+                        "          \"adunit_name\": \"adunitname\",\n" +
+                        "          \"adunit_format\": \"adunitformat\",\n" +
+                        "          \"adgroup_id\": \"adgroupid\",\n" +
+                        "          \"adgroup_name\": \"adgroupname\",\n" +
+                        "          \"adgroup_type\": \"adgrouptype\",\n" +
+                        "          \"adgroup_priority\": 123,\n" +
+                        "          \"currency\": \"USD\",\n" +
+                        "          \"country\": \"USA\",\n" +
+                        "          \"network_name\": \"networkname\",\n" +
+                        "          \"network_placement_id\": \"networkplacementid\",\n" +
+                        "          \"publisher_revenue\": 0.0001,\n" +
+                        "          \"precision\": \"exact\"\n" +
+                        "     }";
+        return new JSONObject(jsonString);
+    }
+
+    private static void addBackoffParameters(final JSONObject response, int time, String reason) throws JSONException {
+        response.put(ResponseHeader.BACKOFF_MS.getKey(), time);
+        response.put(ResponseHeader.BACKOFF_REASON.getKey(), reason);
+    }
 }
diff --git a/mopub-sdk/src/test/java/com/mopub/network/NetworkingTest.java b/mopub-sdk/src/test/java/com/mopub/network/NetworkingTest.java
index 4ed1ac6c..0226ace1 100644
--- a/mopub-sdk/src/test/java/com/mopub/network/NetworkingTest.java
+++ b/mopub-sdk/src/test/java/com/mopub/network/NetworkingTest.java
@@ -17,12 +17,14 @@
 import org.robolectric.Robolectric;
 import org.robolectric.annotation.Config;
 
+import java.util.concurrent.CountDownLatch;
+import java.util.concurrent.TimeUnit;
+
 import static org.fest.assertions.api.Assertions.assertThat;
 
 @RunWith(SdkTestRunner.class)
 public class NetworkingTest {
     private Activity context;
-    static volatile String sUserAgent;
 
     @Before
     public void setUp() {
@@ -32,7 +34,6 @@ public void setUp() {
     @After
     public void tearDown() {
         Networking.clearForTesting();
-        sUserAgent = null;
     }
 
     @Test
@@ -61,6 +62,27 @@ public void getUserAgent_withSdkVersionGreaterThan16_shouldIncludeAndroid() {
         assertThat(userAgent).containsIgnoringCase("android");
     }
 
+    @TargetApi(Build.VERSION_CODES.JELLY_BEAN_MR1)
+    @Config(sdk = Build.VERSION_CODES.JELLY_BEAN_MR1)
+    @Test
+    public void getUserAgent_withSdkVersionGreaterThan16_whenOnABackgroundThread_shouldReturnHttpAgent() throws InterruptedException {
+        final String[] userAgent = new String[1];
+        final CountDownLatch latch = new CountDownLatch(1);
+        new Thread() {
+            @Override
+            public void run() {
+                userAgent[0] = Networking.getUserAgent(context);
+
+                latch.countDown();
+            }
+        }.start();
+
+        latch.await(500, TimeUnit.MILLISECONDS);
+        // Robolectric's default http agent is null which gets rewritten to an empty String.
+        assertThat(userAgent[0]).isEqualTo("");
+
+    }
+
     @Test
     public void getCachedUserAgent_usesCachedUserAgent() {
         Networking.setUserAgentForTesting("some cached user agent");
diff --git a/mopub-sdk/src/test/java/com/mopub/network/RequestRateTrackerTest.java b/mopub-sdk/src/test/java/com/mopub/network/RequestRateTrackerTest.java
new file mode 100644
index 00000000..282dcc8d
--- /dev/null
+++ b/mopub-sdk/src/test/java/com/mopub/network/RequestRateTrackerTest.java
@@ -0,0 +1,216 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.network;
+
+import android.os.SystemClock;
+
+import com.mopub.common.test.support.SdkTestRunner;
+import com.mopub.network.RequestRateTracker.TimeRecord;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.robolectric.Robolectric;
+
+import java.util.concurrent.TimeUnit;
+
+import static org.fest.assertions.api.Assertions.assertThat;
+import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.assertNull;
+
+@RunWith(SdkTestRunner.class)
+public class RequestRateTrackerTest {
+    private static final long DELTA = 100;
+    private static final int BACKOFF_TIME = 88;
+    private static final String AD_UNIT_1 = "ad_unit_1";
+    private static final String AD_UNIT_2 = "ad_unit_2";
+    private static final String REASON = "backoff_reason";
+    private static final String REASON2 = "reason2";
+    private static final String NO_BACKOFF = "no_backoff";
+
+    private RequestRateTracker subject;
+
+    @Before
+    public void setup() {
+        subject = RequestRateTracker.getInstance();
+    }
+
+    @After
+    public void tearDown() {
+        clearRequestRateTracker();
+    }
+
+    @Test
+    public void registerRateLimit_withValidData_shouldSetRateLimitForAdUnit() {
+        long currentTime = SystemClock.uptimeMillis();
+
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+
+        TimeRecord record = subject.getRecordForAdUnit(AD_UNIT_1);
+        assertNotNull(record);
+        assertThat(record.mBlockIntervalMs).isEqualTo(BACKOFF_TIME);
+        assertThat(record.mReason).isEqualTo(REASON);
+        assertThat(record.mBlockStartTime - currentTime).isLessThan(DELTA);
+    }
+
+    @Test
+    public void registerRateLimit_withEmptyAdUnit_shouldDoNothing() {
+        long currentTime = SystemClock.uptimeMillis();
+
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+        subject.registerRateLimit("", BACKOFF_TIME, REASON);
+
+        assertNull(subject.getRecordForAdUnit(""));
+
+        TimeRecord record = subject.getRecordForAdUnit(AD_UNIT_1);
+        assertNotNull(record);
+        assertThat(record.mBlockIntervalMs).isEqualTo(BACKOFF_TIME);
+        assertThat(record.mReason).isEqualTo(REASON);
+        assertThat(record.mBlockStartTime - currentTime).isLessThan(DELTA);
+    }
+
+    @Test
+    public void registerRateLimit_withNegativeBackoffTime_shouldResetAdUnit() {
+        long currentTime = SystemClock.uptimeMillis();
+
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+
+        TimeRecord record = subject.getRecordForAdUnit(AD_UNIT_1);
+        assertNotNull(record);
+        assertThat(record.mBlockIntervalMs).isEqualTo(BACKOFF_TIME);
+        assertThat(record.mReason).isEqualTo(REASON);
+        assertThat(record.mBlockStartTime - currentTime).isLessThan(DELTA);
+
+        subject.registerRateLimit(AD_UNIT_1, -1, REASON2);
+        assertNull(subject.getRecordForAdUnit(AD_UNIT_1));
+    }
+
+    @Test
+    public void registerRateLimit_withTwoAdUnits_shouldStoreBoth() {
+        long currentTime = SystemClock.uptimeMillis();
+
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+        subject.registerRateLimit(AD_UNIT_2, 66, REASON2);
+
+        TimeRecord record1 = subject.getRecordForAdUnit(AD_UNIT_1);
+        assertNotNull(record1);
+        assertThat(record1.mBlockIntervalMs).isEqualTo(BACKOFF_TIME);
+        assertThat(record1.mReason).isEqualTo(REASON);
+        assertThat(record1.mBlockStartTime - currentTime).isLessThan(DELTA);
+
+        TimeRecord record2 = subject.getRecordForAdUnit(AD_UNIT_2);
+        assertNotNull(record2);
+        assertThat(record2.mBlockIntervalMs).isEqualTo(66);
+        assertThat(record2.mReason).isEqualTo(REASON2);
+        assertThat(record2.mBlockStartTime - currentTime).isLessThan(DELTA);
+    }
+
+    @Test
+    public void registerRateLimit_withTwoAdUnits_deleteSecondAdUnit_shouldNotDeleteFirst() {
+        long currentTime = SystemClock.uptimeMillis();
+
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+        subject.registerRateLimit(AD_UNIT_2, 66, REASON2);
+
+        TimeRecord record1 = subject.getRecordForAdUnit(AD_UNIT_1);
+        assertNotNull(record1);
+        assertThat(record1.mBlockIntervalMs).isEqualTo(BACKOFF_TIME);
+        assertThat(record1.mReason).isEqualTo(REASON);
+        assertThat(record1.mBlockStartTime - currentTime).isLessThan(DELTA);
+
+        TimeRecord record2 = subject.getRecordForAdUnit(AD_UNIT_2);
+        assertNotNull(record2);
+        assertThat(record2.mBlockIntervalMs).isEqualTo(66);
+        assertThat(record2.mReason).isEqualTo(REASON2);
+        assertThat(record2.mBlockStartTime - currentTime).isLessThan(DELTA);
+
+        subject.registerRateLimit(AD_UNIT_2, 0, "");
+
+        assertNull(subject.getRecordForAdUnit(AD_UNIT_2));
+        assertThat(subject.getRecordForAdUnit(AD_UNIT_1)).isEqualTo(record1);
+    }
+
+    @Test
+    public void getRecordForAdUnit_withNullAdUnitId_shouldReturnNull() {
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+
+        assertNull(subject.getRecordForAdUnit(null));
+    }
+
+    @Test
+    public void getRecordForAdUnit_withEmptyStringAdUnitId_shouldReturnNull() {
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+
+        assertNull(subject.getRecordForAdUnit(""));
+    }
+
+    @Test
+    public void isBlockedByRateLimit_afterRateLimitSetToZero_shouldReturnFalse() {
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isFalse();
+
+        subject.registerRateLimit(AD_UNIT_1, 0, NO_BACKOFF);
+
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isFalse();
+    }
+
+    @Test
+    public void isBlockedByRateLimit_afterRateLimitSet_shouldReturnTrue() {
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isFalse();
+
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isTrue();
+    }
+
+    @Test
+    public void isBlockedByRateLimit_afterFailedResponse_afterSuccessResponse_shouldReturnTrue() {
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isFalse();
+
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+        subject.registerRateLimit(AD_UNIT_1, 0, NO_BACKOFF);
+
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isFalse();
+    }
+
+    @Test
+    public void isBlockedByRateLimit_withTwoAdUnits_adUnitsDoNotInterfere() {
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isFalse();
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_2)).isFalse();
+
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isTrue();
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_2)).isFalse();
+
+        subject.registerRateLimit(AD_UNIT_2, 0, NO_BACKOFF);
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isTrue();
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_2)).isFalse();
+
+        subject.registerRateLimit(AD_UNIT_1, 0, NO_BACKOFF);
+        subject.registerRateLimit(AD_UNIT_2, BACKOFF_TIME, REASON);
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isFalse();
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_2)).isTrue();
+    }
+
+    @Test
+    public void isBlockedByRateLimit_afterFailedResponse_afterTimeoutExpires_returnsTrue() {
+        subject.registerRateLimit(AD_UNIT_1, BACKOFF_TIME, REASON);
+
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isTrue();
+        Robolectric.getForegroundThreadScheduler().advanceBy(BACKOFF_TIME * 2, TimeUnit.MILLISECONDS);
+        assertThat(subject.isBlockedByRateLimit(AD_UNIT_1)).isFalse();
+    }
+
+    /**
+     * Utility functions
+     */
+    public static void prepareRequestRateTracker(String adUnitId, Integer backoffMs, String backoffReason) {
+        RequestRateTracker.getInstance().registerRateLimit(adUnitId, backoffMs, backoffReason);
+    }
+
+    public static void clearRequestRateTracker() {
+        RequestRateTracker.setInstance(new RequestRateTracker());
+    }
+}
diff --git a/mopub-sdk/src/test/java/com/mopub/network/SingleImpressionTest.java b/mopub-sdk/src/test/java/com/mopub/network/SingleImpressionTest.java
new file mode 100644
index 00000000..b5d15cc0
--- /dev/null
+++ b/mopub-sdk/src/test/java/com/mopub/network/SingleImpressionTest.java
@@ -0,0 +1,44 @@
+// Copyright 2018-2019 Twitter, Inc.
+// Licensed under the MoPub SDK License Agreement
+// http://www.mopub.com/legal/sdk-license-agreement/
+
+package com.mopub.network;
+
+import com.mopub.common.test.support.SdkTestRunner;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import static org.mockito.Matchers.any;
+import static org.mockito.Matchers.anyString;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+@RunWith(SdkTestRunner.class)
+public class SingleImpressionTest {
+
+    @Test
+    public void sendImpression_makesCallToImpressionEmitter() {
+        ImpressionData data = mock(ImpressionData.class);
+        ImpressionListener listener = mock(ImpressionListener.class);
+        ImpressionsEmitter.addListener(listener);
+        SingleImpression subject = new SingleImpression("ad_unit_id", data);
+
+        subject.sendImpression();
+
+        verify(listener).onImpression("ad_unit_id", data);
+    }
+
+    @Test
+    public void sendImpression_withNullAdUnitId_shouldNotCallImpressionEmitter() {
+        ImpressionData data = mock(ImpressionData.class);
+        ImpressionListener listener = mock(ImpressionListener.class);
+        ImpressionsEmitter.addListener(listener);
+        SingleImpression subject = new SingleImpression(null, data);
+
+        subject.sendImpression();
+
+        verify(listener, never()).onImpression(anyString(), any(ImpressionData.class));
+    }
+}
