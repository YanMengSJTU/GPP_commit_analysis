diff --git a/build.gradle b/build.gradle
index b347d7d953..a6a88d3f49 100644
--- a/build.gradle
+++ b/build.gradle
@@ -7,6 +7,7 @@ buildscript {
       'animalSniffer': '1.17',
       'assertj': '3.11.0',
       'bouncycastle': '1.62',
+      'brotli': '0.1.2',
       'checkstyle': '8.15',
       'conscrypt': '2.1.0',
       'findbugs': '3.0.2',
@@ -15,7 +16,7 @@ buildscript {
       'jnrUnixsocket': '0.22',
       'jsoup': '1.11.3',
       'junit': '4.12',
-      'kotlin': '1.3.40',
+      'kotlin': '1.3.41',
       'moshi': '1.8.0',
       'okio': '2.2.2',
       'ktlint': '0.31.0'
@@ -27,6 +28,7 @@ buildscript {
       'animalSniffer': "org.codehaus.mojo:animal-sniffer-annotations:${versions.animalSniffer}",
       'assertj': "org.assertj:assertj-core:${versions.assertj}",
       'bouncycastle': "org.bouncycastle:bcprov-jdk15on:${versions.bouncycastle}",
+      'brotli': "org.brotli:dec:${versions.brotli}",
       'conscrypt': "org.conscrypt:conscrypt-openjdk-uber:${versions.conscrypt}",
       'guava': "com.google.guava:guava:${versions.guava}",
       'jnrUnixsocket': "com.github.jnr:jnr-unixsocket:${versions.jnrUnixsocket}",
diff --git a/gradle/wrapper/gradle-wrapper.properties b/gradle/wrapper/gradle-wrapper.properties
index ed5aaee4f8..e0c4de36dd 100644
--- a/gradle/wrapper/gradle-wrapper.properties
+++ b/gradle/wrapper/gradle-wrapper.properties
@@ -1,5 +1,5 @@
 distributionBase=GRADLE_USER_HOME
 distributionPath=wrapper/dists
-distributionUrl=https\://services.gradle.org/distributions/gradle-5.4-all.zip
+distributionUrl=https\://services.gradle.org/distributions/gradle-5.5-all.zip
 zipStoreBase=GRADLE_USER_HOME
 zipStorePath=wrapper/dists
diff --git a/gradlew b/gradlew
index b0d6d0ab5d..8e25e6c19d 100755
--- a/gradlew
+++ b/gradlew
@@ -7,7 +7,7 @@
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
-#      http://www.apache.org/licenses/LICENSE-2.0
+#      https://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
diff --git a/gradlew.bat b/gradlew.bat
index 15e1ee37a7..24467a141f 100644
--- a/gradlew.bat
+++ b/gradlew.bat
@@ -5,7 +5,7 @@
 @rem you may not use this file except in compliance with the License.
 @rem You may obtain a copy of the License at
 @rem
-@rem      http://www.apache.org/licenses/LICENSE-2.0
+@rem      https://www.apache.org/licenses/LICENSE-2.0
 @rem
 @rem Unless required by applicable law or agreed to in writing, software
 @rem distributed under the License is distributed on an "AS IS" BASIS,
diff --git a/okhttp-brotli/README.md b/okhttp-brotli/README.md
new file mode 100644
index 0000000000..4f8e802fd2
--- /dev/null
+++ b/okhttp-brotli/README.md
@@ -0,0 +1,4 @@
+OkHttp Brotli Implementation
+============================
+
+This module is an implementation of Brotli compression.
diff --git a/okhttp-brotli/build.gradle b/okhttp-brotli/build.gradle
new file mode 100644
index 0000000000..c04a996383
--- /dev/null
+++ b/okhttp-brotli/build.gradle
@@ -0,0 +1,19 @@
+apply plugin: 'com.vanniktech.maven.publish'
+
+jar {
+  manifest {
+    attributes('Automatic-Module-Name': 'okhttp3.brotli')
+  }
+}
+
+dependencies {
+  api project(':okhttp')
+  api deps.brotli
+  compileOnly deps.jsr305
+
+  testImplementation project(':okhttp-testing-support')
+  testImplementation project(':mockwebserver')
+  testImplementation deps.conscrypt
+  testImplementation deps.junit
+  testImplementation deps.assertj
+}
diff --git a/okhttp-brotli/gradle.properties b/okhttp-brotli/gradle.properties
new file mode 100644
index 0000000000..dc6217c482
--- /dev/null
+++ b/okhttp-brotli/gradle.properties
@@ -0,0 +1,3 @@
+POM_ARTIFACT_ID=okhttp-brotli
+POM_NAME=okhttp-brotli
+POM_PACKAGING=jar
diff --git a/okhttp-brotli/src/main/java/okhttp3/brotli/BrotliInterceptor.kt b/okhttp-brotli/src/main/java/okhttp3/brotli/BrotliInterceptor.kt
new file mode 100644
index 0000000000..ab4e18220e
--- /dev/null
+++ b/okhttp-brotli/src/main/java/okhttp3/brotli/BrotliInterceptor.kt
@@ -0,0 +1,64 @@
+/*
+ * Copyright (C) 2019 Square, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package okhttp3.brotli
+
+import okhttp3.Interceptor
+import okhttp3.Response
+import okhttp3.ResponseBody.Companion.asResponseBody
+import okio.GzipSource
+import okio.buffer
+import okio.source
+import org.brotli.dec.BrotliInputStream
+
+/**
+ * Transparent Brotli response support.
+ *
+ * Adds Accept-Encoding: br to request and checks (and strips) for Content-Encoding: br in
+ * responses.  n.b. this replaces the transparent gzip compression in BridgeInterceptor.
+ */
+object BrotliInterceptor : Interceptor {
+  override fun intercept(chain: Interceptor.Chain): Response =
+      if (chain.request().header("Accept-Encoding") == null) {
+        val request = chain.request().newBuilder()
+            .header("Accept-Encoding", "br,gzip")
+            .build()
+
+        val response = chain.proceed(request)
+
+        uncompress(response)
+      } else {
+        chain.proceed(chain.request())
+      }
+
+  internal fun uncompress(response: Response): Response {
+    val body = response.body ?: return response
+    val encoding = response.header("Content-Encoding") ?: return response
+
+    val decompressedSource = when {
+      encoding.equals("br", ignoreCase = true) ->
+        BrotliInputStream(body.source().inputStream()).source().buffer()
+      encoding.equals("gzip", ignoreCase = true) ->
+        GzipSource(body.source()).buffer()
+      else -> return response
+    }
+
+    return response.newBuilder()
+        .removeHeader("Content-Encoding")
+        .removeHeader("Content-Length")
+        .body(decompressedSource.asResponseBody(body.contentType(), -1))
+        .build()
+  }
+}
diff --git a/okhttp-brotli/src/test/java/okhttp3/brotli/BrotliInterceptorJavaApiTest.java b/okhttp-brotli/src/test/java/okhttp3/brotli/BrotliInterceptorJavaApiTest.java
new file mode 100644
index 0000000000..9b0efd0b11
--- /dev/null
+++ b/okhttp-brotli/src/test/java/okhttp3/brotli/BrotliInterceptorJavaApiTest.java
@@ -0,0 +1,26 @@
+/*
+ * Copyright (C) 2019 Square, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package okhttp3.brotli;
+
+import org.junit.Ignore;
+import org.junit.Test;
+
+public class BrotliInterceptorJavaApiTest {
+  @Test @Ignore
+  public void testApi() {
+    BrotliInterceptor.INSTANCE.intercept(null);
+  }
+}
diff --git a/okhttp-brotli/src/test/java/okhttp3/brotli/BrotliInterceptorTest.kt b/okhttp-brotli/src/test/java/okhttp3/brotli/BrotliInterceptorTest.kt
new file mode 100644
index 0000000000..c4e16e6b9d
--- /dev/null
+++ b/okhttp-brotli/src/test/java/okhttp3/brotli/BrotliInterceptorTest.kt
@@ -0,0 +1,112 @@
+/*
+ * Copyright (C) 2019 Square, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package okhttp3.brotli
+
+import okhttp3.MediaType.Companion.toMediaType
+import okhttp3.Protocol
+import okhttp3.Request
+import okhttp3.Response
+import okhttp3.ResponseBody.Companion.toResponseBody
+import okio.ByteString
+import okio.ByteString.Companion.decodeHex
+import okio.ByteString.Companion.encodeUtf8
+import org.assertj.core.api.Assertions.assertThat
+import org.junit.Assert.fail
+import org.junit.Test
+import java.io.IOException
+
+class BrotliInterceptorTest {
+  @Test
+  fun testUncompressBrotli() {
+    val s =
+        "1bce00009c05ceb9f028d14e416230f718960a537b0922d2f7b6adef56532c08dff44551516690131494db" +
+            "6021c7e3616c82c1bc2416abb919aaa06e8d30d82cc2981c2f5c900bfb8ee29d5c03deb1c0dacff80e" +
+            "abe82ba64ed250a497162006824684db917963ecebe041b352a3e62d629cc97b95cac24265b175171e" +
+            "5cb384cd0912aeb5b5dd9555f2dd1a9b20688201"
+
+    val response = response("https://httpbin.org/brotli", s.decodeHex()) {
+      header("Content-Encoding", "br")
+    }
+
+    val uncompressed = BrotliInterceptor.uncompress(response)
+
+    val responseString = uncompressed.body?.string()
+    assertThat(responseString).contains("\"brotli\": true,")
+    assertThat(responseString).contains("\"Accept-Encoding\": \"br\"")
+  }
+
+  @Test
+  fun testUncompressGzip() {
+    val s =
+        "1f8b0800968f215d02ff558ec10e82301044ef7c45b3e75269d0c478e340e4a426e007086c4a636c9bb65e" +
+            "24fcbb5b484c3cec61deccecee9c3106eaa39dc3114e2cfa377296d8848f117d20369324500d03ba98" +
+            "d766b0a3368a0ce83d4f55581b14696c88894f31ba5e1b61bdfa79f7803eaf149a35619f29b3db0b29" +
+            "8abcbd54b7b6b97640c965bbfec238d9f4109ceb6edb01d66ba54d6247296441531e445970f627215b" +
+            "b22f1017320dd5000000"
+
+    val response = response("https://httpbin.org/gzip", s.decodeHex()) {
+      header("Content-Encoding", "gzip")
+    }
+
+    val uncompressed = BrotliInterceptor.uncompress(response)
+
+    val responseString = uncompressed.body?.string()
+    assertThat(responseString).contains("\"gzipped\": true,")
+    assertThat(responseString).contains("\"Accept-Encoding\": \"br,gzip\"")
+  }
+
+  @Test
+  fun testNoUncompress() {
+    val response = response("https://httpbin.org/brotli", "XXXX".encodeUtf8())
+
+    val same = BrotliInterceptor.uncompress(response)
+
+    val responseString = same.body?.string()
+    assertThat(responseString).isEqualTo("XXXX")
+  }
+
+  @Test
+  fun testFailsUncompress() {
+    val response = response("https://httpbin.org/brotli", "bb919aaa06e8".decodeHex()) {
+      header("Content-Encoding", "br")
+    }
+
+    try {
+      val failingResponse = BrotliInterceptor.uncompress(response)
+      failingResponse.body?.string()
+
+      fail("expected uncompress error")
+    } catch (ioe: IOException) {
+      assertThat(ioe).hasMessage("Brotli stream decoding failed")
+      assertThat(ioe.cause?.javaClass?.simpleName).isEqualTo("BrotliRuntimeException")
+    }
+  }
+
+  private fun response(
+    url: String,
+    bodyHex: ByteString,
+    fn: Response.Builder.() -> Unit = {}
+  ): Response {
+    return Response.Builder()
+        .body(bodyHex.toResponseBody("text/plain".toMediaType()))
+        .code(200)
+        .message("OK")
+        .request(Request.Builder().url(url).build())
+        .protocol(Protocol.HTTP_2)
+        .apply(fn)
+        .build()
+  }
+}
diff --git a/okhttp-brotli/src/test/java/okhttp3/brotli/BrotliTestMain.kt b/okhttp-brotli/src/test/java/okhttp3/brotli/BrotliTestMain.kt
new file mode 100644
index 0000000000..bfae423ee1
--- /dev/null
+++ b/okhttp-brotli/src/test/java/okhttp3/brotli/BrotliTestMain.kt
@@ -0,0 +1,36 @@
+/*
+ * Copyright (C) 2019 Square, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package okhttp3.brotli
+
+import okhttp3.OkHttpClient
+import okhttp3.Request
+
+fun main() {
+  val client = OkHttpClient.Builder()
+      .addInterceptor(BrotliInterceptor)
+      .build()
+
+  sendRequest("https://httpbin.org/brotli", client)
+  sendRequest("https://httpbin.org/gzip", client)
+}
+
+private fun sendRequest(url: String, client: OkHttpClient) {
+  val req = Request.Builder().url(url).build()
+
+  client.newCall(req).execute().use {
+    println(it.body?.string())
+  }
+}
\ No newline at end of file
diff --git a/okhttp/src/main/java/okhttp3/internal/ws/WebSocketProtocol.kt b/okhttp/src/main/java/okhttp3/internal/ws/WebSocketProtocol.kt
index 5da8abcc50..58bdda788d 100644
--- a/okhttp/src/main/java/okhttp3/internal/ws/WebSocketProtocol.kt
+++ b/okhttp/src/main/java/okhttp3/internal/ws/WebSocketProtocol.kt
@@ -122,7 +122,7 @@ object WebSocketProtocol {
   fun closeCodeExceptionMessage(code: Int): String? {
     return if (code < 1000 || code >= 5000) {
       "Code must be in range [1000,5000): $code"
-    } else if (code in 1004..1006 || code in 1012..2999) {
+    } else if (code in 1004..1006 || code in 1015..2999) {
       "Code $code is reserved and may not be used."
     } else {
       null
diff --git a/okhttp/src/test/java/okhttp3/URLConnectionTest.java b/okhttp/src/test/java/okhttp3/URLConnectionTest.java
index 12de750610..0d09236762 100644
--- a/okhttp/src/test/java/okhttp3/URLConnectionTest.java
+++ b/okhttp/src/test/java/okhttp3/URLConnectionTest.java
@@ -689,7 +689,6 @@ private void connectViaHttpsReusingConnections(boolean rebuildClient) throws Exc
    */
   @Test public void connectViaHttpsToUntrustedServer() throws Exception {
     // https://github.com/square/okhttp/issues/5222
-    platform.expectFailureOnConscryptPlatform();
 
     server.useHttps(handshakeCertificates.sslSocketFactory(), false);
     server.enqueue(new MockResponse()); // unused
diff --git a/okhttp/src/test/java/okhttp3/internal/ws/WebSocketReaderTest.java b/okhttp/src/test/java/okhttp3/internal/ws/WebSocketReaderTest.java
index efe061cee1..02995e30df 100644
--- a/okhttp/src/test/java/okhttp3/internal/ws/WebSocketReaderTest.java
+++ b/okhttp/src/test/java/okhttp3/internal/ws/WebSocketReaderTest.java
@@ -298,7 +298,7 @@
     data.write(ByteString.decodeHex("880203ec")); // Close with code 1004
     data.write(ByteString.decodeHex("880203ed")); // Close with code 1005
     data.write(ByteString.decodeHex("880203ee")); // Close with code 1006
-    for (int i = 1012; i <= 2999; i++) {
+    for (int i = 1015; i <= 2999; i++) {
       data.write(ByteString.decodeHex(
           "8802" + Util.format("%04X", i))); // Close with code 'i'
     }
@@ -312,7 +312,7 @@
         assertThat(e.getMessage()).matches("Code \\d+ is reserved and may not be used.");
       }
     }
-    assertThat(count).isEqualTo(1991);
+    assertThat(count).isEqualTo(1988);
   }
 
   private byte[] binaryData(int length) {
diff --git a/settings.gradle b/settings.gradle
index 367bee6364..17da3db548 100644
--- a/settings.gradle
+++ b/settings.gradle
@@ -1,6 +1,7 @@
 include ':mockwebserver'
 include ':okcurl'
 include ':okhttp'
+include ':okhttp-brotli'
 include ':okhttp-dnsoverhttps'
 include ':okhttp-hpacktests'
 include ':okhttp-logging-interceptor'
