diff --git a/tinker-build/tinker-patch-cli/src/main/java/com/tencent/tinker/patch/CliMain.java b/tinker-build/tinker-patch-cli/src/main/java/com/tencent/tinker/patch/CliMain.java
index 37dbf0b1..0a34b169 100644
--- a/tinker-build/tinker-patch-cli/src/main/java/com/tencent/tinker/patch/CliMain.java
+++ b/tinker-build/tinker-patch-cli/src/main/java/com/tencent/tinker/patch/CliMain.java
@@ -38,11 +38,11 @@
  * do not use Logger here
  */
 public class CliMain extends Runner {
-    private static final String ARG_HELP   = "--help";
-    private static final String ARG_OUT    = "-out";
+    private static final String ARG_HELP = "--help";
+    private static final String ARG_OUT = "-out";
     private static final String ARG_CONFIG = "-config";
-    private static final String ARG_OLD    = "-old";
-    private static final String ARG_NEW    = "-new";
+    private static final String ARG_OLD = "-old";
+    private static final String ARG_NEW = "-new";
 
 
     protected static String mRunningLocation;
@@ -92,10 +92,20 @@ private void run(String[] args) {
             if (oldApkFile == null || newApkFile == null) {
                 Logger.e("Missing old apk or new apk file argument");
                 goToError();
+            } else if (!oldApkFile.exists() || !newApkFile.exists()) {
+                Logger.e("Old apk or new apk file does not exist");
+                goToError();
             }
 
             if (outputFile == null) {
                 outputFile = new File(mRunningLocation, TypedValue.PATH_DEFAULT_OUTPUT);
+            } else {
+                File[] files = outputFile.listFiles();
+                if (files != null && files.length > 0) {
+                    // 注:需要用户指定的目录为空的,否则在创建补丁过程中会删除里面的文件
+                    Logger.e("Output folder is not empty");
+                    goToError();
+                }
             }
 
             loadConfigFromXml(configFile, outputFile, oldApkFile, newApkFile);
@@ -137,10 +147,10 @@ public void goToError() {
 
     private class ReadArgs {
         private String[] args;
-        private File     configFile;
-        private File     outputFile;
-        private File     oldApkFile;
-        private File     newApkFile;
+        private File configFile;
+        private File outputFile;
+        private File oldApkFile;
+        private File newApkFile;
 
         ReadArgs(String[] args) {
             this.args = args;
diff --git a/tinker-build/tinker-patch-lib/src/main/java/com/tencent/tinker/build/util/Logger.java b/tinker-build/tinker-patch-lib/src/main/java/com/tencent/tinker/build/util/Logger.java
index 965b87c8..1f4d0b25 100644
--- a/tinker-build/tinker-patch-lib/src/main/java/com/tencent/tinker/build/util/Logger.java
+++ b/tinker-build/tinker-patch-lib/src/main/java/com/tencent/tinker/build/util/Logger.java
@@ -34,7 +34,9 @@ public static void initLogger(Configuration config) throws IOException {
     }
 
     public static void closeLogger() {
-        logWriter.close();
+        if (logWriter != null) {
+            logWriter.close();
+        }
     }
 
     public static void d(final String msg) {
@@ -64,7 +66,9 @@ public static void e(final String format, final Object... obj) {
         }
         //add \n
         System.err.printf(log + "\n");
-        logWriter.writeLineToInfoFile(log);
+        if (logWriter != null) {
+            logWriter.writeLineToInfoFile(log);
+        }
 
     }
 
