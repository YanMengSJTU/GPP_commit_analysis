diff --git a/client/src/main/java/org/asynchttpclient/netty/channel/CurrentBk.java b/client/src/main/java/org/asynchttpclient/netty/channel/CurrentBk.java
new file mode 100644
index 000000000..ee03cacb3
--- /dev/null
+++ b/client/src/main/java/org/asynchttpclient/netty/channel/CurrentBk.java
@@ -0,0 +1,14 @@
+package org.asynchttpclient.netty.channel;
+
+public class CurrentBk {
+
+    private static int bkId = 0;
+
+    public static void setBkId(int id) {
+        bkId = id;
+    }
+
+    public static int getBkId() {
+        return bkId;
+    }
+}
diff --git a/client/src/main/java/org/asynchttpclient/netty/channel/MyWebSocketClientCompressionHandler.java b/client/src/main/java/org/asynchttpclient/netty/channel/MyWebSocketClientCompressionHandler.java
index 058ec13b9..bb78278bc 100644
--- a/client/src/main/java/org/asynchttpclient/netty/channel/MyWebSocketClientCompressionHandler.java
+++ b/client/src/main/java/org/asynchttpclient/netty/channel/MyWebSocketClientCompressionHandler.java
@@ -3,7 +3,6 @@
 import io.netty.channel.ChannelHandler.Sharable;
 import io.netty.handler.codec.compression.ZlibCodecFactory;
 import io.netty.handler.codec.http.websocketx.extensions.WebSocketClientExtensionHandler;
-import io.netty.handler.codec.http.websocketx.extensions.WebSocketClientExtensionHandshaker;
 import io.netty.handler.codec.http.websocketx.extensions.compression.DeflateFrameClientExtensionHandshaker;
 import io.netty.handler.codec.http.websocketx.extensions.compression.PerMessageDeflateClientExtensionHandshaker;
 
@@ -17,7 +16,13 @@
     public static final MyWebSocketClientCompressionHandler INSTANCE = new MyWebSocketClientCompressionHandler();
 
     private MyWebSocketClientCompressionHandler() {
-        super(new PerMessageDeflateClientExtensionHandshaker(6, ZlibCodecFactory.isSupportingWindowSizeAndMemLevel(), 15, true, true),
+        super(new PerMessageDeflateClientExtensionHandshaker(
+                6,
+                        ZlibCodecFactory.isSupportingWindowSizeAndMemLevel(),
+                        15,
+                        true,
+                        CurrentBk.getBkId() == 10
+                ),
                 new DeflateFrameClientExtensionHandshaker(false),
                 new DeflateFrameClientExtensionHandshaker(true));
     }
