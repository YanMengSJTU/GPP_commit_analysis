diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatBaseCell.java b/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatBaseCell.java
index 0f865a380..2038e7271 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatBaseCell.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatBaseCell.java
@@ -11,6 +11,7 @@
 import android.annotation.SuppressLint;
 import android.content.Context;
 import android.graphics.Canvas;
+import android.graphics.Color;
 import android.graphics.drawable.Drawable;
 import android.text.Html;
 import android.text.Layout;
@@ -22,16 +23,14 @@
 
 import com.teamjihu.ThemeManager;
 
-import com.teamjihu.ThemeManager;
-
 import org.telegram.android.AndroidUtilities;
 import org.telegram.android.ContactsController;
+import org.telegram.android.ImageReceiver;
 import org.telegram.android.LocaleController;
-import org.telegram.messenger.TLRPC;
+import org.telegram.android.MessageObject;
 import org.telegram.android.MessagesController;
+import org.telegram.messenger.TLRPC;
 import org.telegram.messenger.phonethemeshop.R;
-import org.telegram.android.MessageObject;
-import org.telegram.android.ImageReceiver;
 
 public class ChatBaseCell extends BaseCell {
 
@@ -338,6 +337,9 @@ public void setMessageObject(MessageObject messageObject) {
 
         namesOffset = 0;
 
+        if ( media )
+            drawName = true;
+
         if (drawName && isChat && currentUser != null && !currentMessageObject.isOut()) {
             currentNameString = ContactsController.formatName(currentUser.first_name, currentUser.last_name);
             nameWidth = getMaxNameWidth();
@@ -466,6 +468,7 @@ protected void onLayout(boolean changed, int left, int top, int right, int botto
             layoutHeight = getMeasuredHeight();
 
             timeLayout = new StaticLayout(currentTimeString, currentTimePaint, timeWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
+
             if (!media) {
                 if (!currentMessageObject.isOut()) {
                     timeX = backgroundWidth - AndroidUtilities.dp(9) - timeWidth + (isChat ? AndroidUtilities.dp(52) : 0);
@@ -478,6 +481,22 @@ protected void onLayout(boolean changed, int left, int top, int right, int botto
                 } else {
                     timeX = layoutWidth - timeWidth - AndroidUtilities.dpf(42.0f);
                 }
+
+                //get user name
+                if (drawName && isChat && currentUser != null && !currentMessageObject.isOut()) {
+                    currentNameString = ContactsController.formatName(currentUser.first_name, currentUser.last_name);
+                    nameWidth = getMaxNameWidth();
+
+                    CharSequence nameStringFinal = TextUtils.ellipsize(currentNameString.replace("\n", " "), namePaint, nameWidth - AndroidUtilities.dp(12), TextUtils.TruncateAt.END);
+                    nameLayout = new StaticLayout(nameStringFinal, namePaint, nameWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
+                    if (nameLayout.getLineCount() > 0) {
+                        nameWidth = (int)Math.ceil(nameLayout.getLineWidth(0));
+                        namesOffset += AndroidUtilities.dp(18);
+                        nameOffsetX = nameLayout.getLineLeft(0);
+                    } else {
+                        nameWidth = 0;
+                    }
+                }
             }
 
             if (isAvatarVisible) {
@@ -558,11 +577,23 @@ protected void onDraw(Canvas canvas) {
         onAfterBackgroundDraw(canvas);
 
         if (drawName && nameLayout != null) {
-            canvas.save();
-            canvas.translate(currentBackgroundDrawable.getBounds().left + AndroidUtilities.dp(19) - nameOffsetX, AndroidUtilities.dp(10));
-            namePaint.setColor(AndroidUtilities.getColorForId(currentUser.id));
-            nameLayout.draw(canvas);
-            canvas.restore();
+            if ( media && nameLayout.getText() != "" ) {
+                setDrawableBounds(mediaBackgroundDrawable, currentBackgroundDrawable.getBounds().left + AndroidUtilities.dp(7) - (int)nameOffsetX,
+                        AndroidUtilities.dp(8), nameWidth + AndroidUtilities.dp(4), AndroidUtilities.dpf(17.5f));
+                mediaBackgroundDrawable.draw(canvas);
+
+                canvas.save();
+                canvas.translate(currentBackgroundDrawable.getBounds().left + AndroidUtilities.dp(9) - nameOffsetX, AndroidUtilities.dp(8));
+                namePaint.setColor(Color.WHITE);
+                nameLayout.draw(canvas);
+                canvas.restore();
+            } else {
+                canvas.save();
+                canvas.translate(currentBackgroundDrawable.getBounds().left + AndroidUtilities.dp(19) - nameOffsetX, AndroidUtilities.dp(10));
+                namePaint.setColor(AndroidUtilities.getColorForId(currentUser.id));
+                nameLayout.draw(canvas);
+                canvas.restore();
+            }
         }
 
         if (drawForwardedName && forwardedNameLayout != null) {
@@ -577,7 +608,7 @@ protected void onDraw(Canvas canvas) {
                 forwardNameY = AndroidUtilities.dp(10 + (drawName ? 18 : 0));
             }
             canvas.translate(forwardNameX - forwardNameOffsetX, forwardNameY);
-            forwardedNameLayout.draw(canvas);
+            //forwardedNameLayout.draw(canvas);
             canvas.restore();
         }
 
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Views/ChatActivityEnterView.java b/TMessagesProj/src/main/java/org/telegram/ui/Views/ChatActivityEnterView.java
index d8b6b26dc..c96758df8 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Views/ChatActivityEnterView.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Views/ChatActivityEnterView.java
@@ -146,8 +146,18 @@ public void setContainerView(Activity activity, View containerView, ChatActivity
         messsageEditText = (EditText)containerView.findViewById(R.id.chat_text_edit);
         messsageEditText.setHint(LocaleController.getString("TypeMessage", R.string.TypeMessage));
 
-        zzalButton = (ImageButton)containerView.findViewById(R.id.chat_zzal_button);
-        zzalButton.setImageDrawable(themeManager.getDrawable("ic_zzal", false));
+        if ( chatActivity != null ) {
+            zzalButton = (ImageButton) containerView.findViewById(R.id.chat_zzal_button);
+            zzalButton.setImageDrawable(themeManager.getDrawable("ic_zzal", false));
+
+            zzalButton.setOnClickListener(new View.OnClickListener() {
+                @Override
+                public void onClick(View view) {
+                    if ( chatActivity != null )
+                        chatActivity.presentFragment(new ZzalActivity(chatActivity));
+                }
+            });
+        }
         sendButton = (ImageButton)containerView.findViewById(R.id.chat_send_button);
         sendButton.setImageDrawable(themeManager.getDrawable("ic_send", false));
         sendButton.setVisibility(View.INVISIBLE);
@@ -161,13 +171,6 @@ public void setContainerView(Activity activity, View containerView, ChatActivity
         TextView textView = (TextView)containerView.findViewById(R.id.slideToCancelTextView);
         textView.setText(LocaleController.getString("SlideToCancel", R.string.SlideToCancel));
 
-        zzalButton.setOnClickListener(new View.OnClickListener() {
-            @Override
-            public void onClick(View view) {
-                if ( chatActivity != null )
-                    chatActivity.presentFragment(new ZzalActivity(chatActivity));
-            }
-        });
 
         emojiButton.setOnClickListener(new View.OnClickListener() {
             @Override
