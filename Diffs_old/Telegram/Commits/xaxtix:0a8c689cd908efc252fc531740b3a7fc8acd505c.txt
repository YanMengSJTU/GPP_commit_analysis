diff --git a/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java
index 1a0816e31..b86749264 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java
@@ -11382,15 +11382,11 @@ public void onResume() {
 
         fixLayout();
         applyDraftMaybe(false);
-        if (bottomOverlayChat != null && bottomOverlayChat.getVisibility() != View.VISIBLE && !actionBar.isSearchFieldVisible()) {
+        if (bottomOverlayChat != null && bottomOverlayChat.getVisibility() != View.VISIBLE && !actionBar.isSearchFieldVisible() && ChatObject.canWriteToChat(currentChat)) {
             chatActivityEnterView.setFieldFocused(true);
         }
         if (chatActivityEnterView != null) {
             chatActivityEnterView.onResume();
-            if(ChatObject.canWriteToChat(currentChat)) {
-                EditTextCaption editTextCaption = chatActivityEnterView.getEditField();
-                editTextCaption.clearFocus();
-            }
         }
         if (currentUser != null) {
             chatEnterTime = System.currentTimeMillis();
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java b/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java
index 0c2d8c3b1..76d4aa0f2 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Components/ChatActivityEnterView.java
@@ -2990,7 +2990,7 @@ public void setFieldFocused(boolean focus) {
                     } else {
                         allowFocus = true;
                     }
-                    if (allowFocus && messageEditText != null) {
+                    if (allowFocus && messageEditText != null && messageEditText.getVisibility() == VISIBLE) {
                         try {
                             messageEditText.requestFocus();
                         } catch (Exception e) {
