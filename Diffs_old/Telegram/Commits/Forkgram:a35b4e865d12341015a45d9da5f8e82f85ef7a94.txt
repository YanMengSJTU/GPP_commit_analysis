diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Components/ShareAlert.java b/TMessagesProj/src/main/java/org/telegram/ui/Components/ShareAlert.java
index a96f8473a..91fc914ee 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Components/ShareAlert.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Components/ShareAlert.java
@@ -1047,6 +1047,10 @@ public void dismiss() {
         NotificationCenter.getInstance(currentAccount).removeObserver(this, NotificationCenter.dialogsNeedReload);
     }
 
+    interface SortArchived {
+        void sort(boolean archived);
+    }
+
     private class ShareDialogsAdapter extends RecyclerListView.SelectionAdapter {
 
         private Context context;
@@ -1069,11 +1073,18 @@ public void fetchDialogs() {
                 dialogsMap.put(dialog.id, dialog);
             }
             ArrayList<TLRPC.Dialog> allDialogs = MessagesController.getInstance(currentAccount).getAllDialogs();
+
+            SortArchived sortArchived = (boolean archived) -> {
+
             for (int a = 0; a < allDialogs.size(); a++) {
                 TLRPC.Dialog dialog = allDialogs.get(a);
                 if (!(dialog instanceof TLRPC.TL_dialog)) {
                     continue;
                 }
+                // Archived and unarchived dialogs should not be mixed up.
+                if ((dialog.folder_id == 0) == archived) {
+                    continue;
+                }
                 int lower_id = (int) dialog.id;
                 if (lower_id == selfUserId) {
                     continue;
@@ -1092,6 +1103,10 @@ public void fetchDialogs() {
                     }
                 }
             }
+
+            };
+            sortArchived.sort(false);
+            sortArchived.sort(true);
             notifyDataSetChanged();
         }
 
