diff --git a/TMessagesProj/build.gradle b/TMessagesProj/build.gradle
index 009975b5e..d60fb1b6d 100644
--- a/TMessagesProj/build.gradle
+++ b/TMessagesProj/build.gradle
@@ -80,7 +80,7 @@ android {
     defaultConfig {
         minSdkVersion 8
         targetSdkVersion 19
-        versionCode 311
+        versionCode 312
         versionName "1.8.0"
     }
 }
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/FileUploadOperation.java b/TMessagesProj/src/main/java/org/telegram/messenger/FileUploadOperation.java
index b579ff271..d967d7b88 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/FileUploadOperation.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/FileUploadOperation.java
@@ -218,8 +218,6 @@ private void startUploadRequest() {
                         editor.putString(fileKey + "_key", Utilities.bytesToHex(key));
                     }
                     editor.commit();
-
-                    editor.putString(fileKey + "_key", Utilities.bytesToHex(key));
                 }
 
                 if (isEncrypted) {
