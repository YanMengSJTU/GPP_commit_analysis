diff --git a/TMessagesProj/jni/tgnet/ConnectionsManager.cpp b/TMessagesProj/jni/tgnet/ConnectionsManager.cpp
index 11b16b75c..342b227a0 100644
--- a/TMessagesProj/jni/tgnet/ConnectionsManager.cpp
+++ b/TMessagesProj/jni/tgnet/ConnectionsManager.cpp
@@ -2309,7 +2309,9 @@ void ConnectionsManager::processRequestQueue(uint32_t connectionTypes, uint32_t
                 }
                 uint8_t index;
                 RAND_bytes(&index, 1);
-                datacenterId = allDc[index % allDc.size()];
+                if (!allDc.empty()) {
+                    datacenterId = allDc[index % allDc.size()];
+                }
                 if (dynamic_cast<TL_help_getConfig *>(request->rawRequest)) {
                     updatingDcStartTime = currentTime;
                     request->datacenterId = datacenterId;
