diff --git a/TMessagesProj/build.gradle b/TMessagesProj/build.gradle
index cf9848807..7c18cf092 100644
--- a/TMessagesProj/build.gradle
+++ b/TMessagesProj/build.gradle
@@ -5,26 +5,26 @@ repositories {
 }
 
 dependencies {
-    compile 'com.android.support:support-v4:23.4.0'
-    compile "com.google.android.gms:play-services-gcm:8.4.0"
-    compile "com.google.android.gms:play-services-maps:8.4.0"
+    compile 'com.android.support:support-v4:24.2.1'
+    compile "com.google.android.gms:play-services-gcm:9.6.1"
+    compile "com.google.android.gms:play-services-maps:9.6.1"
     compile 'net.hockeyapp.android:HockeySDK:4.0.1'
     compile 'com.googlecode.mp4parser:isoparser:1.0.6'
 }
 
 android {
-    compileSdkVersion 23
-    buildToolsVersion '23.0.3'
+    compileSdkVersion 24
+    buildToolsVersion '24.0.2'
 
     useLibrary 'org.apache.http.legacy'
-    defaultConfig.applicationId = "org.telegram.messenger"
+    defaultConfig.applicationId = "rikka.rikkagram"
 
     compileOptions {
         sourceCompatibility JavaVersion.VERSION_1_7
         targetCompatibility JavaVersion.VERSION_1_7
     }
 
-    signingConfigs {
+    /*signingConfigs {
         debug {
             storeFile file("config/release.keystore")
             storePassword RELEASE_STORE_PASSWORD
@@ -38,7 +38,7 @@ android {
             keyAlias RELEASE_KEY_ALIAS
             keyPassword RELEASE_KEY_PASSWORD
         }
-    }
+    }*/
 
     buildTypes {
         debug {
@@ -51,7 +51,7 @@ android {
         release {
             debuggable false
             jniDebuggable false
-            signingConfig signingConfigs.release
+            //signingConfig signingConfigs.release
             minifyEnabled false
             proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
         }
@@ -59,7 +59,7 @@ android {
         foss {
             debuggable false
             jniDebuggable false
-            signingConfig signingConfigs.release
+            //signingConfig signingConfigs.release
         }
     }
 
@@ -113,7 +113,7 @@ android {
 
     defaultConfig {
         minSdkVersion 14
-        targetSdkVersion 23
+        targetSdkVersion 24
         versionName "3.10.1"
     }
 }
diff --git a/TMessagesProj/config/debug/AndroidManifest.xml b/TMessagesProj/config/debug/AndroidManifest.xml
index 176edd31f..22f0a522f 100644
--- a/TMessagesProj/config/debug/AndroidManifest.xml
+++ b/TMessagesProj/config/debug/AndroidManifest.xml
@@ -10,19 +10,19 @@
     <uses-feature android:name="android.hardware.LOCATION" android:required="false" />
 
     <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
-    <uses-permission android:name="org.telegram.messenger.permission.MAPS_RECEIVE"/>
-    <uses-permission android:name="org.telegram.messenger.permission.C2D_MESSAGE" />
+    <uses-permission android:name="rikka.rikkagram.beta.permission.MAPS_RECEIVE"/>
+    <uses-permission android:name="rikka.rikkagram.beta.permission.C2D_MESSAGE" />
     <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
     <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
     <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
 
-    <permission android:name="org.telegram.messenger.permission.MAPS_RECEIVE" android:protectionLevel="signature"/>
-    <permission android:name="org.telegram.messenger.permission.C2D_MESSAGE" android:protectionLevel="signature" />
+    <permission android:name="rikka.rikkagram.beta.permission.MAPS_RECEIVE" android:protectionLevel="signature"/>
+    <permission android:name="rikka.rikkagram.beta.permission.C2D_MESSAGE" android:protectionLevel="signature" />
 
     <application
         android:allowBackup="false"
         android:icon="@drawable/ic_launcher"
-        android:label="@string/AppNameBeta"
+        android:label="Rikkagram Beta"
         android:theme="@style/Theme.TMessages.Start"
         android:name=".ApplicationLoader"
         android:hardwareAccelerated="@bool/useHardwareAcceleration"
diff --git a/TMessagesProj/config/release/AndroidManifest.xml b/TMessagesProj/config/release/AndroidManifest.xml
index 8bb0cb0de..66536b2a6 100644
--- a/TMessagesProj/config/release/AndroidManifest.xml
+++ b/TMessagesProj/config/release/AndroidManifest.xml
@@ -10,19 +10,19 @@
     <uses-feature android:name="android.hardware.LOCATION" android:required="false" />
 
     <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
-    <uses-permission android:name="org.telegram.messenger.permission.MAPS_RECEIVE"/>
-    <uses-permission android:name="org.telegram.messenger.permission.C2D_MESSAGE" />
+    <uses-permission android:name="rikka.rikkagram.permission.MAPS_RECEIVE"/>
+    <uses-permission android:name="rikka.rikkagram.permission.C2D_MESSAGE" />
     <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
     <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
     <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
 
-    <permission android:name="org.telegram.messenger.permission.MAPS_RECEIVE" android:protectionLevel="signature"/>
-    <permission android:name="org.telegram.messenger.permission.C2D_MESSAGE" android:protectionLevel="signature" />
+    <permission android:name="rikka.rikkagram.permission.MAPS_RECEIVE" android:protectionLevel="signature"/>
+    <permission android:name="rikka.rikkagram.permission.C2D_MESSAGE" android:protectionLevel="signature" />
 
     <application
         android:allowBackup="false"
         android:icon="@drawable/ic_launcher"
-        android:label="@string/AppName"
+        android:label="Rikkagram"
         android:theme="@style/Theme.TMessages.Start"
         android:name=".ApplicationLoader"
         android:hardwareAccelerated="@bool/useHardwareAcceleration"
diff --git a/TMessagesProj/google-services.json b/TMessagesProj/google-services.json
index 9403433ed..9d8d6b6c8 100755
--- a/TMessagesProj/google-services.json
+++ b/TMessagesProj/google-services.json
@@ -1,49 +1,73 @@
 {
   "project_info": {
-    "project_id": "tmessages2",
-    "project_number": "760348033671",
-    "name": "Telegram"
+    "project_number": "729406368729",
+    "firebase_url": "https://rikkagram.firebaseio.com",
+    "project_id": "rikkagram",
+    "storage_bucket": "rikkagram.appspot.com"
   },
   "client": [
     {
       "client_info": {
-        "mobilesdk_app_id": "1:760348033671:android:f6afd7b67eae3860",
-        "client_id": "android:org.telegram.messenger",
-        "client_type": 1,
+        "mobilesdk_app_id": "1:729406368729:android:cc6547f7405eaa23",
         "android_client_info": {
-          "package_name": "org.telegram.messenger",
-          "certificate_hash": []
+          "package_name": "rikka.rikkagram"
         }
       },
-      "oauth_client": [],
-      "api_key": [],
+      "oauth_client": [
+        {
+          "client_id": "729406368729-cqns6ban3cfgs9j6d1nmmlgsb86jsh21.apps.googleusercontent.com",
+          "client_type": 3
+        }
+      ],
+      "api_key": [
+        {
+          "current_key": "AIzaSyDPuabwXutR2u2tNFjVB2qNnanlTjog2lo"
+        }
+      ],
       "services": {
-        "cloud_messaging_service": {
-          "status": 2,
-          "apns_config": []
+        "analytics_service": {
+          "status": 1
+        },
+        "appinvite_service": {
+          "status": 1,
+          "other_platform_oauth_client": []
+        },
+        "ads_service": {
+          "status": 2
         }
       }
     },
     {
       "client_info": {
-        "mobilesdk_app_id": "1:760348033671:android:dc022572c167a16c",
-        "client_id": "android:org.telegram.messenger.beta",
-        "client_type": 1,
+        "mobilesdk_app_id": "1:729406368729:android:a20d0092faf8a265",
         "android_client_info": {
-          "package_name": "org.telegram.messenger.beta",
-          "certificate_hash": []
+          "package_name": "rikka.rikkagram.beta"
         }
       },
-      "oauth_client": [],
-      "api_key": [],
+      "oauth_client": [
+        {
+          "client_id": "729406368729-cqns6ban3cfgs9j6d1nmmlgsb86jsh21.apps.googleusercontent.com",
+          "client_type": 3
+        }
+      ],
+      "api_key": [
+        {
+          "current_key": "AIzaSyDPuabwXutR2u2tNFjVB2qNnanlTjog2lo"
+        }
+      ],
       "services": {
-        "cloud_messaging_service": {
-          "status": 2,
-          "apns_config": []
+        "analytics_service": {
+          "status": 1
+        },
+        "appinvite_service": {
+          "status": 1,
+          "other_platform_oauth_client": []
+        },
+        "ads_service": {
+          "status": 2
         }
       }
     }
   ],
-  "client_info": [],
-  "ARTIFACT_VERSION": "1"
+  "configuration_version": "1"
 }
\ No newline at end of file
diff --git a/TMessagesProj/jni/Android.mk b/TMessagesProj/jni/Android.mk
index bbcdfab94..d0319362b 100755
--- a/TMessagesProj/jni/Android.mk
+++ b/TMessagesProj/jni/Android.mk
@@ -1,6 +1,8 @@
 LOCAL_PATH := $(call my-dir)
 
-LOCAL_MODULE    := avutil 
+LOCAL_MODULE    := avutil
+
+LOCAL_SHORT_COMMANDS := true
 
 ifeq ($(TARGET_ARCH_ABI),armeabi-v7a)
     LOCAL_SRC_FILES := ./ffmpeg/armv7-a/libavutil.a
diff --git a/TMessagesProj/jni/Application.mk b/TMessagesProj/jni/Application.mk
index bd546a41a..417ed9405 100644
--- a/TMessagesProj/jni/Application.mk
+++ b/TMessagesProj/jni/Application.mk
@@ -1,3 +1,4 @@
+LOCAL_SHORT_COMMANDS := true
 APP_PLATFORM := android-9
 APP_ABI := armeabi armeabi-v7a x86
 NDK_TOOLCHAIN_VERSION := 4.9
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/AndroidUtilities.java b/TMessagesProj/src/main/java/org/telegram/messenger/AndroidUtilities.java
index 8fa36b6b8..38ce39bf9 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/AndroidUtilities.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/AndroidUtilities.java
@@ -357,8 +357,19 @@ public static Typeface getTypeface(String assetPath) {
         synchronized (typefaceCache) {
             if (!typefaceCache.containsKey(assetPath)) {
                 try {
-                    Typeface t = Typeface.createFromAsset(ApplicationLoader.applicationContext.getAssets(), assetPath);
+                    Typeface t;
+                    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {
+                        if (assetPath.equals("fonts/rmedium.ttf")) {
+                            t = Typeface.create("sans-serif-medium", Typeface.NORMAL);
+                        } else {
+                            t = Typeface.create("sans-serif", Typeface.ITALIC);
+                        }
+                    } else {
+                        t = Typeface.createFromAsset(ApplicationLoader.applicationContext.getAssets(), assetPath);
+                    }
+
                     typefaceCache.put(assetPath, t);
+
                 } catch (Exception e) {
                     FileLog.e("Typefaces", "Could not get typeface '" + assetPath + "' because " + e.getMessage());
                     return null;
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/BuildVars.java b/TMessagesProj/src/main/java/org/telegram/messenger/BuildVars.java
index f872d49bd..5e547928e 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/BuildVars.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/BuildVars.java
@@ -12,13 +12,13 @@
     public static boolean DEBUG_VERSION = false;
     public static int BUILD_VERSION = 821;
     public static String BUILD_VERSION_STRING = "3.10";
-    public static int APP_ID = 0; //obtain your own APP_ID at https://core.telegram.org/api/obtaining_api_id
-    public static String APP_HASH = ""; //obtain your own APP_HASH at https://core.telegram.org/api/obtaining_api_id
-    public static String HOCKEY_APP_HASH = "your-hockeyapp-api-key-here";
-    public static String HOCKEY_APP_HASH_DEBUG = "your-hockeyapp-api-key-here";
+    public static int APP_ID = 87965; //obtain your own APP_ID at https://core.telegram.org/api/obtaining_api_id
+    public static String APP_HASH = "d23672cb16dfb9fc0490b2254aac6ecf"; //obtain your own APP_HASH at https://core.telegram.org/api/obtaining_api_id
+    public static String HOCKEY_APP_HASH = "45f1e69a21334119867dd241f8052f0a";
+    public static String HOCKEY_APP_HASH_DEBUG = "d2d518981787407ab28580aa6fa59860";
     public static String GCM_SENDER_ID = "760348033672";
-    public static String SEND_LOGS_EMAIL = "email@gmail.com";
-    public static String BING_SEARCH_KEY = ""; //obtain your own KEY at https://www.bing.com/dev/en-us/dev-center
+    public static String SEND_LOGS_EMAIL = "rikkanyaaa+rikkagram@gmail.com";
+    public static String BING_SEARCH_KEY = "966e110361d14d88b4879816a351af2b"; //obtain your own KEY at https://www.bing.com/dev/en-us/dev-center
     public static String FOURSQUARE_API_KEY = ""; //obtain your own KEY at https://developer.foursquare.com/
     public static String FOURSQUARE_API_ID = ""; //obtain your own API_ID at https://developer.foursquare.com/
     public static String FOURSQUARE_API_VERSION = "20150326";
diff --git a/TMessagesProj/src/main/java/org/telegram/messenger/Emoji.java b/TMessagesProj/src/main/java/org/telegram/messenger/Emoji.java
index 7a5328550..7f48047cd 100644
--- a/TMessagesProj/src/main/java/org/telegram/messenger/Emoji.java
+++ b/TMessagesProj/src/main/java/org/telegram/messenger/Emoji.java
@@ -392,7 +392,7 @@ public static CharSequence replaceEmoji(CharSequence cs, Paint.FontMetricsInt fo
                         }
                     }
                 }
-                if (doneEmoji) {
+                if (false/*doneEmoji*/) {
                     if (i + 2 < length) {
                         if (cs.charAt(i + 1) == 0xD83C && cs.charAt(i + 2) >= 0xDFFB && cs.charAt(i + 2) <= 0xDFFF) {
                             emojiCode.append(cs.subSequence(i + 1, i + 3));
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/Components/PhotoFilterView.java b/TMessagesProj/src/main/java/org/telegram/ui/Components/PhotoFilterView.java
index 5158eeede..13ca50303 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/Components/PhotoFilterView.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/Components/PhotoFilterView.java
@@ -16,6 +16,7 @@
 import android.graphics.Bitmap;
 import android.graphics.Matrix;
 import android.graphics.SurfaceTexture;
+import android.graphics.Typeface;
 import android.opengl.GLES20;
 import android.opengl.GLUtils;
 import android.os.Build;
diff --git a/TMessagesProj/src/main/java/org/telegram/ui/LocationActivity.java b/TMessagesProj/src/main/java/org/telegram/ui/LocationActivity.java
index 9e03f4ff7..057dc3ecc 100644
--- a/TMessagesProj/src/main/java/org/telegram/ui/LocationActivity.java
+++ b/TMessagesProj/src/main/java/org/telegram/ui/LocationActivity.java
@@ -47,6 +47,7 @@
 import com.google.android.gms.maps.MapView;
 
 import com.google.android.gms.maps.MapsInitializer;
+import com.google.android.gms.maps.OnMapReadyCallback;
 import com.google.android.gms.maps.model.BitmapDescriptorFactory;
 import com.google.android.gms.maps.model.CircleOptions;
 import com.google.android.gms.maps.model.LatLng;
@@ -286,11 +287,17 @@ public void getOutline(View view, Outline outline) {
 
         if (messageObject != null) {
             mapView = new MapView(context);
+            mapView.getMapAsync(new OnMapReadyCallback() {
+                @Override
+                public void onMapReady(GoogleMap googleMap) {
+                    LocationActivity.this.googleMap = googleMap;
+                }
+            });
             frameLayout.setBackgroundDrawable(new MapPlaceholderDrawable());
             mapView.onCreate(null);
             try {
                 MapsInitializer.initialize(context);
-                googleMap = mapView.getMap();
+                //googleMap = mapView.getMap();
             } catch (Exception e) {
                 FileLog.e("tmessages", e);
             }
@@ -520,7 +527,13 @@ public boolean onInterceptTouchEvent(MotionEvent ev) {
             }
             try {
                 MapsInitializer.initialize(context);
-                googleMap = mapView.getMap();
+                //googleMap = mapView.getMap();
+                mapView.getMapAsync(new OnMapReadyCallback() {
+                    @Override
+                    public void onMapReady(GoogleMap googleMap) {
+                        LocationActivity.this.googleMap = googleMap;
+                    }
+                });
             } catch (Exception e) {
                 FileLog.e("tmessages", e);
             }
diff --git a/build.gradle b/build.gradle
index cc551aed8..71aba5517 100644
--- a/build.gradle
+++ b/build.gradle
@@ -5,7 +5,7 @@ buildscript {
         mavenCentral()
     }
     dependencies {
-        classpath 'com.android.tools.build:gradle:2.1.2'
-        classpath 'com.google.gms:google-services:2.1.2'
+        classpath 'com.android.tools.build:gradle:2.2.0'
+        classpath 'com.google.gms:google-services:3.0.0'
     }
 }
\ No newline at end of file
diff --git a/gradle.properties b/gradle.properties
index 08f287cfb..fc7e06a13 100644
--- a/gradle.properties
+++ b/gradle.properties
@@ -16,4 +16,3 @@
 RELEASE_KEY_PASSWORD=password
 RELEASE_KEY_ALIAS=alias
 RELEASE_STORE_PASSWORD=password
-android.useDeprecatedNdk=true
diff --git a/gradle/wrapper/gradle-wrapper.properties b/gradle/wrapper/gradle-wrapper.properties
index b0b8557e8..ef93d4eb6 100644
--- a/gradle/wrapper/gradle-wrapper.properties
+++ b/gradle/wrapper/gradle-wrapper.properties
@@ -1,6 +1,6 @@
-#Fri Dec 04 13:44:40 MSK 2015
+#Thu Oct 06 11:43:30 CST 2016
 distributionBase=GRADLE_USER_HOME
 distributionPath=wrapper/dists
 zipStoreBase=GRADLE_USER_HOME
 zipStorePath=wrapper/dists
-distributionUrl=https\://services.gradle.org/distributions/gradle-2.11-all.zip
+distributionUrl=https\://services.gradle.org/distributions/gradle-2.14.1-all.zip
