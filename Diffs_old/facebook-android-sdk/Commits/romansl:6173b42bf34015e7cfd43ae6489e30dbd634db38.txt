diff --git a/examples/simple/src/com/facebook/android/Example.java b/examples/simple/src/com/facebook/android/Example.java
index 54db7d58e..035b505e8 100644
--- a/examples/simple/src/com/facebook/android/Example.java
+++ b/examples/simple/src/com/facebook/android/Example.java
@@ -42,7 +42,7 @@
 
     // Your Facebook Application ID must be set before running this example
     // See http://www.facebook.com/developers/createapp.php
-    public static final String APP_ID = "175729095772478";
+    public static final String APP_ID = "121943604485916";
 
     private LoginButton mLoginButton;
     private TextView mText;
diff --git a/facebook/default.properties b/facebook/default.properties
index 2262a388e..b586c7619 100644
--- a/facebook/default.properties
+++ b/facebook/default.properties
@@ -9,4 +9,4 @@
 
 android.library=true
 # Project target.
-target=android-3
+target=android-7
diff --git a/facebook/res/layout/facebook_dialog.xml b/facebook/res/layout/facebook_dialog.xml
new file mode 100644
index 000000000..11044c66a
--- /dev/null
+++ b/facebook/res/layout/facebook_dialog.xml
@@ -0,0 +1,40 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+	android:id="@+id/root" android:orientation="vertical"
+	android:layout_width="fill_parent" android:layout_height="fill_parent">
+
+	<TextView android:layout_height="wrap_content" android:text="Facebook"
+		android:textColor="#ffffff" android:textStyle="bold"
+		android:paddingLeft="6dip" android:paddingBottom="4dip"
+		android:paddingRight="4dip" android:paddingTop="4dip"
+		android:drawableLeft="@drawable/facebook_icon" android:layout_width="fill_parent"
+		android:id="@+id/title" android:background="@color/fb_blue" />
+
+	<ViewAnimator android:layout_width="fill_parent"
+		android:layout_height="fill_parent" android:id="@+id/switcher"
+		android:inAnimation="@android:anim/fade_in" android:outAnimation="@android:anim/fade_out">
+
+		<LinearLayout android:id="@+id/body" android:orientation="horizontal"
+			android:baselineAligned="false" android:paddingLeft="8dip"
+			android:paddingTop="10dip" android:paddingRight="8dip"
+			android:paddingBottom="10dip" android:layout_gravity="center"
+			android:layout_height="wrap_content" android:layout_width="wrap_content">
+
+			<ProgressBar android:id="@android:id/progress"
+				style="@android:style/Widget.ProgressBar" android:layout_width="wrap_content"
+				android:layout_height="wrap_content" android:max="10000"
+				android:layout_marginRight="12dip" />
+
+			<TextView android:id="@+id/message" android:layout_width="fill_parent"
+				android:layout_height="wrap_content" android:layout_gravity="center_vertical"
+				android:text="Loading..." />
+
+		</LinearLayout>
+
+		<WebView android:layout_height="fill_parent"
+			android:layout_width="fill_parent" android:id="@+id/web"
+			android:scrollbars="vertical" />
+
+	</ViewAnimator>
+
+</LinearLayout>
\ No newline at end of file
diff --git a/facebook/res/values/colors.xml b/facebook/res/values/colors.xml
new file mode 100644
index 000000000..ee4152d0d
--- /dev/null
+++ b/facebook/res/values/colors.xml
@@ -0,0 +1,4 @@
+<?xml version="1.0" encoding="utf-8"?>
+<resources>
+    <color name="fb_blue">#FF6D84B4</color>
+</resources>
diff --git a/facebook/src/com/facebook/android/Facebook.java b/facebook/src/com/facebook/android/Facebook.java
index f4f02a549..08c087000 100644
--- a/facebook/src/com/facebook/android/Facebook.java
+++ b/facebook/src/com/facebook/android/Facebook.java
@@ -22,18 +22,31 @@
 
 import android.Manifest;
 import android.app.Activity;
+import android.app.Dialog;
 import android.content.ActivityNotFoundException;
 import android.content.Context;
+import android.content.DialogInterface;
 import android.content.Intent;
+import android.content.DialogInterface.OnCancelListener;
 import android.content.pm.PackageInfo;
 import android.content.pm.PackageManager;
-import android.content.pm.PackageManager.NameNotFoundException;
 import android.content.pm.ResolveInfo;
 import android.content.pm.Signature;
+import android.content.pm.PackageManager.NameNotFoundException;
+import android.graphics.Bitmap;
+import android.net.Uri;
 import android.os.Bundle;
 import android.text.TextUtils;
 import android.util.Log;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.Window;
 import android.webkit.CookieSyncManager;
+import android.webkit.WebView;
+import android.webkit.WebViewClient;
+import android.widget.FrameLayout;
+import android.widget.TextView;
+import android.widget.ViewAnimator;
 
 /**
  * Main Facebook object for interacting with the Facebook developer API.
@@ -62,12 +75,9 @@
     private static final int DEFAULT_AUTH_ACTIVITY_CODE = 32665;
 
     // Facebook server endpoints: may be modified in a subclass for testing
-    protected static String DIALOG_BASE_URL =
-        "https://m.facebook.com/dialog/";
-    protected static String GRAPH_BASE_URL =
-        "https://graph.facebook.com/";
-    protected static String RESTSERVER_URL =
-        "https://api.facebook.com/restserver.php";
+    protected static String DIALOG_BASE_URL = "https://m.facebook.com/dialog/";
+    protected static String GRAPH_BASE_URL = "https://graph.facebook.com/";
+    protected static String RESTSERVER_URL = "https://api.facebook.com/restserver.php";
 
     private String mAccessToken = null;
     private long mAccessExpires = 0;
@@ -75,7 +85,7 @@
 
     private Activity mAuthActivity;
     private String[] mAuthPermissions;
-    private int mAuthActivityCode;
+    private int mAuthActivityCode = -1;
     private DialogListener mAuthDialogListener;
 
     /**
@@ -619,11 +629,108 @@ public void dialog(Context context, String action, Bundle parameters,
             Util.showAlert(context, "Error",
                     "Application requires permission to access the Internet");
         } else {
-            new FbDialog(context, url, listener).show();
+        	//new FbDialog(context, url, listener).show();
+        	createDialog(context, url, listener).show();
         }
     }
+    
+    private static final String DISPLAY_STRING = "touch";
+
+    private Dialog createDialog(final Context context, String url, final DialogListener listener) {
+    	final Dialog dialog = new Dialog(context);
+    	dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
+    	
+    	LayoutInflater inflater = LayoutInflater.from(context);
+    	View root = inflater.inflate(R.layout.facebook_dialog, null);
+    	dialog.setContentView(root, new FrameLayout.LayoutParams(460, 260));
+
+    	final ViewAnimator switcher = (ViewAnimator) dialog.findViewById(R.id.switcher);
+    	final TextView title = (TextView) dialog.findViewById(R.id.title);
+    	final WebView webView = (WebView) dialog.findViewById(R.id.web);
+    	
+    	title.setCompoundDrawablePadding(6);
+   
+        webView.getSettings().setJavaScriptEnabled(true);
+        webView.loadUrl(url);
+        webView.setWebViewClient(new WebViewClient() {
+            @Override
+            public boolean shouldOverrideUrlLoading(WebView view, String url) {
+                Log.d("Facebook-WebView", "Redirect URL: " + url);
+                
+                if (url.startsWith(Facebook.REDIRECT_URI)) {
+                    Bundle values = Util.parseUrl(url);
+
+                    String error = values.getString("error");
+                    if (error == null) {
+                        error = values.getString("error_type");
+                    }
 
-    /**
+                    if (error == null) {
+                        listener.onComplete(values);
+                    } else if (error.equals("access_denied") ||
+                               error.equals("OAuthAccessDeniedException")) {
+                        listener.onCancel();
+                    } else {
+                        listener.onFacebookError(new FacebookError(error));
+                    }
+
+                    dialog.dismiss();
+                    return true;
+                } else if (url.startsWith(Facebook.CANCEL_URI)) {
+                    listener.onCancel();
+                    dialog.dismiss();
+                    return true;
+                } else if (url.contains(DISPLAY_STRING)) {
+                    return false;
+                }
+                
+                // launch non-dialog URLs in a full browser
+                context.startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(url)));
+                return true;
+            }
+
+            @Override
+            public void onReceivedError(WebView view, int errorCode,
+                    String description, String failingUrl) {
+                listener.onError(new DialogError(description, errorCode, failingUrl));
+                dialog.dismiss();
+            }
+
+            @Override
+            public void onPageStarted(WebView view, String url, Bitmap favicon) {
+                Log.d("Facebook-WebView", "Webview loading URL: " + url);
+                
+                if (switcher.getDisplayedChild() != 0)
+                	switcher.setDisplayedChild(0);
+            }
+
+            @Override
+            public void onPageFinished(WebView view, String url) {
+                String titleText = webView.getTitle();
+                
+                if (titleText != null && titleText.length() > 0) {
+                    title.setText(titleText);
+                }
+                
+                switcher.setDisplayedChild(1);
+                
+                // Волшебным образом фиксит баг с невозможностью
+                // получить фокус у контролов на веб-форме.
+                webView.requestFocus();
+            }
+        });
+
+        dialog.setOnCancelListener(new OnCancelListener() {
+			@Override
+			public void onCancel(DialogInterface dialog) {
+				listener.onCancel();				
+			}
+		});
+
+    	return dialog;
+	}
+    
+	/**
      * @return boolean - whether this object has an non-expired session token
      */
     public boolean isSessionValid() {
diff --git a/facebook/src/com/facebook/android/FbDialog.java b/facebook/src/com/facebook/android/FbDialog.java
deleted file mode 100644
index 513c626e7..000000000
--- a/facebook/src/com/facebook/android/FbDialog.java
+++ /dev/null
@@ -1,179 +0,0 @@
-/*
- * Copyright 2010 Facebook, Inc.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *    http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.facebook.android;
-
-import android.app.Dialog;
-import android.app.ProgressDialog;
-import android.content.Context;
-import android.content.Intent;
-import android.graphics.Bitmap;
-import android.graphics.Color;
-import android.graphics.Typeface;
-import android.graphics.drawable.Drawable;
-import android.net.Uri;
-import android.os.Bundle;
-import android.util.Log;
-import android.view.Display;
-import android.view.ViewGroup;
-import android.view.Window;
-import android.webkit.WebView;
-import android.webkit.WebViewClient;
-import android.widget.FrameLayout;
-import android.widget.LinearLayout;
-import android.widget.TextView;
-
-import com.facebook.android.Facebook.DialogListener;
-
-public class FbDialog extends Dialog {
-
-    static final int FB_BLUE = 0xFF6D84B4;
-    static final float[] DIMENSIONS_LANDSCAPE = {460, 260};
-    static final float[] DIMENSIONS_PORTRAIT = {280, 420};
-    static final FrameLayout.LayoutParams FILL =
-        new FrameLayout.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT,
-                         ViewGroup.LayoutParams.FILL_PARENT);
-    static final int MARGIN = 4;
-    static final int PADDING = 2;
-    static final String DISPLAY_STRING = "touch";
-    static final String FB_ICON = "icon.png";
-
-    private String mUrl;
-    private DialogListener mListener;
-    private ProgressDialog mSpinner;
-    private WebView mWebView;
-    private LinearLayout mContent;
-    private TextView mTitle;
-
-    public FbDialog(Context context, String url, DialogListener listener) {
-        super(context);
-        mUrl = url;
-        mListener = listener;
-    }
-
-    @Override
-    protected void onCreate(Bundle savedInstanceState) {
-        super.onCreate(savedInstanceState);
-        mSpinner = new ProgressDialog(getContext());
-        mSpinner.requestWindowFeature(Window.FEATURE_NO_TITLE);
-        mSpinner.setMessage("Loading...");
-
-        mContent = new LinearLayout(getContext());
-        mContent.setOrientation(LinearLayout.VERTICAL);
-        setUpTitle();
-        setUpWebView();
-        Display display = getWindow().getWindowManager().getDefaultDisplay();
-        final float scale = getContext().getResources().getDisplayMetrics().density;
-        float[] dimensions =
-            (display.getWidth() < display.getHeight())
-                    ? DIMENSIONS_PORTRAIT : DIMENSIONS_LANDSCAPE;
-        addContentView(mContent, new FrameLayout.LayoutParams(
-                (int) (dimensions[0] * scale + 0.5f),
-                (int) (dimensions[1] * scale + 0.5f)));
-    }
-
-    private void setUpTitle() {
-        requestWindowFeature(Window.FEATURE_NO_TITLE);
-        Drawable icon = getContext().getResources().getDrawable(
-                R.drawable.facebook_icon);
-        mTitle = new TextView(getContext());
-        mTitle.setText("Facebook");
-        mTitle.setTextColor(Color.WHITE);
-        mTitle.setTypeface(Typeface.DEFAULT_BOLD);
-        mTitle.setBackgroundColor(FB_BLUE);
-        mTitle.setPadding(MARGIN + PADDING, MARGIN, MARGIN, MARGIN);
-        mTitle.setCompoundDrawablePadding(MARGIN + PADDING);
-        mTitle.setCompoundDrawablesWithIntrinsicBounds(
-                icon, null, null, null);
-        mContent.addView(mTitle);
-    }
-
-    private void setUpWebView() {
-        mWebView = new WebView(getContext());
-        mWebView.setVerticalScrollBarEnabled(false);
-        mWebView.setHorizontalScrollBarEnabled(false);
-        mWebView.setWebViewClient(new FbDialog.FbWebViewClient());
-        mWebView.getSettings().setJavaScriptEnabled(true);
-        mWebView.loadUrl(mUrl);
-        mWebView.setLayoutParams(FILL);
-        mContent.addView(mWebView);
-    }
-
-    private class FbWebViewClient extends WebViewClient {
-
-        @Override
-        public boolean shouldOverrideUrlLoading(WebView view, String url) {
-            Log.d("Facebook-WebView", "Redirect URL: " + url);
-            if (url.startsWith(Facebook.REDIRECT_URI)) {
-                Bundle values = Util.parseUrl(url);
-
-                String error = values.getString("error");
-                if (error == null) {
-                    error = values.getString("error_type");
-                }
-
-                if (error == null) {
-                    mListener.onComplete(values);
-                } else if (error.equals("access_denied") ||
-                           error.equals("OAuthAccessDeniedException")) {
-                    mListener.onCancel();
-                } else {
-                    mListener.onFacebookError(new FacebookError(error));
-                }
-
-                FbDialog.this.dismiss();
-                return true;
-            } else if (url.startsWith(Facebook.CANCEL_URI)) {
-                mListener.onCancel();
-                FbDialog.this.dismiss();
-                return true;
-            } else if (url.contains(DISPLAY_STRING)) {
-                return false;
-            }
-            // launch non-dialog URLs in a full browser
-            getContext().startActivity(
-                    new Intent(Intent.ACTION_VIEW, Uri.parse(url)));
-            return true;
-        }
-
-        @Override
-        public void onReceivedError(WebView view, int errorCode,
-                String description, String failingUrl) {
-            super.onReceivedError(view, errorCode, description, failingUrl);
-            mListener.onError(
-                    new DialogError(description, errorCode, failingUrl));
-            FbDialog.this.dismiss();
-        }
-
-        @Override
-        public void onPageStarted(WebView view, String url, Bitmap favicon) {
-            Log.d("Facebook-WebView", "Webview loading URL: " + url);
-            super.onPageStarted(view, url, favicon);
-            mSpinner.show();
-        }
-
-        @Override
-        public void onPageFinished(WebView view, String url) {
-            super.onPageFinished(view, url);
-            String title = mWebView.getTitle();
-            if (title != null && title.length() > 0) {
-                mTitle.setText(title);
-            }
-            mSpinner.dismiss();
-        }
-
-    }
-}
