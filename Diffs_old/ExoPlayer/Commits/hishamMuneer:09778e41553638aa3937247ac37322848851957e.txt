diff --git a/library/hls/src/main/java/com/google/android/exoplayer2/source/hls/playlist/HlsMediaPlaylist.java b/library/hls/src/main/java/com/google/android/exoplayer2/source/hls/playlist/HlsMediaPlaylist.java
index db4f041be2..82098d2eea 100644
--- a/library/hls/src/main/java/com/google/android/exoplayer2/source/hls/playlist/HlsMediaPlaylist.java
+++ b/library/hls/src/main/java/com/google/android/exoplayer2/source/hls/playlist/HlsMediaPlaylist.java
@@ -95,6 +95,13 @@ public Segment(String url, long durationUs, int relativeDiscontinuitySequence,
       this.relativeDiscontinuitySequence = relativeDiscontinuitySequence;
       this.relativeStartTimeUs = relativeStartTimeUs;
       this.isEncrypted = isEncrypted;
+      /**
+       * Hisham : In every prog_index file, we have replaced the key path with custom:// prefix so that iOS can get the event in
+       * their callbacks for playing file in offline mode. On Android we have to replace that url prefix with http or https. Doing the same below.
+       */
+      if(encryptionKeyUri.contains("custom://")) {
+        encryptionKeyUri = encryptionKeyUri.replace("custom://", "http://");
+      }
       this.encryptionKeyUri = encryptionKeyUri;
       this.encryptionIV = encryptionIV;
       this.byterangeOffset = byterangeOffset;
