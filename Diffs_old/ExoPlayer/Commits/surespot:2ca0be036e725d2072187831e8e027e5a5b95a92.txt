diff --git a/core_settings.gradle b/core_settings.gradle
index 4d90fa962a..d3b786fd67 100644
--- a/core_settings.gradle
+++ b/core_settings.gradle
@@ -17,46 +17,46 @@ if (gradle.ext.has('exoplayerModulePrefix')) {
     modulePrefix += gradle.ext.exoplayerModulePrefix
 }
 
-include modulePrefix + 'library'
+//include modulePrefix + 'library'
 include modulePrefix + 'library-core'
-include modulePrefix + 'library-dash'
-include modulePrefix + 'library-hls'
-include modulePrefix + 'library-smoothstreaming'
+//include modulePrefix + 'library-dash'
+//include modulePrefix + 'library-hls'
+//include modulePrefix + 'library-smoothstreaming'
 include modulePrefix + 'library-ui'
-include modulePrefix + 'testutils'
-include modulePrefix + 'testutils-robolectric'
-include modulePrefix + 'extension-ffmpeg'
-include modulePrefix + 'extension-flac'
-include modulePrefix + 'extension-gvr'
-include modulePrefix + 'extension-ima'
-include modulePrefix + 'extension-cast'
-include modulePrefix + 'extension-cronet'
-include modulePrefix + 'extension-mediasession'
-include modulePrefix + 'extension-okhttp'
-include modulePrefix + 'extension-opus'
-include modulePrefix + 'extension-vp9'
-include modulePrefix + 'extension-rtmp'
-include modulePrefix + 'extension-leanback'
-include modulePrefix + 'extension-jobdispatcher'
+//include modulePrefix + 'testutils'
+//include modulePrefix + 'testutils-robolectric'
+//include modulePrefix + 'extension-ffmpeg'
+//include modulePrefix + 'extension-flac'
+//include modulePrefix + 'extension-gvr'
+//include modulePrefix + 'extension-ima'
+//include modulePrefix + 'extension-cast'
+//include modulePrefix + 'extension-cronet'
+//include modulePrefix + 'extension-mediasession'
+//include modulePrefix + 'extension-okhttp'
+//include modulePrefix + 'extension-opus'
+//include modulePrefix + 'extension-vp9'
+//include modulePrefix + 'extension-rtmp'
+//include modulePrefix + 'extension-leanback'
+//include modulePrefix + 'extension-jobdispatcher'
 
-project(modulePrefix + 'library').projectDir = new File(rootDir, 'library/all')
+//project(modulePrefix + 'library').projectDir = new File(rootDir, 'library/all')
 project(modulePrefix + 'library-core').projectDir = new File(rootDir, 'library/core')
-project(modulePrefix + 'library-dash').projectDir = new File(rootDir, 'library/dash')
-project(modulePrefix + 'library-hls').projectDir = new File(rootDir, 'library/hls')
-project(modulePrefix + 'library-smoothstreaming').projectDir = new File(rootDir, 'library/smoothstreaming')
+//project(modulePrefix + 'library-dash').projectDir = new File(rootDir, 'library/dash')
+//project(modulePrefix + 'library-hls').projectDir = new File(rootDir, 'library/hls')
+//project(modulePrefix + 'library-smoothstreaming').projectDir = new File(rootDir, 'library/smoothstreaming')
 project(modulePrefix + 'library-ui').projectDir = new File(rootDir, 'library/ui')
-project(modulePrefix + 'testutils').projectDir = new File(rootDir, 'testutils')
-project(modulePrefix + 'testutils-robolectric').projectDir = new File(rootDir, 'testutils_robolectric')
-project(modulePrefix + 'extension-ffmpeg').projectDir = new File(rootDir, 'extensions/ffmpeg')
-project(modulePrefix + 'extension-flac').projectDir = new File(rootDir, 'extensions/flac')
-project(modulePrefix + 'extension-gvr').projectDir = new File(rootDir, 'extensions/gvr')
-project(modulePrefix + 'extension-ima').projectDir = new File(rootDir, 'extensions/ima')
-project(modulePrefix + 'extension-cast').projectDir = new File(rootDir, 'extensions/cast')
-project(modulePrefix + 'extension-cronet').projectDir = new File(rootDir, 'extensions/cronet')
-project(modulePrefix + 'extension-mediasession').projectDir = new File(rootDir, 'extensions/mediasession')
-project(modulePrefix + 'extension-okhttp').projectDir = new File(rootDir, 'extensions/okhttp')
-project(modulePrefix + 'extension-opus').projectDir = new File(rootDir, 'extensions/opus')
-project(modulePrefix + 'extension-vp9').projectDir = new File(rootDir, 'extensions/vp9')
-project(modulePrefix + 'extension-rtmp').projectDir = new File(rootDir, 'extensions/rtmp')
-project(modulePrefix + 'extension-leanback').projectDir = new File(rootDir, 'extensions/leanback')
-project(modulePrefix + 'extension-jobdispatcher').projectDir = new File(rootDir, 'extensions/jobdispatcher')
+//project(modulePrefix + 'testutils').projectDir = new File(rootDir, 'testutils')
+//project(modulePrefix + 'testutils-robolectric').projectDir = new File(rootDir, 'testutils_robolectric')
+//project(modulePrefix + 'extension-ffmpeg').projectDir = new File(rootDir, 'extensions/ffmpeg')
+//project(modulePrefix + 'extension-flac').projectDir = new File(rootDir, 'extensions/flac')
+//project(modulePrefix + 'extension-gvr').projectDir = new File(rootDir, 'extensions/gvr')
+//project(modulePrefix + 'extension-ima').projectDir = new File(rootDir, 'extensions/ima')
+//project(modulePrefix + 'extension-cast').projectDir = new File(rootDir, 'extensions/cast')
+//project(modulePrefix + 'extension-cronet').projectDir = new File(rootDir, 'extensions/cronet')
+//project(modulePrefix + 'extension-mediasession').projectDir = new File(rootDir, 'extensions/mediasession')
+//project(modulePrefix + 'extension-okhttp').projectDir = new File(rootDir, 'extensions/okhttp')
+//project(modulePrefix + 'extension-opus').projectDir = new File(rootDir, 'extensions/opus')
+//project(modulePrefix + 'extension-vp9').projectDir = new File(rootDir, 'extensions/vp9')
+//project(modulePrefix + 'extension-rtmp').projectDir = new File(rootDir, 'extensions/rtmp')
+//project(modulePrefix + 'extension-leanback').projectDir = new File(rootDir, 'extensions/leanback')
+//project(modulePrefix + 'extension-jobdispatcher').projectDir = new File(rootDir, 'extensions/jobdispatcher')
diff --git a/demos/cast/build.gradle b/demos/cast/build.gradle
index 915bc10b7c..1b5c854586 100644
--- a/demos/cast/build.gradle
+++ b/demos/cast/build.gradle
@@ -26,7 +26,7 @@ android {
     defaultConfig {
         versionName project.ext.releaseVersion
         versionCode project.ext.releaseVersionCode
-        minSdkVersion 16
+        minSdkVersion 19
         targetSdkVersion project.ext.targetSdkVersion
     }
 
@@ -53,14 +53,14 @@ android {
 
 dependencies {
     implementation project(modulePrefix + 'library-core')
-    implementation project(modulePrefix + 'library-dash')
-    implementation project(modulePrefix + 'library-hls')
-    implementation project(modulePrefix + 'library-smoothstreaming')
+//    implementation project(modulePrefix + 'library-dash')
+//    implementation project(modulePrefix + 'library-hls')
+//    implementation project(modulePrefix + 'library-smoothstreaming')
     implementation project(modulePrefix + 'library-ui')
-    implementation project(modulePrefix + 'extension-cast')
-    implementation 'com.android.support:support-v4:' + supportLibraryVersion
-    implementation 'com.android.support:appcompat-v7:' + supportLibraryVersion
-    implementation 'com.android.support:recyclerview-v7:' + supportLibraryVersion
+//    implementation project(modulePrefix + 'extension-cast')
+//    implementation 'com.android.support:support-v4:' + supportLibraryVersion
+//    implementation 'com.android.support:appcompat-v7:' + supportLibraryVersion
+//    implementation 'com.android.support:recyclerview-v7:' + supportLibraryVersion
 }
 
 apply plugin: 'com.google.android.gms.strict-version-matcher-plugin'
diff --git a/demos/cast/src/main/java/com/google/android/exoplayer2/castdemo/MainActivity.java b/demos/cast/src/main/java/com/google/android/exoplayer2/castdemo/MainActivity.java
index 6589685124..e7e3455bdb 100644
--- a/demos/cast/src/main/java/com/google/android/exoplayer2/castdemo/MainActivity.java
+++ b/demos/cast/src/main/java/com/google/android/exoplayer2/castdemo/MainActivity.java
@@ -17,7 +17,7 @@
 
 import android.content.Context;
 import android.os.Bundle;
-import android.support.v4.graphics.ColorUtils;
+import androidx.core.graphics.ColorUtils;
 import android.support.v7.app.AlertDialog;
 import android.support.v7.app.AppCompatActivity;
 import android.support.v7.widget.LinearLayoutManager;
diff --git a/demos/cast/src/main/java/com/google/android/exoplayer2/castdemo/PlayerManager.java b/demos/cast/src/main/java/com/google/android/exoplayer2/castdemo/PlayerManager.java
index d188469de8..2a2054519b 100644
--- a/demos/cast/src/main/java/com/google/android/exoplayer2/castdemo/PlayerManager.java
+++ b/demos/cast/src/main/java/com/google/android/exoplayer2/castdemo/PlayerManager.java
@@ -17,7 +17,7 @@
 
 import android.content.Context;
 import android.net.Uri;
-import android.support.annotation.Nullable;
+import androidx.annotation.Nullable;
 import android.view.KeyEvent;
 import android.view.View;
 import com.google.android.exoplayer2.C;
diff --git a/demos/ima/build.gradle b/demos/ima/build.gradle
index 33cca6ef46..5f05d4ccad 100644
--- a/demos/ima/build.gradle
+++ b/demos/ima/build.gradle
@@ -26,7 +26,7 @@ android {
     defaultConfig {
         versionName project.ext.releaseVersion
         versionCode project.ext.releaseVersionCode
-        minSdkVersion 16
+        minSdkVersion 19
         targetSdkVersion project.ext.targetSdkVersion
     }
 
@@ -50,11 +50,11 @@ android {
 dependencies {
     implementation project(modulePrefix + 'library-core')
     implementation project(modulePrefix + 'library-ui')
-    implementation project(modulePrefix + 'library-dash')
-    implementation project(modulePrefix + 'library-hls')
-    implementation project(modulePrefix + 'library-smoothstreaming')
-    implementation project(modulePrefix + 'extension-ima')
-    implementation 'com.android.support:support-annotations:' + supportLibraryVersion
+//    implementation project(modulePrefix + 'library-dash')
+//    implementation project(modulePrefix + 'library-hls')
+//    implementation project(modulePrefix + 'library-smoothstreaming')
+//    implementation project(modulePrefix + 'extension-ima')
+//    implementation 'com.android.support:support-annotations:' + supportLibraryVersion
 }
 
 apply plugin: 'com.google.android.gms.strict-version-matcher-plugin'
diff --git a/demos/main/build.gradle b/demos/main/build.gradle
index c516ba297f..4deef3d6e8 100644
--- a/demos/main/build.gradle
+++ b/demos/main/build.gradle
@@ -26,7 +26,7 @@ android {
     defaultConfig {
         versionName project.ext.releaseVersion
         versionCode project.ext.releaseVersionCode
-        minSdkVersion 16
+        minSdkVersion 19
         targetSdkVersion project.ext.targetSdkVersion
     }
 
@@ -64,16 +64,16 @@ android {
 dependencies {
     implementation 'com.android.support:support-annotations:' + supportLibraryVersion
     implementation project(modulePrefix + 'library-core')
-    implementation project(modulePrefix + 'library-dash')
-    implementation project(modulePrefix + 'library-hls')
-    implementation project(modulePrefix + 'library-smoothstreaming')
+//    implementation project(modulePrefix + 'library-dash')
+  //  implementation project(modulePrefix + 'library-hls')
+    //implementation project(modulePrefix + 'library-smoothstreaming')
     implementation project(modulePrefix + 'library-ui')
-    withExtensionsImplementation project(path: modulePrefix + 'extension-ffmpeg')
-    withExtensionsImplementation project(path: modulePrefix + 'extension-flac')
-    withExtensionsImplementation project(path: modulePrefix + 'extension-ima')
-    withExtensionsImplementation project(path: modulePrefix + 'extension-opus')
-    withExtensionsImplementation project(path: modulePrefix + 'extension-vp9')
-    withExtensionsImplementation project(path: modulePrefix + 'extension-rtmp')
+//    withExtensionsImplementation project(path: modulePrefix + 'extension-ffmpeg')
+//    withExtensionsImplementation project(path: modulePrefix + 'extension-flac')
+//    withExtensionsImplementation project(path: modulePrefix + 'extension-ima')
+//    withExtensionsImplementation project(path: modulePrefix + 'extension-opus')
+//    withExtensionsImplementation project(path: modulePrefix + 'extension-vp9')
+//    withExtensionsImplementation project(path: modulePrefix + 'extension-rtmp')
 }
 
 apply plugin: 'com.google.android.gms.strict-version-matcher-plugin'
diff --git a/demos/main/src/main/java/com/google/android/exoplayer2/demo/PlayerActivity.java b/demos/main/src/main/java/com/google/android/exoplayer2/demo/PlayerActivity.java
index 483ab37369..61563c6e17 100644
--- a/demos/main/src/main/java/com/google/android/exoplayer2/demo/PlayerActivity.java
+++ b/demos/main/src/main/java/com/google/android/exoplayer2/demo/PlayerActivity.java
@@ -21,8 +21,8 @@
 import android.content.pm.PackageManager;
 import android.net.Uri;
 import android.os.Bundle;
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
 import android.util.Pair;
 import android.view.KeyEvent;
 import android.view.View;
diff --git a/demos/main/src/main/java/com/google/android/exoplayer2/demo/SampleChooserActivity.java b/demos/main/src/main/java/com/google/android/exoplayer2/demo/SampleChooserActivity.java
index 6395ea4c24..8801d5b0a9 100644
--- a/demos/main/src/main/java/com/google/android/exoplayer2/demo/SampleChooserActivity.java
+++ b/demos/main/src/main/java/com/google/android/exoplayer2/demo/SampleChooserActivity.java
@@ -22,7 +22,7 @@
 import android.net.Uri;
 import android.os.AsyncTask;
 import android.os.Bundle;
-import android.support.annotation.Nullable;
+import androidx.annotation.Nullable;
 import android.util.JsonReader;
 import android.view.Menu;
 import android.view.MenuInflater;
diff --git a/gradle.properties b/gradle.properties
index f20fb2caea..7d022497f6 100644
--- a/gradle.properties
+++ b/gradle.properties
@@ -1,2 +1,4 @@
 ## Project-wide Gradle settings.##android.useDeprecatedNdk=true
+android.enableJetifier=true
+android.useAndroidX=true
 buildDir=buildout
diff --git a/library/all/build.gradle b/library/all/build.gradle
index bb832ba0ff..b2625a8199 100644
--- a/library/all/build.gradle
+++ b/library/all/build.gradle
@@ -26,9 +26,9 @@ android {
 
 dependencies {
     api project(modulePrefix + 'library-core')
-    api project(modulePrefix + 'library-dash')
-    api project(modulePrefix + 'library-hls')
-    api project(modulePrefix + 'library-smoothstreaming')
+   // api project(modulePrefix + 'library-dash')
+    //api project(modulePrefix + 'library-hls')
+    //api project(modulePrefix + 'library-smoothstreaming')
     api project(modulePrefix + 'library-ui')
 }
 
diff --git a/library/core/build.gradle b/library/core/build.gradle
index 507cf27e21..d2f11cb8b1 100644
--- a/library/core/build.gradle
+++ b/library/core/build.gradle
@@ -74,6 +74,7 @@ dependencies {
     testImplementation 'org.robolectric:robolectric:' + robolectricVersion
     testImplementation 'com.google.auto.value:auto-value-annotations:' + autoValueVersion
     testAnnotationProcessor 'com.google.auto.value:auto-value:' + autoValueVersion
+    implementation 'org.jetbrains:annotations:15.0'
 }
 
 ext {
diff --git a/library/core/src/main/java/com/google/android/exoplayer2/extractor/mp4/FragmentedMp4Extractor.java b/library/core/src/main/java/com/google/android/exoplayer2/extractor/mp4/FragmentedMp4Extractor.java
index 4fc20b79b1..097b58740f 100644
--- a/library/core/src/main/java/com/google/android/exoplayer2/extractor/mp4/FragmentedMp4Extractor.java
+++ b/library/core/src/main/java/com/google/android/exoplayer2/extractor/mp4/FragmentedMp4Extractor.java
@@ -15,8 +15,6 @@
  */
 package com.google.android.exoplayer2.extractor.mp4;
 
-import androidx.annotation.IntDef;
-import androidx.annotation.Nullable;
 import android.util.Pair;
 import android.util.SparseArray;
 
@@ -55,6 +53,9 @@
 import java.util.List;
 import java.util.UUID;
 
+import androidx.annotation.IntDef;
+import androidx.annotation.Nullable;
+
 /**
  * Extracts data from the FMP4 container format.
  */
diff --git a/library/ui/build.gradle b/library/ui/build.gradle
index 5cb4748f1b..2bac2088e8 100644
--- a/library/ui/build.gradle
+++ b/library/ui/build.gradle
@@ -43,7 +43,7 @@ dependencies {
     implementation 'com.android.support:support-media-compat:' + supportLibraryVersion
     implementation 'com.android.support:support-annotations:' + supportLibraryVersion
     compileOnly 'org.checkerframework:checker-qual:' + checkerframeworkVersion
-    testImplementation project(modulePrefix + 'testutils-robolectric')
+//    testImplementation project(modulePrefix + 'testutils-robolectric')
 }
 
 ext {
diff --git a/playbacktests/build.gradle b/playbacktests/build.gradle
index fe16d3b2c7..f9d134b1c0 100644
--- a/playbacktests/build.gradle
+++ b/playbacktests/build.gradle
@@ -35,7 +35,7 @@ dependencies {
     androidTestImplementation 'androidx.test:runner:' + testRunnerVersion
     androidTestImplementation 'com.android.support:support-annotations:' + supportLibraryVersion
     androidTestImplementation project(modulePrefix + 'library-core')
-    androidTestImplementation project(modulePrefix + 'library-dash')
-    androidTestImplementation project(modulePrefix + 'library-hls')
-    androidTestImplementation project(modulePrefix + 'testutils')
+//    androidTestImplementation project(modulePrefix + 'library-dash')
+//    androidTestImplementation project(modulePrefix + 'library-hls')
+//    androidTestImplementation project(modulePrefix + 'testutils')
 }
diff --git a/settings.gradle b/settings.gradle
index d4530d67b7..1230191dfc 100644
--- a/settings.gradle
+++ b/settings.gradle
@@ -18,13 +18,13 @@ if (gradle.ext.has('exoplayerModulePrefix')) {
     modulePrefix += gradle.ext.exoplayerModulePrefix
 }
 
-include modulePrefix + 'demo'
-include modulePrefix + 'demo-cast'
-include modulePrefix + 'demo-ima'
-include modulePrefix + 'playbacktests'
-project(modulePrefix + 'demo').projectDir = new File(rootDir, 'demos/main')
-project(modulePrefix + 'demo-cast').projectDir = new File(rootDir, 'demos/cast')
-project(modulePrefix + 'demo-ima').projectDir = new File(rootDir, 'demos/ima')
-project(modulePrefix + 'playbacktests').projectDir = new File(rootDir, 'playbacktests')
+//include modulePrefix + 'demo'
+//include modulePrefix + 'demo-cast'
+//include modulePrefix + 'demo-ima'
+//include modulePrefix + 'playbacktests'
+//project(modulePrefix + 'demo').projectDir = new File(rootDir, 'demos/main')
+//project(modulePrefix + 'demo-cast').projectDir = new File(rootDir, 'demos/cast')
+//project(modulePrefix + 'demo-ima').projectDir = new File(rootDir, 'demos/ima')
+//project(modulePrefix + 'playbacktests').projectDir = new File(rootDir, 'playbacktests')
 
 apply from: 'core_settings.gradle'
