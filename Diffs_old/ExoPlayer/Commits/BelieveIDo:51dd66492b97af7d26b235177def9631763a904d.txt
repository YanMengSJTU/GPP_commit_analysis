diff --git a/library/src/main/java/com/google/android/exoplayer/hls/HlsSampleSource.java b/library/src/main/java/com/google/android/exoplayer/hls/HlsSampleSource.java
index b8fffd4c11..9db6c4ccc0 100644
--- a/library/src/main/java/com/google/android/exoplayer/hls/HlsSampleSource.java
+++ b/library/src/main/java/com/google/android/exoplayer/hls/HlsSampleSource.java
@@ -164,7 +164,7 @@ public boolean continueBuffering(long playbackPositionUs) throws IOException {
     if (!extractors.isEmpty()) {
       discardSamplesForDisabledTracks(extractors.getFirst(), downstreamPositionUs);
     }
-    return continueBufferingInternal();
+    return loadingFinished || continueBufferingInternal();
   }
 
   private boolean continueBufferingInternal() throws IOException {
diff --git a/library/src/main/java/com/google/android/exoplayer/mp4/Mp4Util.java b/library/src/main/java/com/google/android/exoplayer/mp4/Mp4Util.java
index e593858f8b..ea41e3a2cf 100644
--- a/library/src/main/java/com/google/android/exoplayer/mp4/Mp4Util.java
+++ b/library/src/main/java/com/google/android/exoplayer/mp4/Mp4Util.java
@@ -171,6 +171,9 @@ public static int findNalUnit(byte[] data, int startOffset, int endOffset, int t
         // loop advance the index by three.
       } else if (data[i - 2] == 0 && data[i - 1] == 0 && data[i] == 1
           && matchesType(data, i + 1, type)) {
+        if (prefixFlags != null) {
+          clearPrefixFlags(prefixFlags);
+        }
         return i - 2;
       } else {
         // There isn't a NAL prefix here, but there might be at the next position. We should
