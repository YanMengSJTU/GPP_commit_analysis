diff --git a/library/src/main/java/com/google/android/exoplayer/MediaCodecTrackRenderer.java b/library/src/main/java/com/google/android/exoplayer/MediaCodecTrackRenderer.java
index 4ddf9d70c5..46291ae976 100644
--- a/library/src/main/java/com/google/android/exoplayer/MediaCodecTrackRenderer.java
+++ b/library/src/main/java/com/google/android/exoplayer/MediaCodecTrackRenderer.java
@@ -783,10 +783,13 @@ protected void onInputFormatChanged(MediaFormatHolder formatHolder) throws ExoPl
     MediaFormat oldFormat = format;
     format = formatHolder.format;
     drmInitData = formatHolder.drmInitData;
-    if (Util.areEqual(format, oldFormat)) {
+    boolean needsDrmInit = drmInitData != null && !openedDrmSession;
+    if (Util.areEqual(format, oldFormat) && !needsDrmInit) {
       return;
     }
-    if (codec != null && canReconfigureCodec(codec, codecIsAdaptive, oldFormat, format)) {
+    if (codec != null
+        && !needsDrmInit
+        && canReconfigureCodec(codec, codecIsAdaptive, oldFormat, format)) {
       codecReconfigured = true;
       codecReconfigurationState = RECONFIGURATION_STATE_WRITE_PENDING;
       codecNeedsAdaptationWorkaroundBuffer = codecNeedsAdaptationWorkaround
