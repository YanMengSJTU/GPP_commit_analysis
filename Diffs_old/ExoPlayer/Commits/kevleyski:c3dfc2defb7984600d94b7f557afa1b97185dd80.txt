diff --git a/library/core/src/main/java/com/google/android/exoplayer2/ExoPlayerImplInternal.java b/library/core/src/main/java/com/google/android/exoplayer2/ExoPlayerImplInternal.java
index fea2a7bc24..c41905dccd 100644
--- a/library/core/src/main/java/com/google/android/exoplayer2/ExoPlayerImplInternal.java
+++ b/library/core/src/main/java/com/google/android/exoplayer2/ExoPlayerImplInternal.java
@@ -1424,13 +1424,13 @@ private void updatePeriods() throws ExoPlaybackException, IOException {
     }
 
     // Issue #4185: If end of Period is reached then this triggers next Period also
-    boolean isAtEndOfPeriod = (rendererPositionUs >= playingPeriodHolder.next.rendererPositionOffsetUs);
+    boolean isAtEndOfPeriod = ((playingPeriodHolder.next != null) && (rendererPositionUs >= playingPeriodHolder.next.rendererPositionOffsetUs));
 
     for (int i = 0; i < renderers.length; i++) {
       Renderer renderer = renderers[i];
       SampleStream sampleStream = readingPeriodHolder.sampleStreams[i];
       if (renderer.getStream() != sampleStream
-          || (sampleStream != null && !renderer.hasReadStreamToEnd() && !isAtEndOfPeriod)) {
+              || (sampleStream != null && !renderer.hasReadStreamToEnd() && !isAtEndOfPeriod)) {
         // The current reading period is still being read by at least one renderer.
         return;
       }
