diff --git a/RELEASENOTES.md b/RELEASENOTES.md
index ed9635a340..06c1ed7f80 100644
--- a/RELEASENOTES.md
+++ b/RELEASENOTES.md
@@ -29,6 +29,9 @@
   ([#5891](https://github.com/google/ExoPlayer/issues/5891)).
 * Add ProgressUpdateListener to PlayerControlView
   ([#5834](https://github.com/google/ExoPlayer/issues/5834)).
+* Prevent unexpected `DownloadHelper.Callback.onPrepared` callbacks after the
+  preparation of the `DownloadHelper` failed
+  ([#5915](https://github.com/google/ExoPlayer/issues/5915)).
 
 ### 2.10.1 ###
 
diff --git a/library/core/src/main/java/com/google/android/exoplayer2/offline/DownloadHelper.java b/library/core/src/main/java/com/google/android/exoplayer2/offline/DownloadHelper.java
index d2b7bd84d2..e7cf87ed6e 100644
--- a/library/core/src/main/java/com/google/android/exoplayer2/offline/DownloadHelper.java
+++ b/library/core/src/main/java/com/google/android/exoplayer2/offline/DownloadHelper.java
@@ -943,6 +943,7 @@ private boolean handleDownloadHelperCallbackMessage(Message msg) {
           downloadHelper.onMediaPrepared();
           return true;
         case DOWNLOAD_HELPER_CALLBACK_MESSAGE_FAILED:
+          release();
           downloadHelper.onMediaPreparationFailed((IOException) Util.castNonNull(msg.obj));
           return true;
         default:
