diff --git a/library/core/src/main/java/com/google/android/exoplayer2/offline/DownloadService.java b/library/core/src/main/java/com/google/android/exoplayer2/offline/DownloadService.java
index b0269d21e0..22347c6196 100644
--- a/library/core/src/main/java/com/google/android/exoplayer2/offline/DownloadService.java
+++ b/library/core/src/main/java/com/google/android/exoplayer2/offline/DownloadService.java
@@ -263,17 +263,18 @@ public int onStartCommand(Intent intent, int flags, int startId) {
     lastStartId = startId;
     taskRemoved = false;
     String intentAction = null;
+    byte[] actionData = null;
     if (intent != null) {
       intentAction = intent.getAction();
       startedInForeground |=
           intent.getBooleanExtra(KEY_FOREGROUND, false) || ACTION_RESTART.equals(intentAction);
+      actionData = intent.getByteArrayExtra(KEY_DOWNLOAD_ACTION);
     }
     // intentAction is null if the service is restarted or no action is specified.
     if (intentAction == null) {
       intentAction = ACTION_INIT;
     }
     logd("onStartCommand action: " + intentAction + " startId: " + startId);
-    byte[] actionData = intent.getByteArrayExtra(KEY_DOWNLOAD_ACTION);
     switch (intentAction) {
       case ACTION_INIT:
       case ACTION_RESTART:
