diff --git a/RELEASENOTES.md b/RELEASENOTES.md
index 3148cf0779..884cfe6bc2 100644
--- a/RELEASENOTES.md
+++ b/RELEASENOTES.md
@@ -1,5 +1,10 @@
 # Release notes #
 
+### 2.7.3 ###
+
+* Fix ProGuard configuration for Cast, IMA and OkHttp extensions.
+* Update OkHttp extension to depend on OkHttp 3.10.0.
+
 ### 2.7.2 ###
 
 * Gradle: Upgrade Gradle version from 4.1 to 4.4 so it can work with Android
diff --git a/constants.gradle b/constants.gradle
index 61b2e44b27..32210bc95c 100644
--- a/constants.gradle
+++ b/constants.gradle
@@ -13,8 +13,8 @@
 // limitations under the License.
 project.ext {
     // ExoPlayer version and version code.
-    releaseVersion = '2.7.2'
-    releaseVersionCode = 2702
+    releaseVersion = '2.7.3'
+    releaseVersionCode = 2703
     // Important: ExoPlayer specifies a minSdkVersion of 14 because various
     // components provided by the library may be of use on older devices.
     // However, please note that the core media playback functionality provided
diff --git a/demos/cast/build.gradle b/demos/cast/build.gradle
index c928d0e46e..ae6bdd1d94 100644
--- a/demos/cast/build.gradle
+++ b/demos/cast/build.gradle
@@ -29,7 +29,10 @@ android {
         release {
             shrinkResources true
             minifyEnabled true
-            proguardFiles getDefaultProguardFile('proguard-android.txt')
+            proguardFiles = [
+                "proguard-rules.txt",
+                getDefaultProguardFile('proguard-android.txt')
+            ]
         }
         debug {
             jniDebuggable = true
diff --git a/demos/cast/proguard-rules.txt b/demos/cast/proguard-rules.txt
new file mode 100644
index 0000000000..3221818080
--- /dev/null
+++ b/demos/cast/proguard-rules.txt
@@ -0,0 +1,6 @@
+# Proguard rules specific to the Cast demo app.
+
+# Accessed via menu.xml
+-keep class android.support.v7.app.MediaRouteActionProvider {
+  *;
+}
diff --git a/demos/main/src/main/java/com/google/android/exoplayer2/demo/PlayerActivity.java b/demos/main/src/main/java/com/google/android/exoplayer2/demo/PlayerActivity.java
index e91feaa291..058133895e 100644
--- a/demos/main/src/main/java/com/google/android/exoplayer2/demo/PlayerActivity.java
+++ b/demos/main/src/main/java/com/google/android/exoplayer2/demo/PlayerActivity.java
@@ -550,7 +550,7 @@ private void updateButtonVisibilities() {
         button.setText(label);
         button.setTag(i);
         button.setOnClickListener(this);
-        debugRootView.addView(button, debugRootView.getChildCount() - 1);
+        debugRootView.addView(button);
       }
     }
   }
diff --git a/extensions/cast/build.gradle b/extensions/cast/build.gradle
index 253a1922a8..d7e99573cb 100644
--- a/extensions/cast/build.gradle
+++ b/extensions/cast/build.gradle
@@ -21,7 +21,7 @@ android {
     defaultConfig {
         minSdkVersion 14
         targetSdkVersion project.ext.targetSdkVersion
-        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
+        consumerProguardFiles 'proguard-rules.txt'
     }
 }
 
diff --git a/extensions/cast/proguard-rules.txt b/extensions/cast/proguard-rules.txt
new file mode 100644
index 0000000000..bc94b33c1c
--- /dev/null
+++ b/extensions/cast/proguard-rules.txt
@@ -0,0 +1,4 @@
+# Proguard rules specific to the Cast extension.
+
+# DefaultCastOptionsProvider is commonly referred to only by the app's manifest.
+-keep class com.google.android.exoplayer2.ext.cast.DefaultCastOptionsProvider
diff --git a/extensions/cast/src/test/AndroidManifest.xml b/extensions/cast/src/test/AndroidManifest.xml
index 057efdc245..3f34bbb1f5 100644
--- a/extensions/cast/src/test/AndroidManifest.xml
+++ b/extensions/cast/src/test/AndroidManifest.xml
@@ -15,7 +15,6 @@
 -->
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:tools="http://schemas.android.com/tools"
     package="com.google.android.exoplayer2.ext.cast.test">
 
   <uses-sdk android:minSdkVersion="14" android:targetSdkVersion="26"/>
diff --git a/extensions/cronet/build.gradle b/extensions/cronet/build.gradle
index 1cfb4f5513..0a52344464 100644
--- a/extensions/cronet/build.gradle
+++ b/extensions/cronet/build.gradle
@@ -21,7 +21,6 @@ android {
     defaultConfig {
         minSdkVersion project.ext.minSdkVersion
         targetSdkVersion project.ext.targetSdkVersion
-        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
     }
 
     sourceSets.main {
diff --git a/extensions/cronet/src/test/AndroidManifest.xml b/extensions/cronet/src/test/AndroidManifest.xml
index 52be9aa157..a1512ae605 100644
--- a/extensions/cronet/src/test/AndroidManifest.xml
+++ b/extensions/cronet/src/test/AndroidManifest.xml
@@ -15,7 +15,6 @@
 -->
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:tools="http://schemas.android.com/tools"
     package="com.google.android.exoplayer2.ext.cronet">
 
   <uses-sdk android:minSdkVersion="14" android:targetSdkVersion="26"/>
diff --git a/extensions/ima/build.gradle b/extensions/ima/build.gradle
index 3a20e378ae..1a35ad3450 100644
--- a/extensions/ima/build.gradle
+++ b/extensions/ima/build.gradle
@@ -21,7 +21,7 @@ android {
     defaultConfig {
         minSdkVersion project.ext.minSdkVersion
         targetSdkVersion project.ext.targetSdkVersion
-        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
+        consumerProguardFiles 'proguard-rules.txt'
     }
 }
 
diff --git a/extensions/okhttp/build.gradle b/extensions/okhttp/build.gradle
index 2da245b1a5..2f7d84d33b 100644
--- a/extensions/okhttp/build.gradle
+++ b/extensions/okhttp/build.gradle
@@ -21,6 +21,7 @@ android {
     defaultConfig {
         minSdkVersion project.ext.minSdkVersion
         targetSdkVersion project.ext.targetSdkVersion
+        consumerProguardFiles 'proguard-rules.txt'
     }
 
     lintOptions {
@@ -32,7 +33,7 @@ android {
 dependencies {
     implementation project(modulePrefix + 'library-core')
     implementation 'com.android.support:support-annotations:' + supportLibraryVersion
-    implementation('com.squareup.okhttp3:okhttp:3.9.0') {
+    api('com.squareup.okhttp3:okhttp:3.10.0') {
         exclude group: 'org.json'
     }
 }
diff --git a/extensions/okhttp/proguard-rules.txt b/extensions/okhttp/proguard-rules.txt
new file mode 100644
index 0000000000..50d774a509
--- /dev/null
+++ b/extensions/okhttp/proguard-rules.txt
@@ -0,0 +1,8 @@
+# Proguard rules specific to the OkHttp extension.
+
+# Options specified by https://github.com/square/okhttp/blob/master/README.md
+-dontwarn okhttp3.**
+-dontwarn okio.**
+-dontwarn javax.annotation.**
+-dontwarn org.conscrypt.**
+-keepnames class okhttp3.internal.publicsuffix.PublicSuffixDatabase
diff --git a/javadoc_combined.gradle b/javadoc_combined.gradle
index aba4bf54bd..aea65d4d97 100644
--- a/javadoc_combined.gradle
+++ b/javadoc_combined.gradle
@@ -11,7 +11,7 @@
 // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 // See the License for the specific language governing permissions and
 // limitations under the License.
-apply from: "${rootDir}/javadoc_util.gradle"
+apply from: "${buildscript.sourceFile.parentFile}/javadoc_util.gradle"
 
 class CombinedJavadocPlugin implements Plugin<Project> {
 
diff --git a/javadoc_library.gradle b/javadoc_library.gradle
index a252b148c6..65219843e3 100644
--- a/javadoc_library.gradle
+++ b/javadoc_library.gradle
@@ -11,7 +11,7 @@
 // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 // See the License for the specific language governing permissions and
 // limitations under the License.
-apply from: "${rootDir}/javadoc_util.gradle"
+apply from: "${buildscript.sourceFile.parentFile}/javadoc_util.gradle"
 
 android.libraryVariants.all { variant ->
     def name = variant.buildType.name
diff --git a/library/core/src/main/java/com/google/android/exoplayer2/ExoPlayerLibraryInfo.java b/library/core/src/main/java/com/google/android/exoplayer2/ExoPlayerLibraryInfo.java
index bb3732fb94..e91495227e 100644
--- a/library/core/src/main/java/com/google/android/exoplayer2/ExoPlayerLibraryInfo.java
+++ b/library/core/src/main/java/com/google/android/exoplayer2/ExoPlayerLibraryInfo.java
@@ -29,11 +29,11 @@
 
   /** The version of the library expressed as a string, for example "1.2.3". */
   // Intentionally hardcoded. Do not derive from other constants (e.g. VERSION_INT) or vice versa.
-  public static final String VERSION = "2.7.2";
+  public static final String VERSION = "2.7.3";
 
   /** The version of the library expressed as {@code "ExoPlayerLib/" + VERSION}. */
   // Intentionally hardcoded. Do not derive from other constants (e.g. VERSION) or vice versa.
-  public static final String VERSION_SLASHY = "ExoPlayerLib/2.7.2";
+  public static final String VERSION_SLASHY = "ExoPlayerLib/2.7.3";
 
   /**
    * The version of the library expressed as an integer, for example 1002003.
@@ -43,7 +43,7 @@
    * integer version 123045006 (123-045-006).
    */
   // Intentionally hardcoded. Do not derive from other constants (e.g. VERSION) or vice versa.
-  public static final int VERSION_INT = 2007002;
+  public static final int VERSION_INT = 2007003;
 
   /**
    * Whether the library was compiled with {@link com.google.android.exoplayer2.util.Assertions}
diff --git a/library/core/src/test/AndroidManifest.xml b/library/core/src/test/AndroidManifest.xml
index 660c33c636..f2a4cd6647 100644
--- a/library/core/src/test/AndroidManifest.xml
+++ b/library/core/src/test/AndroidManifest.xml
@@ -15,7 +15,6 @@
 -->
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:tools="http://schemas.android.com/tools"
     package="com.google.android.exoplayer2.core.test">
 
   <uses-sdk android:minSdkVersion="14" android:targetSdkVersion="26"/>
diff --git a/library/dash/src/test/AndroidManifest.xml b/library/dash/src/test/AndroidManifest.xml
index eecf596b92..d18291d0ee 100644
--- a/library/dash/src/test/AndroidManifest.xml
+++ b/library/dash/src/test/AndroidManifest.xml
@@ -15,7 +15,6 @@
 -->
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:tools="http://schemas.android.com/tools"
     package="com.google.android.exoplayer2.source.dash.test">
 
   <uses-sdk android:minSdkVersion="14" android:targetSdkVersion="25"/>
diff --git a/library/hls/src/test/AndroidManifest.xml b/library/hls/src/test/AndroidManifest.xml
index 331f3439ad..89fab4d9a2 100644
--- a/library/hls/src/test/AndroidManifest.xml
+++ b/library/hls/src/test/AndroidManifest.xml
@@ -15,7 +15,6 @@
 -->
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:tools="http://schemas.android.com/tools"
     package="com.google.android.exoplayer2.source.hls.test">
 
   <uses-sdk android:minSdkVersion="14" android:targetSdkVersion="26"/>
diff --git a/library/smoothstreaming/src/test/AndroidManifest.xml b/library/smoothstreaming/src/test/AndroidManifest.xml
index 1a8f8ee9c4..61eb3caddf 100644
--- a/library/smoothstreaming/src/test/AndroidManifest.xml
+++ b/library/smoothstreaming/src/test/AndroidManifest.xml
@@ -15,7 +15,6 @@
 -->
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:tools="http://schemas.android.com/tools"
     package="com.google.android.exoplayer2.source.smoothstreaming.test">
 
   <uses-sdk android:minSdkVersion="14" android:targetSdkVersion="26"/>
diff --git a/testutils/src/test/AndroidManifest.xml b/testutils/src/test/AndroidManifest.xml
index 9602d01633..bea920852c 100644
--- a/testutils/src/test/AndroidManifest.xml
+++ b/testutils/src/test/AndroidManifest.xml
@@ -15,7 +15,6 @@
 -->
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:tools="http://schemas.android.com/tools"
     package="com.google.android.exoplayer2.testutil.test">
 
   <uses-sdk android:minSdkVersion="14" android:targetSdkVersion="26"/>
