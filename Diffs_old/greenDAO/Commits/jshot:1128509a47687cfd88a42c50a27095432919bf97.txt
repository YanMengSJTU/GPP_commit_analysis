diff --git a/DaoCore/src/de/greenrobot/dao/test/AbstractDaoTest.java b/DaoCore/src/de/greenrobot/dao/test/AbstractDaoTest.java
index ba19de41..78baedce 100644
--- a/DaoCore/src/de/greenrobot/dao/test/AbstractDaoTest.java
+++ b/DaoCore/src/de/greenrobot/dao/test/AbstractDaoTest.java
@@ -73,8 +73,12 @@ protected void setUp() {
     }
 
     protected void setUpTableForDao() throws Exception {
-        Method createTableMethod = daoClass.getMethod("createTable", SQLiteDatabase.class, boolean.class);
-        createTableMethod.invoke(null, db, false);
+        try {
+            Method createTableMethod = daoClass.getMethod("createTable", SQLiteDatabase.class, boolean.class);
+            createTableMethod.invoke(null, db, false);
+        } catch (NoSuchMethodException e) {
+            DaoLog.i("No createTable method");
+        }
     }
 
     protected void clearIdentityScopeIfAny() {
diff --git a/DaoGenerator/src-template/dao-unit-test.ftl b/DaoGenerator/src-template/dao-unit-test.ftl
index 8cd898b2..376cf431 100644
--- a/DaoGenerator/src-template/dao-unit-test.ftl
+++ b/DaoGenerator/src-template/dao-unit-test.ftl
@@ -39,7 +39,9 @@ isStringPK>AbstractDaoTestStringPk<${entity.classNameDao}, ${entity.className}><
     @Override
     protected ${entity.className} createEntity(<#if isStringPK>String<#else>Long</#if> key) {
         ${entity.className} entity = new ${entity.className}();
+<#if entity.pkProperty??>
         entity.set${entity.pkProperty.propertyName?cap_first}(key);
+</#if>
 <#list entity.properties as property>
 <#if property.notNull>
         entity.set${property.propertyName?cap_first}();
diff --git a/DaoGenerator/src-template/dao.ftl b/DaoGenerator/src-template/dao.ftl
index fafb977a..f89bfa74 100644
--- a/DaoGenerator/src-template/dao.ftl
+++ b/DaoGenerator/src-template/dao.ftl
@@ -236,13 +236,18 @@ as property>${property.columnName}<#if property_has_next>,</#if></#list>);");
     /** @inheritdoc */
     @Override
     protected ${entity.pkType} updateKeyAfterInsert(${entity.className} entity, long rowId) {
-<#if entity.pkProperty?? && entity.pkProperty.propertyType == "Long">
+<#if entity.pkProperty??>
+<#if entity.pkProperty.propertyType == "Long">
 <#if !entity.protobuf>
         entity.set${entity.pkProperty.propertyName?cap_first}(rowId);
 </#if>
         return rowId;
 <#else>
         return entity.get${entity.pkProperty.propertyName?cap_first}();
+</#if>
+<#else>
+        // Unsupported or missing PK type
+        return null;
 </#if>
     }
     
