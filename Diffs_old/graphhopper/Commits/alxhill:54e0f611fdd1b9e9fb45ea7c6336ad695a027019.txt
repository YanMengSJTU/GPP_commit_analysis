diff --git a/.gitignore b/.gitignore
index 4719a4a493..6836076d3c 100644
--- a/.gitignore
+++ b/.gitignore
@@ -39,3 +39,4 @@ local.properties
 **/node_modules
 *.zip
 .DS_Store
+simulations/
\ No newline at end of file
diff --git a/marmoset/src/main/java/com/graphhopper/marmoset/Marmoset.java b/marmoset/src/main/java/com/graphhopper/marmoset/Marmoset.java
index da97bb144c..ed71851363 100644
--- a/marmoset/src/main/java/com/graphhopper/marmoset/Marmoset.java
+++ b/marmoset/src/main/java/com/graphhopper/marmoset/Marmoset.java
@@ -5,11 +5,9 @@
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
-import java.io.File;
-import java.io.IOException;
+import java.io.*;
 import java.net.InetSocketAddress;
 import java.nio.ByteBuffer;
-import java.util.Arrays;
 import java.util.stream.IntStream;
 
 /**
@@ -37,9 +35,9 @@ public static void main(String[] args) throws IOException, InterruptedException
             startFileServer();
             startWebSocketServer();
         }
-        else
+        else if (args[0].equals("--file"))
         {
-
+            startFileSimulation(args[1], Integer.parseInt(args[2]));
         }
 
         System.out.println("Press enter to terminate");
@@ -51,6 +49,24 @@ public static void main(String[] args) throws IOException, InterruptedException
         System.exit(0);
     }
 
+    private static void startFileSimulation(String outfile, int initialVehicles) throws IOException
+    {
+        PrintWriter p = new PrintWriter("simulations/" + outfile, "UTF-8");
+        start(initialVehicles);
+        while (mh.getVehicleCount() > 0)
+        {
+            if (mh.timestep()) {
+                logger.info("===ITERATION [" + iteration + "]===");
+                if (iteration % 10 == 0)
+                    logger.info(mh.getVehicleCount() + " vehicles remaining");
+                String metrics = mh.getMetrics();
+                p.println(metrics);
+                iteration++;
+            }
+        }
+        p.close();
+    }
+
     public static void start(int initialVehicles)
     {
         if (!isRunning)
