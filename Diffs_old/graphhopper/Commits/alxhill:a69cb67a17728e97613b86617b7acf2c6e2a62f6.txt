diff --git a/marmoset/src/main/java/com/graphhopper/marmoset/Marmoset.java b/marmoset/src/main/java/com/graphhopper/marmoset/Marmoset.java
index e424e022d6..a4081c1b5a 100644
--- a/marmoset/src/main/java/com/graphhopper/marmoset/Marmoset.java
+++ b/marmoset/src/main/java/com/graphhopper/marmoset/Marmoset.java
@@ -3,65 +3,17 @@
 import fi.iki.elonen.SimpleWebServer;
 import fi.iki.elonen.util.ServerRunner;
 
-import org.java_websocket.WebSocket;
-import org.java_websocket.handshake.ClientHandshake;
-import org.java_websocket.server.WebSocketServer;
-
 import java.io.File;
 import java.io.IOException;
 import java.net.InetSocketAddress;
-import java.util.HashSet;
 
 /**
  * Created by alexander on 16/02/2016.
  */
 public class Marmoset {
 
-    private static class MarmosetSocketServer extends WebSocketServer {
-
-        private HashSet<WebSocket> sockets;
-
-        public MarmosetSocketServer(InetSocketAddress address)
-        {
-            super(address);
-            sockets = new HashSet<WebSocket>();
-        }
-
-        public void distributeData(String s) {
-
-
-        }
-
-        @Override
-        public void onOpen(WebSocket webSocket, ClientHandshake clientHandshake)
-        {
-            System.out.println("OPEN!" + webSocket.toString());
-            sockets.add(webSocket);
-        }
-
-        @Override
-        public void onClose(WebSocket webSocket, int i, String s, boolean b)
-        {
-            System.out.println("CLOSE!" + webSocket.toString());
-            sockets.remove(webSocket);
-        }
-
-        @Override
-        public void onMessage(WebSocket webSocket, String s)
-        {
-            System.out.println("Message:" + s);
-        }
-
-        @Override
-        public void onError(WebSocket webSocket, Exception e)
-        {
-            System.out.println("Error :(");
-            sockets.remove(webSocket);
-            e.printStackTrace();
-        }
-    }
-
     private static MarmosetHopper mh;
+    private static MarmosetSocketServer mss;
 
     public static void main(String[] args) throws IOException
     {
@@ -70,15 +22,15 @@ public static void main(String[] args) throws IOException
 
         startFileServer();
         startWebSocketServer();
-
     }
 
     private static void startWebSocketServer()
     {
         int port = 8888;
 
-        WebSocketServer server = new MarmosetSocketServer(new InetSocketAddress(port));
-        server.start();
+        mss = new MarmosetSocketServer(new InetSocketAddress(port));
+        mss.start();
+        System.out.println("Listening for websocket requests.");
     }
 
     private static void startFileServer()
diff --git a/marmoset/src/main/java/com/graphhopper/marmoset/MarmosetSocketServer.java b/marmoset/src/main/java/com/graphhopper/marmoset/MarmosetSocketServer.java
new file mode 100644
index 0000000000..1f610583c4
--- /dev/null
+++ b/marmoset/src/main/java/com/graphhopper/marmoset/MarmosetSocketServer.java
@@ -0,0 +1,57 @@
+package com.graphhopper.marmoset;
+
+import org.java_websocket.WebSocket;
+import org.java_websocket.handshake.ClientHandshake;
+import org.java_websocket.server.WebSocketServer;
+
+import java.net.InetSocketAddress;
+import java.util.HashSet;
+
+/**
+ * Created by alexander on 18/02/2016.
+ */
+public class MarmosetSocketServer extends WebSocketServer {
+
+    private HashSet<WebSocket> sockets;
+
+    public MarmosetSocketServer(InetSocketAddress address)
+    {
+        super(address);
+        sockets = new HashSet<WebSocket>();
+    }
+
+    public void distributeData(String s)
+    {
+        for (WebSocket socket : sockets) {
+            socket.send(s);
+        }
+    }
+
+    @Override
+    public void onOpen(WebSocket webSocket, ClientHandshake clientHandshake)
+    {
+        System.out.println("OPEN!" + webSocket.toString());
+        sockets.add(webSocket);
+    }
+
+    @Override
+    public void onClose(WebSocket webSocket, int i, String s, boolean b)
+    {
+        System.out.println("CLOSE!" + webSocket.toString());
+        sockets.remove(webSocket);
+    }
+
+    @Override
+    public void onMessage(WebSocket webSocket, String s)
+                                                    {
+                                                       System.out.println("Message:" + s);
+                                                                                          }
+
+    @Override
+    public void onError(WebSocket webSocket, Exception e)
+    {
+        System.out.println("Error :(");
+        sockets.remove(webSocket);
+        e.printStackTrace();
+    }
+}
diff --git a/marmoset/src/main/java/com/graphhopper/marmoset/Vehicle.java b/marmoset/src/main/java/com/graphhopper/marmoset/Vehicle.java
index a38e0edad2..029929c585 100644
--- a/marmoset/src/main/java/com/graphhopper/marmoset/Vehicle.java
+++ b/marmoset/src/main/java/com/graphhopper/marmoset/Vehicle.java
@@ -6,8 +6,16 @@
  */
 public class Vehicle {
 
+    private static int maxId = 0;
+
+    private long currentRoadId; // OSM ID of the current road
+    private float lat;
+    private float lon;
+    public final int id;
+
     public Vehicle(long startRoadId)
     {
+        this.id = maxId++;
         this.currentRoadId = startRoadId;
     }
 
@@ -26,7 +34,9 @@ public float getLon()
         return lon;
     }
 
-    private long currentRoadId; // OSM ID of the current road
-    private float lat;
-    private float lon;
+    @Override
+    public String toString()
+    {
+        return String.format("%d|%f|%f", id, getLat(), getLon());
+    }
 }
