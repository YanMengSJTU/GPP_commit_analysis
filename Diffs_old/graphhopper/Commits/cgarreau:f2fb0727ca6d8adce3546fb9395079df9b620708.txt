diff --git a/core/src/test/java/com/graphhopper/GraphHopperTest.java b/core/src/test/java/com/graphhopper/GraphHopperTest.java
index 256abbb97f..ea1e50565d 100644
--- a/core/src/test/java/com/graphhopper/GraphHopperTest.java
+++ b/core/src/test/java/com/graphhopper/GraphHopperTest.java
@@ -448,9 +448,12 @@ public void testPrepareOnly()
     public void testVia()
     {
         instance = new GraphHopper().setInMemory(true).
-                setEncodingManager(new EncodingManager("CAR")).
-                setGraphHopperLocation(ghLoc).
-                setOSMFile(testOsm3);
+                init(
+                new CmdArgs().
+                put("prepare.minNetworkSize", "1").
+                put("osmreader.acceptWay", "CAR").
+                put("osmreader.osm", testOsm3)).
+                setGraphHopperLocation(ghLoc);
         instance.importOrLoad();
 
         // A -> B -> C
