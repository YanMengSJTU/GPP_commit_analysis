diff --git a/build.gradle b/build.gradle
index ea8d78df5..d93cbb23a 100644
--- a/build.gradle
+++ b/build.gradle
@@ -19,6 +19,7 @@ buildscript {
             classpath "net.ltgt.gradle:gradle-errorprone-plugin:${ERROR_PRONE_PLUGIN_VERSION}"
         }
         classpath "se.bjurr.violations:violations-gradle-plugin:${VIOLATIONS_PLUGIN_VERSION}"
+        classpath 'com.github.dcendents:android-maven-gradle-plugin:2.1' // Add this line
     }
 }
 
@@ -39,6 +40,7 @@ subprojects { project ->
         maven {
             url "https://oss.sonatype.org/content/repositories/snapshots"
         }
+        maven { url 'https://jitpack.io' }
     }
 
     tasks.withType(JavaCompile) {
diff --git a/library/build.gradle b/library/build.gradle
index e2fa09bd1..3e1e3d28f 100644
--- a/library/build.gradle
+++ b/library/build.gradle
@@ -1,5 +1,5 @@
 apply plugin: 'com.android.library'
-
+group='com.codyy.mobile'
 if (!hasProperty('DISABLE_ERROR_PRONE')) {
     apply plugin: "net.ltgt.errorprone"
 }
@@ -62,3 +62,42 @@ def classPathForQuality() {
 }
 
 apply from: "${rootProject.projectDir}/scripts/upload.gradle"
+//gradlew assembleRelease
+//---------------------------------------------
+// 指定编码
+tasks.withType(JavaCompile) {
+    options.encoding = "UTF-8"
+}
+
+// 打包源码
+task sourcesJar(type: Jar) {
+    from android.sourceSets.main.java.srcDirs
+    classifier = 'sources'
+}
+
+task javadoc(type: Javadoc) {
+    failOnError  false
+    source = android.sourceSets.main.java.sourceFiles
+    classpath += project.files(android.getBootClasspath().join(File.pathSeparator))
+    classpath += configurations.compile
+}
+javadoc {
+    options {
+        encoding "UTF-8"
+        charSet 'UTF-8'
+        author true
+        version true
+        links "http://docs.oracle.com/javase/7/docs/api"
+        title "glide4.9.0"
+    }
+}
+// 制作文档(Javadoc)
+task javadocJar(type: Jar, dependsOn: javadoc) {
+    classifier = 'javadoc'
+    from javadoc.destinationDir
+}
+
+artifacts {
+    archives sourcesJar
+    archives javadocJar
+}
diff --git a/library/src/main/java/com/bumptech/glide/Registry.java b/library/src/main/java/com/bumptech/glide/Registry.java
index c5903fcf2..37c5e687a 100644
--- a/library/src/main/java/com/bumptech/glide/Registry.java
+++ b/library/src/main/java/com/bumptech/glide/Registry.java
@@ -266,8 +266,9 @@ public Registry() {
   @NonNull
   public final Registry setResourceDecoderBucketPriorityList(@NonNull List<String> buckets) {
     // See #3296 and https://bugs.openjdk.java.net/browse/JDK-6260652.
-    List<String> modifiedBuckets = new ArrayList<>(buckets.size());
-    modifiedBuckets.addAll(buckets);
+    //List<String> modifiedBuckets = new ArrayList<>(buckets.size());
+    //modifiedBuckets.addAll(buckets);
+    List<String> modifiedBuckets = Arrays.asList(Arrays.copyOf(new List[]{buckets}, buckets.size(), String[].class));
     modifiedBuckets.add(0, BUCKET_PREPEND_ALL);
     modifiedBuckets.add(BUCKET_APPEND_ALL);
     decoderRegistry.setBucketPriorityList(modifiedBuckets);
