diff --git a/javatests/dagger/functional/BUILD b/javatests/dagger/functional/BUILD
index 093b6abec..58056d57c 100644
--- a/javatests/dagger/functional/BUILD
+++ b/javatests/dagger/functional/BUILD
@@ -21,6 +21,7 @@ load(
     "//:build_defs.bzl",
     "DOCLINT_HTML_AND_SYNTAX",
     "PRE_JAVA_8_INFERENCE_OPTS",
+    "SOURCE_7_TARGET_7",
 )
 load("//:test_defs.bzl", "GenJavaTests")
 
@@ -29,7 +30,8 @@ GenJavaTests(
     srcs = glob(
         ["**/*.java"],
     ),
-    javacopts = PRE_JAVA_8_INFERENCE_OPTS + DOCLINT_HTML_AND_SYNTAX,
+    javacopts = DOCLINT_HTML_AND_SYNTAX,
+    lib_javacopts = SOURCE_7_TARGET_7 + PRE_JAVA_8_INFERENCE_OPTS,
     # NOTE: This should not depend on Guava or jsr305 to ensure that Dagger can be
     # used without Guava and jsr305 deps.
     test_only_deps = [
diff --git a/test_defs.bzl b/test_defs.bzl
index 59c1e826c..4c86d3543 100644
--- a/test_defs.bzl
+++ b/test_defs.bzl
@@ -12,23 +12,19 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-def GenJavaTests(name, srcs, deps, test_only_deps = None, plugins = None, javacopts = None):
-  _GenTests(
-      native.java_library, native.java_test, name, srcs, deps, test_only_deps, plugins, javacopts)
+def GenJavaTests(name, srcs, deps, test_only_deps=None, plugins=None, javacopts=None,
+                 lib_javacopts=None, test_javacopts=None):
+  _GenTests(native.java_library, native.java_test, name, srcs, deps, test_only_deps=test_only_deps,
+            plugins=plugins, javacopts=javacopts, lib_javacopts=lib_javacopts,
+            test_javacopts=test_javacopts)
 
-def GenRobolectricTests(name, srcs, deps, test_only_deps = None, plugins = None, javacopts = None):
+def GenRobolectricTests(name, srcs, deps, test_only_deps=None, plugins=None, javacopts=None,
+                        lib_javacopts=None, test_javacopts=None):
   # TODO(ronshapiro): enable these when Bazel supports robolectric tests
   pass
 
-def _GenTests(
-    library_rule_type,
-    test_rule_type,
-    name,
-    srcs,
-    deps,
-    test_only_deps = None,
-    plugins = None,
-    javacopts = None):
+def _GenTests(library_rule_type, test_rule_type, name, srcs, deps, test_only_deps=None,
+              plugins=None, javacopts=None, lib_javacopts=None, test_javacopts=None):
   test_files = []
   supporting_files = []
   for src in srcs:
@@ -49,7 +45,7 @@ def _GenTests(
         deps = deps,
         srcs = supporting_files,
         plugins = plugins,
-        javacopts = javacopts,
+        javacopts = (javacopts or []) + (lib_javacopts or []),
         testonly = 1,
     )
 
@@ -64,6 +60,6 @@ def _GenTests(
         deps = test_deps,
         srcs = [test_file],
         plugins = plugins,
-        javacopts = javacopts,
+        javacopts = (javacopts or []) + (test_javacopts or []),
         test_class = test_class,
     )
