diff --git a/java/dagger/internal/codegen/BUILD b/java/dagger/internal/codegen/BUILD
index 426096962..0a472eb1c 100644
--- a/java/dagger/internal/codegen/BUILD
+++ b/java/dagger/internal/codegen/BUILD
@@ -76,6 +76,8 @@ gen_maven_artifact(
     # The javadocs should only include ComponentProcessor.java, since that is the only class used
     # externally. Specifically, ComponentProcessor.forTesting() is required for testing SPI plugins.
     javadoc_srcs = ["ComponentProcessor.java"],
+    shaded_deps = ["@com_google_auto_auto_common//jar"],
+    shaded_rules = ["rule com.google.auto.common.** dagger.shaded.auto.common.@1"],
     deps = [
         ":package_info",
         "//java/dagger/internal/codegen/base",
diff --git a/java/dagger/producers/BUILD b/java/dagger/producers/BUILD
index 891926d07..a7e4aba06 100644
--- a/java/dagger/producers/BUILD
+++ b/java/dagger/producers/BUILD
@@ -64,4 +64,5 @@ gen_maven_artifact(
     ],
     javadoc_root_packages = ["dagger.producers"],
     javadoc_srcs = SRCS,
+    # TODO(user): Look more into why auto/common shading isn't needed here.
 )
diff --git a/java/dagger/spi/BUILD b/java/dagger/spi/BUILD
index fb02754da..9829d1ab6 100644
--- a/java/dagger/spi/BUILD
+++ b/java/dagger/spi/BUILD
@@ -60,6 +60,8 @@ gen_maven_artifact(
         ":spi-srcs",
         "//java/dagger/model:model-srcs",
     ],
+    shaded_deps = ["@com_google_auto_auto_common//jar"],
+    shaded_rules = ["rule com.google.auto.common.** dagger.shaded.auto.common.@1"],
     deps = [
         "//java/dagger/internal/codegen/extension",
         "//java/dagger/model",
diff --git a/tools/maven.bzl b/tools/maven.bzl
index b84bf425c..94a762095 100644
--- a/tools/maven.bzl
+++ b/tools/maven.bzl
@@ -40,8 +40,6 @@ def pom_file(name, targets, artifact_name, artifact_id, packaging = None, **kwar
 
 POM_VERSION = "${project.version}"
 
-_SHADE_RULES = ["rule com.google.auto.common.** dagger.shaded.auto.common.@1"]
-
 def gen_maven_artifact(
         name,
         artifact_name,
@@ -53,7 +51,9 @@ def gen_maven_artifact(
         javadoc_root_packages = None,
         javadoc_exclude_packages = None,
         javadoc_android_api_level = None,
-        deps = None):
+        deps = None,
+        shaded_deps = None,
+        shaded_rules = None):
     """Generates the files required for a maven artifact.
 
     This macro generates the following targets:
@@ -81,6 +81,8 @@ def gen_maven_artifact(
       javadoc_exclude_packages: The packages to exclude from the javadocs.
       javadoc_android_api_level: The android api level for the javadocs.
       deps: The required deps to include with the target.
+      shaded_deps: The shaded deps for the jarjar.
+      shaded_rules: The shaded rules for the jarjar
     """
     _validate_maven_deps(
         name = name + "-validation",
@@ -88,6 +90,8 @@ def gen_maven_artifact(
         deps = deps,
     )
 
+    shaded_deps = shaded_deps or []
+    shaded_rules = shaded_rules or []
     artifact_targets = [artifact_target] + (deps or [])
 
     pom_file(
@@ -109,8 +113,8 @@ def gen_maven_artifact(
 
     jarjar_library(
         name = name,
-        jars = artifact_targets,
-        rules = _SHADE_RULES,
+        jars = artifact_targets + shaded_deps,
+        rules = shaded_rules,
     )
 
     jarjar_library(
