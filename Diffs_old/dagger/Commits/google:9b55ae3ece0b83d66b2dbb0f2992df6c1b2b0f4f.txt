diff --git a/java/dagger/internal/codegen/BindingGraphConverter.java b/java/dagger/internal/codegen/BindingGraphConverter.java
index 89ad6f195..f09004a93 100644
--- a/java/dagger/internal/codegen/BindingGraphConverter.java
+++ b/java/dagger/internal/codegen/BindingGraphConverter.java
@@ -104,6 +104,7 @@ protected void visitComponent(BindingGraph graph) {
       network.addNode(currentComponent);
 
       for (ResolvedBindings resolvedBindings : graph.resolvedBindings()) {
+        ImmutableSet<TypeElement> declaringModules = subcomponentDeclaringModules(resolvedBindings);
         for (BindingNode binding : bindingNodes(resolvedBindings)) {
           addBinding(binding);
           if (binding.kind().equals(SUBCOMPONENT_BUILDER)
@@ -111,8 +112,7 @@ protected void visitComponent(BindingGraph graph) {
             network.addEdge(
                 binding,
                 subcomponentNode(binding.key().type(), graph),
-                new SubcomponentBuilderBindingEdgeImpl(
-                    subcomponentDeclaringModules(resolvedBindings)));
+                new SubcomponentBuilderBindingEdgeImpl(declaringModules));
           }
         }
       }
