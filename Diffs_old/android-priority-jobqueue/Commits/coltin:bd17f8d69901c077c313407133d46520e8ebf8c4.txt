diff --git a/jobqueue/build.gradle b/jobqueue/build.gradle
index 454e81b..0a27a4f 100644
--- a/jobqueue/build.gradle
+++ b/jobqueue/build.gradle
@@ -1,5 +1,3 @@
-import com.android.builder.core.BuilderConstants
-
 import java.util.regex.Pattern
 
 apply plugin: 'com.android.library'
@@ -7,6 +5,7 @@ apply plugin: 'com.android.library'
 Properties releaseConfig = new Properties()
 releaseConfig.load(new FileInputStream("${projectDir}/releaseConfig.properties"))
 ext.releaseConfig = releaseConfig
+
 task wrapper(type: Wrapper) {
     gradleVersion = '2.8.0'
 }
@@ -73,7 +72,7 @@ println "version name:${manifestVersionName}"
 android.libraryVariants.all { variant ->
     def name = variant.buildType.name
     println "checking variant ${name}"
-    if (name.equals(BuilderConstants.DEBUG)) {
+    if (variant.buildType.isDebuggable()) {
         return; // Skip debug builds.
     }
     def suffix = name.capitalize()
diff --git a/jobqueue/src/main/java/com/path/android/jobqueue/network/NetworkUtilImpl.java b/jobqueue/src/main/java/com/path/android/jobqueue/network/NetworkUtilImpl.java
index 873f76a..96798f0 100644
--- a/jobqueue/src/main/java/com/path/android/jobqueue/network/NetworkUtilImpl.java
+++ b/jobqueue/src/main/java/com/path/android/jobqueue/network/NetworkUtilImpl.java
@@ -36,6 +36,9 @@ public void onReceive(Context context, Intent intent) {
 
     @Override
     public boolean isConnected(Context context) {
+        // During Doze mode, also called Idle, the network is unavailable but isConnectedOrConnecting()
+        // will return true. So we first check if we are in idle mode through the PowerManager before
+        // trusting the ConnectivityManager.
         if (VERSION.SDK_INT >= VERSION_CODES.M) {
             PowerManager powerManager = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
             if (powerManager.isDeviceIdleMode()) {
